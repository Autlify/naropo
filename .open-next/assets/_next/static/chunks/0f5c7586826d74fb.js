(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,868499,e=>{"use strict";let t;var r=e.i(843476),a=e.i(271645),o=e.i(30030),n=e.i(820783),s=e.i(326999),l=e.i(981140),i=Symbol("radix.slottable"),d="AlertDialog",[c,u]=(0,o.createContextScope)(d,[s.createDialogScope]),m=(0,s.createDialogScope)(),p=e=>{let{__scopeAlertDialog:t,...a}=e,o=m(t);return(0,r.jsx)(s.Root,{...o,...a,modal:!0})};p.displayName=d;var g=a.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...o}=e,n=m(a);return(0,r.jsx)(s.Trigger,{...n,...o,ref:t})});g.displayName="AlertDialogTrigger";var f=e=>{let{__scopeAlertDialog:t,...a}=e,o=m(t);return(0,r.jsx)(s.Portal,{...o,...a})};f.displayName="AlertDialogPortal";var h=a.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...o}=e,n=m(a);return(0,r.jsx)(s.Overlay,{...n,...o,ref:t})});h.displayName="AlertDialogOverlay";var b="AlertDialogContent",[x,y]=c(b),v=((t=({children:e})=>(0,r.jsx)(r.Fragment,{children:e})).displayName="AlertDialogContent.Slottable",t.__radixId=i,t),C=a.forwardRef((e,t)=>{let{__scopeAlertDialog:o,children:i,...d}=e,c=m(o),u=a.useRef(null),p=(0,n.useComposedRefs)(t,u),g=a.useRef(null);return(0,r.jsx)(s.WarningProvider,{contentName:b,titleName:j,docsSlug:"alert-dialog",children:(0,r.jsx)(x,{scope:o,cancelRef:g,children:(0,r.jsxs)(s.Content,{role:"alertdialog",...c,...d,ref:p,onOpenAutoFocus:(0,l.composeEventHandlers)(d.onOpenAutoFocus,e=>{e.preventDefault(),g.current?.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,r.jsx)(v,{children:i}),(0,r.jsx)(D,{contentRef:u})]})})})});C.displayName=b;var j="AlertDialogTitle",w=a.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...o}=e,n=m(a);return(0,r.jsx)(s.Title,{...n,...o,ref:t})});w.displayName=j;var S="AlertDialogDescription",A=a.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...o}=e,n=m(a);return(0,r.jsx)(s.Description,{...n,...o,ref:t})});A.displayName=S;var F=a.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...o}=e,n=m(a);return(0,r.jsx)(s.Close,{...n,...o,ref:t})});F.displayName="AlertDialogAction";var N="AlertDialogCancel",k=a.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...o}=e,{cancelRef:l}=y(N,a),i=m(a),d=(0,n.useComposedRefs)(t,l);return(0,r.jsx)(s.Close,{...i,...o,ref:d})});k.displayName=N;var D=({contentRef:e})=>{let t=`\`${b}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${b}\` by passing a \`${S}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${b}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return a.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},L=e.i(975157),M=e.i(519455);let E=a.forwardRef(({className:e,...t},a)=>(0,r.jsx)(h,{className:(0,L.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:a}));E.displayName=h.displayName;let V=a.forwardRef(({className:e,...t},a)=>(0,r.jsxs)(f,{children:[(0,r.jsx)(E,{}),(0,r.jsx)(C,{ref:a,className:(0,L.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));V.displayName=C.displayName;let I=({className:e,...t})=>(0,r.jsx)("div",{className:(0,L.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});I.displayName="AlertDialogHeader";let R=({className:e,...t})=>(0,r.jsx)("div",{className:(0,L.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});R.displayName="AlertDialogFooter";let U=a.forwardRef(({className:e,...t},a)=>(0,r.jsx)(w,{ref:a,className:(0,L.cn)("text-lg font-semibold",e),...t}));U.displayName=w.displayName;let T=a.forwardRef(({className:e,...t},a)=>(0,r.jsx)(A,{ref:a,className:(0,L.cn)("text-sm text-muted-foreground",e),...t}));T.displayName=A.displayName;let P=a.forwardRef(({className:e,...t},a)=>(0,r.jsx)(F,{ref:a,className:(0,L.cn)((0,M.buttonVariants)(),e),...t}));P.displayName=F.displayName;let O=a.forwardRef(({className:e,...t},a)=>(0,r.jsx)(k,{ref:a,className:(0,L.cn)((0,M.buttonVariants)({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));O.displayName=k.displayName,e.s(["AlertDialog",()=>p,"AlertDialogAction",()=>P,"AlertDialogCancel",()=>O,"AlertDialogContent",()=>V,"AlertDialogDescription",()=>T,"AlertDialogFooter",()=>R,"AlertDialogHeader",()=>I,"AlertDialogOverlay",()=>E,"AlertDialogPortal",()=>f,"AlertDialogTitle",()=>U,"AlertDialogTrigger",()=>g],868499)},924765,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("7ce77e2f8558484be720070be666097800d1d54b31",t.callServer,void 0,t.findSourceMapURL,"changeUserPermissions");e.s(["changeUserPermissions",()=>r])},11765,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("00d1e8c27b8f6f54414802ce4b8fc7cfdbce5b4072",t.callServer,void 0,t.findSourceMapURL,"getAuthUserDetails");e.s(["getAuthUserDetails",()=>r])},361919,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("400e4316b3f57301b5e594a2e827f77a092945f2fa",t.callServer,void 0,t.findSourceMapURL,"getUserMemberships");e.s(["getUserMemberships",()=>r])},724296,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("40464f6453247197f55b96edcbb5a1d00b3b500f33",t.callServer,void 0,t.findSourceMapURL,"updateUser");e.s(["updateUser",()=>r])},721898,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("40d54bd414469e40ff3b9278e05b5e53ff02ef900a",t.callServer,void 0,t.findSourceMapURL,"hasPermission");e.s(["hasPermission",()=>r])},72028,e=>{"use strict";var t=e.i(843476),r=e.i(86896),a=e.i(271645),o=e.i(922140),n=e.i(618566),s=e.i(924765),l=e.i(11765),i=e.i(361919),d=e.i(2170),c=e.i(724296),u=e.i(721898),m=e.i(681307),p=e.i(653145),g=e.i(994814),f=e.i(515288),h=e.i(903133),b=e.i(795320),x=e.i(793479),y=e.i(519455),v=e.i(888173),C=e.i(772436),j=e.i(699375);e.s(["default",0,({id:e,type:w,subAccounts:S,userData:A})=>{let[F,N]=(0,a.useState)(null),{data:k,setClose:D}=(0,r.useModal)(),[L,M]=(0,a.useState)(""),[E,V]=(0,a.useState)(!1),[I,R]=(0,a.useState)(null),[U,T]=(0,a.useState)(!1),{toast:P}=(0,o.useToast)(),O=(0,n.useRouter)();(0,a.useEffect)(()=>{k.user&&(async()=>{let e=await (0,l.getAuthUserDetails)();e&&R(e),T(await (0,u.hasPermission)("core.agency.team_member.invite"))})()},[k]);let _=m.z.object({name:m.z.string().min(1),email:m.z.string().email(),avatarUrl:m.z.string().nullable().optional()}),$=(0,p.useForm)({resolver:(0,g.zodResolver)(_),mode:"onChange",defaultValues:{name:(A?A.name:k?.user?.name)||"",email:(A?A.email:k?.user?.email)||"",avatarUrl:A?A.avatarUrl??void 0:k?.user?.avatarUrl??void 0}});(0,a.useEffect)(()=>{k.user&&(async()=>{k.user&&N(await (0,i.getUserMemberships)(k.user.id))})()},[k,$]);let H=async(e,t,r)=>{if(!k.user?.id)return;V(!0);let a=F?.SubAccountMemberships?.find(t=>t.subAccountId===e)?.roleId;if(!a){P({variant:"destructive",title:"Failed",description:"Could not find role for permission update"}),V(!1);return}let o=await (0,s.changeUserPermissions)(k.user.id,a,"subaccount",void 0,e),n=I?.AgencyMemberships?.[0];"agency"===w&&n&&await (0,d.saveActivityLogsNotification)({agencyId:n.agencyId,description:`Gave ${A?.name} access to | ${F?.SubAccountMemberships?.find(t=>t.subAccountId===e)?.SubAccount?.name} `,subaccountId:e}),o?P({title:"Success",description:"The request was successfull"}):P({variant:"destructive",title:"Failed",description:"Could not update permissions"}),O.refresh(),V(!1)},B=async t=>{if(!e)return;let r=$.getValues();if(A||k?.user){let e=await (0,c.updateUser)(r),t=I?.AgencyMemberships?.[0];t&&t.Agency.SubAccount.filter(e=>I.SubAccountMemberships?.some(t=>t.subAccountId===e.id&&t.isActive)).forEach(async e=>{await (0,d.saveActivityLogsNotification)({agencyId:void 0,description:`Updated ${A?.name} information`,subaccountId:e.id})}),e?(P({title:"Success",description:"Update User Information"}),D(),O.refresh()):P({variant:"destructive",title:"Oppse!",description:"Could not update user information"})}else console.log("Error could not submit")};return(0,t.jsxs)(f.Card,{className:"w-full",children:[(0,t.jsxs)(f.CardHeader,{children:[(0,t.jsx)(f.CardTitle,{children:"User Details"}),(0,t.jsx)(f.CardDescription,{children:"Add or update your information"})]}),(0,t.jsx)(f.CardContent,{children:(0,t.jsx)(h.Form,{...$,children:(0,t.jsxs)("form",{onSubmit:$.handleSubmit(B),className:"space-y-4",children:[(0,t.jsx)(h.FormField,{disabled:$.formState.isSubmitting,control:$.control,name:"avatarUrl",render:({field:e})=>(0,t.jsxs)(h.FormItem,{children:[(0,t.jsx)(h.FormLabel,{children:"Profile picture"}),(0,t.jsx)(h.FormControl,{children:(0,t.jsx)(b.default,{apiEndpoint:"avatar",value:e.value||void 0,onChange:e.onChange})}),(0,t.jsx)(h.FormMessage,{})]})}),(0,t.jsx)(h.FormField,{disabled:$.formState.isSubmitting,control:$.control,name:"name",render:({field:e})=>(0,t.jsxs)(h.FormItem,{className:"flex-1",children:[(0,t.jsx)(h.FormLabel,{children:"User full name"}),(0,t.jsx)(h.FormControl,{children:(0,t.jsx)(x.Input,{required:!0,placeholder:"Full Name",...e})}),(0,t.jsx)(h.FormMessage,{})]})}),(0,t.jsx)(h.FormField,{disabled:$.formState.isSubmitting,control:$.control,name:"email",render:({field:e})=>(0,t.jsxs)(h.FormItem,{className:"flex-1",children:[(0,t.jsx)(h.FormLabel,{children:"Email"}),(0,t.jsx)(h.FormControl,{children:(0,t.jsx)(x.Input,{readOnly:$.formState.isSubmitting,placeholder:"Email",...e})}),(0,t.jsx)(h.FormMessage,{})]})}),(0,t.jsx)(y.Button,{disabled:$.formState.isSubmitting,type:"submit",children:$.formState.isSubmitting?(0,t.jsx)(v.default,{}):"Save User Details"}),U&&(0,t.jsxs)("div",{children:[(0,t.jsx)(C.Separator,{className:"my-4"}),(0,t.jsx)(h.FormLabel,{children:" User Permissions"}),(0,t.jsx)(h.FormDescription,{className:"mb-4",children:"You can give Sub Account access to team member by turning on access control for each Sub Account. This is only visible to agency owners"}),(0,t.jsx)("div",{className:"flex flex-col gap-4",children:S?.map(e=>{let r=F?.SubAccountMemberships?.find(t=>t.subAccountId===e.id);return(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[(0,t.jsx)("div",{children:(0,t.jsx)("p",{children:e.name})}),(0,t.jsx)(j.Switch,{disabled:E,checked:r?.isActive,onCheckedChange:t=>{H(e.id,t,r?.id)}})]},e.id)})})]})]})})})]})}])},824356,847130,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("40fdae98fa52de3fc80204287d341014b32b4e0853",t.callServer,void 0,t.findSourceMapURL,"deleteAgency");e.s(["deleteAgency",()=>r],824356);let a=(0,t.createServerReference)("7047958315d032829b8c444890acd418149a8c123a",t.callServer,void 0,t.findSourceMapURL,"initUser");e.s(["initUser",()=>a],847130)},314560,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("60760475caf56aba00693d5e265157d944e2584156",t.callServer,void 0,t.findSourceMapURL,"updateAgencyDetails");e.s(["updateAgencyDetails",()=>r])},213557,e=>{"use strict";var t=e.i(95187);let r=(0,t.createServerReference)("60fe1d98610af4fb0b4d1bd574e6cd26a9d3a4edee",t.callServer,void 0,t.findSourceMapURL,"upsertAgency");e.s(["upsertAgency",()=>r])},445747,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(290571);let o=e=>{var t=(0,a.__rest)(e,[]);return r.default.createElement("svg",Object.assign({},t,{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2.5"}),r.default.createElement("path",{d:"M12 4v16m8-8H4"}))},n=e=>{var t=(0,a.__rest)(e,[]);return r.default.createElement("svg",Object.assign({},t,{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2.5"}),r.default.createElement("path",{d:"M20 12H4"}))};var s=e.i(444755),l=e.i(673706);let i=e=>{var t=(0,a.__rest)(e,[]);return r.default.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},t),r.default.createElement("path",{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM11 15V17H13V15H11ZM11 7V13H13V7H11Z"}))},d=e=>{var t=(0,a.__rest)(e,[]);return r.default.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},t),r.default.createElement("path",{d:"M1.18164 12C2.12215 6.87976 6.60812 3 12.0003 3C17.3924 3 21.8784 6.87976 22.8189 12C21.8784 17.1202 17.3924 21 12.0003 21C6.60812 21 2.12215 17.1202 1.18164 12ZM12.0003 17C14.7617 17 17.0003 14.7614 17.0003 12C17.0003 9.23858 14.7617 7 12.0003 7C9.23884 7 7.00026 9.23858 7.00026 12C7.00026 14.7614 9.23884 17 12.0003 17ZM12.0003 15C10.3434 15 9.00026 13.6569 9.00026 12C9.00026 10.3431 10.3434 9 12.0003 9C13.6571 9 15.0003 10.3431 15.0003 12C15.0003 13.6569 13.6571 15 12.0003 15Z"}))},c=e=>{var t=(0,a.__rest)(e,[]);return r.default.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},t),r.default.createElement("path",{d:"M4.52047 5.93457L1.39366 2.80777L2.80788 1.39355L22.6069 21.1925L21.1927 22.6068L17.8827 19.2968C16.1814 20.3755 14.1638 21.0002 12.0003 21.0002C6.60812 21.0002 2.12215 17.1204 1.18164 12.0002C1.61832 9.62282 2.81932 7.5129 4.52047 5.93457ZM14.7577 16.1718L13.2937 14.7078C12.902 14.8952 12.4634 15.0002 12.0003 15.0002C10.3434 15.0002 9.00026 13.657 9.00026 12.0002C9.00026 11.537 9.10522 11.0984 9.29263 10.7067L7.82866 9.24277C7.30514 10.0332 7.00026 10.9811 7.00026 12.0002C7.00026 14.7616 9.23884 17.0002 12.0003 17.0002C13.0193 17.0002 13.9672 16.6953 14.7577 16.1718ZM7.97446 3.76015C9.22127 3.26959 10.5793 3.00016 12.0003 3.00016C17.3924 3.00016 21.8784 6.87992 22.8189 12.0002C22.5067 13.6998 21.8038 15.2628 20.8068 16.5925L16.947 12.7327C16.9821 12.4936 17.0003 12.249 17.0003 12.0002C17.0003 9.23873 14.7617 7.00016 12.0003 7.00016C11.7514 7.00016 11.5068 7.01833 11.2677 7.05343L7.97446 3.76015Z"}))},u=r.default.forwardRef((e,t)=>{var o;let{value:n,defaultValue:u,type:m,placeholder:p="Type...",icon:g,error:f=!1,errorMessage:h,disabled:b=!1,stepper:x,makeInputClassName:y,className:v,onChange:C,onValueChange:j,autoFocus:w,pattern:S}=e,A=(0,a.__rest)(e,["value","defaultValue","type","placeholder","icon","error","errorMessage","disabled","stepper","makeInputClassName","className","onChange","onValueChange","autoFocus","pattern"]),[F,N]=(0,r.useState)(w||!1),[k,D]=(0,r.useState)(!1),L=(0,r.useCallback)(()=>D(!k),[k,D]),M=(0,r.useRef)(null),E=null!=(o=n||u)&&""!==o;return r.default.useEffect(()=>{let e=()=>N(!0),t=()=>N(!1),r=M.current;return r&&(r.addEventListener("focus",e),r.addEventListener("blur",t),w&&r.focus()),()=>{r&&(r.removeEventListener("focus",e),r.removeEventListener("blur",t))}},[w]),r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:(0,s.tremorTwMerge)(y("root"),"relative w-full flex items-center min-w-[10rem] outline-none rounded-tremor-default transition duration-100 border","shadow-tremor-input","dark:shadow-dark-tremor-input",((e,t,r=!1)=>(0,s.tremorTwMerge)(t?"bg-tremor-background-subtle dark:bg-dark-tremor-background-subtle":"bg-tremor-background dark:bg-dark-tremor-background",!t&&"hover:bg-tremor-background-muted dark:hover:bg-dark-tremor-background-muted",e?"text-tremor-content-emphasis dark:text-dark-tremor-content-emphasis":"text-tremor-content dark:text-dark-tremor-content",t&&"text-tremor-content-subtle dark:text-dark-tremor-content-subtle",r&&"text-red-500 placeholder:text-red-500 dark:text-red-500 dark:placeholder:text-red-500",r?"border-red-500 dark:border-red-500":"border-tremor-border dark:border-dark-tremor-border"))(E,b,f),F&&(0,s.tremorTwMerge)("ring-2","border-tremor-brand-subtle ring-tremor-brand-muted","dark:border-dark-tremor-brand-subtle dark:ring-dark-tremor-brand-muted"),v)},g?r.default.createElement(g,{className:(0,s.tremorTwMerge)(y("icon"),"shrink-0 h-5 w-5 mx-2.5 absolute left-0 flex items-center","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle")}):null,r.default.createElement("input",Object.assign({ref:(0,l.mergeRefs)([M,t]),defaultValue:u,value:n,type:k?"text":m,className:(0,s.tremorTwMerge)(y("input"),"w-full bg-transparent focus:outline-none focus:ring-0 border-none text-tremor-default rounded-tremor-default transition duration-100 py-2","text-tremor-content-emphasis","dark:text-dark-tremor-content-emphasis","[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none","password"===m?f?"pr-16":"pr-12":f?"pr-8":"pr-3",g?"pl-10":"pl-3",b?"placeholder:text-tremor-content-subtle dark:placeholder:text-dark-tremor-content-subtle":"placeholder:text-tremor-content dark:placeholder:text-dark-tremor-content"),placeholder:p,disabled:b,"data-testid":"base-input",onChange:e=>{null==C||C(e),null==j||j(e.target.value)},pattern:S},A)),"password"!==m||b?null:r.default.createElement("button",{className:(0,s.tremorTwMerge)(y("toggleButton"),"absolute inset-y-0 right-0 flex items-center px-2.5 rounded-lg"),type:"button",onClick:()=>L(),"aria-label":k?"Hide password":"Show Password"},k?r.default.createElement(c,{className:(0,s.tremorTwMerge)("flex-none h-5 w-5 transition","text-tremor-content-subtle hover:text-tremor-content","dark:text-dark-tremor-content-subtle hover:dark:text-dark-tremor-content"),"aria-hidden":!0}):r.default.createElement(d,{className:(0,s.tremorTwMerge)("flex-none h-5 w-5 transition","text-tremor-content-subtle hover:text-tremor-content","dark:text-dark-tremor-content-subtle hover:dark:text-dark-tremor-content"),"aria-hidden":!0})),f?r.default.createElement(i,{className:(0,s.tremorTwMerge)(y("errorIcon"),"text-red-500 shrink-0 h-5 w-5 absolute right-0 flex items-center","password"===m?"mr-10":"number"===m?x?"mr-20":"mr-3":"mx-2.5")}):null,null!=x?x:null),f&&h?r.default.createElement("p",{className:(0,s.tremorTwMerge)(y("errorMessage"),"text-sm text-red-500 mt-1")},h):null)});u.displayName="BaseInput";let m="flex mx-auto text-tremor-content-subtle dark:text-dark-tremor-content-subtle",p="cursor-pointer hover:text-tremor-content dark:hover:text-dark-tremor-content",g=r.default.forwardRef((e,t)=>{let{onSubmit:i,enableStepper:d=!0,disabled:c,onValueChange:g,onChange:f}=e,h=(0,a.__rest)(e,["onSubmit","enableStepper","disabled","onValueChange","onChange"]),b=(0,r.useRef)(null),[x,y]=r.default.useState(!1),v=r.default.useCallback(()=>{y(!0)},[]),C=r.default.useCallback(()=>{y(!1)},[]),[j,w]=r.default.useState(!1),S=r.default.useCallback(()=>{w(!0)},[]),A=r.default.useCallback(()=>{w(!1)},[]);return r.default.createElement(u,Object.assign({type:"number",ref:(0,l.mergeRefs)([b,t]),disabled:c,makeInputClassName:(0,l.makeClassName)("NumberInput"),onKeyDown:e=>{var t;if("Enter"===e.key&&!e.ctrlKey&&!e.altKey&&!e.shiftKey){let e=null==(t=b.current)?void 0:t.value;null==i||i(parseFloat(null!=e?e:""))}"ArrowDown"===e.key&&v(),"ArrowUp"===e.key&&S()},onKeyUp:e=>{"ArrowDown"===e.key&&C(),"ArrowUp"===e.key&&A()},onChange:e=>{c||(null==g||g(parseFloat(e.target.value)),null==f||f(e))},stepper:d?r.default.createElement("div",{className:(0,s.tremorTwMerge)("flex justify-center align-middle")},r.default.createElement("div",{tabIndex:-1,onClick:e=>e.preventDefault(),onMouseDown:e=>e.preventDefault(),onTouchStart:e=>{e.cancelable&&e.preventDefault()},onMouseUp:()=>{var e,t;c||(null==(e=b.current)||e.stepDown(),null==(t=b.current)||t.dispatchEvent(new Event("input",{bubbles:!0})))},className:(0,s.tremorTwMerge)(!c&&p,m,"group py-[10px] px-2.5 border-l border-tremor-border dark:border-dark-tremor-border")},r.default.createElement(n,{"data-testid":"step-down",className:(x?"scale-95":"")+" h-4 w-4 duration-75 transition group-active:scale-95"})),r.default.createElement("div",{tabIndex:-1,onClick:e=>e.preventDefault(),onMouseDown:e=>e.preventDefault(),onTouchStart:e=>{e.cancelable&&e.preventDefault()},onMouseUp:()=>{var e,t;c||(null==(e=b.current)||e.stepUp(),null==(t=b.current)||t.dispatchEvent(new Event("input",{bubbles:!0})))},className:(0,s.tremorTwMerge)(!c&&p,m,"group py-[10px] px-2.5 border-l border-tremor-border dark:border-dark-tremor-border")},r.default.createElement(o,{"data-testid":"step-up",className:(j?"scale-95":"")+" h-4 w-4 duration-75 transition group-active:scale-95"}))):null},h))});g.displayName="NumberInput";var f=e.i(422233),h=e.i(526732),b=e.i(653145),x=e.i(618566),y=e.i(758302),v=e.i(868499),C=e.i(994814),j=e.i(515288),w=e.i(903133),S=e.i(110204),A=e.i(922140),F=e.i(362201),N=e.i(795320),k=e.i(793479),D=e.i(699375),L=e.i(824356),M=e.i(847130),E=e.i(2170),V=e.i(314560),I=e.i(213557),R=e.i(519455),U=e.i(888173),T=e.i(781164),P=e.i(713766),O=e.i(886883);let _=F.object({name:F.string().min(2,{message:"Agency name must be atleast 2 chars."}),companyEmail:F.string().min(1),companyPhone:F.string().min(1),whiteLabel:F.boolean(),line1:F.string().min(1),line2:F.string().optional(),city:F.string().min(1),postalCode:F.string().min(1),state:F.string().optional(),country:F.string().min(1),countryCode:F.string().optional(),stateCode:F.string().optional(),phoneCode:F.string().optional(),agencyLogo:F.string().min(1)});e.s(["default",0,({data:a,selectedPlan:o})=>{let{toast:n}=(0,A.useToast)(),s=(0,x.useRouter)(),{update:l}=(0,h.useSession)(),[i,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(a?.companyPhone||""),[m,p]=(0,r.useState)(a?.country||""),[F,$]=(0,r.useState)(a?.state||""),[H,B]=(0,r.useState)(a?.city||""),[z,Z]=(0,r.useState)(a?.companyPhone||""),K=(0,b.useForm)({mode:"onSubmit",resolver:(0,C.zodResolver)(_),defaultValues:{name:a?.name||"",companyEmail:a?.companyEmail||"",phoneCode:a?.companyPhone||"",companyPhone:a?.companyPhone||"",whiteLabel:a?.whiteLabel||!1,line1:a?.line1||"",line2:a?.line2||"",city:a?.city||"",postalCode:a?.postalCode||"",state:a?.state,country:a?.country||"",countryCode:a?.country||"",stateCode:a?.state||"",agencyLogo:a?.agencyLogo||""}}),Y=K.formState.isSubmitting;(0,r.useEffect)(()=>{a?.id||m||(async()=>{try{let t=await fetch("https://ipapi.co/json/"),r=await t.json();if(r.country_code){let{Country:t}=await e.A(856088),a=t.getAllCountries().find(e=>e.isoCode===r.country_code);if(a){p(a.isoCode),K.setValue("country",a.name),K.setValue("countryCode",a.isoCode);let e=`+${a.phonecode}`;u(e),K.setValue("phoneCode",e)}}}catch(e){console.log("Location detection failed, using defaults")}})()},[a?.id,m,K]),(0,r.useEffect)(()=>{if(a){let e=P.Country.getAllCountries().find(e=>e.name===a?.country),t=O.State.getStatesOfCountry(e?.isoCode).find(e=>e.name===a?.state),r=T.City.getCitiesOfState(t?.countryCode||"",t?.isoCode||"").find(e=>e.name===a?.city),o=a?.companyPhone&&e?a.companyPhone.match(RegExp(`^(\\+${e.phonecode})(.*)$`)):null,n=o?o[1]:null,s=o?o[2].toString().trim():null;p(e?e.isoCode:""),K.setValue("country",e?e.name:a.country||""),K.setValue("countryCode",e?e.isoCode:""),$(t?t.isoCode:""),K.setValue("state",t?t.name:a.state||""),K.setValue("stateCode",t?t.isoCode:""),B(r?r.name:""),K.setValue("city",r?r.name:a.city||""),K.setValue("postalCode",a.postalCode||""),u(n||""),K.setValue("phoneCode",n||""),Z(s||a.companyPhone||"")}},[a,K]);let W=async e=>{try{let e,t=K.getValues();if(!a?.id){let r={email:t.companyEmail,name:t.name,shipping:{address:{city:t.city,country:t.country,line1:t.line1,line2:t.line2||void 0,postal_code:t.postalCode,state:t.state},name:t.name},address:{city:t.city,country:t.country,line1:t.line1,line2:t.line2||void 0,postal_code:t.postalCode,state:t.state}},a=await fetch("/api/stripe/customer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});e=(await a.json()).customerId}if(await (0,M.initUser)({}),!a?.customerId&&!e)return;let r=await (0,I.upsertAgency)({id:a?.id?a.id:(0,f.v4)(),customerId:a?.customerId||e||"",line1:t.line1,line2:t.line2||"",agencyLogo:t.agencyLogo,city:t.city,companyPhone:`${t.phoneCode} ${t.companyPhone}`,country:t.country,name:t.name,state:t.state,whiteLabel:t.whiteLabel,postalCode:t.postalCode,createdAt:new Date,updatedAt:new Date,companyEmail:t.companyEmail,connectAccountId:"",goal:5,taxIdentityId:null});if(n({title:"Created Agency"}),a?.id)return s.refresh();if(r){if(await l(),o){window.location.href=`/agency/${r.id}/billing?plan=${o}`;return}window.location.href=`/agency/${r.id}`;return}}catch(e){console.error("Agency creation error:",e),n({variant:"destructive",title:"Oops!",description:e instanceof Error?e.message:"Could not create your agency"})}},q=async()=>{if(a?.id){d(!0);try{await (0,L.deleteAgency)(a.id),n({title:"Deleted Agency",description:"Deleted your agency and all subaccounts"}),s.refresh()}catch(e){console.log(e),n({variant:"destructive",title:"Oppse!",description:"could not delete your agency "})}d(!1)}};return(0,t.jsx)(v.AlertDialog,{children:(0,t.jsxs)(j.Card,{className:"w-full",children:[(0,t.jsxs)(j.CardHeader,{children:[(0,t.jsx)(j.CardTitle,{children:"Agency Information"}),(0,t.jsx)(j.CardDescription,{children:"Lets create an agency for you business. You can edit agency settings later from the agency settings tab."})]}),(0,t.jsxs)(j.CardContent,{children:[(0,t.jsx)(w.Form,{...K,children:(0,t.jsxs)("form",{onSubmit:K.handleSubmit(W),className:"space-y-4",children:[(0,t.jsx)(w.FormField,{disabled:Y,control:K.control,name:"agencyLogo",render:({field:e})=>(0,t.jsxs)(w.FormItem,{children:[(0,t.jsx)(w.FormLabel,{children:"Agency Logo"}),(0,t.jsx)(w.FormControl,{children:(0,t.jsx)(N.default,{apiEndpoint:"agencyLogo",onChange:e.onChange,value:e.value})}),(0,t.jsx)(w.FormMessage,{})]})}),(0,t.jsxs)("div",{className:"flex md:flex-row gap-4",children:[(0,t.jsx)(w.FormField,{disabled:Y,control:K.control,name:"name",render:({field:e})=>(0,t.jsxs)(w.FormItem,{className:"flex-1",children:[(0,t.jsx)(w.FormLabel,{children:"Agency Name"}),(0,t.jsx)(w.FormControl,{children:(0,t.jsx)(k.Input,{placeholder:"Your agency name",...e})}),(0,t.jsx)(w.FormMessage,{})]})}),(0,t.jsx)(w.FormField,{control:K.control,name:"companyEmail",render:({field:e})=>(0,t.jsxs)(w.FormItem,{className:"flex-1",children:[(0,t.jsx)(w.FormLabel,{children:"Agency Email"}),(0,t.jsx)(w.FormControl,{children:(0,t.jsx)(k.Input,{readOnly:!0,className:"text-gray-500 cursor-not-allowed",placeholder:"Email",...e})}),(0,t.jsx)(w.FormMessage,{})]})})]}),(0,t.jsx)(w.FormField,{disabled:Y,control:K.control,name:"companyPhone",render:({field:e})=>(0,t.jsxs)(w.FormItem,{children:[(0,t.jsx)(w.FormLabel,{children:"Agency Phone Number"}),(0,t.jsx)(w.FormControl,{children:(0,t.jsx)(y.PhoneCodeSelector,{value:e.value,onValueChange:e.onChange,countryCode:m,onCountryCodeChange:(e,t)=>{p(e),K.setValue("phoneCode",t?.phonecode||"")},placeholder:"Enter phone number",disabled:Y,styleVariant:"plain"})}),(0,t.jsx)(w.FormMessage,{})]})}),(0,t.jsx)(w.FormField,{disabled:Y,control:K.control,name:"whiteLabel",render:({field:e})=>(0,t.jsxs)(w.FormItem,{className:"flex flex-row items-center justify-between rounded-lg border gap-4 p-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(w.FormLabel,{children:"Whitelabel Agency"}),(0,t.jsx)(w.FormDescription,{children:"Turning on whilelabel mode will show your agency logo to all sub accounts by default. You can overwrite this functionality through sub account settings."})]}),(0,t.jsx)(w.FormControl,{children:(0,t.jsx)(D.Switch,{checked:e.value,onCheckedChange:e.onChange})})]})}),(0,t.jsxs)("div",{className:"flex md:flex-row gap-4",children:[(0,t.jsx)(w.FormField,{disabled:Y,control:K.control,name:"line2",render:({field:e})=>(0,t.jsxs)(w.FormItem,{className:"flex-1",children:[(0,t.jsx)(w.FormLabel,{children:"Address Line 2 (Optional)"}),(0,t.jsx)(w.FormControl,{children:(0,t.jsx)(k.Input,{className:"italic text-sm",placeholder:"Apartment, suite, unit, building, floor, etc.",...e})}),(0,t.jsx)(w.FormMessage,{})]})}),(0,t.jsx)(w.FormField,{disabled:Y,control:K.control,name:"postalCode",render:({field:e})=>(0,t.jsxs)(w.FormItem,{className:"w-40",children:[(0,t.jsx)(w.FormLabel,{children:"Postal Code"}),(0,t.jsx)(w.FormControl,{children:(0,t.jsx)(y.PostalCodeInput,{value:e.value,onValueChange:e.onChange,countryCode:m,placeholder:"Enter postal code",disabled:Y,styleVariant:"plain"})}),(0,t.jsx)(w.FormMessage,{})]})})]}),(0,t.jsx)(w.FormField,{disabled:Y,control:K.control,name:"line1",render:({field:r})=>(0,t.jsxs)(w.FormItem,{className:"flex-1",children:[(0,t.jsx)(w.FormLabel,{children:"Address Line 1"}),(0,t.jsx)(w.FormControl,{children:(0,t.jsx)(y.AddressAutocomplete,{value:r.value,onValueChange:r.onChange,onAddressSelect:async t=>{K.setValue("line1",t.street),t.city&&K.setValue("city",t.city);let r=K.getValues("postalCode");if(t.postalCode&&!r&&K.setValue("postalCode",t.postalCode),t.state&&m){let{State:r}=await e.A(856088),a=r.getStatesOfCountry(m).find(e=>e.name.toLowerCase()===t.state?.toLowerCase()||e.isoCode.toLowerCase()===t.state?.toLowerCase());a?($(a.isoCode),K.setValue("state",a.name),K.setValue("stateCode",a.isoCode)):($(""),K.setValue("state",t.state),K.setValue("stateCode",""))}},countryCode:m,placeholder:"type to search address",disabled:Y,styleVariant:"plain"})}),(0,t.jsx)(w.FormMessage,{})]})}),(0,t.jsxs)("div",{className:"flex md:flex-row gap-4",children:[(0,t.jsx)(w.FormField,{disabled:Y,control:K.control,name:"city",render:({field:e})=>(0,t.jsxs)(w.FormItem,{className:"flex-1",children:[(0,t.jsx)(w.FormLabel,{children:"City"}),(0,t.jsx)(w.FormControl,{children:(0,t.jsx)(y.CitySelector,{value:e.value,onValueChange:e=>{K.setValue("city",e)},countryCode:m,stateCode:F,placeholder:"Select city",disabled:Y,styleVariant:"plain"})}),(0,t.jsx)(w.FormMessage,{})]})}),(0,t.jsx)(w.FormField,{disabled:Y,control:K.control,name:"state",render:({field:e})=>(0,t.jsxs)(w.FormItem,{className:"flex-1",children:[(0,t.jsx)(w.FormLabel,{children:"State"}),(0,t.jsx)(w.FormControl,{children:(0,t.jsx)(y.StateSelector,{value:F,onValueChange:(e,t)=>{$(e),K.setValue("state",t?.name||""),K.setValue("stateCode",e),K.setValue("city","")},countryCode:m,placeholder:"Select state",disabled:Y,styleVariant:"plain"})}),(0,t.jsx)(w.FormMessage,{})]})}),(0,t.jsx)(w.FormField,{disabled:Y,control:K.control,name:"country",render:({field:e})=>(0,t.jsxs)(w.FormItem,{className:"flex-1",children:[(0,t.jsx)(w.FormLabel,{children:"Country"}),(0,t.jsx)(w.FormControl,{children:(0,t.jsx)(y.CountrySelector,{value:m,onValueChange:(e,t)=>{p(e),$(""),K.setValue("country",t?.name||""),K.setValue("countryCode",e),K.setValue("state",""),K.setValue("stateCode",""),K.setValue("city","")},placeholder:"Select country",disabled:Y,styleVariant:"plain"})}),(0,t.jsx)(w.FormMessage,{})]})})]}),a?.id&&(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(S.Label,{children:"Create A Goal"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"âœ¨ Create a goal for your agency. As your business grows your goals grow too so dont forget to set the bar higher!"}),(0,t.jsx)(g,{defaultValue:a?.goal,onValueChange:async e=>{a?.id&&(await (0,V.updateAgencyDetails)(a.id,{goal:e}),await (0,E.saveActivityLogsNotification)({agencyId:a.id,description:`Updated the agency goal to | ${e} Sub Account`,subaccountId:void 0}),s.refresh())},min:1,className:"bg-background !border !border-input",placeholder:"Sub Account Goal"})]}),(0,t.jsx)(R.Button,{type:"submit",disabled:Y,children:Y?(0,t.jsx)(U.default,{}):"Save Agency Information"})]})}),a?.id&&(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between rounded-lg border border-destructive gap-4 p-4 mt-4",children:[(0,t.jsx)("div",{children:(0,t.jsx)("div",{children:"Danger Zone"})}),(0,t.jsx)("div",{className:"text-muted-foreground",children:"Deleting your agency cannpt be undone. This will also delete all sub accounts and all data related to your sub accounts. Sub accounts will no longer have access to funnels, contacts etc."}),(0,t.jsx)(v.AlertDialogTrigger,{disabled:Y||i,className:"text-red-600 p-2 text-center mt-2 rounded-md hove:bg-red-600 hover:text-white whitespace-nowrap",children:i?"Deleting...":"Delete Agency"})]}),(0,t.jsxs)(v.AlertDialogContent,{children:[(0,t.jsxs)(v.AlertDialogHeader,{children:[(0,t.jsx)(v.AlertDialogTitle,{className:"text-left",children:"Are you absolutely sure?"}),(0,t.jsx)(v.AlertDialogDescription,{className:"text-left",children:"This action cannot be undone. This will permanently delete the Agency account and all related sub accounts."})]}),(0,t.jsxs)(v.AlertDialogFooter,{className:"flex items-center",children:[(0,t.jsx)(v.AlertDialogCancel,{className:"mb-2",children:"Cancel"}),(0,t.jsx)(v.AlertDialogAction,{disabled:i,className:"bg-destructive hover:bg-destructive",onClick:q,children:"Delete"})]})]})]})]})})}],445747)}]);