module.exports=[84580,a=>{"use strict";var b=a.i(907997),c=a.i(395936);a.i(570396);var d=a.i(673727),e=a.i(635330),f=a.i(638904),g=a.i(819637),h=a.i(766343),i=a.i(259334),j=a.i(167541),k=a.i(852875),l=a.i(603735),m=a.i(545166),n=a.i(514268),o=a.i(823862),p=a.i(807872),q=a.i(183978),r=a.i(828241),s=a.i(446932),t=a.i(504357),u=a.i(239062),v=a.i(990915);function w({agencyId:a,apps:d}){let h=d.filter(a=>!!a.isCore),j=d.filter(a=>!a.isCore),l=h.find(a=>"webhooks"===a.key),m=(0,i.describeInstallState)(l?.state??"AVAILABLE"),n=h.find(a=>"support"===a.key),o=(0,i.describeInstallState)(n?.state??"AVAILABLE");return(0,b.jsxs)("div",{className:"p-6 space-y-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Apps Hub"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage installed modules and add-ons for this agency."})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)(e.CardTitle,{children:"Support Center"}),(0,b.jsx)(g.Badge,{variant:o.tone,children:o.label})]}),(0,b.jsx)(e.CardDescription,{children:"Guided troubleshooting, diagnostics, and support tickets."})]}),(0,b.jsxs)(e.CardContent,{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{asChild:!0,disabled:(n?.state??"AVAILABLE")!=="INSTALLED",children:(0,b.jsx)(c.default,{href:`/agency/${a}/apps/support`,children:"Open"})}),(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/agency/${a}/apps/support/tickets`,children:"Tickets"})})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)(e.CardTitle,{children:"Webhooks"}),(0,b.jsx)(g.Badge,{variant:m.tone,children:m.label})]}),(0,b.jsx)(e.CardDescription,{children:"Providers, connections, API keys, subscriptions, and deliveries."})]}),(0,b.jsxs)(e.CardContent,{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{asChild:!0,disabled:(l?.state??"AVAILABLE")!=="INSTALLED",children:(0,b.jsx)(c.default,{href:`/agency/${a}/apps/webhooks`,children:"Open"})}),(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/agency/${a}/apps/webhooks/api-keys`,children:"API Keys"})}),(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/agency/${a}/apps/webhooks/deliveries`,children:"Deliveries"})})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Add-ons"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Install optional modules when they're included in your plan."})]}),(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:j.map(d=>{let h=(0,i.describeInstallState)(d.state);return(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)(e.CardTitle,{children:d.label}),(0,b.jsx)(g.Badge,{variant:d.entitled?h.tone:"outline",children:d.entitled?h.label:"Upgrade"})]}),(0,b.jsx)(e.CardDescription,{children:d.description??"—"})]}),(0,b.jsxs)(e.CardContent,{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(f.Button,{asChild:!0,disabled:"INSTALLED"!==d.state,children:(0,b.jsx)(c.default,{href:`/agency/${a}/apps/${d.key}`,children:"Open"})}),d.entitled?d.canInstall?(0,b.jsxs)("form",{action:k.installAppAgencyAction,children:[(0,b.jsx)("input",{type:"hidden",name:"agencyId",value:a}),(0,b.jsx)("input",{type:"hidden",name:"appKey",value:d.key}),(0,b.jsx)(f.Button,{type:"submit",children:"Install"})]}):d.canUninstall?(0,b.jsxs)("form",{action:k.uninstallAppAgencyAction,children:[(0,b.jsx)("input",{type:"hidden",name:"agencyId",value:a}),(0,b.jsx)("input",{type:"hidden",name:"appKey",value:d.key}),(0,b.jsx)(f.Button,{type:"submit",variant:"outline",children:"Uninstall"})]}):null:(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/agency/${a}/billing?action=upgrade&app=${encodeURIComponent(d.key)}`,children:"Upgrade"})})]})]},d.key)})})]})]})}function x({agencyId:a,children:c}){let d=`/agency/${a}/apps/support`;return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Support Center"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Guided troubleshooting, diagnostics, and support tickets."})]}),(0,b.jsx)(s.SupportNav,{basePath:d}),(0,b.jsx)("div",{className:"space-y-6",children:c})]})}function y({agencyId:a,segments:c}){let d,[e]=c;if(!e||""===e)return(0,b.jsx)(x,{agencyId:a,children:(0,b.jsx)(t.SupportWizardPanel,{scope:{type:"AGENCY",agencyId:a}})});switch(e){case"wizard":default:d=(0,b.jsx)(t.SupportWizardPanel,{scope:{type:"AGENCY",agencyId:a}});break;case"tickets":d=(0,b.jsx)(u.SupportTicketsPanel,{scope:{type:"AGENCY",agencyId:a}})}return(0,b.jsx)(x,{agencyId:a,children:d})}function z({agencyId:a,children:c}){let d=`/agency/${a}/apps/webhooks`;return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Webhooks"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Providers, connections, API keys, subscriptions, and deliveries."})]}),(0,b.jsx)(m.WebhooksNav,{basePath:d}),(0,b.jsx)("div",{className:"space-y-6",children:c})]})}async function A({agencyId:a,segments:c}){let e,[f,g]=c;switch((!f||""===f)&&(0,d.redirect)(`/agency/${a}/apps/webhooks/providers`),f){case"providers":e=g?(0,b.jsx)(v.default,{agencyId:a,provider:g}):(0,b.jsx)(n.WebhooksProvidersPanel,{agencyId:a});break;case"connections":e=(0,b.jsx)(o.WebhooksConnectionsPanel,{agencyId:a});break;case"api-keys":e=(0,b.jsx)(p.WebhooksApiKeysPanel,{agencyId:a});break;case"subscriptions":e=(0,b.jsx)(q.WebhooksSubscriptionsPanel,{agencyId:a});break;case"deliveries":if(g){let c=await (0,l.getDeliveryDetail)(g,{type:"AGENCY",agencyId:a});if(!c)return(0,d.notFound)();e=(0,b.jsx)(B,{agencyId:a,detail:c})}else e=(0,b.jsx)(r.WebhooksDeliveriesPanel,{agencyId:a});break;default:e=(0,b.jsx)(v.default,{agencyId:a,provider:f})}return(0,b.jsx)(z,{agencyId:a,children:e})}function B({agencyId:a,detail:d}){return(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Delivery details"}),(0,b.jsxs)(e.CardDescription,{children:["Provider: ",(0,b.jsx)("span",{className:"font-medium",children:d.delivery.provider})]})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(g.Badge,{variant:"SUCCESS"===d.delivery.status?"default":"FAILED"===d.delivery.status?"destructive":"secondary",children:d.delivery.status}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Attempts: ",d.delivery.attemptCount??0," • Created: ",d.delivery.createdAt?new Date(d.delivery.createdAt).toLocaleString():"—"]})]}),(0,b.jsx)(h.Separator,{}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Subscription URL"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground break-all",children:d.delivery.subscriptionUrl})]}),d.attempts?.length?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Attempts"}),(0,b.jsx)("div",{className:"divide-y rounded-xl border",children:d.attempts.map(a=>(0,b.jsxs)("div",{className:"p-3 space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.attemptedAt?new Date(a.attemptedAt).toLocaleString():"—"}),(0,b.jsx)(g.Badge,{variant:a.statusCode&&a.statusCode<400?"default":"secondary",children:a.statusCode??"—"})]}),a.error?(0,b.jsx)("div",{className:"text-xs text-destructive break-all",children:a.error}):null,a.responseBody?(0,b.jsx)("div",{className:"text-xs text-muted-foreground break-all",children:a.responseBody}):null]},a.id))})]}):null,(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/agency/${a}/apps/webhooks/deliveries`,children:"Back to Deliveries"})})})]})]})}function C({agencyId:a,appKey:d,info:g}){let h=(0,i.describeInstallState)(g?.state??"AVAILABLE"),j=g?.entitled??!1,l=g?.canInstall??!1;return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)(e.Card,{className:"max-w-2xl",children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"App access"}),(0,b.jsxs)(e.CardDescription,{children:[(0,b.jsx)("span",{className:"font-medium",children:g?.label??d})," — ",j?h.label:"Upgrade"]})]}),(0,b.jsx)(e.CardContent,{className:"space-y-4",children:j?g?.state!=="INSTALLED"?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"This module is available for install in this agency."}),(0,b.jsxs)("div",{className:"flex gap-2",children:[l?(0,b.jsxs)("form",{action:k.installAppAgencyAction,children:[(0,b.jsx)("input",{type:"hidden",name:"agencyId",value:a}),(0,b.jsx)("input",{type:"hidden",name:"appKey",value:d}),(0,b.jsx)(f.Button,{type:"submit",children:"Install"})]}):null,(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/agency/${a}/apps`,children:"Back to Apps Hub"})})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"This module is installed, but there is no registered route yet."}),(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/agency/${a}/apps`,children:"Back to Apps Hub"})})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"This module isn't included in your current plan. Upgrade your subscription to enable it."}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{asChild:!0,children:(0,b.jsx)(c.default,{href:`/agency/${a}/billing?action=upgrade&app=${encodeURIComponent(d)}`,children:"Go to Billing"})}),(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/agency/${a}/apps`,children:"Back to Apps Hub"})})]})]})})]})})}async function D({params:a}){let{agencyId:c,path:e=[]}=await a,f=await (0,j.listAppsWithState)({agencyId:c,subAccountId:null,meteringScope:"AGENCY"});if(0===e.length)return(0,b.jsx)(w,{agencyId:c,apps:f});let[g,...h]=e,i=f.find(a=>a.key===g);if(!i?.entitled||"INSTALLED"!==i.state){if("integrations"!==g&&"webhooks"!==g)return(0,b.jsx)(C,{agencyId:c,appKey:g,info:i});else if(i?.state!=="INSTALLED")return(0,b.jsx)(C,{agencyId:c,appKey:g,info:i})}switch(g){case"support":return(0,b.jsx)(y,{agencyId:c,segments:h});case"webhooks":return(0,b.jsx)(A,{agencyId:c,segments:h});case"integrations":!function(a,b){let[c]=b;c&&""!==c||(0,d.redirect)(`/agency/${a}/apps/webhooks/providers`);let e=b[1];(0,d.redirect)(`/agency/${a}/apps/webhooks/${{providers:"providers",connections:"connections","api-keys":"api-keys",webhooks:"subscriptions",deliveries:"deliveries"}[c]||c}${e?`/${e}`:""}`)}(c,h);default:return(0,b.jsx)(C,{agencyId:c,appKey:g,info:i})}}a.s(["default",()=>D])}];

//# sourceMappingURL=src_app_%28main%29_agency_%5BagencyId%5D_apps_%5B%5B___path%5D%5D_page_tsx_13351c86._.js.map