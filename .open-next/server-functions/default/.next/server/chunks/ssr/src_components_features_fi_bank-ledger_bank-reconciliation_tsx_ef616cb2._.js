module.exports=[576311,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(372228),e=a.i(267900),f=a.i(533441),g=a.i(167453),h=a.i(405784),i=a.i(29403),j=a.i(669520),k=a.i(587532),l=a.i(701110);let m=(0,a.i(170106).default)("wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);var n=a.i(786304),o=a.i(699570),p=a.i(591119),q=a.i(315055),r=a.i(335732),s=a.i(866718),t=a.i(333140),u=a.i(206015),v=a.i(823292),w=a.i(368114),x=a.i(405050);let y=(0,x.createServerReference)("60220f0165e3737d8edc61e791a38cfe13323821ea",x.callServer,void 0,x.findSourceMapURL,"getBankTransactions"),z=(0,x.createServerReference)("00a2cd4056863067eeacd89c7b7ae8800b2a910e74",x.callServer,void 0,x.findSourceMapURL,"listBankAccounts"),A=(0,x.createServerReference)("70f18222e5f2a5635dcb61a04a1201e1b4a055b12e",x.callServer,void 0,x.findSourceMapURL,"reconcileTransactions"),B=(0,x.createServerReference)("6092a0c4983f5247a600c03634f54c29f336679d03",x.callServer,void 0,x.findSourceMapURL,"unreconciledTransactions"),C=()=>{let[a,x]=c.useState([]),[C,D]=c.useState(null),[E,F]=c.useState([]),[G,H]=c.useState(new Set),[I,J]=c.useState(!0),[K,L]=c.useState(!1),[M,N]=c.useState(!1),[O,P]=c.useState(""),[Q,R]=c.useState("all"),[S,T]=c.useState(1),[U,V]=c.useState(0);c.useEffect(()=>{(async()=>{J(!0);let a=await z();a.success&&a.data?(x(a.data),a.data.length>0&&D(a.data[0])):v.toast.error(a.error||"Failed to load bank accounts"),J(!1)})()},[]),c.useEffect(()=>{C&&(async()=>{L(!0),H(new Set);let a=await y(C.id,{reconciledOnly:"all"===Q?void 0:"reconciled"===Q,page:S,pageSize:50});a.success&&a.data?(F(a.data.transactions),V(a.data.total)):v.toast.error(a.error||"Failed to load transactions"),L(!1)})()},[C,Q,S]);let W=c.useMemo(()=>{if(!O.trim())return E;let a=O.toLowerCase();return E.filter(b=>b.entryNumber.toLowerCase().includes(a)||b.description.toLowerCase().includes(a))},[E,O]),X=c.useCallback(()=>{G.size===W.length?H(new Set):H(new Set(W.map(a=>a.journalEntryId)))},[W,G]),Y=c.useCallback(a=>{H(b=>{let c=new Set(b);return c.has(a)?c.delete(a):c.add(a),c})},[]),Z=async()=>{if(!C||0===G.size)return;N(!0);let a=await A(C.id,Array.from(G),new Date);if(a.success){v.toast.success(`${a.data?.reconciled??0} transaction(s) marked as reconciled`),H(new Set);let b=await y(C.id,{reconciledOnly:"all"===Q?void 0:"reconciled"===Q,page:S,pageSize:50});b.success&&b.data&&(F(b.data.transactions),V(b.data.total));let c=await z();if(c.success&&c.data){x(c.data);let a=c.data.find(a=>a.id===C.id);a&&D(a)}}else v.toast.error(a.error||"Failed to reconcile");N(!1)},$=async()=>{if(!C||0===G.size)return;N(!0);let a=await B(C.id,Array.from(G));if(a.success){v.toast.success(`${a.data?.unreconciledCount??0} transaction(s) marked as unreconciled`),H(new Set);let b=await y(C.id,{reconciledOnly:"all"===Q?void 0:"reconciled"===Q,page:S,pageSize:50});b.success&&b.data&&(F(b.data.transactions),V(b.data.total))}else v.toast.error(a.error||"Failed to unreconcile");N(!1)},_=(a,b="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:b}).format(a);return I?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-3",children:[1,2,3].map(a=>(0,b.jsxs)(p.Card,{children:[(0,b.jsx)(p.CardHeader,{className:"pb-2",children:(0,b.jsx)(t.Skeleton,{className:"h-4 w-24"})}),(0,b.jsx)(p.CardContent,{children:(0,b.jsx)(t.Skeleton,{className:"h-8 w-32"})})]},a))}),(0,b.jsxs)(p.Card,{children:[(0,b.jsx)(p.CardHeader,{children:(0,b.jsx)(t.Skeleton,{className:"h-6 w-48"})}),(0,b.jsx)(p.CardContent,{children:(0,b.jsx)("div",{className:"space-y-2",children:[1,2,3,4,5].map(a=>(0,b.jsx)(t.Skeleton,{className:"h-12 w-full"},a))})})]})]}):0===a.length?(0,b.jsx)(p.Card,{children:(0,b.jsxs)(p.CardContent,{className:"flex flex-col items-center justify-center py-16",children:[(0,b.jsx)(e.Building2,{className:"text-muted-foreground mb-4 size-12"}),(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"No Bank Accounts"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1 text-sm",children:"No bank accounts found. Add a Chart of Account with Control Account Type = Bank."})]})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)(p.Card,{className:(0,w.cn)(C&&"border-primary"),children:[(0,b.jsxs)(p.CardHeader,{className:"pb-2",children:[(0,b.jsx)(p.CardDescription,{children:"Selected Account"}),(0,b.jsxs)(r.DropdownMenu,{children:[(0,b.jsx)(r.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(o.Button,{variant:"ghost",className:"h-auto justify-start p-0 text-left",children:(0,b.jsxs)(p.CardTitle,{className:"flex items-center gap-2 text-lg",children:[(0,b.jsx)(m,{className:"size-4"}),C?.name??"Select account",(0,b.jsx)(h.ChevronDown,{className:"text-muted-foreground size-4"})]})})}),(0,b.jsx)(r.DropdownMenuContent,{align:"start",className:"w-64",children:a.map(a=>(0,b.jsxs)(r.DropdownMenuItem,{onClick:()=>{D(a),T(1)},className:"flex flex-col items-start",children:[(0,b.jsx)("span",{className:"font-medium",children:a.name}),(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:a.code})]},a.id))})]})]}),(0,b.jsx)(p.CardContent,{children:(0,b.jsxs)("p",{className:"text-muted-foreground text-sm",children:[C?.code," • ",C?.currency]})})]}),(0,b.jsxs)(p.Card,{children:[(0,b.jsxs)(p.CardHeader,{className:"pb-2",children:[(0,b.jsx)(p.CardDescription,{children:"Current Balance"}),(0,b.jsx)(p.CardTitle,{className:"text-2xl",children:C?_(C.currentBalance,C.currency):"—"})]}),(0,b.jsx)(p.CardContent,{children:(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:"Per GL closing balance"})})]}),(0,b.jsxs)(p.Card,{children:[(0,b.jsxs)(p.CardHeader,{className:"pb-2",children:[(0,b.jsx)(p.CardDescription,{children:"Unreconciled Items"}),(0,b.jsxs)(p.CardTitle,{className:"flex items-center gap-2 text-2xl",children:[C?.unreconciledCount??0,C&&0===C.unreconciledCount?(0,b.jsx)(g.CheckCircle2,{className:"size-5 text-green-500"}):(0,b.jsx)(i.CircleDot,{className:"size-5 text-amber-500"})]})]}),(0,b.jsx)(p.CardContent,{children:(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:C&&C.unreconciledCount>0?"Items pending reconciliation":"All items reconciled"})})]})]}),(0,b.jsxs)(p.Card,{children:[(0,b.jsx)(p.CardHeader,{children:(0,b.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(p.CardTitle,{children:"Transactions"}),(0,b.jsx)(p.CardDescription,{children:"Mark transactions as reconciled to match your bank statement"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(o.Button,{size:"sm",onClick:Z,disabled:0===G.size||M,children:[(0,b.jsx)(f.Check,{className:"mr-1 size-4"}),"Reconcile (",G.size,")"]}),(0,b.jsxs)(o.Button,{size:"sm",variant:"outline",onClick:$,disabled:0===G.size||M,children:[(0,b.jsx)(l.Undo2,{className:"mr-1 size-4"}),"Unreconcile"]})]})]})}),(0,b.jsxs)(p.CardContent,{children:[(0,b.jsxs)("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(k.Search,{className:"text-muted-foreground absolute left-3 top-1/2 size-4 -translate-y-1/2"}),(0,b.jsx)(s.Input,{placeholder:"Search by entry number or description...",value:O,onChange:a=>P(a.target.value),className:"pl-9"})]}),(0,b.jsxs)(r.DropdownMenu,{children:[(0,b.jsx)(r.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(o.Button,{variant:"outline",className:"shrink-0",children:[(0,b.jsx)(j.RefreshCw,{className:"mr-2 size-4"}),"all"===Q?"All Transactions":"reconciled"===Q?"Reconciled":"Unreconciled",(0,b.jsx)(h.ChevronDown,{className:"ml-2 size-4"})]})}),(0,b.jsxs)(r.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(r.DropdownMenuItem,{onClick:()=>{R("all"),T(1)},children:"All Transactions"}),(0,b.jsx)(r.DropdownMenuItem,{onClick:()=>{R("reconciled"),T(1)},children:"Reconciled Only"}),(0,b.jsx)(r.DropdownMenuItem,{onClick:()=>{R("unreconciled"),T(1)},children:"Unreconciled Only"})]})]})]}),(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(u.Table,{children:[(0,b.jsx)(u.TableHeader,{children:(0,b.jsxs)(u.TableRow,{children:[(0,b.jsx)(u.TableHead,{className:"w-10",children:(0,b.jsx)(q.Checkbox,{checked:W.length>0&&G.size===W.length,onCheckedChange:X,"aria-label":"Select all"})}),(0,b.jsx)(u.TableHead,{children:"Entry #"}),(0,b.jsx)(u.TableHead,{children:"Date"}),(0,b.jsx)(u.TableHead,{children:"Description"}),(0,b.jsx)(u.TableHead,{className:"text-right",children:"Debit"}),(0,b.jsx)(u.TableHead,{className:"text-right",children:"Credit"}),(0,b.jsx)(u.TableHead,{className:"text-center",children:"Status"})]})}),(0,b.jsx)(u.TableBody,{children:K?[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(u.TableRow,{children:[...Array(7)].map((a,c)=>(0,b.jsx)(u.TableCell,{children:(0,b.jsx)(t.Skeleton,{className:"h-4 w-full"})},c))},c)):0===W.length?(0,b.jsx)(u.TableRow,{children:(0,b.jsx)(u.TableCell,{colSpan:7,className:"h-32 text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"No transactions found"})})}):W.map(a=>(0,b.jsxs)(u.TableRow,{className:(0,w.cn)(G.has(a.journalEntryId)&&"bg-muted/50"),children:[(0,b.jsx)(u.TableCell,{children:(0,b.jsx)(q.Checkbox,{checked:G.has(a.journalEntryId),onCheckedChange:()=>Y(a.journalEntryId),"aria-label":`Select ${a.entryNumber}`})}),(0,b.jsx)(u.TableCell,{className:"font-mono text-sm",children:a.entryNumber}),(0,b.jsx)(u.TableCell,{children:(0,d.format)(new Date(a.entryDate),"MMM d, yyyy")}),(0,b.jsx)(u.TableCell,{className:"max-w-[300px] truncate",children:a.description}),(0,b.jsx)(u.TableCell,{className:"text-right font-mono",children:a.debitAmount>0?_(a.debitAmount,C?.currency):"—"}),(0,b.jsx)(u.TableCell,{className:"text-right font-mono",children:a.creditAmount>0?_(a.creditAmount,C?.currency):"—"}),(0,b.jsx)(u.TableCell,{className:"text-center",children:a.isReconciled?(0,b.jsxs)(n.Badge,{variant:"default",className:"bg-green-600",children:[(0,b.jsx)(f.Check,{className:"mr-1 size-3"}),"Reconciled"]}):(0,b.jsx)(n.Badge,{variant:"secondary",children:"Pending"})})]},a.id))})]})}),U>50&&(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,b.jsxs)("p",{className:"text-muted-foreground text-sm",children:["Showing ",(S-1)*50+1," to ",Math.min(50*S,U)," of ",U]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>T(a=>Math.max(1,a-1)),disabled:1===S,children:"Previous"}),(0,b.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>T(a=>a+1),disabled:50*S>=U,children:"Next"})]})]})]})]})]})};a.s(["BankReconciliation",()=>C],576311)}];

//# sourceMappingURL=src_components_features_fi_bank-ledger_bank-reconciliation_tsx_ef616cb2._.js.map