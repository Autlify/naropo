module.exports=[325283,a=>{"use strict";var b=a.i(907997),c=a.i(395936);a.i(570396);var d=a.i(673727),e=a.i(635330),f=a.i(638904),g=a.i(819637),h=a.i(766343),i=a.i(259334),j=a.i(167541),k=a.i(852875),l=a.i(603735),m=a.i(528355),n=a.i(537150),o=a.i(545166),p=a.i(514268),q=a.i(823862),r=a.i(807872),s=a.i(183978),t=a.i(828241),u=a.i(446932),v=a.i(504357),w=a.i(239062),x=a.i(990915);let y=({subaccountId:a,agencyId:d,apps:h})=>{let j=h.filter(a=>!!a.isCore),l=h.filter(a=>!a.isCore),m=j.find(a=>"webhooks"===a.key),n=(0,i.describeInstallState)(m?.state??"AVAILABLE"),o=j.find(a=>"support"===a.key),p=(0,i.describeInstallState)(o?.state??"AVAILABLE");return(0,b.jsxs)("div",{className:"p-6 space-y-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Apps Hub"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage installed modules and add-ons for this subaccount."})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)(e.CardTitle,{children:"Support Center"}),(0,b.jsx)(g.Badge,{variant:p.tone,children:p.label})]}),(0,b.jsx)(e.CardDescription,{children:"Guided troubleshooting, diagnostics, and support tickets."})]}),(0,b.jsxs)(e.CardContent,{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{asChild:!0,disabled:(o?.state??"AVAILABLE")!=="INSTALLED",children:(0,b.jsx)(c.default,{href:`/subaccount/${a}/apps/support`,children:"Open"})}),(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/subaccount/${a}/apps/support/tickets`,children:"Tickets"})})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)(e.CardTitle,{children:"Webhooks"}),(0,b.jsx)(g.Badge,{variant:n.tone,children:n.label})]}),(0,b.jsx)(e.CardDescription,{children:"Providers, connections, API keys, subscriptions, and deliveries."})]}),(0,b.jsxs)(e.CardContent,{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{asChild:!0,disabled:(m?.state??"AVAILABLE")!=="INSTALLED",children:(0,b.jsx)(c.default,{href:`/subaccount/${a}/apps/webhooks`,children:"Open"})}),(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/subaccount/${a}/apps/webhooks/api-keys`,children:"API Keys"})}),(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/subaccount/${a}/apps/webhooks/deliveries`,children:"Deliveries"})})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Add-ons"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Install optional modules when they're included in your plan."})]}),(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:l.map(h=>{let j=(0,i.describeInstallState)(h.state);return(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)(e.CardTitle,{children:h.label}),(0,b.jsx)(g.Badge,{variant:h.entitled?j.tone:"outline",children:h.entitled?j.label:"Upgrade"})]}),(0,b.jsx)(e.CardDescription,{children:h.description??"—"})]}),(0,b.jsxs)(e.CardContent,{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(f.Button,{asChild:!0,disabled:"INSTALLED"!==h.state,children:(0,b.jsx)(c.default,{href:`/subaccount/${a}/apps/${h.key}`,children:"Open"})}),h.entitled?h.canInstall?(0,b.jsxs)("form",{action:k.installAppSubAccountAction,children:[(0,b.jsx)("input",{type:"hidden",name:"subAccountId",value:a}),(0,b.jsx)("input",{type:"hidden",name:"appKey",value:h.key}),(0,b.jsx)(f.Button,{type:"submit",children:"Install"})]}):h.canUninstall?(0,b.jsxs)("form",{action:k.uninstallAppSubAccountAction,children:[(0,b.jsx)("input",{type:"hidden",name:"subAccountId",value:a}),(0,b.jsx)("input",{type:"hidden",name:"appKey",value:h.key}),(0,b.jsx)(f.Button,{type:"submit",variant:"outline",children:"Uninstall"})]}):null:(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/agency/${d}/billing?action=upgrade&app=${encodeURIComponent(h.key)}`,children:"Upgrade"})})]})]},h.key)})})]})]})},z=({subaccountId:a,children:c})=>{let d=`/subaccount/${a}/apps/support`;return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Support Center"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Guided troubleshooting, diagnostics, and support tickets."})]}),(0,b.jsx)(u.SupportNav,{basePath:d}),(0,b.jsx)("div",{className:"space-y-6",children:c})]})},A=({subaccountId:a,segments:c})=>{let d,[e]=c;if(!e||""===e)return(0,b.jsx)(z,{subaccountId:a,children:(0,b.jsx)(v.SupportWizardPanel,{scope:{type:"SUBACCOUNT",subaccountId:a}})});switch(e){case"wizard":default:d=(0,b.jsx)(v.SupportWizardPanel,{scope:{type:"SUBACCOUNT",subaccountId:a}});break;case"tickets":d=(0,b.jsx)(w.SupportTicketsPanel,{scope:{type:"SUBACCOUNT",subaccountId:a}})}return(0,b.jsx)(z,{subaccountId:a,children:d})};function B({subaccountId:a,children:c}){let d=`/subaccount/${a}/apps/webhooks`;return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Webhooks"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Providers, connections, API keys, subscriptions, and deliveries."})]}),(0,b.jsx)(o.WebhooksNav,{basePath:d}),(0,b.jsx)("div",{className:"space-y-6",children:c})]})}let C=async({subaccountId:a,agencyId:c,segments:e})=>{let f,[g,h]=e;switch((!g||""===g)&&(0,d.redirect)(`/subaccount/${a}/apps/webhooks/providers`),g){case"providers":f=h?(0,b.jsx)(x.default,{subAccountId:a,provider:h}):(0,b.jsx)(p.WebhooksProvidersPanel,{subAccountId:a});break;case"connections":f=(0,b.jsx)(q.WebhooksConnectionsPanel,{subAccountId:a});break;case"api-keys":f=(0,b.jsx)(r.WebhooksApiKeysPanel,{subAccountId:a});break;case"subscriptions":f=(0,b.jsx)(s.WebhooksSubscriptionsPanel,{subAccountId:a});break;case"deliveries":if(h){let c=await (0,l.getDeliveryDetail)(h,{type:"SUBACCOUNT",subAccountId:a});if(!c)return(0,d.notFound)();f=(0,b.jsx)(D,{subaccountId:a,detail:c})}else f=(0,b.jsx)(t.WebhooksDeliveriesPanel,{subAccountId:a});break;default:f=(0,b.jsx)(x.default,{subAccountId:a,provider:g})}return(0,b.jsx)(B,{subaccountId:a,children:f})},D=({subaccountId:a,detail:d})=>(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Delivery details"}),(0,b.jsxs)(e.CardDescription,{children:["Provider: ",(0,b.jsx)("span",{className:"font-medium",children:d.delivery.provider})]})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(g.Badge,{variant:"SUCCESS"===d.delivery.status?"default":"FAILED"===d.delivery.status?"destructive":"secondary",children:d.delivery.status}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Attempts: ",d.delivery.attemptCount??0," • Created: ",d.delivery.createdAt?new Date(d.delivery.createdAt).toLocaleString():"—"]})]}),(0,b.jsx)(h.Separator,{}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Subscription URL"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground break-all",children:d.delivery.subscriptionUrl})]}),d.attempts?.length?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Attempts"}),(0,b.jsx)("div",{className:"divide-y rounded-xl border",children:d.attempts.map(a=>(0,b.jsxs)("div",{className:"p-3 space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.attemptedAt?new Date(a.attemptedAt).toLocaleString():"—"}),(0,b.jsx)(g.Badge,{variant:a.statusCode&&a.statusCode<400?"default":"secondary",children:a.statusCode??"—"})]}),a.error?(0,b.jsx)("div",{className:"text-xs text-destructive break-all",children:a.error}):null,a.responseBody?(0,b.jsx)("div",{className:"text-xs text-muted-foreground break-all",children:a.responseBody}):null]},a.id))})]}):null,(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/subaccount/${a}/apps/webhooks/deliveries`,children:"Back to Deliveries"})})})]})]}),E=({subaccountId:a,agencyId:d,appKey:g,info:h})=>{let j=(0,i.describeInstallState)(h?.state??"AVAILABLE"),l=h?.entitled??!1,m=h?.canInstall??!1;return(0,b.jsx)("div",{className:"p-6",children:(0,b.jsxs)(e.Card,{className:"max-w-2xl",children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"App access"}),(0,b.jsxs)(e.CardDescription,{children:[(0,b.jsx)("span",{className:"font-medium",children:h?.label??g})," — ",l?j.label:"Upgrade"]})]}),(0,b.jsx)(e.CardContent,{className:"space-y-4",children:l?h?.state!=="INSTALLED"?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"This module is available for install in this subaccount."}),(0,b.jsxs)("div",{className:"flex gap-2",children:[m?(0,b.jsxs)("form",{action:k.installAppSubAccountAction,children:[(0,b.jsx)("input",{type:"hidden",name:"subAccountId",value:a}),(0,b.jsx)("input",{type:"hidden",name:"appKey",value:g}),(0,b.jsx)(f.Button,{type:"submit",children:"Install"})]}):null,(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/subaccount/${a}/apps`,children:"Back to Apps Hub"})})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"This module is installed, but there is no registered route yet."}),(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/subaccount/${a}/apps`,children:"Back to Apps Hub"})})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"This module isn't included in your current plan. Upgrade your subscription to enable it."}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{asChild:!0,children:(0,b.jsx)(c.default,{href:`/agency/${d}/billing?action=upgrade&app=${encodeURIComponent(g)}`,children:"Go to Billing"})}),(0,b.jsx)(f.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(c.default,{href:`/subaccount/${a}/apps`,children:"Back to Apps Hub"})})]})]})})]})})};async function F({params:a}){let{subaccountId:c,path:e=[]}=await a,f=await (0,m.requireSubAccountAccess)({subAccountId:c,permissionKeys:[n.KEYS.core.apps.app.view],requireActiveAgencySubscription:!0,redirectTo:`/subaccount/${c}/apps`}),g=await (0,j.listAppsWithState)({agencyId:f.agencyId,subAccountId:c,meteringScope:"SUBACCOUNT"});if(0===e.length)return(0,b.jsx)(y,{subaccountId:c,agencyId:f.agencyId,apps:g});let[h,...i]=e,k=g.find(a=>a.key===h);if(!k?.entitled||"INSTALLED"!==k.state){if("integrations"!==h&&"webhooks"!==h)return(0,b.jsx)(E,{subaccountId:c,agencyId:f.agencyId,appKey:h,info:k});else if(k?.state!=="INSTALLED")return(0,b.jsx)(E,{subaccountId:c,agencyId:f.agencyId,appKey:h,info:k})}switch(h){case"support":return(0,b.jsx)(A,{subaccountId:c,segments:i});case"webhooks":return(0,b.jsx)(C,{subaccountId:c,agencyId:f.agencyId,segments:i});case"integrations":((a,b)=>{let[c]=b;c&&""!==c||(0,d.redirect)(`/subaccount/${a}/apps/webhooks/providers`);let e=b[1];(0,d.redirect)(`/subaccount/${a}/apps/webhooks/${{providers:"providers",connections:"connections","api-keys":"api-keys",webhooks:"subscriptions",deliveries:"deliveries"}[c]||c}${e?`/${e}`:""}`)})(c,i);default:return(0,b.jsx)(E,{subaccountId:c,agencyId:f.agencyId,appKey:h,info:k})}}a.s(["default",()=>F])}];

//# sourceMappingURL=src_app_%28main%29_subaccount_%5BsubaccountId%5D_apps_%5B%5B___path%5D%5D_page_tsx_bb19a808._.js.map