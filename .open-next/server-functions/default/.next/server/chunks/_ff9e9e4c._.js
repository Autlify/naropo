module.exports=[717890,e=>{"use strict";e.s(["version",()=>"7.7.4"])},330415,e=>{"use strict";let t=e=>{console.warn(`⚠️ [uploadthing][deprecated] ${e}`)};e.s(["logDeprecationWarning",()=>t])},266493,e=>{"use strict";var t=e.i(842862);let r=e=>(t,r)=>t===r||e(t,r),i=(e,t)=>e===t,n=(0,t.dual)(2,(e,t)=>r((r,i)=>e(t(r),t(i)))),a=n(i,e=>e.getTime());e.s(["Date",0,a,"array",0,e=>r((t,r)=>{if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(!e(t[i],r[i]))return!1;return!0}),"bigint",0,i,"boolean",0,i,"make",0,r,"mapInput",0,n,"number",0,i,"string",0,i,"struct",0,e=>{let t=Object.keys(e);return r((r,i)=>{for(let n of t)if(!e[n](r[n],i[n]))return!1;return!0})},"tuple",0,(...e)=>r((t,r)=>{let i=Math.min(t.length,r.length),n=0;for(let a of e){if(n>=i)break;if(!a(t[n],r[n]))return!1;n++}return!0})])},842862,100808,e=>{"use strict";let t=e=>"function"==typeof e,r=function(e,t){if("function"==typeof e)return function(){return e(arguments)?t.apply(this,arguments):e=>t(e,...arguments)};switch(e){case 0:case 1:throw RangeError(`Invalid arity ${e}`);case 2:return function(e,r){return arguments.length>=2?t(e,r):function(r){return t(r,e)}};case 3:return function(e,r,i){return arguments.length>=3?t(e,r,i):function(i){return t(i,e,r)}};case 4:return function(e,r,i,n){return arguments.length>=4?t(e,r,i,n):function(n){return t(n,e,r,i)}};case 5:return function(e,r,i,n,a){return arguments.length>=5?t(e,r,i,n,a):function(a){return t(a,e,r,i,n)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(e){return t(e,...r)}}}},i=e=>e,n=e=>()=>e,a=n(!0),s=n(!1),o=n(null),l=n(void 0);function u(e,t,r,i,n,a,s,o,l){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return i(r(t(e)));case 5:return n(i(r(t(e))));case 6:return a(n(i(r(t(e)))));case 7:return s(a(n(i(r(t(e))))));case 8:return o(s(a(n(i(r(t(e)))))));case 9:return l(o(s(a(n(i(r(t(e))))))));default:{let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return e}}}e.s(["constFalse",0,s,"constNull",0,o,"constTrue",0,a,"constUndefined",0,l,"constVoid",0,l,"constant",0,n,"dual",0,r,"identity",0,i,"isFunction",0,t,"pipe",()=>u,"unsafeCoerce",0,i],842862);let c=e=>"object"==typeof e&&null!==e,p=e=>c(e)||t(e),f=r(2,(e,t)=>p(e)&&t in e),d=r(2,(e,t)=>f(e,"_tag")&&e._tag===t),h=r(2,(e,t)=>r=>e(r)||t(r));e.s(["hasProperty",0,f,"isBigInt",0,e=>"bigint"==typeof e,"isBoolean",0,e=>"boolean"==typeof e,"isDate",0,e=>e instanceof Date,"isFunction",0,t,"isIterable",0,e=>f(e,Symbol.iterator),"isMap",0,e=>e instanceof Map,"isNever",0,e=>!1,"isNotNull",0,e=>null!==e,"isNotNullable",0,e=>null!=e,"isNotUndefined",0,e=>void 0!==e,"isNull",0,e=>null===e,"isNullable",0,e=>null==e,"isNumber",0,e=>"number"==typeof e,"isObject",0,p,"isPromiseLike",0,e=>f(e,"then")&&t(e.then),"isRecord",0,e=>c(e)&&!Array.isArray(e),"isRecordOrArray",0,c,"isRegExp",0,e=>e instanceof RegExp,"isSet",0,e=>e instanceof Set,"isString",0,e=>"string"==typeof e,"isSymbol",0,e=>"symbol"==typeof e,"isTagged",0,d,"isTruthy",0,e=>!!e,"isUint8Array",0,e=>e instanceof Uint8Array,"isUndefined",0,e=>void 0===e,"or",0,h],100808)},408043,402409,965766,686434,e=>{"use strict";let t;var r=e.i(842862);let i="effect/GlobalValue",n=(e,r)=>(t||(globalThis[i]??=new Map,t=globalThis[i]),t.has(e)||t.set(e,r()),t.get(e));e.s(["globalValue",0,n],402409);var a=e.i(100808);let s=e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`;e.s(["getBugErrorMessage",0,s],965766);let o=Symbol.for("effect/Gen/GenKind");class l{value;constructor(e){this.value=e}get _F(){return r.identity}get _R(){return e=>e}get _O(){return e=>e}get _E(){return e=>e}[o]=o;[Symbol.iterator](){return new u(this)}}class u{self;called=!1;constructor(e){this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(e){return{value:e,done:!0}}throw(e){throw e}[Symbol.iterator](){return new u(this.self)}}class c{_state;constructor(e,t,r,i){return(0,a.isNullable)(t)&&(0,a.isNullable)(e)?(t=0xffffffff*Math.random()>>>0,e=0):(0,a.isNullable)(t)&&(t=e,e=0),(0,a.isNullable)(i)&&(0,a.isNullable)(r)?(i=this._state?this._state[3]:0xf767814f,r=this._state?this._state[2]:0x14057b7e):(0,a.isNullable)(i)&&(i=r,r=0),this._state=new Int32Array([0,0,r>>>0,(1|(i||0))>>>0]),this._next(),p(this._state,this._state[0],this._state[1],e>>>0,t>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(e){this._state[0]=e[0],this._state[1]=e[1],this._state[2]=e[2],this._state[3]=1|e[3]}integer(e){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%e}number(){return(0x8000000*((0x3ffffff&this._next())*1)+(0x7ffffff&this._next())*1)/0x20000000000000}_next(){var e,t,r;let i,n,a,s,o=this._state[0]>>>0,l=this._state[1]>>>0;e=this._state,t=o,i=((r=l)>>>16)*32557>>>0,n=(65535&r)*19605>>>0,a=(65535&r)*32557>>>0,s=(r>>>16)*19605+((n>>>16)+(i>>>16))>>>0,(a=a+(n=n<<16>>>0)>>>0)>>>0<n>>>0&&(s=s+1>>>0),(a=a+(i=i<<16>>>0)>>>0)>>>0<i>>>0&&(s=s+1>>>0),s=(s=s+Math.imul(r,0x5851f42d)>>>0)+Math.imul(t,0x4c957f2d)>>>0,e[0]=s,e[1]=a,p(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let u=o>>>18,c=(l>>>18|o<<14)>>>0;u=(u^o)>>>0;let f=((c=(c^l)>>>0)>>>27|u<<5)>>>0,d=o>>>27;return(f>>>d|f<<((-d>>>0&31)>>>0))>>>0}}function p(e,t,r,i,n){let a=t+i>>>0,s=r+n>>>0;s>>>0<r>>>0&&(a=a+1|0),e[0]=a,e[1]=s}let f=Symbol.for("effect/Utils/YieldWrap");class d{#e;constructor(e){this.#e=e}[f](){return this.#e}}function h(e){if("object"==typeof e&&null!==e&&f in e)return e[f]();throw Error(s("yieldWrapGet"))}let m=n("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),g=e=>e(),y=g(()=>Error().stack)?.includes("effect_internal_function")===!0,b=(function*(){}).constructor;e.s(["PCGRandom",()=>c,"SingleShotGen",()=>u,"YieldWrap",()=>d,"adapter",0,()=>function(){let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return new l(e)},"internalCall",0,y?g:e=>e(),"isGenKind",0,e=>(0,a.isObject)(e)&&o in e,"isGeneratorFunction",0,e=>(0,a.isObject)(e)&&e.constructor===b,"structuralRegionState",0,m,"yieldWrapGet",()=>h],686434);let S=n(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),v=Symbol.for("effect/Hash"),E=e=>{if(!0===m.enabled)return 0;switch(typeof e){case"number":return C(e);case"bigint":return I(e.toString(10));case"boolean":case"symbol":return I(String(e));case"string":return I(e);case"undefined":return I("undefined");case"function":case"object":if(null===e)return I("null");if(e instanceof Date)return E(e.toISOString());if(e instanceof URL)return E(e.href);else if(x(e))return e[v]();else return w(e);default:throw Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},w=e=>(S.has(e)||S.set(e,C(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),S.get(e)),_=e=>t=>53*t^e,k=e=>0xbfffffff&e|e>>>1&0x40000000,x=e=>(0,a.hasProperty)(e,v),C=e=>{if(e!=e||e===1/0)return 0;let t=0|e;for(t!==e&&(t^=0xffffffff*e);e>0xffffffff;)t^=e/=0xffffffff;return k(t)},I=e=>{let t=5381,r=e.length;for(;r;)t=33*t^e.charCodeAt(--r);return k(t)};e.s(["array",0,e=>{let t=6151;for(let i=0;i<e.length;i++)t=(0,r.pipe)(t,_(E(e[i])));return k(t)},"cached",0,function(){if(1==arguments.length){let e=arguments[0];return function(t){return Object.defineProperty(e,v,{value:()=>t,enumerable:!1}),t}}let e=arguments[0],t=arguments[1];return Object.defineProperty(e,v,{value:()=>t,enumerable:!1}),t},"combine",0,_,"hash",0,E,"number",0,C,"random",0,w,"string",0,I,"structure",0,e=>((e,t)=>{let i=12289;for(let n=0;n<t.length;n++)i^=(0,r.pipe)(I(t[n]),_(E(e[t[n]])));return k(i)})(e,Object.keys(e)),"symbol",0,v],408043)},945831,580537,787039,e=>{"use strict";var t=e.i(408043),r=e.i(100808),i=e.i(686434);let n=Symbol.for("effect/Equal");function a(){return 1==arguments.length?e=>s(e,arguments[0]):s(arguments[0],arguments[1])}function s(e,r){if(e===r)return!0;let a=typeof e;if(a!==typeof r)return!1;if("object"===a||"function"===a){if(null!==e&&null!==r){if(o(e)&&o(r))if(t.hash(e)===t.hash(r)&&e[n](r))return!0;else return!!i.structuralRegionState.enabled&&!!i.structuralRegionState.tester&&i.structuralRegionState.tester(e,r);else if(e instanceof Date&&r instanceof Date)return e.toISOString()===r.toISOString();else if(e instanceof URL&&r instanceof URL)return e.href===r.href}if(i.structuralRegionState.enabled){if(Array.isArray(e)&&Array.isArray(r))return e.length===r.length&&e.every((e,t)=>s(e,r[t]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){let t=Object.keys(e),n=Object.keys(r);if(t.length===n.length){for(let n of t)if(!(n in r&&s(e[n],r[n])))return!!i.structuralRegionState.tester&&i.structuralRegionState.tester(e,r);return!0}}return!!i.structuralRegionState.tester&&i.structuralRegionState.tester(e,r)}}return!!i.structuralRegionState.enabled&&!!i.structuralRegionState.tester&&i.structuralRegionState.tester(e,r)}let o=e=>(0,r.hasProperty)(e,n);e.s(["equals",()=>a,"equivalence",0,()=>a,"isEqual",0,o,"symbol",0,n],945831);var l=e.i(402409);let u=Symbol.for("nodejs.util.inspect.custom"),c=e=>{try{if((0,r.hasProperty)(e,"toJSON")&&(0,r.isFunction)(e.toJSON)&&0===e.toJSON.length)return e.toJSON();if(Array.isArray(e))return e.map(c)}catch{return{}}return y(e)},p=e=>JSON.stringify(e,null,2);class f{[u](){return this.toJSON()}toString(){return p(this.toJSON())}}let d=(e,t)=>{let r=[],i=JSON.stringify(e,(e,t)=>"object"==typeof t&&null!==t?r.includes(t)?void 0:r.push(t)&&(void 0!==g.fiberRefs&&m(t)?t[h](g.fiberRefs):t):t,t);return r=void 0,i},h=Symbol.for("effect/Inspectable/Redactable"),m=e=>"object"==typeof e&&null!==e&&h in e,g=(0,l.globalValue)("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),y=e=>m(e)&&void 0!==g.fiberRefs?e[h](g.fiberRefs):e;e.s(["BaseProto",0,{toJSON(){return c(this)},[u](){return this.toJSON()},toString(){return p(this.toJSON())}},"Class",()=>f,"NodeInspectSymbol",0,u,"format",0,p,"redact",0,y,"stringifyCircular",0,d,"symbolRedactable",0,h,"toJSON",0,c,"toStringUnknown",0,(e,t=2)=>{if("string"==typeof e)return e;try{return"object"==typeof e?d(e,t):String(e)}catch{return String(e)}},"withRedactableContext",0,(e,t)=>{let r=g.fiberRefs;g.fiberRefs=e;try{return t()}finally{g.fiberRefs=r}}],580537);e.s(["pipeArguments",0,(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let e=0,i=t.length;e<i;e++)r=t[e](r);return r}}}],787039)},874995,25560,347133,480467,e=>{"use strict";var t=e.i(945831),r=e.i(408043),i=e.i(787039),n=e.i(686434);let a="Commit";e.s(["OP_ASYNC",0,"Async","OP_COMMIT",0,a,"OP_FAILURE",0,"Failure","OP_ITERATOR",0,"Iterator","OP_ON_FAILURE",0,"OnFailure","OP_ON_SUCCESS",0,"OnSuccess","OP_ON_SUCCESS_AND_FAILURE",0,"OnSuccessAndFailure","OP_REVERT_FLAGS",0,"RevertFlags","OP_SUCCESS",0,"Success","OP_SYNC",0,"Sync","OP_TAG",0,"Tag","OP_UPDATE_RUNTIME_FLAGS",0,"UpdateRuntimeFlags","OP_WHILE",0,"While","OP_WITH_RUNTIME",0,"WithRuntime","OP_YIELD",0,"Yield"],25560);let s=()=>"3.17.7";e.s(["getCurrentVersion",0,s],347133);let o=Symbol.for("effect/Effect"),l=Symbol.for("effect/Stream"),u=Symbol.for("effect/Sink"),c=Symbol.for("effect/Channel"),p={_R:e=>e,_E:e=>e,_A:e=>e,_V:s()},f={[o]:p,[l]:p,[u]:{_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},[c]:{_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},[t.symbol](e){return this===e},[r.symbol](){return r.cached(this,r.random(this))},[Symbol.iterator](){return new n.SingleShotGen(new n.YieldWrap(this))},pipe(){return(0,i.pipeArguments)(this,arguments)}},d={[r.symbol](){return r.cached(this,r.structure(this))},[t.symbol](e){let r=Object.keys(this),i=Object.keys(e);if(r.length!==i.length)return!1;for(let i of r)if(!(i in e&&t.equals(this[i],e[i])))return!1;return!0}},h={...f,_op:a},m={...h,...d},g=function(){function e(){}return e.prototype=h,e}(),y=function(){function e(){}return e.prototype=m,e}();e.s(["Base",0,g,"ChannelTypeId",0,c,"CommitPrototype",0,h,"EffectPrototype",0,f,"EffectTypeId",0,o,"SinkTypeId",0,u,"StreamTypeId",0,l,"StructuralBase",0,y,"StructuralCommitPrototype",0,m,"StructuralPrototype",0,d,"effectVariance",0,p],874995);var b=e.i(580537),S=e.i(100808);let v=Symbol.for("effect/Option"),E={...f,[v]:{_A:e=>e},[b.NodeInspectSymbol](){return this.toJSON()},toString(){return(0,b.format)(this.toJSON())}},w=Object.assign(Object.create(E),{_tag:"Some",_op:"Some",[t.symbol](e){return x(e)&&I(e)&&t.equals(this.value,e.value)},[r.symbol](){return r.cached(this,r.combine(r.hash(this._tag))(r.hash(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:(0,b.toJSON)(this.value)}}}),_=r.hash("None"),k=Object.assign(Object.create(E),{_tag:"None",_op:"None",[t.symbol]:e=>x(e)&&C(e),[r.symbol]:()=>_,toJSON(){return{_id:"Option",_tag:this._tag}}}),x=e=>(0,S.hasProperty)(e,v),C=e=>"None"===e._tag,I=e=>"Some"===e._tag,T=Object.create(k);e.s(["isNone",0,C,"isOption",0,x,"isSome",0,I,"none",0,T,"some",0,e=>{let t=Object.create(w);return t.value=e,t}],480467)},964665,717222,3349,e=>{"use strict";var t=e.i(266493),r=e.i(842862);e.s(["bind",0,(e,t)=>(0,r.dual)(3,(r,i,n)=>t(r,t=>e(n(t),e=>({...t,[i]:e})))),"bindTo",0,e=>(0,r.dual)(2,(t,r)=>e(t,e=>({[r]:e}))),"let_",0,e=>(0,r.dual)(3,(t,r,i)=>e(t,e=>({...e,[r]:i(e)})))],717222);var i=e.i(945831),n=e.i(408043),a=e.i(580537),s=e.i(100808),o=e.i(874995),l=e.i(480467);let u=Symbol.for("effect/Either"),c={...o.EffectPrototype,[u]:{_R:e=>e},[a.NodeInspectSymbol](){return this.toJSON()},toString(){return(0,a.format)(this.toJSON())}},p=Object.assign(Object.create(c),{_tag:"Right",_op:"Right",[i.symbol](e){return d(e)&&m(e)&&i.equals(this.right,e.right)},[n.symbol](){return n.combine(n.hash(this._tag))(n.hash(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:(0,a.toJSON)(this.right)}}}),f=Object.assign(Object.create(c),{_tag:"Left",_op:"Left",[i.symbol](e){return d(e)&&h(e)&&i.equals(this.left,e.left)},[n.symbol](){return n.combine(n.hash(this._tag))(n.hash(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:(0,a.toJSON)(this.left)}}}),d=e=>(0,s.hasProperty)(e,u),h=e=>"Left"===e._tag,m=e=>"Right"===e._tag,g=e=>{let t=Object.create(f);return t.left=e,t},y=e=>{let t=Object.create(p);return t.right=e,t},b=e=>m(e)?l.none:l.some(e.left),S=e=>h(e)?l.none:l.some(e.right),v=(0,r.dual)(2,(e,t)=>l.isNone(e)?g(t()):y(e.value));e.s(["TypeId",0,u,"fromOption",0,v,"getLeft",0,b,"getRight",0,S,"isEither",0,d,"isLeft",0,h,"isRight",0,m,"left",0,g,"right",0,y],3349),e.i(686434);let E=e=>{if((0,s.isFunction)(e))try{return y(e())}catch(e){return g(e)}try{return y(e.try())}catch(t){return g(e.catch(t))}},w=(0,r.dual)(2,(e,{onLeft:t,onRight:r})=>h(e)?g(t(e.left)):y(r(e.right))),_=(0,r.dual)(2,(e,t)=>h(e)?g(t(e.left)):y(e.right)),k=(0,r.dual)(2,(e,t)=>m(e)?y(t(e.right)):g(e.left)),x=(0,r.dual)(2,(e,{onLeft:t,onRight:r})=>h(e)?t(e.left):r(e.right)),C=(0,r.dual)(3,(e,t,r)=>t(e)?y(e):g(r(e))),I=x({onLeft:r.identity,onRight:r.identity});r.constNull,r.constUndefined;let T=(0,r.dual)(2,(e,t)=>{if(m(e))return e.right;throw t(e.left)}),R=T(()=>Error("getOrThrow called on a Left")),O=(0,r.dual)(2,(e,t)=>h(e)?g(e.left):t(e.right));(e,t,r)=>O(e,e=>k(t,t=>r(e,t))),e.s(["all",0,e=>{if(Symbol.iterator in e){let t=[];for(let r of e){if(h(r))return r;t.push(r.right)}return y(t)}let t={};for(let r of Object.keys(e)){let i=e[r];if(h(i))return i;t[r]=i.right}return y(t)},"fromOption",0,v,"getEquivalence",0,({left:e,right:r})=>t.make((t,i)=>h(t)?h(i)&&e(t.left,i.left):m(i)&&r(t.right,i.right)),"getLeft",0,b,"getOrThrow",0,R,"getOrThrowWith",0,T,"getRight",0,S,"isEither",0,d,"isLeft",0,h,"isRight",0,m,"left",0,g,"liftPredicate",0,C,"map",0,k,"mapBoth",0,w,"mapLeft",0,_,"match",0,x,"merge",0,I,"right",0,y,"try",()=>E],964665)},65632,129248,e=>{"use strict";let t;var r=e.i(945831),i=e.i(266493),n=e.i(842862);e.i(717222);var a=e.i(3349),s=e.i(480467);let o=e=>(t,r)=>t===r?0:e(t,r),l=o((e,t)=>e<t?-1:1),u=o((e,t)=>e<t?-1:1),c=o((e,t)=>e<t?-1:1),p=o((e,t)=>e<t?-1:1),f=(0,n.dual)(2,(e,t)=>o((r,i)=>{let n=e(r,i);if(0!==n)return n;for(let e of t)if(0!==(n=e(r,i)))break;return n})),d=(0,n.dual)(2,(e,t)=>o((r,i)=>e(t(r),t(i)))),h=e=>(0,n.dual)(2,(t,r)=>-1===e(t,r)),m=e=>(0,n.dual)(2,(t,r)=>1===e(t,r)),g=e=>(0,n.dual)(2,(t,r)=>t===r||1>e(t,r)?t:r),y=e=>(0,n.dual)(2,(t,r)=>t===r||e(t,r)>-1?t:r);e.s(["array",0,e=>o((t,r)=>{let i=t.length,n=r.length,a=Math.min(i,n);for(let i=0;i<a;i++){let n=e(t[i],r[i]);if(0!==n)return n}return u(i,n)}),"between",0,e=>(0,n.dual)(2,(t,r)=>!h(e)(t,r.minimum)&&!m(e)(t,r.maximum)),"bigint",0,p,"boolean",0,c,"clamp",0,e=>(0,n.dual)(2,(t,r)=>g(e)(r.maximum,y(e)(r.minimum,t))),"combineAll",0,e=>f(o(()=>0),e),"greaterThan",0,m,"greaterThanOrEqualTo",0,e=>(0,n.dual)(2,(t,r)=>-1!==e(t,r)),"lessThan",0,h,"lessThanOrEqualTo",0,e=>(0,n.dual)(2,(t,r)=>1!==e(t,r)),"make",0,o,"mapInput",0,d,"max",0,y,"min",0,g,"number",0,u,"string",0,l,"struct",0,e=>{let t=Object.keys(e);return o((r,i)=>{for(let n of t){let t=e[n](r[n],i[n]);if(0!==t)return t}return 0})},"tuple",0,(...e)=>{let t;return t=e,o((e,r)=>{let i=Math.min(e.length,r.length),n=0;for(let a of t){if(n>=i)break;let t=a(e[n],r[n]);if(0!==t)return t;n++}return 0})}],129248),e.i(686434);let b=()=>s.none,S=s.some,v=s.isOption,E=s.isNone,w=s.isSome,_=(0,n.dual)(2,(e,{onNone:t,onSome:r})=>E(e)?t():r(e.value)),k=a.getRight;a.getLeft;let x=(0,n.dual)(2,(e,t)=>E(e)?t():e.value),C=(0,n.dual)(2,(e,t)=>E(e)?t():e),I=(0,n.dual)(2,(e,t)=>E(e)?S(t()):e),T=e=>null==e?b():S(e),R=x(n.constNull),O=x(n.constUndefined),F=(0,n.dual)(2,(e,t)=>{if(w(e))return e.value;throw t()}),M=F(()=>Error("getOrThrow called on a None")),A=(0,n.dual)(2,(e,t)=>E(e)?b():S(t(e.value))),N=(0,n.dual)(2,(e,t)=>E(e)?b():t(e.value)),P=(0,n.dual)(2,(e,t)=>E(e)?b():T(t(e.value)));n.identity,(e,t)=>N(e,e=>A(t(e),()=>e));let D=(0,n.dual)(3,(e,t,r)=>A(w(e)&&w(t)?S([e.value,t.value]):b(),([e,t])=>r(e,t))),L=(0,n.dual)(2,(e,t)=>N(e,e=>t(e)?s.some(e):s.none)),U=(t=r.equivalence(),(0,n.dual)(2,(e,r)=>!E(e)&&t(e.value,r))),z=(0,n.dual)(2,(e,t)=>!E(e)&&t(e.value));e.s(["all",0,e=>{if(Symbol.iterator in e){let t=[];for(let r of e){if(E(r))return b();t.push(r.value)}return S(t)}let t={};for(let r of Object.keys(e)){let i=e[r];if(E(i))return b();t[r]=i.value}return S(t)},"contains",0,U,"exists",0,z,"filter",0,L,"flatMap",0,N,"flatMapNullable",0,P,"fromNullable",0,T,"getEquivalence",0,e=>i.make((t,r)=>E(t)?E(r):!E(r)&&e(t.value,r.value)),"getOrElse",0,x,"getOrNull",0,R,"getOrThrow",0,M,"getOrThrowWith",0,F,"getOrUndefined",0,O,"getRight",0,k,"isNone",0,E,"isOption",0,v,"isSome",0,w,"liftThrowable",0,e=>(...t)=>{try{return S(e(...t))}catch{return b()}},"map",0,A,"match",0,_,"mergeWith",0,e=>(t,r)=>E(t)?r:E(r)?t:S(e(t.value,r.value)),"none",0,b,"orElse",0,C,"orElseSome",0,I,"some",0,S,"toArray",0,e=>E(e)?[]:[e.value],"zipWith",0,D],65632)},435146,362573,434596,753126,847272,e=>{"use strict";var t=e.i(964665),r=e.i(945831),i=e.i(266493),n=e.i(842862);let a=e=>e.length>0;e.s(["isNonEmptyArray",0,a],362573),e.i(717222);var s=e.i(65632),o=e.i(100808),l=e.i(129248);let u=(...e)=>e;i.tuple,l.tuple,e.s(["make",0,u],434596),(e,t)=>c(t,e);let c=(0,n.dual)(2,(e,t)=>({[Symbol.iterator](){let r,i=e[Symbol.iterator](),n=!1;return{next(){if(!n){let e=i.next();return e.done?(n=!0,(r=t[Symbol.iterator]()).next()):e}return r.next()}}}})),p=(0,n.dual)(2,(e,t)=>{let r=0;for(let i of e){let e=t(i,r);if((0,o.isBoolean)(e)){if(e)return s.some(i)}else if(s.isSome(e))return e;r++}return s.none()});(e,t,r)=>({[Symbol.iterator](){let i=e[Symbol.iterator](),n=t[Symbol.iterator]();return{next(){let e=i.next(),t=n.next();return e.done||t.done?{done:!0,value:void 0}:{done:!1,value:r(e.value,t.value)}}}}});let f={[Symbol.iterator]:()=>d},d={next:()=>({done:!0,value:void 0})},h=(0,n.dual)(2,(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),i=0;return{next(){let e=r.next();return e.done?{done:!0,value:void 0}:{done:!1,value:t(e.value,i++)}}}}})),m=(0,n.dual)(2,(e,t)=>g(h(e,t))),g=e=>({[Symbol.iterator](){let t,r=e[Symbol.iterator]();return{next:function e(){if(void 0===t){let e=r.next();if(e.done)return e;t=e.value[Symbol.iterator]()}let i=t.next();return i.done?(t=void 0,e()):i}}}});(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),i=0;return{next(){let e=r.next();for(;!e.done;){let n=t(e.value,i++);if(s.isSome(n))return{done:!1,value:n.value};e=r.next()}return{done:!0,value:void 0}}}}}),n.identity;let y=(0,n.dual)(3,(e,t,r)=>{if(Array.isArray(e))return e.reduce(r,t);let i=0,n=t;for(let t of e)n=r(n,t,i++);return n});(e,t,r)=>m(e,e=>h(t,t=>r(e,t))),e.s(["empty",0,()=>f,"findFirst",0,p,"reduce",0,y,"unsafeHead",0,e=>{let t=e[Symbol.iterator]().next();if(t.done)throw Error("unsafeHead: empty iterable");return t.value}],753126);let b=(0,n.dual)(2,(e,t)=>{let r=[];for(let i of _(e))r.push(t(i,e[i]));return r})((e,t)=>[e,t]),S=(0,n.dual)(2,(e,t)=>Object.prototype.hasOwnProperty.call(e,t)),v=(0,n.dual)(2,(e,t)=>S(e,t)?s.some(e[t]):s.none()),E=((e,t,r)=>S(e,t)?s.some({...e,[t]:r(e[t])}):s.none(),(0,n.dual)(2,(e,t)=>{if(!S(e,t))return{...e};let r={...e};return delete r[t],r})),w=(0,n.dual)(2,(e,t)=>{let r={...e};for(let i of _(e))r[i]=t(e[i],i);return r});n.identity,n.identity;let _=e=>Object.keys(e),k=(0,n.dual)(3,(e,t,r)=>({...e,[t]:r}));e.s(["get",0,v,"getEquivalence",0,e=>{let t=(0,n.dual)(2,(t,r)=>{for(let i of _(t))if(!S(r,i)||!e(t[i],r[i]))return!1;return!0});return(e,r)=>t(e,r)&&t(r,e)},"isEmptyRecord",0,e=>0===_(e).length,"map",0,w,"remove",0,E,"set",0,k,"toEntries",0,b],847272);let x=(0,n.dual)(2,(e,t)=>{let r=Math.max(1,Math.floor(e)),i=Array(r);for(let e=0;e<r;e++)i[e]=t(e);return i}),C=e=>Array.isArray(e)?e:Array.from(e);s.toArray;let I=(0,n.dual)(2,(e,{onEmpty:t,onNonEmpty:r})=>N(e)?r(e):t()),T=(0,n.dual)(2,(e,{onEmpty:t,onNonEmpty:r})=>N(e)?r(j(e),q(e)):t()),R=(0,n.dual)(2,(e,t)=>[t,...e]),O=(0,n.dual)(2,(e,t)=>[...e,t]),F=(0,n.dual)(2,(e,t)=>C(e).concat(C(t))),M=Array.isArray,A=e=>0===e.length,N=a,P=(e,t)=>e<0||e>=t.length,D=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),L=(0,n.dual)(2,(e,t)=>{let r=Math.floor(t);return P(r,e)?s.none():s.some(e[r])}),U=(0,n.dual)(2,(e,t)=>{let r=Math.floor(t);if(P(r,e))throw Error(`Index ${r} out of bounds`);return e[r]}),z=L(0),j=U(0),W=e=>e[e.length-1],q=e=>e.slice(1),$=((e,t)=>{let r=C(e);return r.slice(0,D(t,r))},(0,n.dual)(2,(e,t)=>en(e,((e,t)=>{let r=0;for(let i of e){if(!t(i,r))break;r++}return r})(e,t)))),B=(0,n.dual)(2,(e,t)=>{let r=C(e);return r.slice(D(t,r),r.length)}),H=(0,n.dual)(2,(e,t)=>{let r=0;for(let i of e){if(t(i,r))return s.some(r);r++}return s.none()}),V=(0,n.dual)(2,(e,t)=>{let r=C(e);for(let e=r.length-1;e>=0;e--)if(t(r[e],e))return s.some(e);return s.none()}),J=(0,n.dual)(2,(e,t)=>{let r=C(e);for(let e=r.length-1;e>=0;e--){let i=r[e],n=t(i,e);if(o.isBoolean(n)){if(n)return s.some(i)}else if(s.isSome(n))return n}return s.none()}),G=(0,n.dual)(3,(e,t,r)=>{let i=Array.from(e);if(P(t,i))return i;let n=r(i[t]);return i[t]=n,i}),K=((e,t,r)=>{let i=C(e);if(P(t,i))return s.none();let n=Array.isArray(e)?e.slice():i,a=r(i[t]);return n[t]=a,s.some(n)},(0,n.dual)(2,(e,t)=>{let r=Array.from(e);return P(t,r)||r.splice(t,1),r})),Z=(0,n.dual)(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r}),Q=(0,n.dual)(2,(e,t)=>Y(e,t,u)),Y=(0,n.dual)(3,(e,t,r)=>{let i=C(e),n=C(t);if(N(i)&&N(n)){let e=[r(j(i),j(n))],t=Math.min(i.length,n.length);for(let a=1;a<t;a++)e[a]=r(i[a],n[a]);return e}return[]}),X=((e,t)=>[t(j(e)),...q(e)],(0,n.dual)(2,(e,t)=>{let r=C(e);if(N(r)){let i=r.length,n=Math.round(t)%i;if(P(Math.abs(n),r)||0===n)return es(r);if(!(n<0))return X(e,n-i);{let[e,t]=ea(r,-n);return F(t,e)}}return[]})),ee=e=>(0,n.dual)(2,(t,r)=>{for(let i of t)if(e(r,i))return!0;return!1}),et=r.equivalence(),er=ee(et),ei=(0,n.dual)(2,(e,t)=>{let r=C(e);if(N(r)){let[e,i]=t(r),n=[e],s=i;for(;a(s);){let[e,r]=t(s);n.push(e),s=r}return n}return[]}),en=(0,n.dual)(2,(e,t)=>{let r=Array.from(e),i=Math.floor(t);return N(r)?i>=1?ea(r,i):[[],r]:[r,[]]}),ea=(0,n.dual)(2,(e,t)=>{let r=Math.max(1,Math.floor(t));return r>=e.length?[es(e),[]]:[R(e.slice(1,r),j(e)),e.slice(r)]}),es=e=>e.slice();(e,t)=>{let r=C(e);return N(r)?ei(r,ea(t)):[]};let eo=(0,n.dual)(3,(e,t,r)=>{let i=C(e),n=C(t);return N(i)?N(n)?eI(r)(F(i,n)):i:n}),el=(0,n.dual)(2,(e,t)=>eo(e,t,et)),eu=e=>{let t=ee(e);return(0,n.dual)(2,(e,r)=>C(e).filter(e=>t(r,e)))},ec=eu(et),ep=e=>{let t=ee(e);return(0,n.dual)(2,(e,r)=>C(e).filter(e=>!t(r,e)))},ef=ep(et),ed=(0,n.dual)(2,(e,t)=>e.map(t)),eh=(0,n.dual)(2,(e,t)=>{if(A(e))return[];let r=[];for(let i=0;i<e.length;i++){let n=t(e[i],i);for(let e=0;e<n.length;e++)r.push(n[e])}return r}),em=eh(n.identity),eg=(0,n.dual)(2,(e,t)=>{let r=C(e),i=[];for(let e=0;e<r.length;e++){let n=t(r[e],e);s.isSome(n)&&i.push(n.value)}return i}),ey=(0,n.dual)(2,(e,t)=>{let r=0,i=[];for(let n of e){let e=t(n,r);if(s.isSome(e))i.push(e.value);else break;r++}return i}),eb=(0,n.dual)(2,(e,r)=>{let i=[],n=[],a=C(e);for(let e=0;e<a.length;e++){let s=r(a[e],e);t.isLeft(s)?i.push(s.left):n.push(s.right)}return[i,n]}),eS=eg(n.identity),ev=(0,n.dual)(2,(e,t)=>{let r=C(e),i=[];for(let e=0;e<r.length;e++)t(r[e],e)&&i.push(r[e]);return i}),eE=(0,n.dual)(2,(e,t)=>{let r=[],i=[],n=C(e);for(let e=0;e<n.length;e++)t(n[e],e)?i.push(n[e]):r.push(n[e]);return[r,i]}),ew=eb(n.identity),e_=(0,n.dual)(3,(e,t,r)=>C(e).reduce((e,t,i)=>r(e,t,i),t)),ek=(0,n.dual)(3,(e,t,r)=>C(e).reduceRight((e,t,i)=>r(e,t,i),t)),ex=(0,n.dual)(2,(e,t)=>e.every(t));l.array;let eC=i.array,eI=(0,n.dual)(2,(e,t)=>{let r=C(e);if(N(r)){let e=[j(r)];for(let i of q(r))e.every(e=>!t(i,e))&&e.push(i);return e}return[]}),eT=(0,n.dual)(2,(e,t)=>{let r=[],i=s.none();for(let n of e)(s.isNone(i)||!t(n,i.value))&&(r.push(n),i=s.some(n));return r})(r.equivalence()),eR=(0,n.dual)(2,(e,t)=>C(e).join(t)),eO=(0,n.dual)(3,(e,t,r)=>{let i=0,n=t,a=[];for(let t of e){let e=r(n,t,i);n=e[0],a.push(e[1]),i++}return[n,a]});(e,t,r)=>eh(e,e=>ed(t,t=>r(e,t))),e.s(["allocate",0,e=>Array(e),"append",0,O,"appendAll",0,F,"contains",0,er,"containsWith",0,ee,"copy",0,es,"dedupe",0,e=>eI(e,r.equivalence()),"dedupeAdjacent",0,eT,"difference",0,ef,"differenceWith",0,ep,"drop",0,B,"empty",0,()=>[],"ensure",0,e=>Array.isArray(e)?e:[e],"every",0,ex,"filter",0,ev,"filterMap",0,eg,"filterMapWhile",0,ey,"findFirst",0,p,"findFirstIndex",0,H,"findLast",0,J,"findLastIndex",0,V,"flatMap",0,eh,"flatten",0,em,"fromIterable",0,C,"getEquivalence",0,eC,"getSomes",0,eS,"head",0,z,"headNonEmpty",0,j,"intersection",0,ec,"intersectionWith",0,eu,"isArray",0,M,"isEmptyReadonlyArray",0,A,"isNonEmptyArray",0,a,"isNonEmptyReadonlyArray",0,N,"join",0,eR,"last",0,e=>N(e)?s.some(W(e)):s.none(),"lastNonEmpty",0,W,"make",0,(...e)=>e,"makeBy",0,x,"map",0,ed,"mapAccum",0,eO,"match",0,I,"matchLeft",0,T,"modify",0,G,"of",0,e=>[e],"partition",0,eE,"partitionMap",0,eb,"prepend",0,R,"reduce",0,e_,"reduceRight",0,ek,"remove",0,K,"reverse",0,e=>Array.from(e).reverse(),"separate",0,ew,"sort",0,Z,"span",0,$,"splitAt",0,en,"tailNonEmpty",0,q,"unfold",0,(e,t)=>{let r,i=[],n=e;for(;s.isSome(r=t(n));){let[e,t]=r.value;i.push(e),n=t}return i},"union",0,el,"unsafeGet",0,U,"unzip",0,e=>{let t=C(e);if(N(t)){let e=[t[0][0]],r=[t[0][1]];for(let i=1;i<t.length;i++)e[i]=t[i][0],r[i]=t[i][1];return[e,r]}return[[],[]]},"zip",0,Q,"zipWith",0,Y],435146)},777865,327184,e=>{"use strict";var t=e.i(945831),r=e.i(842862),i=e.i(402409),n=e.i(408043),a=e.i(580537),s=e.i(787039),o=e.i(100808),l=e.i(874995),u=e.i(480467);let c=Symbol.for("effect/Context/Tag"),p=Symbol.for("effect/Context/Reference"),f=Symbol.for("effect/STM"),d={...l.EffectPrototype,_op:"Tag",[f]:l.effectVariance,[c]:{_Service:e=>e,_Identifier:e=>e},toString(){return(0,a.format)(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[a.NodeInspectSymbol](){return this.toJSON()},of:e=>e,context(e){return C(this,e)}},h={...d,[p]:p},m=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=Error();Error.stackTraceLimit=t;let i=Object.create(d);return Object.defineProperty(i,"stack",{get:()=>r.stack}),i.key=e,i},g=e=>()=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=Error();function i(){}return Error.stackTraceLimit=t,Object.setPrototypeOf(i,d),i.key=e,Object.defineProperty(i,"stack",{get:()=>r.stack}),i},y=()=>(e,t)=>{let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let i=Error();function n(){}return Error.stackTraceLimit=r,Object.setPrototypeOf(n,h),n.key=e,n.defaultValue=t.defaultValue,Object.defineProperty(n,"stack",{get:()=>i.stack}),n},b=Symbol.for("effect/Context"),S={[b]:{_Services:e=>e},[t.symbol](e){if(E(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let r of this.unsafeMap.keys())if(!e.unsafeMap.has(r)||!t.equals(this.unsafeMap.get(r),e.unsafeMap.get(r)))return!1;return!0}return!1},[n.symbol](){return n.cached(this,n.number(this.unsafeMap.size))},pipe(){return(0,s.pipeArguments)(this,arguments)},toString(){return(0,a.format)(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(a.toJSON)}},[a.NodeInspectSymbol](){return this.toJSON()}},v=e=>{let t=Object.create(S);return t.unsafeMap=e,t},E=e=>(0,o.hasProperty)(e,b),w=e=>(0,o.hasProperty)(e,c),_=e=>(0,o.hasProperty)(e,p),k=v(new Map),x=()=>k,C=(e,t)=>v(new Map([[e.key,t]])),I=(0,r.dual)(3,(e,t,r)=>{let i=new Map(e.unsafeMap);return i.set(t.key,r),v(i)}),T=(0,i.globalValue)("effect/Context/defaultValueCache",()=>new Map),R=e=>{if(T.has(e.key))return T.get(e.key);let t=e.defaultValue();return T.set(e.key,t),t},O=(0,r.dual)(2,(e,t)=>{if(!e.unsafeMap.has(t.key)){if(p in t)return R(t);throw(e=>{let t=Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){let r=e.stack.split("\n");if(r.length>2){let e=r[2].match(/at (.*)/);e&&(t.message=t.message+` (defined at ${e[1]})`)}}if(t.stack){let e=t.stack.split("\n");e.splice(1,3),t.stack=e.join("\n")}return t})(t)}return e.unsafeMap.get(t.key)}),F=(0,r.dual)(3,(e,t,r)=>e.unsafeMap.has(t.key)?e.unsafeMap.get(t.key):_(t)?R(t):r()),M=(0,r.dual)(2,(e,t)=>e.unsafeMap.has(t.key)?u.some(e.unsafeMap.get(t.key)):_(t)?u.some(R(t)):u.none),A=(0,r.dual)(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[e,i]of t.unsafeMap)r.set(e,i);return v(r)});e.s(["Reference",0,y,"ReferenceTypeId",0,p,"Tag",0,g,"TagProto",0,d,"TagTypeId",0,c,"TypeId",0,b,"add",0,I,"empty",0,x,"get",0,O,"getOption",0,M,"getOrElse",0,F,"isContext",0,E,"isReference",0,_,"isTag",0,w,"make",0,C,"makeContext",0,v,"makeGenericTag",0,m,"merge",0,A,"mergeAll",0,(...e)=>{let t=new Map;for(let r of e)for(let[e,i]of r.unsafeMap)t.set(e,i);return v(t)},"omit",0,(...e)=>t=>{let r=new Map(t.unsafeMap);for(let t of e)r.delete(t.key);return v(r)},"pick",0,(...e)=>t=>{let r=new Set(e.map(e=>e.key)),i=new Map;for(let[e,n]of t.unsafeMap.entries())r.has(e)&&i.set(e,n);return v(i)},"unsafeGet",0,O,"unsafeGetReference",0,(e,t)=>e.unsafeMap.has(t.key)?e.unsafeMap.get(t.key):R(t)],327184),e.s(["GenericTag",0,m,"Reference",0,y,"Tag",0,g,"add",0,I,"empty",0,x,"get",0,O,"getOption",0,M,"isContext",0,E,"isTag",0,w,"make",0,C,"merge",0,A,"unsafeGet",0,O,"unsafeMake",0,v],777865)},700157,680465,e=>{"use strict";var t=e.i(435146),r=e.i(777865),i=e.i(874995);i.EffectTypeId,i.StreamTypeId,i.SinkTypeId,i.ChannelTypeId;let n=i.EffectPrototype,a=i.CommitPrototype;i.StructuralCommitPrototype;let s=i.Base,o=i.StructuralBase;class l extends s{}class u extends o{}e.s(["Class",()=>l,"CommitPrototype",0,a,"EffectPrototype",0,n,"StructuralClass",()=>u],680465),e.i(964665);var c=e.i(945831),p=e.i(842862),f=e.i(402409),d=e.i(408043),h=e.i(580537),m=e.i(327184);e.i(717222);var g=e.i(65632),y=e.i(787039),b=e.i(100808),S=e.i(686434);let v=Symbol.for("effect/Micro"),E=Symbol.for("effect/Micro/MicroExit"),w=e=>"object"==typeof e&&null!==e&&v in e,_=Symbol.for("effect/Micro/MicroCause"),k={_E:p.identity};class x extends globalThis.Error{_tag;traces;[_];constructor(e,t,r){let i,n,a;const s=`MicroCause.${e}`;if(t instanceof globalThis.Error){i=`(${s}) ${t.name}`;const e=(n=t.message).split("\n").length;a=t.stack?`(${s}) ${t.stack.split("\n").slice(0,e+3).join("\n")}`:`${i}: ${n}`}else i=s,n=(0,h.toStringUnknown)(t,0),a=`${i}: ${n}`;r.length>0&&(a+=`
    ${r.join("\n    ")}`),super(n),this._tag=e,this.traces=r,this[_]=k,this.name=i,this.stack=a}pipe(){return(0,y.pipeArguments)(this,arguments)}toString(){return this.stack}[h.NodeInspectSymbol](){return this.stack}}class C extends x{error;constructor(e,t=[]){super("Fail",e,t),this.error=e}}let I=(e,t=[])=>new C(e,t);class T extends x{defect;constructor(e,t=[]){super("Die",e,t),this.defect=e}}let R=(e,t=[])=>new T(e,t);class O extends x{constructor(e=[]){super("Interrupt","interrupted",e)}}let F=(e=[])=>new O(e),M=e=>"Fail"===e._tag,A=e=>"Interrupt"===e._tag,N=(0,p.dual)(2,(e,t)=>{let r=[...e.traces,t];switch(e._tag){case"Die":return R(e.defect,r);case"Interrupt":return F(r);case"Fail":return I(e.error,r)}}),P=Symbol.for("effect/Micro/MicroFiber"),D={_A:p.identity,_E:p.identity};class L{context;interruptible;[P];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(e,t=!0){this.context=e,this.interruptible=t,this[P]=D}getRef(e){return m.unsafeGetReference(this.context,e)}addObserver(e){return this._exit?(e(this._exit),p.constVoid):(this._observers.push(e),()=>{let t=this._observers.indexOf(e);t>=0&&this._observers.splice(t,1)})}_interrupted=!1;unsafeInterrupt(){!this._exit&&(this._interrupted=!0,this.interruptible&&this.evaluate(ew))}unsafePoll(){return this._exit}evaluate(e){if(this._exit)return;if(void 0!==this._yielded){let e=this._yielded;this._yielded=void 0,e()}let t=this.runLoop(e);if(t===V)return;let r=U.interruptChildren&&U.interruptChildren(this);if(void 0!==r)return this.evaluate(eg(r,()=>t));this._exit=t;for(let e=0;e<this._observers.length;e++)this._observers[e](t);this._observers.length=0}runLoop(e){let t=!1,r=e;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!t&&this.getRef(eA).shouldYield(this)){t=!0;let e=r;r=eg(en,()=>e)}if((r=r[q](this))===V){let e=this._yielded;if(E in e)return this._yielded=void 0,e;return V}}}catch(e){if(!(0,b.hasProperty)(r,q))return e_(`MicroFiber.runLoop: Not a valid effect: ${String(r)}`);return e_(e)}}getCont(e){for(;;){let t=this._stack.pop();if(!t)return;let r=t[H]&&t[H](this);if(r)return{[e]:r};if(t[e])return t}}_yielded=void 0;yieldWith(e){return this._yielded=e,V}children(){return this._children??=new Set}}let U=(0,f.globalValue)("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),z=e=>ei(()=>{for(let t of e)t.unsafeInterrupt();let t=e[Symbol.iterator](),r=ei(()=>{let e=t.next();for(;!e.done;){if(e.value.unsafePoll()){e=t.next();continue}let i=e.value;return ec(e=>{i.addObserver(t=>{e(r)})})}return ex});return r}),j=Symbol.for("effect/Micro/identifier"),W=Symbol.for("effect/Micro/args"),q=Symbol.for("effect/Micro/evaluate"),$=Symbol.for("effect/Micro/successCont"),B=Symbol.for("effect/Micro/failureCont"),H=Symbol.for("effect/Micro/ensureCont"),V=Symbol.for("effect/Micro/Yield"),J={_A:p.identity,_E:p.identity,_R:p.identity},G={...n,_op:"Micro",[v]:J,pipe(){return(0,y.pipeArguments)(this,arguments)},[Symbol.iterator](){return new S.SingleShotGen(new S.YieldWrap(this))},toJSON(){return{_id:"Micro",op:this[j],...W in this?{args:this[W]}:void 0}},toString(){return(0,h.format)(this)},[h.NodeInspectSymbol](){return(0,h.format)(this)}};function K(e){return e_("Micro.evaluate: Not implemented")}let Z=e=>({...G,[j]:e.op,[q]:e.eval??K,[$]:e.contA,[B]:e.contE,[H]:e.ensure}),Q=e=>{let t=Z(e);return function(){let r=Object.create(t);return r[W]=!1===e.single?arguments:arguments[0],r}},Y=e=>{let t={...Z(e),[E]:E,_tag:e.op,get[e.prop](){return this[W]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[W]}},[c.symbol](t){return eS(t)&&t._tag===e.op&&c.equals(this[W],t[W])},[d.symbol](){return d.cached(this,d.combine(d.string(e.op))(d.hash(this[W])))}};return function(e){let r=Object.create(t);return r[W]=e,r[$]=void 0,r[B]=void 0,r[H]=void 0,r}},X=Y({op:"Success",prop:"value",eval(e){let t=e.getCont($);return t?t[$](this[W],e):e.yieldWith(this)}}),ee=Y({op:"Failure",prop:"cause",eval(e){let t=e.getCont(B);for(;A(this[W])&&t&&e.interruptible;)t=e.getCont(B);return t?t[B](this[W],e):e.yieldWith(this)}}),et=e=>ee(I(e)),er=Q({op:"Sync",eval(e){let t=this[W](),r=e.getCont($);return r?r[$](t,e):e.yieldWith(ev(t))}}),ei=Q({op:"Suspend",eval(e){return this[W]()}}),en=Q({op:"Yield",eval(e){let t=!1;return e.getRef(eA).scheduleTask(()=>{t||e.evaluate(ex)},this[W]??0),e.yieldWith(()=>{t=!0})}})(0),ea=X(void 0),es=e=>ei(()=>{try{return X(e.try())}catch(t){return et(e.catch(t))}}),eo=Q({op:"WithMicroFiber",eval(e){return this[W](e)}}),el=Q({op:"Async",single:!1,eval(e){let t=this[W][0],r=!1,i=!1,n=this[W][1]?new AbortController:void 0,a=t(t=>{r||(r=!0,i?e.evaluate(t):i=t)},n?.signal);return!1!==i?i:(i=!0,e._yielded=()=>{r=!0},void 0===n&&void 0===a||e._stack.push(eu(()=>(r=!0,n?.abort(),a??ex))),V)}}),eu=Q({op:"AsyncFinalizer",ensure(e){e.interruptible&&(e.interruptible=!1,e._stack.push(eQ(!0)))},contE(e,t){return A(e)?eg(this[W](),()=>ee(e)):ee(e)}}),ec=e=>el(e,e.length>=2),ep=Q({op:"Iterator",contA(e,t){let r=this[W].next(e);return r.done?X(r.value):(t._stack.push(this),(0,S.yieldWrapGet)(r.value))},eval(e){return this[$](void 0,e)}}),ef=(0,p.dual)(2,(e,t)=>eb(e,e=>t)),ed=(0,p.dual)(2,(e,t)=>eg(e,e=>{let r=w(t)?t:"function"==typeof t?t(e):t;return w(r)?r:X(r)})),eh=((e,t)=>eg(e,e=>{let r=w(t)?t:"function"==typeof t?t(e):t;return w(r)?ef(r,e):X(e)}),e=>eB(e,{onFailure:eE,onSuccess:ev})),em=(0,p.dual)(2,(e,t)=>{let r;return r=[e,t],eo(e=>ec(t=>{let i=!1,n=new Set,a=e=>{i=!0,t(0===n.size?e:eg(z(n),()=>e))};for(let t of r){if(i)break;let r=e6(e,eY(t),!0,!0);n.add(r),r.addObserver(e=>{n.delete(r),a(e)})}return z(n)}))}),eg=(0,p.dual)(2,(e,t)=>{let r=Object.create(ey);return r[W]=e,r[$]=t,r}),ey=Z({op:"OnSuccess",eval(e){return e._stack.push(this),this[W]}}),eb=(0,p.dual)(2,(e,t)=>eg(e,e=>X(t(e)))),eS=e=>(0,b.hasProperty)(e,E),ev=X,eE=ee,ew=eE(F()),e_=e=>eE(R(e)),ek=e=>"Failure"===e._tag,ex=ev(void 0),eC=e=>{for(let t of e)if("Failure"===t._tag)return t;return ex},eI="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class eT{tasks=[];running=!1;scheduleTask(e,t){this.tasks.push(e),this.running||(this.running=!0,eI(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let e=this.tasks;this.tasks=[];for(let t=0,r=e.length;t<r;t++)e[t]()}shouldYield(e){return e.currentOpCount>=e.getRef(eF)}flush(){for(;this.tasks.length>0;)this.runTasks()}}let eR=(0,p.dual)(2,(e,t)=>eo(r=>{let i=r.context;return r.context=t(i),eG(e,()=>(r.context=i,ea))})),eO=(0,p.dual)(2,(e,t)=>eR(e,r.merge(t)));(e,t,i)=>eR(e,r.add(t,i));class eF extends r.Reference()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class eM extends r.Reference()("effect/Micro/currentConcurrency",{defaultValue:()=>"unbounded"}){}class eA extends r.Reference()("effect/Micro/currentScheduler",{defaultValue:()=>new eT}){}e=>w(e[1]),(e,t,r,i)=>i?.concurrent?eb(e0([e,t],{concurrency:2}),([e,t])=>r(e,t)):eg(e,e=>eb(t,t=>r(e,t)));let eN=(0,p.dual)(e=>w(e[0]),(e,t,r)=>eg(e,e=>t(e)?X(e):et(r(e)))),eP=((e,t)=>ei(()=>{let r=t.schedule?Date.now():0,i=0,n=eg(eh(e),e=>{if(void 0!==t.while&&!t.while(e)||void 0!==t.times&&i>=t.times)return e;i++;let a=en;if(void 0!==t.schedule){let n=Date.now()-r,s=t.schedule(i,n);if(g.isNone(s))return e;a=eH(s.value)}return eg(a,()=>n)});return n}),(0,p.dual)(2,(e,t)=>{let r=Object.create(eD);return r[W]=e,r[B]=t,r})),eD=Z({op:"OnFailure",eval(e){return e._stack.push(this),this[W]}}),eL=(0,p.dual)(3,(e,t,r)=>eP(e,e=>t(e)?r(e):ee(e))),eU=(0,p.dual)(2,(e,t)=>eL(e,M,e=>t(e.error))),ez=(0,p.dual)(3,(e,t,r)=>eL(e,t,e=>ed(r(e),ee(e)))),ej=(0,p.dual)(2,(e,t)=>ez(e,M,e=>t(e.error))),eW=((e,t,r)=>eL(e,e=>M(e)&&t(e.error),e=>r(e.error)),(0,p.dual)(2,(e,t)=>eU(e,e=>er(t)))),eq=(0,p.dual)(2,(e,t)=>{let r=Object.create(e$);return r[W]=e,r[$]=t.onSuccess,r[B]=t.onFailure,r}),e$=Z({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[W]}}),eB=(0,p.dual)(2,(e,t)=>eq(e,{onFailure:e=>er(()=>t.onFailure(e)),onSuccess:e=>er(()=>t.onSuccess(e))})),eH=((e,t)=>eq(e,{onFailure:e=>"Fail"===e._tag?t.onFailure(e.error):ee(e),onSuccess:t.onSuccess}),e=>ec(t=>{let r=setTimeout(()=>{t(ea)},e);return er(()=>{clearTimeout(r)})})),eV=((e,t)=>em(e,ed(eY(eH(t.duration)),t.onTimeout)),Symbol.for("effect/Micro/MicroScope"));class eJ{[eV];state={_tag:"Open",finalizers:new Set};constructor(){this[eV]=eV}unsafeAddFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.add(e)}addFinalizer(e){return ei(()=>"Open"===this.state._tag?(this.state.finalizers.add(e),ea):e(this.state.exit))}unsafeRemoveFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.delete(e)}close(e){return ei(()=>{if("Open"===this.state._tag){let t=Array.from(this.state.finalizers).reverse();return this.state={_tag:"Closed",exit:e},eg(e2(t,t=>eh(t(e))),eC)}return ea})}get fork(){return er(()=>{let e=new eJ;if("Closed"===this.state._tag)return e.state=this.state,e;function t(t){return e.close(t)}return this.state.finalizers.add(t),e.unsafeAddFinalizer(e=>er(()=>this.unsafeRemoveFinalizer(t))),e})}}let eG=(0,p.dual)(2,(e,t)=>eX(r=>eq(r(e),{onFailure:e=>eg(t(eE(e)),()=>ee(e)),onSuccess:e=>eg(t(ev(e)),()=>X(e))}))),eK=(0,p.dual)(3,(e,t,r)=>eG(e,e=>t(e)?r(e):ex)),eZ=(0,p.dual)(2,(e,t)=>eK(e,ek,e=>t(e.cause))),eQ=Q({op:"SetInterruptible",ensure(e){if(e.interruptible=this[W],e._interrupted&&e.interruptible)return()=>ew}}),eY=e=>eo(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(eQ(!1)),t._interrupted)?ew:e),eX=e=>eo(t=>t.interruptible?(t.interruptible=!1,t._stack.push(eQ(!0)),e(eY)):e(p.identity)),e0=(e,t)=>Array.isArray(e)||(0,b.isIterable)(e)?e2(e,p.identity,t):t?.discard?e2(Object.values(e),p.identity,t):ei(()=>{let r={};return ef(e2(Object.entries(e),([e,t])=>eb(t,t=>{r[e]=t}),{discard:!0,concurrency:t?.concurrency}),r)}),e1=Q({op:"While",contA(e,t){return(this[W].step(e),this[W].while())?(t._stack.push(this),this[W].body()):ex},eval(e){return this[W].while()?(e._stack.push(this),this[W].body()):ex}}),e2=(e,r,i)=>eo(n=>{let a=i?.concurrency==="inherit"?n.getRef(eM):i?.concurrency??1,s="unbounded"===a?1/0:Math.max(1,a),o=t.fromIterable(e),l=o.length;if(0===l)return i?.discard?ea:X([]);let u=i?.discard?void 0:Array(l),c=0;return 1===s?ef(e1({while:()=>c<o.length,body:()=>r(o[c],c),step:u?e=>u[c++]=e:e=>c++}),u):ec(e=>{let t,i=new Set,a=0,p=0,f=!1,d=!1;return!function h(){for(f=!0;a<s&&c<l;){let m=c,g=o[m];c++,a++;try{let o=e6(n,r(g,m),!0,!0);i.add(o),o.addObserver(r=>{i.delete(o),d||("Failure"===r._tag?void 0===t&&(t=r,l=c,i.forEach(e=>e.unsafeInterrupt())):void 0!==u&&(u[m]=r.value),p++,a--,p===l?e(t??X(u)):!f&&a<s&&h())})}catch(e){t=e_(e),l=c,i.forEach(e=>e.unsafeInterrupt())}}f=!1}(),ei(()=>(d=!0,c=l,z(i)))})}),e6=(e,t,r=!1,i=!1)=>{let n=new L(e.context,e.interruptible);return i||(e.children().add(n),n.addObserver(()=>e.children().delete(n))),r?n.evaluate(t):e.getRef(eA).scheduleTask(()=>n.evaluate(t),0),n},e3=(e,t)=>{let r=new L(eA.context(t?.scheduler??new eT));if(r.evaluate(e),t?.signal)if(t.signal.aborted)r.unsafeInterrupt();else{let e=()=>r.unsafeInterrupt();t.signal.addEventListener("abort",e,{once:!0}),r.addObserver(()=>t.signal.removeEventListener("abort",e))}return r},e4=function(){class e extends globalThis.Error{}return Object.assign(e.prototype,G,i.StructuralPrototype,{[j]:"Failure",[q](){return et(this)},toString(){return this.message?`${this.name}: ${this.message}`:this.name},toJSON(){return{...this}},[h.NodeInspectSymbol](){let e=this.stack;return e?`${this.toString()}
${e.split("\n").slice(1).join("\n")}`:this.toString()}}),e}(),e5=class extends e4{constructor(e){super(),e&&Object.assign(this,e)}},e8=e=>{class t extends e5{_tag=e}return t.prototype.name=e,t};e.s(["Error",0,e5,"TaggedError",0,e8,"fail",0,et,"filterOrFail",0,eN,"flatMap",0,eg,"fromEither",0,e=>"Right"===e._tag?X(e.right):et(e.left),"gen",0,(...e)=>ei(()=>ep(1===e.length?e[0]():e[1].call(e[0]))),"map",0,eb,"orElseSucceed",0,eW,"promise",0,e=>el(function(t,r){e(r).then(e=>t(X(e)),e=>t(e_(e)))},0!==e.length),"provideContext",0,eO,"runFork",0,e3,"runSync",0,e=>{let t,r,i=(r=e3(e,{scheduler:t=new eT}),t.flush(),r._exit??e_(r));if("Failure"===i._tag)throw i.cause;return i.value},"service",0,e=>eo(t=>X(r.unsafeGet(t.context,e))),"succeed",0,X,"sync",0,er,"tapError",0,ej,"try",()=>es,"tryPromise",0,e=>el(function(t,r){try{e.try(r).then(e=>t(X(e)),r=>t(et(e.catch(r))))}catch(r){t(et(e.catch(r)))}},0!==e.try.length),"withTrace",0,function(){let e=globalThis.Error.stackTraceLimit;globalThis.Error.stackTraceLimit=2;let t=new globalThis.Error;globalThis.Error.stackTraceLimit=e;let r=e=>r=>eZ(r,r=>ee(function(e,r){let i=t.stack;if(!i)return r;let n=i.split("\n")[2]?.trim().replace(/^at /,"");if(!n)return r;let a=n.match(/\((.*)\)$/);return N(r,`at ${e} (${a?a[1]:n})`)}(e,r)));return 2==arguments.length?r(arguments[1])(arguments[0]):r(arguments[0])}],700157)},916947,e=>{"use strict";var t=e.i(964665),r=e.i(100808);let i=Symbol.for("effect/Encoding/errors/Decode"),n=(e,t)=>{let n={_tag:"DecodeException",[i]:i,input:e};return(0,r.isString)(t)&&(n.message=t),n},a=Symbol.for("effect/Encoding/errors/Encode"),s=new TextEncoder,o=new TextDecoder,l=e=>{let t,r=e.length,i="";for(t=2;t<r;t+=3)i+=f[e[t-2]>>2],i+=f[(3&e[t-2])<<4|e[t-1]>>4],i+=f[(15&e[t-1])<<2|e[t]>>6],i+=f[63&e[t]];return t===r+1&&(i+=f[e[t-2]>>2],i+=f[(3&e[t-2])<<4],i+="=="),t===r&&(i+=f[e[t-2]>>2],i+=f[(3&e[t-2])<<4|e[t-1]>>4],i+=f[(15&e[t-1])<<2],i+="="),i},u=e=>{let r=c(e),i=r.length;if(i%4!=0)return t.left(n(r,`Length must be a multiple of 4, but is ${i}`));let a=r.indexOf("=");if(-1!==a&&(a<i-2||a===i-2&&"="!==r[i-1]))return t.left(n(r,"Found a '=' character, but it is not at the end"));try{let e=r.endsWith("==")?2:+!!r.endsWith("="),n=new Uint8Array(i/4*3-e);for(let e=0,t=0;e<i;e+=4,t+=3){let i=p(r.charCodeAt(e))<<18|p(r.charCodeAt(e+1))<<12|p(r.charCodeAt(e+2))<<6|p(r.charCodeAt(e+3));n[t]=i>>16,n[t+1]=i>>8&255,n[t+2]=255&i}return t.right(n)}catch(e){return t.left(n(r,e instanceof Error?e.message:"Invalid input"))}},c=e=>e.replace(/[\n\r]/g,"");function p(e){if(e>=d.length)throw TypeError(`Invalid character ${String.fromCharCode(e)}`);let t=d[e];if(255===t)throw TypeError(`Invalid character ${String.fromCharCode(e)}`);return t}let f=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],d=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],h=e=>l(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),m=e=>{let t="";for(let r=0;r<e.length;++r)t+=g[e[r]];return t},g=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],y=e=>{if(48<=e&&e<=57)return e-48;if(97<=e&&e<=102)return e-97+10;if(65<=e&&e<=70)return e-65+10;throw TypeError("Invalid input")},b=e=>u(e),S=e=>(e=>{let r=c(e),i=r.length;if(i%4==1)return t.left(n(r,`Length should be a multiple of 4, but is ${i}`));if(!/^[-_A-Z0-9]*?={0,2}$/i.test(r))return t.left(n(r,"Invalid input"));let a=i%4==2?`${r}==`:i%4==3?`${r}=`:r;return u(a=a.replace(/-/g,"+").replace(/_/g,"/"))})(e),v=e=>(e=>{let r=new TextEncoder().encode(e);if(r.length%2!=0)return t.left(n(e,`Length must be a multiple of 2, but is ${r.length}`));try{let e=r.length/2,i=new Uint8Array(e);for(let t=0;t<e;t++){let e=y(r[2*t]),n=y(r[2*t+1]);i[t]=e<<4|n}return t.right(i)}catch(r){return t.left(n(e,r instanceof Error?r.message:"Invalid input"))}})(e);e.s(["decodeBase64",0,b,"decodeBase64String",0,e=>t.map(b(e),e=>o.decode(e)),"decodeBase64Url",0,S,"decodeBase64UrlString",0,e=>t.map(S(e),e=>o.decode(e)),"decodeHex",0,v,"decodeHexString",0,e=>t.map(v(e),e=>o.decode(e)),"decodeUriComponent",0,e=>t.try({try:()=>decodeURIComponent(e),catch:t=>n(e,t instanceof Error?t.message:"Invalid input")}),"encodeBase64",0,e=>"string"==typeof e?l(s.encode(e)):l(e),"encodeBase64Url",0,e=>"string"==typeof e?h(s.encode(e)):h(e),"encodeHex",0,e=>"string"==typeof e?m(s.encode(e)):m(e),"encodeUriComponent",0,e=>t.try({try:()=>encodeURIComponent(e),catch:t=>{var i,n;let s;return i=e,n=t instanceof Error?t.message:"Invalid input",s={_tag:"EncodeException",[a]:a,input:i},(0,r.isString)(n)&&(s.message=n),s}})],916947)},376799,e=>{"use strict";var t=e.i(945831),r=e.i(842862),i=e.i(402409),n=e.i(408043),a=e.i(580537),s=e.i(787039),o=e.i(100808);let l="effect/Redacted",u=(0,i.globalValue)("effect/Redacted/redactedRegistry",()=>new WeakMap),c=Symbol.for(l),p={[c]:{_A:e=>e},pipe(){return(0,s.pipeArguments)(this,arguments)},toString:()=>"<redacted>",toJSON:()=>"<redacted>",[a.NodeInspectSymbol]:()=>"<redacted>",[n.symbol](){return(0,r.pipe)(n.hash(l),n.combine(n.hash(u.get(this))),n.cached(this))},[t.symbol](e){return f(e)&&t.equals(u.get(this),u.get(e))}},f=e=>(0,o.hasProperty)(e,c);e.s(["RedactedTypeId",0,c,"isRedacted",0,f,"make",0,e=>{let t=Object.create(p);return u.set(t,e),t},"proto",0,p,"redactedRegistry",0,u,"unsafeWipe",0,e=>u.delete(e),"value",0,e=>{if(u.has(e))return u.get(e);throw Error("Unable to get redacted value")}])},392353,e=>{"use strict";var t=e.i(266493),r=e.i(376799);r.RedactedTypeId;let i=r.isRedacted,n=r.make,a=r.value;r.unsafeWipe,e.s(["getEquivalence",0,e=>t.make((t,r)=>e(a(t),a(r))),"isRedacted",0,i,"make",0,n,"value",0,a])},836689,e=>{"use strict";let t={alphabet:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",minLength:0,blocklist:new Set(["0rgasm","1d10t","1d1ot","1di0t","1diot","1eccacu10","1eccacu1o","1eccacul0","1eccaculo","1mbec11e","1mbec1le","1mbeci1e","1mbecile","a11upat0","a11upato","a1lupat0","a1lupato","aand","ah01e","ah0le","aho1e","ahole","al1upat0","al1upato","allupat0","allupato","ana1","ana1e","anal","anale","anus","arrapat0","arrapato","arsch","arse","ass","b00b","b00be","b01ata","b0ceta","b0iata","b0ob","b0obe","b0sta","b1tch","b1te","b1tte","ba1atkar","balatkar","bastard0","bastardo","batt0na","battona","bitch","bite","bitte","bo0b","bo0be","bo1ata","boceta","boiata","boob","boobe","bosta","bran1age","bran1er","bran1ette","bran1eur","bran1euse","branlage","branler","branlette","branleur","branleuse","c0ck","c0g110ne","c0g11one","c0g1i0ne","c0g1ione","c0gl10ne","c0gl1one","c0gli0ne","c0glione","c0na","c0nnard","c0nnasse","c0nne","c0u111es","c0u11les","c0u1l1es","c0u1lles","c0ui11es","c0ui1les","c0uil1es","c0uilles","c11t","c11t0","c11to","c1it","c1it0","c1ito","cabr0n","cabra0","cabrao","cabron","caca","cacca","cacete","cagante","cagar","cagare","cagna","cara1h0","cara1ho","caracu10","caracu1o","caracul0","caraculo","caralh0","caralho","cazz0","cazz1mma","cazzata","cazzimma","cazzo","ch00t1a","ch00t1ya","ch00tia","ch00tiya","ch0d","ch0ot1a","ch0ot1ya","ch0otia","ch0otiya","ch1asse","ch1avata","ch1er","ch1ng0","ch1ngadaz0s","ch1ngadazos","ch1ngader1ta","ch1ngaderita","ch1ngar","ch1ngo","ch1ngues","ch1nk","chatte","chiasse","chiavata","chier","ching0","chingadaz0s","chingadazos","chingader1ta","chingaderita","chingar","chingo","chingues","chink","cho0t1a","cho0t1ya","cho0tia","cho0tiya","chod","choot1a","choot1ya","chootia","chootiya","cl1t","cl1t0","cl1to","clit","clit0","clito","cock","cog110ne","cog11one","cog1i0ne","cog1ione","cogl10ne","cogl1one","cogli0ne","coglione","cona","connard","connasse","conne","cou111es","cou11les","cou1l1es","cou1lles","coui11es","coui1les","couil1es","couilles","cracker","crap","cu10","cu1att0ne","cu1attone","cu1er0","cu1ero","cu1o","cul0","culatt0ne","culattone","culer0","culero","culo","cum","cunt","d11d0","d11do","d1ck","d1ld0","d1ldo","damn","de1ch","deich","depp","di1d0","di1do","dick","dild0","dildo","dyke","encu1e","encule","enema","enf01re","enf0ire","enfo1re","enfoire","estup1d0","estup1do","estupid0","estupido","etr0n","etron","f0da","f0der","f0ttere","f0tters1","f0ttersi","f0tze","f0utre","f1ca","f1cker","f1ga","fag","fica","ficker","figa","foda","foder","fottere","fotters1","fottersi","fotze","foutre","fr0c10","fr0c1o","fr0ci0","fr0cio","fr0sc10","fr0sc1o","fr0sci0","fr0scio","froc10","froc1o","froci0","frocio","frosc10","frosc1o","frosci0","froscio","fuck","g00","g0o","g0u1ne","g0uine","gandu","go0","goo","gou1ne","gouine","gr0gnasse","grognasse","haram1","harami","haramzade","hund1n","hundin","id10t","id1ot","idi0t","idiot","imbec11e","imbec1le","imbeci1e","imbecile","j1zz","jerk","jizz","k1ke","kam1ne","kamine","kike","leccacu10","leccacu1o","leccacul0","leccaculo","m1erda","m1gn0tta","m1gnotta","m1nch1a","m1nchia","m1st","mam0n","mamahuev0","mamahuevo","mamon","masturbat10n","masturbat1on","masturbate","masturbati0n","masturbation","merd0s0","merd0so","merda","merde","merdos0","merdoso","mierda","mign0tta","mignotta","minch1a","minchia","mist","musch1","muschi","n1gger","neger","negr0","negre","negro","nerch1a","nerchia","nigger","orgasm","p00p","p011a","p01la","p0l1a","p0lla","p0mp1n0","p0mp1no","p0mpin0","p0mpino","p0op","p0rca","p0rn","p0rra","p0uff1asse","p0uffiasse","p1p1","p1pi","p1r1a","p1rla","p1sc10","p1sc1o","p1sci0","p1scio","p1sser","pa11e","pa1le","pal1e","palle","pane1e1r0","pane1e1ro","pane1eir0","pane1eiro","panele1r0","panele1ro","paneleir0","paneleiro","patakha","pec0r1na","pec0rina","pecor1na","pecorina","pen1s","pendej0","pendejo","penis","pip1","pipi","pir1a","pirla","pisc10","pisc1o","pisci0","piscio","pisser","po0p","po11a","po1la","pol1a","polla","pomp1n0","pomp1no","pompin0","pompino","poop","porca","porn","porra","pouff1asse","pouffiasse","pr1ck","prick","pussy","put1za","puta","puta1n","putain","pute","putiza","puttana","queca","r0mp1ba11e","r0mp1ba1le","r0mp1bal1e","r0mp1balle","r0mpiba11e","r0mpiba1le","r0mpibal1e","r0mpiballe","rand1","randi","rape","recch10ne","recch1one","recchi0ne","recchione","retard","romp1ba11e","romp1ba1le","romp1bal1e","romp1balle","rompiba11e","rompiba1le","rompibal1e","rompiballe","ruff1an0","ruff1ano","ruffian0","ruffiano","s1ut","sa10pe","sa1aud","sa1ope","sacanagem","sal0pe","salaud","salope","saugnapf","sb0rr0ne","sb0rra","sb0rrone","sbattere","sbatters1","sbattersi","sborr0ne","sborra","sborrone","sc0pare","sc0pata","sch1ampe","sche1se","sche1sse","scheise","scheisse","schlampe","schwachs1nn1g","schwachs1nnig","schwachsinn1g","schwachsinnig","schwanz","scopare","scopata","sexy","sh1t","shit","slut","sp0mp1nare","sp0mpinare","spomp1nare","spompinare","str0nz0","str0nza","str0nzo","stronz0","stronza","stronzo","stup1d","stupid","succh1am1","succh1ami","succhiam1","succhiami","sucker","t0pa","tapette","test1c1e","test1cle","testic1e","testicle","tette","topa","tr01a","tr0ia","tr0mbare","tr1ng1er","tr1ngler","tring1er","tringler","tro1a","troia","trombare","turd","twat","vaffancu10","vaffancu1o","vaffancul0","vaffanculo","vag1na","vagina","verdammt","verga","w1chsen","wank","wichsen","x0ch0ta","x0chota","xana","xoch0ta","xochota","z0cc01a","z0cc0la","z0cco1a","z0ccola","z1z1","z1zi","ziz1","zizi","zocc01a","zocc0la","zocco1a","zoccola"])};class r{constructor(e){var r,i,n;const a=null!=(r=null==e?void 0:e.alphabet)?r:t.alphabet,s=null!=(i=null==e?void 0:e.minLength)?i:t.minLength,o=null!=(n=null==e?void 0:e.blocklist)?n:t.blocklist;if(new Blob([a]).size!==a.length)throw Error("Alphabet cannot contain multibyte characters");if(a.length<3)throw Error("Alphabet length must be at least 3");if(new Set(a).size!==a.length)throw Error("Alphabet must contain unique characters");if("number"!=typeof s||s<0||s>255)throw Error("Minimum length has to be between 0 and 255");const l=new Set,u=a.toLowerCase().split("");for(const e of o)if(e.length>=3){const t=e.toLowerCase(),r=t.split("");r.filter(e=>u.includes(e)).length===r.length&&l.add(t)}this.alphabet=this.shuffle(a),this.minLength=s,this.blocklist=l}encode(e){if(0===e.length)return"";if(e.filter(e=>e>=0&&e<=this.maxValue()).length!==e.length)throw Error(`Encoding supports numbers between 0 and ${this.maxValue()}`);return this.encodeNumbers(e)}decode(e){let t=[];if(""===e)return t;let r=this.alphabet.split("");for(let i of e.split(""))if(!r.includes(i))return t;let i=e.charAt(0),n=this.alphabet.indexOf(i),a=this.alphabet.slice(n)+this.alphabet.slice(0,n);a=a.split("").reverse().join("");let s=e.slice(1);for(;s.length>0;){let e=a.slice(0,1),r=s.split(e);if(r.length>0){if(""===r[0])return t;t.push(this.toNumber(r[0],a.slice(1))),r.length>1&&(a=this.shuffle(a))}s=r.slice(1).join(e)}return t}encodeNumbers(e,t=0){if(t>this.alphabet.length)throw Error("Reached max attempts to re-generate the ID");let r=e.reduce((e,t,r)=>this.alphabet[t%this.alphabet.length].codePointAt(0)+r+e,e.length)%this.alphabet.length;r=(r+t)%this.alphabet.length;let i=this.alphabet.slice(r)+this.alphabet.slice(0,r),n=i.charAt(0);i=i.split("").reverse().join("");let a=[n];for(let t=0;t!==e.length;t++){let r=e[t];a.push(this.toId(r,i.slice(1))),t<e.length-1&&(a.push(i.slice(0,1)),i=this.shuffle(i))}let s=a.join("");if(this.minLength>s.length)for(s+=i.slice(0,1);this.minLength-s.length>0;)i=this.shuffle(i),s+=i.slice(0,Math.min(this.minLength-s.length,i.length));return this.isBlockedId(s)&&(s=this.encodeNumbers(e,t+1)),s}shuffle(e){let t=e.split("");for(let e=0,r=t.length-1;r>0;e++,r--){let i=(e*r+t[e].codePointAt(0)+t[r].codePointAt(0))%t.length;[t[e],t[i]]=[t[i],t[e]]}return t.join("")}toId(e,t){let r=[],i=t.split(""),n=e;do r.unshift(i[n%i.length]),n=Math.floor(n/i.length);while(n>0)return r.join("")}toNumber(e,t){let r=t.split("");return e.split("").reduce((e,t)=>e*r.length+r.indexOf(t),0)}isBlockedId(e){let t=e.toLowerCase();for(let e of this.blocklist)if(e.length<=t.length){if(t.length<=3||e.length<=3){if(t===e)return!0}else if(/\d/.test(e)){if(t.startsWith(e)||t.endsWith(e))return!0}else if(t.includes(e))return!0}return!1}maxValue(){return Number.MAX_SAFE_INTEGER}}e.s(["default",()=>r,"defaultOptions",0,t])},244795,e=>e.a(async(t,r)=>{try{var i=e.i(700157),n=e.i(614202),a=e.i(100808),s=e.i(777865),o=e.i(990837),l=e.i(435122),u=e.i(975952),c=e.i(230772),p=e.i(916947),f=e.i(408043),d=e.i(392353),h=e.i(836689),m=t([n,o,l,u,c]);[n,o,l,u,c]=m.then?(await m)():m;let x=["inline","attachment"],C=["public-read","private"];var g=class extends i.TaggedError("InvalidRouteConfig"){constructor(e,t){super({reason:t?`Expected route config to have a ${t} for key ${e} but none was found.`:`Encountered an invalid route config during backfilling. ${e} was not found.`})}},y=class extends i.TaggedError("UnknownFileType"){constructor(e){super({reason:`Could not determine type for ${e}`})}},b=class extends i.TaggedError("InvalidFileType"){constructor(e,t){super({reason:`File type ${e} not allowed for ${t}`})}},S=class extends i.TaggedError("InvalidFileSize"){constructor(e){super({reason:`Invalid file size: ${e}`})}};function v(e){return{maxFileSize:"image"===e?"4MB":"video"===e?"16MB":"audio"===e||"blob"===e?"8MB":"pdf"===e?"4MB":"text"===e?"64KB":"4MB",maxFileCount:1,minFileCount:1,contentDisposition:"inline"}}i.TaggedError("InvalidURL"),i.TaggedError("RetryError"),i.TaggedError("FetchError"),i.TaggedError("InvalidJson"),i.TaggedError("BadRequestError"),i.TaggedError("UploadAborted"),i.TaggedError("UploadAborted");let I=e=>{if(Array.isArray(e))return i.succeed(e.reduce((e,t)=>(e[t]=v(t),e),{}));let t={};for(let r of E(e)){let n=e[r];if(!n)return i.fail(new g(r));t[r]={...v(r),...n}}return i.succeed(JSON.parse(JSON.stringify(t,M)))},T=(e,t)=>{let r=e.type||(0,n.lookup)(e.name);if(!r)return t.includes("blob")?i.succeed("blob"):i.fail(new y(e.name));if(t.some(e=>e.includes("/"))&&t.includes(r))return i.succeed(r);let a="application/pdf"===r.toLowerCase()?"pdf":r.split("/")[0];if(!t.includes(a))if(t.includes("blob"))return i.succeed("blob");else return i.fail(new b(a,e.name));return i.succeed(a)},R=["B","KB","MB","GB","TB"],O=e=>{let t=RegExp(`^(\\d+)(\\.\\d+)?\\s*(${R.join("|")})$`,"i"),r=e.match(t);if(!r?.[1]||!r[3])return i.fail(new S(e));let n=parseFloat(r[1]),a=r[3].toUpperCase(),s=n*Math.pow(1024,R.indexOf(a));return i.succeed(Math.floor(s))},F=e=>{if(0===e||-1===e)return"0B";let t=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,t)).toFixed(2)}${R[t]}`};function E(e){return Object.keys(e)}function w(e){return Object.fromEntries(Object.entries(e).filter(e=>null!=e[1]))}let M=(e,t)=>"number"!=typeof t||Number.isSafeInteger(t)||t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER?t:t===1/0?Number.MAX_SAFE_INTEGER:t===-1/0?Number.MIN_SAFE_INTEGER:Number.isNaN(t)?0:void 0,A={BAD_REQUEST:400,NOT_FOUND:404,FORBIDDEN:403,INTERNAL_SERVER_ERROR:500,INTERNAL_CLIENT_ERROR:500,TOO_LARGE:413,TOO_SMALL:400,TOO_MANY_FILES:400,KEY_TOO_LONG:400,URL_GENERATION_FAILED:500,UPLOAD_FAILED:500,MISSING_ENV:500,INVALID_SERVER_CONFIG:500,FILE_LIMIT_EXCEEDED:500};var _=class e extends i.Error{_tag="UploadThingError";name="UploadThingError";cause;code;data;constructor(e){const t="string"==typeof e?{code:"INTERNAL_SERVER_ERROR",message:e}:e;super({message:t.message??function(e,t){return"string"==typeof e?e:e instanceof Error||e&&"object"==typeof e&&"message"in e&&"string"==typeof e.message?e.message:t??"An unknown error occurred"}(t.cause,t.code)}),this.code=t.code,this.data=t.data,t.cause instanceof Error?this.cause=t.cause:a.isRecord(t.cause)&&a.isNumber(t.cause.status)&&a.isString(t.cause.statusText)?this.cause=Error(`Response ${t.cause.status} ${t.cause.statusText}`):a.isString(t.cause)?this.cause=Error(t.cause):this.cause=t.cause}static toObject(e){return{code:e.code,message:e.message,data:e.data}}static serialize(t){return JSON.stringify(e.toObject(t))}};function k(e){return A[e.code]}s.Tag("uploadthing/Fetch")();let N={name:"HMAC",hash:"SHA-256"},P=new TextEncoder,D=(e,t,r)=>i.gen(function*(){let n=t?.slice(12);if(!n)return!1;let a=P.encode(d.value(r)),s=yield*i.promise(()=>crypto.subtle.importKey("raw",a,N,!1,["verify"])),o=yield*i.fromEither(p.decodeHex(n)),l=P.encode(e);return yield*i.promise(()=>crypto.subtle.verify(N,s,o,l))}).pipe(i.withTrace("verifySignature"),i.orElseSucceed(()=>!1)),L=(e,t,r)=>i.sync(()=>{let i=JSON.stringify(r?.(e)??[e.name,e.size,e.type,e.lastModified,Date.now()]),n=function(e,t){let r,i,n=e.split(""),a=f.string(t);for(let e=0;e<n.length;e++)i=(a%(e+1)+e)%n.length,r=n[e],n[e]=n[i],n[i]=r;return n.join("")}(h.defaultOptions.alphabet,t),a=new h.default({alphabet:n,minLength:36}).encode([Math.abs(f.string(i))]);return new h.default({alphabet:n,minLength:12}).encode([Math.abs(f.string(t))])+a}).pipe(i.withTrace("generateKey")),U=(e,t,r)=>i.gen(function*(){let n,a=new URL(e),s=r.ttlInSeconds?function(e){if("number"==typeof e)return e;let t=e.split(/(\d+)/).filter(Boolean),r=Number(t[0]),i=(t[1]??"s").trim().slice(0,1);return r*({s:1,m:60,h:3600,d:86400})[i]}(r.ttlInSeconds):3600,o=Date.now()+1e3*s;a.searchParams.append("expires",o.toString()),r.data&&Object.entries(r.data).forEach(([e,t])=>{if(null==t)return;let r=encodeURIComponent(t);a.searchParams.append(e,r)});let l=yield*(n=a.toString(),i.gen(function*(){let e=yield*i.tryPromise({try:()=>crypto.subtle.importKey("raw",P.encode(d.value(t)),N,!1,["sign"]),catch:e=>new _({code:"BAD_REQUEST",message:"Invalid signing secret",cause:e})}),r=yield*i.map(i.tryPromise({try:()=>crypto.subtle.sign(N,e,P.encode(n)),catch:e=>new _({code:"BAD_REQUEST",cause:e})}),e=>p.encodeHex(new Uint8Array(e)));return`hmac-sha256=${r}`}).pipe(i.withTrace("signPayload")));return a.searchParams.append("signature",l),a.href}).pipe(i.withTrace("generateSignedURL"));e.s(["InvalidRouteConfigError",()=>g,"UploadThingError",()=>_,"ValidACLs",()=>C,"ValidContentDispositions",()=>x,"bytesToFileSize",()=>F,"fileSizeToBytes",()=>O,"fillInputRouteConfig",()=>I,"filterDefinedObjectValues",()=>w,"generateKey",()=>L,"generateSignedURL",()=>U,"getStatusCodeFromError",()=>k,"matchFileType",()=>T,"objectKeys",()=>E,"verifySignature",()=>D]),r()}catch(e){r(e)}},!1),129627,526886,456239,838927,649488,727606,720369,500577,214250,807816,260082,997617,679986,57105,890115,968484,587212,472167,389668,399683,248726,215139,957502,167804,580611,e=>{"use strict";let t,r;var i=e.i(435146),n=e.i(945831),a=e.i(266493),s=e.i(842862),o=e.i(408043),l=e.i(580537),u=e.i(65632),c=e.i(129248),p=e.i(787039),f=e.i(100808);let d=Symbol.for("effect/Chunk"),h=[],m=e=>a.make((t,r)=>t.length===r.length&&C(t).every((t,i)=>e(t,F(r,i)))),g=m(n.equals),y={[d]:{_A:e=>e},toString(){return(0,l.format)(this.toJSON())},toJSON(){return{_id:"Chunk",values:C(this).map(l.toJSON)}},[l.NodeInspectSymbol](){return this.toJSON()},[n.symbol](e){return S(e)&&g(this,e)},[o.symbol](){return o.cached(this,o.array(C(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return h[Symbol.iterator]();default:return C(this)[Symbol.iterator]()}},pipe(){return(0,p.pipeArguments)(this,arguments)}},b=e=>{let t=Object.create(y);switch(t.backing=e,e._tag){case"IEmpty":t.length=0,t.depth=0,t.left=t,t.right=t;break;case"IConcat":t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break;case"IArray":t.length=e.array.length,t.depth=0,t.left=v,t.right=v;break;case"ISingleton":t.length=1,t.depth=0,t.left=v,t.right=v;break;case"ISlice":t.length=e.length,t.depth=e.chunk.depth+1,t.left=v,t.right=v}return t},S=e=>(0,f.hasProperty)(e,d),v=b({_tag:"IEmpty"}),E=()=>v,w=(...e)=>O(e),_=e=>b({_tag:"ISingleton",a:e}),k=e=>S(e)?e:R(i.fromIterable(e)),x=(e,t,r)=>{switch(e.backing._tag){case"IArray":!function(e,t,r,i,n){for(let t=0;t<Math.min(e.length,0+n);t++)r[i+t-0]=e[t]}(e.backing.array,0,t,r,e.length);break;case"IConcat":x(e.left,t,r),x(e.right,t,r+e.left.length);break;case"ISingleton":t[r]=e.backing.a;break;case"ISlice":{let i=0,n=r;for(;i<e.length;)t[n]=F(e,i),i+=1,n+=1}}},C=e=>{switch(e.backing._tag){case"IEmpty":return h;case"IArray":return e.backing.array;default:{let t=Array(e.length);return x(e,t,0),e.backing={_tag:"IArray",array:t},e.left=v,e.right=v,e.depth=0,t}}},I=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return b({_tag:"IArray",array:i.reverse(e.backing.array)});case"IConcat":return b({_tag:"IConcat",left:I(e.backing.right),right:I(e.backing.left)});case"ISlice":return R(i.reverse(C(e)))}},T=(0,s.dual)(2,(e,t)=>t<0||t>=e.length?u.none():u.some(F(e,t))),R=e=>0===e.length?E():1===e.length?_(e[0]):b({_tag:"IArray",array:e}),O=e=>R(e),F=(0,s.dual)(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw Error("Index out of bounds");case"ISingleton":if(0!==t)throw Error("Index out of bounds");return e.backing.a;case"IArray":if(t>=e.length||t<0)throw Error("Index out of bounds");return e.backing.array[t];case"IConcat":return t<e.left.length?F(e.left,t):F(e.right,t-e.left.length);case"ISlice":return F(e.backing.chunk,t+e.backing.offset)}}),M=(0,s.dual)(2,(e,t)=>L(e,_(t))),A=(0,s.dual)(2,(e,t)=>L(_(t),e)),N=(0,s.dual)(2,(e,t)=>{if(t<=0)return v;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return b({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":if(t>e.left.length)return b({_tag:"IConcat",left:e.left,right:N(e.right,t-e.left.length)});return N(e.left,t);default:return b({_tag:"ISlice",chunk:e,offset:0,length:t})}}),P=(0,s.dual)(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return v;switch(e.backing._tag){case"ISlice":return b({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":if(t>e.left.length)return P(e.right,t-e.left.length);return b({_tag:"IConcat",left:P(e.left,t),right:e.right});default:return b({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}}),D=(0,s.dual)(2,(e,t)=>{let r=C(e),i=r.length,n=0;for(;n<i&&t(r[n]);)n++;return P(e,n)}),L=(0,s.dual)(2,(e,t)=>{if("IEmpty"===e.backing._tag)return t;if("IEmpty"===t.backing._tag)return e;let r=t.depth-e.depth;if(1>=Math.abs(r))return b({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let r=L(e.right,t);return b({_tag:"IConcat",left:e.left,right:r})}else{let r=L(e.right.right,t);if(r.depth===e.depth-3){let t=b({_tag:"IConcat",left:e.right.left,right:r});return b({_tag:"IConcat",left:e.left,right:t})}{let t=b({_tag:"IConcat",left:e.left,right:e.right.left});return b({_tag:"IConcat",left:t,right:r})}}if(t.right.depth>=t.left.depth)return b({_tag:"IConcat",left:L(e,t.left),right:t.right});{let r=L(e,t.left.left);if(r.depth===t.depth-3){let e=b({_tag:"IConcat",left:r,right:t.left.right});return b({_tag:"IConcat",left:e,right:t.right})}{let e=b({_tag:"IConcat",left:t.left.right,right:t.right});return b({_tag:"IConcat",left:r,right:e})}}}),U=(0,s.dual)(2,(e,t)=>R(i.filterMap(e,t))),z=(0,s.dual)(2,(e,t)=>R(i.filter(e,t))),j=(0,s.dual)(2,(e,t)=>R(i.filterMapWhile(e,t))),W=(0,s.dual)(2,(e,t)=>{if("ISingleton"===e.backing._tag)return t(e.backing.a,0);let r=v,i=0;for(let n of e)r=L(r,t(n,i++));return r}),q=(0,s.dual)(2,(e,t)=>C(e).forEach(t)),$=W(s.identity),B=((e,t)=>{let r=[],i=[];return C(e).forEach(e=>{i.push(e),i.length>=t&&(r.push(R(i)),i=[])}),i.length>0&&r.push(R(i)),R(r)},e=>0===e.length),H=e=>e.length>0,V=T(0),J=e=>F(e,0),G=(0,s.dual)(2,(e,t)=>"ISingleton"===e.backing._tag?_(t(e.backing.a,0)):R((0,s.pipe)(C(e),i.map((e,r)=>t(e,r))))),K=(0,s.dual)(3,(e,t,r)=>{let[n,a]=i.mapAccum(e,t,r);return[n,R(a)]}),Z=((e,t)=>R(i.sort(C(e),t)),(0,s.dual)(2,(e,t)=>[N(e,t),P(e,t)])),Q=(0,s.dual)(2,(e,t)=>{let r=0;for(let i of C(e))if(t(i))break;else r++;return Z(e,r)}),Y=e=>P(e,1),X=(0,s.dual)(2,(e,t)=>P(e,e.length-t)),ee=(0,s.dual)(2,(e,t)=>{let r=[];for(let i of C(e))if(t(i))r.push(i);else break;return R(r)}),et=(0,s.dual)(3,(e,t,r)=>R(i.zipWith(e,t,r))),er=(0,s.dual)(3,(e,t,r)=>t<0||t>=e.length?u.none():u.some(R(i.modify(C(e),t,r)))),ei=((e,t,r)=>u.getOrElse(er(e,t,r),()=>e),(0,s.dual)(2,(e,t)=>k(i.makeBy(e,t))));i.contains,i.containsWith;let en=i.findFirst;i.findFirstIndex,i.findLast,i.findLastIndex;let ea=(0,s.dual)(2,(e,t)=>i.fromIterable(e).some(t));i.join;let es=i.reduce,eo=i.reduceRight;e.s(["append",0,M,"appendAll",0,L,"drop",0,P,"dropWhile",0,D,"empty",0,E,"filter",0,z,"filterMap",0,U,"filterMapWhile",0,j,"findFirst",0,en,"flatMap",0,W,"flatten",0,$,"forEach",0,q,"fromIterable",0,k,"getEquivalence",0,m,"head",0,V,"headNonEmpty",0,J,"isChunk",0,S,"isEmpty",0,B,"isNonEmpty",0,H,"last",0,e=>T(e,e.length-1),"make",0,w,"map",0,G,"mapAccum",0,K,"of",0,_,"prepend",0,A,"range",0,(e,t)=>e<=t?ei(t-e+1,t=>e+t):_(e),"reduce",0,es,"reduceRight",0,eo,"reverse",0,I,"some",0,ea,"splitAt",0,Z,"splitWhere",0,Q,"tailNonEmpty",0,Y,"take",0,N,"takeRight",0,X,"takeWhile",0,ee,"toArray",0,e=>C(e).slice(),"toReadonlyArray",0,C,"unsafeFromArray",0,R,"unsafeFromNonEmptyArray",0,O,"unsafeGet",0,F,"unsafeHead",0,J,"unsafeLast",0,e=>F(e,e.length-1),"zipWith",0,et],526886);var el=e.i(964665),eu=e.i(402409);function ec(e,t){var r;return r=e&t-1,r-=r>>1&0x55555555,r=(r=(0x33333333&r)+(r>>2&0x33333333))+(r>>4)&0xf0f0f0f,r+=r>>8,127&(r+=r>>16)}let ep=(e,t)=>({value:e,previous:t});function ef(e,t,r,i){let n=i;if(!e){let e=i.length;n=Array(e);for(let t=0;t<e;++t)n[t]=i[t]}return n[t]=r,n}function ed(e,t,r){let i=r.length-1,n=0,a=0,s=r;if(e)n=a=t;else for(s=Array(i);n<t;)s[a++]=r[n++];for(++n;n<=i;)s[a++]=r[n++];return e&&(s.length=i),s}e.s(["make",0,ep],456239);class eh{_tag="EmptyNode";modify(e,t,r,i,n,a){let s=r(u.none());return u.isNone(s)?new eh:(++a.value,new ey(e,i,n,s))}}function em(e){return(0,f.isTagged)(e,"EmptyNode")}function eg(e,t){return!em(e)&&t===e.edit}class ey{edit;hash;key;value;_tag="LeafNode";constructor(e,t,r,i){this.edit=e,this.hash=t,this.key=r,this.value=i}modify(e,t,r,i,a,s){if((0,n.equals)(a,this.key)){let t=r(this.value);return t===this.value?this:u.isNone(t)?(--s.value,new eh):eg(this,e)?(this.value=t,this):new ey(e,i,a,t)}let o=r(u.none());return u.isNone(o)?this:(++s.value,eE(e,t,this.hash,this,i,new ey(e,i,a,o)))}}class eb{edit;hash;children;_tag="CollisionNode";constructor(e,t,r){this.edit=e,this.hash=t,this.children=r}modify(e,t,r,i,n,a){if(i===this.hash){let t=eg(this,e),i=this.updateCollisionList(t,e,this.hash,this.children,r,n,a);return i===this.children?this:i.length>1?new eb(e,this.hash,i):i[0]}let s=r(u.none());return u.isNone(s)?this:(++a.value,eE(e,t,this.hash,this,i,new ey(e,i,n,s)))}updateCollisionList(e,t,r,i,a,s,o){let l=i.length;for(let c=0;c<l;++c){let l=i[c];if("key"in l&&(0,n.equals)(s,l.key)){let n=l.value,p=a(n);if(p===n)return i;if(u.isNone(p))return--o.value,ed(e,c,i);return ef(e,c,new ey(t,r,s,p),i)}}let c=a(u.none());return u.isNone(c)?i:(++o.value,ef(e,l,new ey(t,r,s,c),i))}}class eS{edit;mask;children;_tag="IndexedNode";constructor(e,t,r){this.edit=e,this.mask=t,this.children=r}modify(e,t,r,i,n,a){let s,o=this.mask,l=this.children,u=i>>>t&31,c=1<<u,p=ec(o,c),f=o&c,d=eg(this,e);if(!f){let s=new eh().modify(e,t+5,r,i,n,a);return s?l.length>=16?function(e,t,r,i,n){let a=[],s=i,o=0;for(let e=0;s;++e)1&s&&(a[e]=n[o++]),s>>>=1;return a[t]=r,new ev(e,o+1,a)}(e,u,s,o,l):new eS(e,o|c,function(e,t,r,i){let n=i.length;if(e){let e=n;for(;e>=t;)i[e--]=i[e];return i[t]=r,i}let a=0,s=0,o=Array(n+1);for(;a<t;)o[s++]=i[a++];for(o[t]=r;a<n;)o[++s]=i[a++];return o}(d,p,s,l)):this}let h=l[p],m=h.modify(e,t+5,r,i,n,a);if(h===m)return this;let g=o;if(em(m)){var y;if(!(g&=~c))return new eh;if(l.length<=2&&(em(y=l[1^p])||"LeafNode"===y._tag||"CollisionNode"===y._tag))return l[1^p];s=ed(d,p,l)}else s=ef(d,p,m,l);return d?(this.mask=g,this.children=s,this):new eS(e,g,s)}}class ev{edit;size;children;_tag="ArrayNode";constructor(e,t,r){this.edit=e,this.size=t,this.children=r}modify(e,t,r,i,n,a){let s,o=this.size,l=this.children,u=i>>>t&31,c=l[u],p=(c||new eh).modify(e,t+5,r,i,n,a);if(c===p)return this;let f=eg(this,e);if(em(c)&&!em(p))++o,s=ef(f,u,p,l);else if(!em(c)&&em(p)){if(--o<=8)return function(e,t,r,i){let n=Array(t-1),a=0,s=0;for(let e=0,t=i.length;e<t;++e)if(e!==r){let t=i[e];t&&!em(t)&&(n[a++]=t,s|=1<<e)}return new eS(e,s,n)}(e,o,u,l);s=ef(f,u,new eh,l)}else s=ef(f,u,p,l);return f?(this.size=o,this.children=s,this):new ev(e,o,s)}}function eE(e,t,r,i,n,a){let s,o=t;for(;;){let t=function(e,t,r,i,n,a){if(r===n)return new eb(e,r,[a,i]);let s=r>>>t&31,o=n>>>t&31;return s===o?t=>new eS(e,1<<s|1<<o,[t]):new eS(e,1<<s|1<<o,s<o?[i,a]:[a,i])}(e,o,r,i,n,a);if("function"==typeof t)s=ep(t,s),o+=5;else{let e=t;for(;null!=s;)e=s.value(e),s=s.previous;return e}}}let ew="effect/HashMap",e_=Symbol.for(ew),ek={[e_]:e_,[Symbol.iterator](){return new eC(this,(e,t)=>[e,t])},[o.symbol](){let e=o.hash(ew);for(let t of this)e^=(0,s.pipe)(o.hash(t[0]),o.combine(o.hash(t[1])));return o.cached(this,e)},[n.symbol](e){if(eA(e)){if(e._size!==this._size)return!1;for(let t of this){let r=(0,s.pipe)(e,eP(t[0],o.hash(t[0])));if(u.isNone(r)||!n.equals(t[1],r.value))return!1}return!0}return!1},toString(){return(0,l.format)(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(l.toJSON)}},[l.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,p.pipeArguments)(this,arguments)}},ex=(e,t,r,i)=>{let n=Object.create(ek);return n._editable=e,n._edit=t,n._root=r,n._size=i,n};class eC{map;f;v;constructor(e,t){this.map=e,this.f=t,this.v=eT(this.map._root,this.f,void 0)}next(){if(u.isNone(this.v))return{done:!0,value:void 0};let e=this.v.value;return this.v=eI(e.cont),{done:!1,value:e.value}}[Symbol.iterator](){return new eC(this.map,this.f)}}let eI=e=>e?eR(e[0],e[1],e[2],e[3],e[4]):u.none(),eT=(e,t,r)=>{switch(e._tag){case"LeafNode":if(u.isSome(e.value))return u.some({value:t(e.key,e.value.value),cont:r});return eI(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let i=e.children;return eR(i.length,i,0,t,r)}default:return eI(r)}},eR=(e,t,r,i,n)=>{for(;r<e;){let a=t[r++];if(a&&!em(a))return eT(a,i,[e,t,r,i,n])}return eI(n)},eO=ex(!1,0,new eh,0),eF=()=>eO,eM=e=>{let t=eq(eF());for(let r of e)eU(t,r[0],r[1]);return e$(t)},eA=e=>(0,f.hasProperty)(e,e_),eN=s.dual(2,(e,t)=>eP(e,t,o.hash(t))),eP=s.dual(3,(e,t,r)=>{let i=e._root,a=0;for(;;)switch(i._tag){case"LeafNode":return n.equals(t,i.key)?i.value:u.none();case"CollisionNode":if(r===i.hash){let e=i.children;for(let r=0,i=e.length;r<i;++r){let i=e[r];if("key"in i&&n.equals(t,i.key))return i.value}}return u.none();case"IndexedNode":{let e=1<<(r>>>a&31);if(i.mask&e){i=i.children[ec(i.mask,e)],a+=5;break}return u.none()}case"ArrayNode":if(i=i.children[r>>>a&31]){a+=5;break}return u.none();default:return u.none()}}),eD=s.dual(2,(e,t)=>{let r=eP(e,t,o.hash(t));if(u.isNone(r))throw Error("Expected map to contain key");return r.value}),eL=s.dual(2,(e,t)=>u.isSome(eP(e,t,o.hash(t)))),eU=s.dual(3,(e,t,r)=>eH(e,t,()=>u.some(r))),ez=s.dual(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:ex(e._editable,e._edit,t,r)),ej=e=>new eC(e,e=>e),eW=e=>e._size,eq=e=>ex(!0,e._edit+1,e._root,e._size),e$=e=>(e._editable=!1,e),eB=s.dual(2,(e,t)=>{let r=eq(e);return t(r),e$(r)}),eH=s.dual(3,(e,t,r)=>eV(e,t,o.hash(t),r)),eV=s.dual(4,(e,t,r,i)=>{let n={value:e._size},a=e._root.modify(e._editable?e._edit:NaN,0,i,r,t,n);return(0,s.pipe)(e,ez(a,n.value))}),eJ=s.dual(2,(e,t)=>eH(e,t,u.none)),eG=s.dual(2,(e,t)=>eZ(e,eF(),(e,r,i)=>eU(e,i,t(r,i)))),eK=s.dual(2,(e,t)=>eZ(e,void 0,(e,r,i)=>t(r,i))),eZ=s.dual(3,(e,t,r)=>{let i,n=e._root;if("LeafNode"===n._tag)return u.isSome(n.value)?r(t,n.value.value,n.key):t;if("EmptyNode"===n._tag)return t;let a=[n.children];for(;i=a.pop();)for(let e=0,n=i.length;e<n;){let n=i[e++];n&&!em(n)&&("LeafNode"===n._tag?u.isSome(n.value)&&(t=r(t,n.value.value,n.key)):a.push(n.children))}return t}),eQ=((e,t)=>{for(let r of e)if(t(r[1],r[0]))return u.some(r);return u.none()},"effect/HashSet"),eY=Symbol.for(eQ),eX={[eY]:eY,[Symbol.iterator](){return ej(this._keyMap)},[o.symbol](){return o.cached(this,o.combine(o.hash(this._keyMap))(o.hash(eQ)))},[n.symbol](e){return!!e1(e)&&eW(this._keyMap)===eW(e._keyMap)&&n.equals(this._keyMap,e._keyMap)},toString(){return(0,l.format)(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(l.toJSON)}},[l.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,p.pipeArguments)(this,arguments)}},e0=e=>{let t=Object.create(eX);return t._keyMap=e,t},e1=e=>(0,f.hasProperty)(e,eY),e2=e0(eF()),e6=()=>e2,e3=(0,s.dual)(2,(e,t)=>eL(e._keyMap,t)),e4=(0,s.dual)(2,(e,t)=>{let r=!1;for(let i of e)if(r=t(i))break;return r}),e5=(0,s.dual)(2,(e,t)=>!e4(e,e=>!t(e))),e8=e=>e0(eq(e._keyMap)),e7=e=>(e._keyMap._editable=!1,e),e9=(0,s.dual)(2,(e,t)=>{let r=e8(e);return t(r),e7(r)}),te=(0,s.dual)(2,(e,t)=>e._keyMap._editable?(eU(t,!0)(e._keyMap),e):e0(eU(t,!0)(e._keyMap))),tt=(0,s.dual)(2,(e,t)=>e._keyMap._editable?(eJ(t)(e._keyMap),e):e0(eJ(t)(e._keyMap))),tr=(0,s.dual)(2,(e,t)=>e9(e,e=>{for(let r of t)tt(e,r)})),ti=(0,s.dual)(2,(e,t)=>e9(e6(),r=>{for(let i of(ts(e,e=>te(r,e)),t))te(r,i)})),tn=(0,s.dual)(2,(e,t)=>e9(e6(),r=>{ts(e,e=>{let i=t(e);e3(r,i)||te(r,i)})})),ta=(0,s.dual)(2,(e,t)=>e9(e6(),r=>{ts(e,e=>{for(let i of t(e))e3(r,i)||te(r,i)})})),ts=(0,s.dual)(2,(e,t)=>eK(e._keyMap,(e,r)=>t(r))),to=(0,s.dual)(3,(e,t,r)=>eZ(e._keyMap,t,(e,t,i)=>r(e,i))),tl=(...e)=>{let t=e8(e6());for(let r of e)te(t,r);return e7(t)},tu=e=>eW(e._keyMap);e.s(["add",0,te,"difference",0,tr,"empty",0,e6,"every",0,e5,"flatMap",0,ta,"forEach",0,ts,"fromIterable",0,e=>{let t=e8(e6());for(let r of e)te(t,r);return e7(t)},"has",0,e3,"isHashSet",0,e1,"make",0,tl,"map",0,tn,"reduce",0,to,"remove",0,tt,"size",0,tu,"union",0,ti],838927);var tc=e.i(965766);let tp="Empty",tf="Fail",td="Interrupt",th="Parallel",tm="Sequential",tg="effect/Cause",ty=Symbol.for(tg),tb={[ty]:{_E:e=>e},[o.symbol](){return(0,s.pipe)(o.hash(tg),o.combine(o.hash(tB(this))),o.cached(this))},[n.symbol](e){return tx(e)&&t$(this,e)},pipe(){return(0,p.pipeArguments)(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:(0,l.toJSON)(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:(0,l.toJSON)(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:(0,l.toJSON)(this.left),right:(0,l.toJSON)(this.right)}}},toString(){return t6(this)},[l.NodeInspectSymbol](){return this.toJSON()}},tS=((t=Object.create(tb))._tag=tp,t),tv=e=>{let t=Object.create(tb);return t._tag=tf,t.error=e,t},tE=e=>{let t=Object.create(tb);return t._tag="Die",t.defect=e,t},tw=e=>{let t=Object.create(tb);return t._tag=td,t.fiberId=e,t},t_=(e,t)=>{let r=Object.create(tb);return r._tag=th,r.left=e,r.right=t,r},tk=(e,t)=>{let r=Object.create(tb);return r._tag=tm,r.left=e,r.right=t,r},tx=e=>(0,f.hasProperty)(e,ty),tC=e=>u.isSome(tN(e)),tI=e=>t2(void 0,tZ)(e),tT=e=>I(t1(e,E(),(e,t)=>t._tag===tf?u.some((0,s.pipe)(e,A(t.error))):u.none())),tR=e=>I(t1(e,E(),(e,t)=>"Die"===t._tag?u.some((0,s.pipe)(e,A(t.defect))):u.none())),tO=e=>t1(e,e6(),(e,t)=>t._tag===td?u.some((0,s.pipe)(e,te(t.fiberId))):u.none()),tF=e=>tV(e,e=>e._tag===tf?u.some(e.error):u.none()),tM=e=>{let t=tF(e);switch(t._tag){case"None":return el.right(e);case"Some":return el.left(t.value)}},tA=e=>tV(e,e=>"Die"===e._tag?u.some(e.defect):u.none()),tN=e=>tV(e,e=>e._tag===td?u.some(e.fiberId):u.none()),tP=e=>t0(e,{onEmpty:u.none(),onFail:e=>u.some(tE(e)),onDie:e=>u.some(tE(e)),onInterrupt:()=>u.none(),onSequential:u.mergeWith(tk),onParallel:u.mergeWith(t_)}),tD=e=>t0(e,{onEmpty:tS,onFail:tE,onDie:tE,onInterrupt:tw,onSequential:tk,onParallel:t_}),tL=(0,s.dual)(2,(e,t)=>t0(e,{onEmpty:u.some(tS),onFail:e=>u.some(tv(e)),onDie:e=>{let r=t(e);return u.isSome(r)?u.none():u.some(tE(e))},onInterrupt:e=>u.some(tw(e)),onSequential:u.mergeWith(tk),onParallel:u.mergeWith(t_)})),tU=(0,s.dual)(2,(e,t)=>tz(e,()=>t)),tz=(0,s.dual)(2,(e,t)=>tj(e,e=>tv(t(e)))),tj=(0,s.dual)(2,(e,t)=>t0(e,{onEmpty:tS,onFail:e=>t(e),onDie:e=>tE(e),onInterrupt:e=>tw(e),onSequential:(e,t)=>tk(e,t),onParallel:(e,t)=>t_(e,t)})),tW=(0,s.dual)(2,(e,t)=>(0,f.isFunction)(t)?tj(e,t):tj(e,()=>t)),tq=(0,s.dual)(2,(e,t)=>t._tag===tp||e===t||t1(e,!1,(e,r)=>u.some(e||t$(r,t)))),t$=(e,t)=>{let r=_(e),i=_(t);for(;H(r)&&H(i);){let[e,t]=(0,s.pipe)(J(r),t1([e6(),E()],([e,t],r)=>{let[i,n]=tG(r);return u.some([(0,s.pipe)(e,ti(i)),(0,s.pipe)(t,L(n))])})),[a,o]=(0,s.pipe)(J(i),t1([e6(),E()],([e,t],r)=>{let[i,n]=tG(r);return u.some([(0,s.pipe)(e,ti(i)),(0,s.pipe)(t,L(n))])}));if(!n.equals(e,a))return!1;r=t,i=o}return!0},tB=e=>tH(_(e),E()),tH=(e,t)=>{for(;;){let[r,n]=(0,s.pipe)(e,i.reduce([e6(),E()],([e,t],r)=>{let[i,n]=tG(r);return[(0,s.pipe)(e,ti(i)),(0,s.pipe)(t,L(n))]})),a=tu(r)>0?(0,s.pipe)(t,A(r)):t;if(B(n))return I(a);e=n,t=a}throw Error((0,tc.getBugErrorMessage)("Cause.flattenCauseLoop"))},tV=(0,s.dual)(2,(e,t)=>{let r=[e];for(;r.length>0;){let e=r.pop(),i=t(e);switch(i._tag){case"None":switch(e._tag){case tm:case th:r.push(e.right),r.push(e.left)}break;case"Some":return i}}return u.none()}),tJ=(0,s.dual)(2,(e,t)=>t2(e,void 0,tQ(t))),tG=e=>{let t=e,r=[],i=e6(),n=E();for(;void 0!==t;)switch(t._tag){case tp:if(0===r.length)return[i,n];t=r.pop();break;case tf:if(i=te(i,w(t._tag,t.error)),0===r.length)return[i,n];t=r.pop();break;case"Die":if(i=te(i,w(t._tag,t.defect)),0===r.length)return[i,n];t=r.pop();break;case td:if(i=te(i,w(t._tag,t.fiberId)),0===r.length)return[i,n];t=r.pop();break;case tm:switch(t.left._tag){case tp:t=t.right;break;case tm:t=tk(t.left.left,tk(t.left.right,t.right));break;case th:t=t_(tk(t.left.left,t.right),tk(t.left.right,t.right));break;default:n=A(n,t.right),t=t.left}break;case th:r.push(t.right),t=t.left}throw Error((0,tc.getBugErrorMessage)("Cause.evaluateCauseLoop"))},tK={emptyCase:()=>0,failCase:()=>1,dieCase:()=>1,interruptCase:()=>1,sequentialCase:(e,t,r)=>t+r,parallelCase:(e,t,r)=>t+r},tZ={emptyCase:s.constTrue,failCase:s.constFalse,dieCase:s.constFalse,interruptCase:s.constTrue,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r},tQ=e=>({emptyCase:()=>tS,failCase:(e,t)=>tv(t),dieCase:(e,t)=>tE(t),interruptCase:(e,t)=>tw(t),sequentialCase:(t,r,i)=>e(r)?e(i)?tk(r,i):r:e(i)?i:tS,parallelCase:(t,r,i)=>e(r)?e(i)?t_(r,i):r:e(i)?i:tS}),tY="SequentialCase",tX="ParallelCase",t0=(0,s.dual)(2,(e,{onDie:t,onEmpty:r,onFail:i,onInterrupt:n,onParallel:a,onSequential:s})=>t2(e,void 0,{emptyCase:()=>r,failCase:(e,t)=>i(t),dieCase:(e,r)=>t(r),interruptCase:(e,t)=>n(t),sequentialCase:(e,t,r)=>s(t,r),parallelCase:(e,t,r)=>a(t,r)})),t1=(0,s.dual)(3,(e,t,r)=>{let i=t,n=e,a=[];for(;void 0!==n;){let e=r(i,n);switch(i=u.isSome(e)?e.value:i,n._tag){case tm:case th:a.push(n.right),n=n.left;break;default:n=void 0}void 0===n&&a.length>0&&(n=a.pop())}return i}),t2=(0,s.dual)(3,(e,t,r)=>{let i=[e],n=[];for(;i.length>0;){let e=i.pop();switch(e._tag){case tp:n.push(el.right(r.emptyCase(t)));break;case tf:n.push(el.right(r.failCase(t,e.error)));break;case"Die":n.push(el.right(r.dieCase(t,e.defect)));break;case td:n.push(el.right(r.interruptCase(t,e.fiberId)));break;case tm:i.push(e.right),i.push(e.left),n.push(el.left({_tag:tY}));break;case th:i.push(e.right),i.push(e.left),n.push(el.left({_tag:tX}))}}let a=[];for(;n.length>0;){let e=n.pop();switch(e._tag){case"Left":switch(e.left._tag){case tY:{let e=a.pop(),i=a.pop(),n=r.sequentialCase(t,e,i);a.push(n);break}case tX:{let e=a.pop(),i=a.pop(),n=r.parallelCase(t,e,i);a.push(n)}}break;case"Right":a.push(e.right)}}if(0===a.length)throw Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return a.pop()}),t6=(e,t)=>tI(e)?"All fibers interrupted without errors.":rt(e).map(function(e){return t?.renderErrorCause!==!0||void 0===e.cause?e.stack:`${e.stack} {
${t3(e.cause,"  ")}
}`}).join("\n"),t3=(e,t)=>{let r=e.stack.split("\n"),i=`${t}[cause]: ${r[0]}`;for(let e=1,n=r.length;e<n;e++)i+=`
${t}${r[e]}`;return e.cause&&(i+=` {
${t3(e.cause,`${t}  `)}
${t}}`),i};class t4 extends globalThis.Error{span=void 0;constructor(e){const t="object"==typeof e&&null!==e,r=Error.stackTraceLimit;Error.stackTraceLimit=1,super(t5(e),t&&"cause"in e&&void 0!==e.cause?{cause:new t4(e.cause)}:void 0),""===this.message&&(this.message="An error has occurred"),Error.stackTraceLimit=r,this.name=e instanceof Error?e.name:"Error",t&&(re in e&&(this.span=e[re]),Object.keys(e).forEach(t=>{t in this||(this[t]=e[t])})),this.stack=t9(`${this.name}: ${this.message}`,e instanceof Error&&e.stack?e.stack:"",this.span)}}let t5=e=>{if("string"==typeof e)return e;if("object"==typeof e&&null!==e&&e instanceof Error)return e.message;try{if((0,f.hasProperty)(e,"toString")&&(0,f.isFunction)(e.toString)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return(0,l.stringifyCircular)(e)},t8=/\((.*)\)/g,t7=(0,eu.globalValue)("effect/Tracer/spanToTrace",()=>new WeakMap),t9=(e,t,r)=>{let i=[e],n=t.startsWith(e)?t.slice(e.length).split("\n"):t.split("\n");for(let e=1;e<n.length;e++){if(n[e].includes(" at new BaseEffectError")||n[e].includes(" at new YieldableError")){e++;continue}if(n[e].includes("Generator.next")||n[e].includes("effect_internal_function"))break;i.push(n[e].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(r){let e=r,t=0;for(;e&&"Span"===e._tag&&t<10;){let r=t7.get(e);if("function"==typeof r){let t=r();if("string"==typeof t){let r=t.matchAll(t8),n=!1;for(let[,t]of r)n=!0,i.push(`    at ${e.name} (${t})`);n||i.push(`    at ${e.name} (${t.replace(/^at /,"")})`)}else i.push(`    at ${e.name}`)}else i.push(`    at ${e.name}`);e=u.getOrUndefined(e.parent),t++}}return i.join("\n")},re=Symbol.for("effect/SpanAnnotation"),rt=e=>t2(e,void 0,{emptyCase:()=>[],dieCase:(e,t)=>[new t4(t)],failCase:(e,t)=>[new t4(t)],interruptCase:()=>[],parallelCase:(e,t,r)=>[...t,...r],sequentialCase:(e,t,r)=>[...t,...r]});e.s(["CauseTypeId",0,ty,"andThen",0,tW,"as",0,tU,"contains",0,tq,"defects",0,tR,"die",0,tE,"dieOption",0,tA,"electFailures",0,tD,"empty",0,tS,"fail",0,tv,"failureOption",0,tF,"failureOrCause",0,tM,"failures",0,tT,"filter",0,tJ,"find",0,tV,"flatMap",0,tj,"flatten",0,e=>tj(e,s.identity),"flipCauseOption",0,e=>t0(e,{onEmpty:u.some(tS),onFail:u.map(tv),onDie:e=>u.some(tE(e)),onInterrupt:e=>u.some(tw(e)),onSequential:u.mergeWith(tk),onParallel:u.mergeWith(t_)}),"interrupt",0,tw,"interruptOption",0,tN,"interruptors",0,tO,"isCause",0,tx,"isDie",0,e=>u.isSome(tA(e)),"isDieType",0,e=>"Die"===e._tag,"isEmpty",0,e=>e._tag===tp||t1(e,!0,(e,t)=>{switch(t._tag){case tp:return u.some(e);case"Die":case tf:case td:return u.some(!1);default:return u.none()}}),"isEmptyType",0,e=>e._tag===tp,"isFailType",0,e=>e._tag===tf,"isFailure",0,e=>u.isSome(tF(e)),"isInterruptType",0,e=>e._tag===td,"isInterrupted",0,tC,"isInterruptedOnly",0,tI,"isParallelType",0,e=>e._tag===th,"isSequentialType",0,e=>e._tag===tm,"keepDefects",0,e=>t0(e,{onEmpty:u.none(),onFail:()=>u.none(),onDie:e=>u.some(tE(e)),onInterrupt:()=>u.none(),onSequential:u.mergeWith(tk),onParallel:u.mergeWith(t_)}),"keepDefectsAndElectFailures",0,tP,"linearize",0,e=>t0(e,{onEmpty:e6(),onFail:e=>tl(tv(e)),onDie:e=>tl(tE(e)),onInterrupt:e=>tl(tw(e)),onSequential:(e,t)=>ta(e,e=>tn(t,t=>tk(e,t))),onParallel:(e,t)=>ta(e,e=>tn(t,t=>t_(e,t)))}),"map",0,tz,"match",0,t0,"parallel",0,t_,"pretty",0,t6,"prettyErrorMessage",0,t5,"prettyErrors",0,rt,"reduce",0,t1,"reduceWithContext",0,t2,"sequential",0,tk,"size",0,e=>t2(e,void 0,tK),"spanSymbol",0,re,"spanToTrace",0,t7,"stripFailures",0,e=>t0(e,{onEmpty:tS,onFail:()=>tS,onDie:tE,onInterrupt:tw,onSequential:tk,onParallel:t_}),"stripSomeDefects",0,tL],129627);var rr=e.i(777865);let ri=Symbol.for("effect/Duration"),rn=BigInt(0),ra=BigInt(24),rs=BigInt(60),ro=BigInt(1e3),rl=BigInt(1e6),ru=BigInt(1e9),rc=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,rp=e=>{if(ry(e))return e;if((0,f.isNumber)(e))return rw(e);if((0,f.isBigInt)(e))return rv(e);if(Array.isArray(e)&&2===e.length&&e.every(f.isNumber))return e[0]===-1/0||e[1]===-1/0||Number.isNaN(e[0])||Number.isNaN(e[1])?rb:e[0]===1/0||e[1]===1/0?rS:rv(BigInt(Math.round(1e9*e[0]))+BigInt(Math.round(e[1])));if((0,f.isString)(e)){let t=rc.exec(e);if(t){let[e,r,i]=t,n=Number(r);switch(i){case"nano":case"nanos":return rv(BigInt(r));case"micro":case"micros":return rE(BigInt(r));case"milli":case"millis":return rw(n);case"second":case"seconds":return r_(n);case"minute":case"minutes":return rk(n);case"hour":case"hours":return rx(n);case"day":case"days":return rC(n);case"week":case"weeks":return rI(n)}}}throw Error("Invalid DurationInput")},rf=u.liftThrowable(rp),rd={_tag:"Millis",millis:0},rh={_tag:"Infinity"},rm={[ri]:ri,[o.symbol](){return o.cached(this,o.structure(this.value))},[n.symbol](e){return ry(e)&&r$(this,e)},toString(){return`Duration(${rB(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:rR(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[l.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,p.pipeArguments)(this,arguments)}},rg=e=>{let t=Object.create(rm);return(0,f.isNumber)(e)?isNaN(e)||e<=0?t.value=rd:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(1e6*e))}:t.value=rh:e<=rn?t.value=rd:t.value={_tag:"Nanos",nanos:e},t},ry=e=>(0,f.hasProperty)(e,ri),rb=rg(0),rS=rg(1/0),rv=e=>rg(e),rE=e=>rg(e*ro),rw=e=>rg(e),r_=e=>rg(1e3*e),rk=e=>rg(6e4*e),rx=e=>rg(36e5*e),rC=e=>rg(864e5*e),rI=e=>rg(6048e5*e),rT=e=>rO(e,{onMillis:e=>e,onNanos:e=>Number(e)/1e6}),rR=e=>{let t=rp(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/ru),Number(t.value.nanos%ru)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},rO=(0,s.dual)(2,(e,t)=>{let r=rp(e);switch(r.value._tag){case"Nanos":return t.onNanos(r.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(r.value.millis)}}),rF=(0,s.dual)(3,(e,t,r)=>{let i=rp(e),n=rp(t);if("Infinity"===i.value._tag||"Infinity"===n.value._tag)return r.onMillis(rT(i),rT(n));if("Nanos"===i.value._tag||"Nanos"===n.value._tag){let e="Nanos"===i.value._tag?i.value.nanos:BigInt(Math.round(1e6*i.value.millis)),t="Nanos"===n.value._tag?n.value.nanos:BigInt(Math.round(1e6*n.value.millis));return r.onNanos(e,t)}return r.onMillis(i.value.millis,n.value.millis)}),rM=c.make((e,t)=>rF(e,t,{onMillis:(e,t)=>e<t?-1:+(e>t),onNanos:(e,t)=>e<t?-1:+(e>t)})),rA=c.between(c.mapInput(rM,rp)),rN=(e,t)=>rF(e,t,{onMillis:(e,t)=>e===t,onNanos:(e,t)=>e===t}),rP=c.clamp(rM),rD=(0,s.dual)(2,(e,t)=>rP(rp(e),{minimum:rp(t.minimum),maximum:rp(t.maximum)})),rL=(0,s.dual)(2,(e,t)=>rO(e,{onMillis:e=>rg(e*t),onNanos:e=>rg(e*BigInt(t))})),rU=(0,s.dual)(2,(e,t)=>rF(e,t,{onMillis:(e,t)=>rg(e+t),onNanos:(e,t)=>rg(e+t)})),rz=(0,s.dual)(2,(e,t)=>rF(e,t,{onMillis:(e,t)=>e<t,onNanos:(e,t)=>e<t})),rj=(0,s.dual)(2,(e,t)=>rF(e,t,{onMillis:(e,t)=>e<=t,onNanos:(e,t)=>e<=t})),rW=(0,s.dual)(2,(e,t)=>rF(e,t,{onMillis:(e,t)=>e>t,onNanos:(e,t)=>e>t})),rq=(0,s.dual)(2,(e,t)=>rF(e,t,{onMillis:(e,t)=>e>=t,onNanos:(e,t)=>e>=t})),r$=(0,s.dual)(2,(e,t)=>rN(rp(e),rp(t))),rB=e=>{let t=rp(e);if("Infinity"===t.value._tag)return"Infinity";if((e=>{switch(e.value._tag){case"Millis":return 0===e.value.millis;case"Nanos":return e.value.nanos===rn;case"Infinity":return!1}})(t))return"0";let r=(e=>{let t=rp(e);if("Infinity"===t.value._tag)return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};let r=(e=>{let t=rp(e);switch(t.value._tag){case"Infinity":throw Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(1e6*t.value.millis))}})(t),i=r/rl,n=i/ro,a=n/rs,s=a/rs;return{days:Number(s/ra),hours:Number(s%ra),minutes:Number(a%rs),seconds:Number(n%rs),millis:Number(i%ro),nanos:Number(r%rl)}})(t),i=[];return 0!==r.days&&i.push(`${r.days}d`),0!==r.hours&&i.push(`${r.hours}h`),0!==r.minutes&&i.push(`${r.minutes}m`),0!==r.seconds&&i.push(`${r.seconds}s`),0!==r.millis&&i.push(`${r.millis}ms`),0!==r.nanos&&i.push(`${r.nanos}ns`),i.join(" ")};e.s(["Equivalence",0,rN,"between",0,rA,"clamp",0,rD,"decode",0,rp,"decodeUnknown",0,rf,"format",0,rB,"greaterThan",0,rW,"greaterThanOrEqualTo",0,rq,"infinity",0,rS,"isDuration",0,ry,"isFinite",0,e=>"Infinity"!==e.value._tag,"lessThan",0,rz,"lessThanOrEqualTo",0,rj,"millis",0,rw,"nanos",0,rv,"seconds",0,r_,"sum",0,rU,"times",0,rL,"toMillis",0,rT,"toNanos",0,e=>{let t=rp(e);switch(t.value._tag){case"Infinity":return u.none();case"Nanos":return u.some(t.value.nanos);case"Millis":return u.some(BigInt(Math.round(1e6*t.value.millis)))}},"toSeconds",0,e=>rO(e,{onMillis:e=>e/1e3,onNanos:e=>Number(e)/1e9}),"zero",0,rb],649488);let rH=Symbol.for("effect/MutableRef"),rV={[rH]:rH,toString(){return(0,l.format)(this.toJSON())},toJSON(){return{_id:"MutableRef",current:(0,l.toJSON)(this.current)}},[l.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,p.pipeArguments)(this,arguments)}},rJ=e=>{let t=Object.create(rV);return t.current=e,t},rG=s.dual(3,(e,t,r)=>!!n.equals(t,e.current)&&(e.current=r,!0)),rK=e=>e.current,rZ=((e,t)=>{let r=e.current;return e.current=t,r},s.dual(2,(e,t)=>(e.current=t,e)));(e,t)=>(e.current=t,e.current),e.s(["compareAndSet",0,rG,"get",0,rK,"make",0,rJ,"set",0,rZ],727606);let rQ="effect/FiberId",rY=Symbol.for(rQ),rX="None",r0="Runtime",r1="Composite",r2=o.string(`${rQ}-${rX}`);class r6{[rY]=rY;_tag=rX;id=-1;startTimeMillis=-1;[o.symbol](){return r2}[n.symbol](e){return r9(e)&&e._tag===rX}toString(){return(0,l.format)(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[l.NodeInspectSymbol](){return this.toJSON()}}class r3{id;startTimeMillis;[rY]=rY;_tag=r0;constructor(e,t){this.id=e,this.startTimeMillis=t}[o.symbol](){return o.cached(this,o.string(`${rQ}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[n.symbol](e){return r9(e)&&e._tag===r0&&this.id===e.id&&this.startTimeMillis===e.startTimeMillis}toString(){return(0,l.format)(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[l.NodeInspectSymbol](){return this.toJSON()}}class r4{left;right;[rY]=rY;_tag=r1;constructor(e,t){this.left=e,this.right=t}_hash;[o.symbol](){return(0,s.pipe)(o.string(`${rQ}-${this._tag}`),o.combine(o.hash(this.left)),o.combine(o.hash(this.right)),o.cached(this))}[n.symbol](e){return r9(e)&&e._tag===r1&&n.equals(this.left,e.left)&&n.equals(this.right,e.right)}toString(){return(0,l.format)(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:(0,l.toJSON)(this.left),right:(0,l.toJSON)(this.right)}}[l.NodeInspectSymbol](){return this.toJSON()}}let r5=new r6,r8=(e,t)=>new r3(e,t),r7=(e,t)=>new r4(e,t),r9=e=>(0,f.hasProperty)(e,rY),ie=e=>e._tag===rX||(0,s.pipe)(iu(e),e5(e=>ie(e))),it=(0,s.dual)(2,(e,t)=>e._tag===rX?t:t._tag===rX?e:new r4(e,t)),ir=e=>(0,s.pipe)(e,to(r5,(e,t)=>it(t)(e))),ii=(0,s.dual)(2,(e,t)=>ie(e)?t:e),ia=e=>{switch(e._tag){case rX:return e6();case r0:return tl(e.id);case r1:return(0,s.pipe)(ia(e.left),ti(ia(e.right)))}},is=(0,eu.globalValue)(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>rJ(0)),io=(e,t)=>new r3(e,t),il=e=>Array.from(ia(e)).map(e=>`#${e}`).join(","),iu=e=>{switch(e._tag){case rX:return e6();case r0:return tl(e);case r1:return(0,s.pipe)(iu(e.left),ti(iu(e.right)))}},ic=()=>{let e=rK(is);return(0,s.pipe)(is,rZ(e+1)),new r3(e,Date.now())};e.s(["FiberIdTypeId",0,rY,"combine",0,it,"combineAll",0,ir,"composite",0,r7,"getOrElse",0,ii,"ids",0,ia,"isComposite",0,e=>e._tag===r1,"isFiberId",0,r9,"isNone",0,ie,"isRuntime",0,e=>e._tag===r0,"make",0,io,"none",0,r5,"runtime",0,r8,"threadName",0,il,"toOption",0,e=>{let t,r=iu(e);if(0===tu(r))return u.none();let i=!0;for(let e of r)i?(t=e,i=!1):t=(0,s.pipe)(t,it(e));return u.some(t)},"toSet",0,iu,"unsafeMake",0,ic],720369);let ip=r5;e.s(["combine",0,it,"combineAll",0,ir,"composite",0,r7,"getOrElse",0,ii,"ids",0,ia,"isFiberId",0,r9,"make",0,io,"none",0,ip,"runtime",0,r8,"threadName",0,il,"unsafeMake",0,ic],500577);let id=e=>e&&em(e._root);e.s(["empty",0,eF,"forEach",0,eK,"fromIterable",0,eM,"get",0,eN,"has",0,eL,"isEmpty",0,id,"isHashMap",0,eA,"keys",0,ej,"make",0,(...e)=>eM(e),"map",0,eG,"modifyAt",0,eH,"mutate",0,eB,"reduce",0,eZ,"remove",0,eJ,"set",0,eU,"size",0,eW,"unsafeGet",0,eD],214250);let ih=Symbol.for("effect/List"),im=e=>i.fromIterable(e),ig=(r=n.equals,a.mapInput(i.getEquivalence(r),im)),iy={[ih]:ih,_tag:"Cons",toString(){return(0,l.format)(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:im(this).map(l.toJSON)}},[l.NodeInspectSymbol](){return this.toJSON()},[n.symbol](e){return iE(e)&&this._tag===e._tag&&ig(this,e)},[o.symbol](){return o.cached(this,o.array(im(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if("Nil"===t._tag)return e=!0,this.return();let r=t.head;return t=t.tail,{done:e,value:r}},return:t=>(e||(e=!0),{done:!0,value:t})}},pipe(){return(0,p.pipeArguments)(this,arguments)}},ib=(e,t)=>{let r=Object.create(iy);return r.head=e,r.tail=t,r},iS=o.string("Nil"),iv=Object.create({[ih]:ih,_tag:"Nil",toString(){return(0,l.format)(this.toJSON())},toJSON:()=>({_id:"List",_tag:"Nil"}),[l.NodeInspectSymbol](){return this.toJSON()},[o.symbol]:()=>iS,[n.symbol](e){return iE(e)&&this._tag===e._tag},[Symbol.iterator]:()=>({next:()=>({done:!0,value:void 0})}),pipe(){return(0,p.pipeArguments)(this,arguments)}}),iE=e=>(0,f.hasProperty)(e,ih),iw=e=>"Nil"===e._tag,i_=e=>"Cons"===e._tag,ik=e=>{let t=e,r=0;for(;!iw(t);)r+=1,t=t.tail;return r},ix=(e,t)=>ib(e,t),iC=()=>iv,iI=e=>ib(e,iv),iT=e=>{let t,r=e[Symbol.iterator]();if(!(t=r.next())||t.done)return iv;{let e=ib(t.value,iv),i=e;for(;(t=r.next())&&!t.done;){let e=ib(t.value,iv);i.tail=e,i=e}return e}},iR=(0,s.dual)(2,(e,t)=>iF(t,e)),iO=(0,s.dual)(2,(e,t)=>ix(t,e)),iF=(0,s.dual)(2,(e,t)=>{if(iw(e))return t;{if(iw(t))return e;let r=ib(t.head,e),i=r,n=t.tail;for(;!iw(n);){let t=ib(n.head,e);i.tail=t,i=t,n=n.tail}return r}}),iM=((e,t)=>{if(t<=0)return e;if(t>=ik(e))return iv;let r=e,i=0;for(;!iw(r)&&i<t;)r=r.tail,i+=1;return r},(e,t,r,i)=>{for(;;)if(iw(t))return e;else{if(r(t.head)===i)return iA(e,t,r,i);t=t.tail}}),iA=(e,t,r,i)=>{let n=ib(iL(e),iv),a=iU(e),o=n;for(;a!==t;){let e=ib(iL(a),iv);o.tail=e,o=(0,s.unsafeCoerce)(e),a=(0,s.unsafeCoerce)(a.tail)}let l=t.tail,u=(0,s.unsafeCoerce)(l);for(;!iw(l);)if(r(iL(l))!==i)l=l.tail;else{for(;u!==l;){let e=ib(iL(u),iv);o.tail=e,o=e,u=(0,s.unsafeCoerce)(u.tail)}u=(0,s.unsafeCoerce)(l.tail),l=l.tail}return iw(u)||(o.tail=u),n},iN=(0,s.dual)(3,(e,t,r)=>{let i=t,n=e;for(;!iw(n);)i=r(i,n.head),n=n.tail;return i}),iP=e=>{let t=iC(),r=e;for(;!iw(r);)t=iO(t,r.head),r=r.tail;return t},iD=((e,t)=>{if(t<=0)return iv;if(t>=ik(e))return e;let r=((...e)=>iT(e))(iL(e)),i=iU(e);for(let e=1;e<t;e++)r=ib(iL(i),r),i=iU(i);return iP(r)},"Expected List to be non-empty"),iL=e=>{if(iw(e))throw Error(iD);return e.head},iU=e=>{if(iw(e))throw Error(iD);return e.tail};e.s(["appendAll",0,iR,"cons",0,ix,"empty",0,iC,"fromIterable",0,iT,"isCons",0,i_,"isList",0,iE,"isNil",0,iw,"of",0,iI,"prepend",0,iO,"reduce",0,iN,"reverse",0,iP,"unsafeHead",0,iL,"unsafeTail",0,iU],807816);var iz=e.i(874995);let ij=Object.assign(Object.create(Array.prototype),{[o.symbol](){return o.cached(this,o.array(this))},[n.symbol](e){return!!Array.isArray(e)&&this.length===e.length&&this.every((t,r)=>n.equals(t,e[r]))}}),iW=function(){function e(e){e&&Object.assign(this,e)}return e.prototype=iz.StructuralPrototype,e}();e.s(["ArrayProto",0,ij,"Structural",0,iW,"struct",0,e=>Object.assign(Object.create(iz.StructuralPrototype),e)],260082);let iq=Symbol.for("effect/DifferChunkPatch");function i$(e){return e}let iB={...iW.prototype,[iq]:{_Value:i$,_Patch:i$}},iH=Object.create(Object.assign(Object.create(iB),{_tag:"Empty"})),iV=()=>iH,iJ=Object.assign(Object.create(iB),{_tag:"AndThen"}),iG=Object.assign(Object.create(iB),{_tag:"Append"}),iK=Object.assign(Object.create(iB),{_tag:"Slice"}),iZ=Object.assign(Object.create(iB),{_tag:"Update"}),iQ=(e,t)=>{let r=Object.create(iZ);return r.index=e,r.patch=t,r},iY=e=>{var t,r;let i,a,o=0,l=iV();for(;o<e.oldValue.length&&o<e.newValue.length;){let t=F(o)(e.oldValue),r=F(o)(e.newValue),i=e.differ.diff(t,r);n.equals(i,e.differ.empty)||(l=(0,s.pipe)(l,iX(iQ(o,i)))),o+=1}return o<e.oldValue.length&&(l=(0,s.pipe)(l,iX((t=o,(i=Object.create(iK)).from=0,i.until=t,i)))),o<e.newValue.length&&(l=(0,s.pipe)(l,iX((r=P(o)(e.newValue),(a=Object.create(iG)).values=r,a)))),l},iX=s.dual(2,(e,t)=>{let r;return(r=Object.create(iJ)).first=e,r.second=t,r}),i0=s.dual(3,(e,t,r)=>{if("Empty"===e._tag)return t;let i=t,n=_(e);for(;H(n);){let e=J(n),t=Y(n);switch(e._tag){case"Empty":n=t;break;case"AndThen":n=A(e.first)(A(e.second)(t));break;case"Append":i=L(e.values)(i),n=t;break;case"Slice":i=R(C(i).slice(e.from,e.until)),n=t;break;case"Update":{let a=C(i);a[e.index]=r.patch(e.patch,a[e.index]),i=R(a),n=t}}}return i});e.s(["ChunkPatchTypeId",0,iq,"combine",0,iX,"diff",0,iY,"empty",0,iV,"patch",0,i0],997617);var i1=e.i(327184);let i2=Symbol.for("effect/DifferContextPatch");function i6(e){return e}let i3={...iW.prototype,[i2]:{_Value:i6,_Patch:i6}},i4=Object.create(Object.assign(Object.create(i3),{_tag:"Empty"})),i5=()=>i4,i8=Object.assign(Object.create(i3),{_tag:"AndThen"}),i7=Object.assign(Object.create(i3),{_tag:"AddService"}),i9=(e,t)=>{let r=Object.create(i7);return r.key=e,r.service=t,r},ne=Object.assign(Object.create(i3),{_tag:"RemoveService"}),nt=e=>{let t=Object.create(ne);return t.key=e,t},nr=Object.assign(Object.create(i3),{_tag:"UpdateService"}),ni=(e,t)=>{let r=Object.create(nr);return r.key=e,r.update=t,r},nn=(e,t)=>{let r=new Map(e.unsafeMap),i=i5();for(let[e,a]of t.unsafeMap.entries())if(r.has(e)){let t=r.get(e);r.delete(e),n.equals(t,a)||(i=na(ni(e,()=>a))(i))}else r.delete(e),i=na(i9(e,a))(i);for(let[e]of r.entries())i=na(nt(e))(i);return i},na=s.dual(2,(e,t)=>{let r;return(r=Object.create(i8)).first=e,r.second=t,r}),ns=s.dual(2,(e,t)=>{if("Empty"===e._tag)return t;let r=!1,i=_(e),n=new Map(t.unsafeMap);for(;H(i);){let e=J(i),t=Y(i);switch(e._tag){case"Empty":i=t;break;case"AddService":n.set(e.key,e.service),i=t;break;case"AndThen":i=A(A(t,e.second),e.first);break;case"RemoveService":n.delete(e.key),i=t;break;case"UpdateService":n.set(e.key,e.update(n.get(e.key))),r=!0,i=t}}if(!r)return(0,i1.makeContext)(n);let a=new Map;for(let[e]of t.unsafeMap)n.has(e)&&(a.set(e,n.get(e)),n.delete(e));for(let[e,t]of n)a.set(e,t);return(0,i1.makeContext)(a)});e.s(["ContextPatchTypeId",0,i2,"combine",0,na,"diff",0,nn,"empty",0,i5,"patch",0,ns],679986);let no=Symbol.for("effect/DifferHashMapPatch");function nl(e){return e}let nu={...iW.prototype,[no]:{_Value:nl,_Key:nl,_Patch:nl}},nc=Object.create(Object.assign(Object.create(nu),{_tag:"Empty"})),np=()=>nc,nf=Object.assign(Object.create(nu),{_tag:"AndThen"}),nd=Object.assign(Object.create(nu),{_tag:"Add"}),nh=Object.assign(Object.create(nu),{_tag:"Remove"}),nm=Object.assign(Object.create(nu),{_tag:"Update"}),ng=e=>{let[t,r]=eZ([e.oldValue,np()],([t,r],i,a)=>{let s=eN(a)(t);switch(s._tag){case"Some":{let o,l=e.differ.diff(s.value,i);if(n.equals(l,e.differ.empty))return[eJ(a)(t),r];return[eJ(a)(t),ny(((o=Object.create(nm)).key=a,o.patch=l,o))(r)]}case"None":let o;return[t,ny(((o=Object.create(nd)).key=a,o.value=i,o))(r)]}})(e.newValue);return eZ(r,(e,t,r)=>{let i;return ny(((i=Object.create(nh)).key=r,i))(e)})(t)},ny=s.dual(2,(e,t)=>{let r;return(r=Object.create(nf)).first=e,r.second=t,r}),nb=s.dual(3,(e,t,r)=>{if("Empty"===e._tag)return t;let i=t,n=_(e);for(;H(n);){let e=J(n),t=Y(n);switch(e._tag){case"Empty":n=t;break;case"AndThen":n=A(e.first)(A(e.second)(t));break;case"Add":i=eU(e.key,e.value)(i),n=t;break;case"Remove":i=eJ(e.key)(i),n=t;break;case"Update":{let a=eN(e.key)(i);"Some"===a._tag&&(i=eU(e.key,r.patch(e.patch,a.value))(i)),n=t}}}return i});e.s(["HashMapPatchTypeId",0,no,"combine",0,ny,"diff",0,ng,"empty",0,np,"patch",0,nb],57105);let nS=Symbol.for("effect/DifferHashSetPatch");function nv(e){return e}let nE={...iW.prototype,[nS]:{_Value:nv,_Key:nv,_Patch:nv}},nw=Object.create(Object.assign(Object.create(nE),{_tag:"Empty"})),n_=()=>nw,nk=Object.assign(Object.create(nE),{_tag:"AndThen"}),nx=Object.assign(Object.create(nE),{_tag:"Add"}),nC=Object.assign(Object.create(nE),{_tag:"Remove"}),nI=(e,t)=>{let[r,i]=to([e,n_()],([e,t],r)=>{let i;return e3(r)(e)?[tt(r)(e),t]:[e,nT(((i=Object.create(nx)).value=r,i))(t)]})(t);return to(i,(e,t)=>{let r;return nT(((r=Object.create(nC)).value=t,r))(e)})(r)},nT=s.dual(2,(e,t)=>{let r;return(r=Object.create(nk)).first=e,r.second=t,r}),nR=s.dual(2,(e,t)=>{if("Empty"===e._tag)return t;let r=t,i=_(e);for(;H(i);){let e=J(i),t=Y(i);switch(e._tag){case"Empty":i=t;break;case"AndThen":i=A(e.first)(A(e.second)(t));break;case"Add":r=te(e.value)(r),i=t;break;case"Remove":r=tt(e.value)(r),i=t}}return r});e.s(["HashSetPatchTypeId",0,nS,"combine",0,nT,"diff",0,nI,"empty",0,n_,"patch",0,nR],890115);let nO=Symbol.for("effect/DifferOrPatch");function nF(e){return e}let nM={...iW.prototype,[nO]:{_Value:nF,_Key:nF,_Patch:nF}},nA=Object.create(Object.assign(Object.create(nM),{_tag:"Empty"})),nN=()=>nA,nP=Object.assign(Object.create(nM),{_tag:"AndThen"}),nD=Object.assign(Object.create(nM),{_tag:"SetLeft"}),nL=Object.assign(Object.create(nM),{_tag:"SetRight"}),nU=Object.assign(Object.create(nM),{_tag:"UpdateLeft"}),nz=Object.assign(Object.create(nM),{_tag:"UpdateRight"}),nj=e=>{var t,r;switch(e.oldValue._tag){case"Left":switch(e.newValue._tag){case"Left":{let t,r=e.left.diff(e.oldValue.left,e.newValue.left);if(n.equals(r,e.left.empty))return nN();return(t=Object.create(nU)).patch=r,t}case"Right":let i;return t=e.newValue.right,(i=Object.create(nL)).value=t,i}case"Right":switch(e.newValue._tag){case"Left":let a;return r=e.newValue.left,(a=Object.create(nD)).value=r,a;case"Right":{let t,r=e.right.diff(e.oldValue.right,e.newValue.right);if(n.equals(r,e.right.empty))return nN();return(t=Object.create(nz)).patch=r,t}}}},nW=s.dual(2,(e,t)=>{let r;return(r=Object.create(nP)).first=e,r.second=t,r}),nq=s.dual(2,(e,{left:t,oldValue:r,right:i})=>{if("Empty"===e._tag)return r;let n=_(e),a=r;for(;H(n);){let e=J(n),r=Y(n);switch(e._tag){case"Empty":n=r;break;case"AndThen":n=A(e.first)(A(e.second)(r));break;case"UpdateLeft":"Left"===a._tag&&(a=el.left(t.patch(e.patch,a.left))),n=r;break;case"UpdateRight":"Right"===a._tag&&(a=el.right(i.patch(e.patch,a.right))),n=r;break;case"SetLeft":a=el.left(e.value),n=r;break;case"SetRight":a=el.right(e.value),n=r}}return a});e.s(["OrPatchTypeId",0,nO,"combine",0,nW,"diff",0,nj,"empty",0,nN,"patch",0,nq],968484);let n$=Symbol.for("effect/DifferReadonlyArrayPatch");function nB(e){return e}let nH={...iW.prototype,[n$]:{_Value:nB,_Patch:nB}},nV=Object.create(Object.assign(Object.create(nH),{_tag:"Empty"})),nJ=()=>nV,nG=Object.assign(Object.create(nH),{_tag:"AndThen"}),nK=Object.assign(Object.create(nH),{_tag:"Append"}),nZ=Object.assign(Object.create(nH),{_tag:"Slice"}),nQ=Object.assign(Object.create(nH),{_tag:"Update"}),nY=(e,t)=>{let r=Object.create(nQ);return r.index=e,r.patch=t,r},nX=e=>{var t,r;let a,s,o=0,l=nJ();for(;o<e.oldValue.length&&o<e.newValue.length;){let t=e.oldValue[o],r=e.newValue[o],i=e.differ.diff(t,r);n.equals(i,e.differ.empty)||(l=n0(l,nY(o,i))),o+=1}return o<e.oldValue.length&&(l=n0(l,(t=o,(a=Object.create(nZ)).from=0,a.until=t,a))),o<e.newValue.length&&(l=n0(l,(r=i.drop(o)(e.newValue),(s=Object.create(nK)).values=r,s))),l},n0=s.dual(2,(e,t)=>{let r;return(r=Object.create(nG)).first=e,r.second=t,r}),n1=s.dual(3,(e,t,r)=>{if("Empty"===e._tag)return t;let n=t.slice(),a=i.of(e);for(;i.isNonEmptyArray(a);){let e=i.headNonEmpty(a),t=i.tailNonEmpty(a);switch(e._tag){case"Empty":a=t;break;case"AndThen":t.unshift(e.first,e.second),a=t;break;case"Append":for(let t of e.values)n.push(t);a=t;break;case"Slice":n=n.slice(e.from,e.until),a=t;break;case"Update":n[e.index]=r.patch(e.patch,n[e.index]),a=t}}return n});e.s(["ReadonlyArrayPatchTypeId",0,n$,"combine",0,n0,"diff",0,nX,"empty",0,nJ,"patch",0,n1],587212);let n2=Symbol.for("effect/Differ"),n6={[n2]:{_P:s.identity,_V:s.identity},pipe(){return(0,p.pipeArguments)(this,arguments)}},n3=e=>{let t=Object.create(n6);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},n4=()=>n3({empty:i5(),combine:(e,t)=>na(t)(e),diff:(e,t)=>nn(e,t),patch:(e,t)=>ns(t)(e)}),n5=()=>n3({empty:n_(),combine:(e,t)=>nT(t)(e),diff:(e,t)=>nI(e,t),patch:(e,t)=>nR(t)(e)}),n8=s.dual(2,(e,t)=>n3({empty:nN(),combine:(e,t)=>nW(e,t),diff:(r,i)=>nj({oldValue:r,newValue:i,left:e,right:t}),patch:(r,i)=>nq(r,{oldValue:i,left:e,right:t})})),n7=e=>n3({empty:nJ(),combine:(e,t)=>n0(e,t),diff:(t,r)=>nX({oldValue:t,newValue:r,differ:e}),patch:(t,r)=>n1(t,r,e)}),n9=s.dual(2,(e,{toNew:t,toOld:r})=>n3({empty:e.empty,combine:(t,r)=>e.combine(t,r),diff:(t,i)=>e.diff(r(t),r(i)),patch:(i,n)=>t(e.patch(i,r(n)))})),ae=()=>at((e,t)=>t),at=e=>n3({empty:s.identity,combine:(e,t)=>e===s.identity?t:t===s.identity?e:r=>t(e(r)),diff:(e,t)=>n.equals(e,t)?s.identity:(0,s.constant)(t),patch:(t,r)=>e(r,t(r))}),ar=s.dual(2,(e,t)=>n3({empty:[e.empty,t.empty],combine:(r,i)=>[e.combine(r[0],i[0]),t.combine(r[1],i[1])],diff:(r,i)=>[e.diff(r[0],i[0]),t.diff(r[1],i[1])],patch:(r,i)=>[e.patch(r[0],i[0]),t.patch(r[1],i[1])]}));e.s(["DifferTypeId",0,n2,"chunk",0,e=>n3({empty:iV(),combine:(e,t)=>iX(t)(e),diff:(t,r)=>iY({oldValue:t,newValue:r,differ:e}),patch:(t,r)=>i0(r,e)(t)}),"environment",0,n4,"hashMap",0,e=>n3({empty:np(),combine:(e,t)=>ny(t)(e),diff:(t,r)=>ng({oldValue:t,newValue:r,differ:e}),patch:(t,r)=>nb(r,e)(t)}),"hashSet",0,n5,"make",0,n3,"orElseEither",0,n8,"readonlyArray",0,n7,"transform",0,n9,"update",0,ae,"updateWith",0,at,"zip",0,ar],472167);let ai=e=>255&e,an=e=>e>>8&255,aa=(e,t)=>(255&e)+((t&e&255)<<8),as=aa(0,0),ao=e=>aa(e,e),al=e=>aa(e,0),au=(0,s.dual)(2,(e,t)=>(ai(e)&t)!=0),ac=(0,s.dual)(2,(e,t)=>(an(e)&t)!=0),ap=(0,s.dual)(2,(e,t)=>(ai(e)&t)!=0&&(an(e)&t)==0),af=(0,s.dual)(2,(e,t)=>aa(ai(e)&~t,an(e))),ad=(0,s.dual)(2,(e,t)=>aa(ai(e)|ai(t),an(e)&an(t))),ah=(0,s.dual)(2,(e,t)=>aa(ai(e)|ai(t),an(e)|an(t))),am=(0,s.dual)(2,(e,t)=>e|t),ag=e=>~e>>>0&255;e.s(["active",0,ai,"andThen",0,am,"both",0,ad,"disable",0,al,"either",0,ah,"empty",0,as,"enable",0,ao,"enabled",0,an,"exclude",0,af,"inverse",0,e=>aa(an(e),ag(ai(e))),"invert",0,ag,"isActive",0,au,"isDisabled",0,ap,"isEmpty",0,e=>0===e,"isEnabled",0,ac,"make",0,aa],389668);let ay=[0,1,2,4,16,32],ab=e=>{switch(e){case 32:return"CooperativeYielding";case 16:return"WindDown";case 4:return"RuntimeMetrics";case 2:return"OpSupervision";case 1:return"Interruption";case 0:return"None"}},aS=(0,s.dual)(2,(e,t)=>e&~t),av=(0,s.dual)(2,(e,t)=>e|t),aE=e=>aw(e,1),aw=(0,s.dual)(2,(e,t)=>(e&t)!=0),a_=(...e)=>e.reduce((e,t)=>e|t,0),ak=a_(0),ax=e=>new Set(ay.filter(t=>aw(e,t))),aC=e=>ax(ai(e)&an(e)),aI=e=>ax(ai(e)&~an(e)),aT=(0,s.dual)(2,(e,t)=>aa(e^t,t)),aR=(0,s.dual)(2,(e,t)=>e&(ag(ai(t))|an(t))|ai(t)&an(t)),aO=n3({empty:as,diff:(e,t)=>aT(e,t),combine:(e,t)=>am(t)(e),patch:(e,t)=>aR(t,e)});e.s(["CooperativeYielding",0,32,"Interruption",0,1,"OpSupervision",0,2,"RuntimeMetrics",0,4,"WindDown",0,16,"cooperativeYielding",0,e=>aw(e,32),"diff",0,aT,"differ",0,aO,"disable",0,aS,"disabledSet",0,aI,"enable",0,av,"enabledSet",0,aC,"interruptible",0,e=>aE(e)&&!aw(e,16),"interruption",0,aE,"make",0,a_,"none",0,ak,"patch",0,aR,"renderPatch",0,e=>{let t=Array.from(aC(e)).map(e=>ab(e)).join(", "),r=Array.from(aI(e)).map(e=>ab(e)).join(", ");return`RuntimeFlagsPatch(enabled = (${t}), disabled = (${r}))`},"runtimeMetrics",0,e=>aw(e,4)],399683),e.s(["disable",0,al,"empty",0,as,"enable",0,ao,"exclude",0,af],248726);var aF=e.i(686434);let aM=(e,t)=>({_tag:"Par",left:e,right:t}),aA=(e,t)=>({_tag:"Seq",left:e,right:t}),aN=e=>{let t=e,r=aq(),i=iC(),n=iC();for(;;)switch(t._tag){case"Empty":if(iw(i))return[r,n];t=i.head,i=i.tail;break;case"Par":i=ix(t.right,i),t=t.left;break;case"Seq":{let e=t.left,r=t.right;switch(e._tag){case"Empty":t=r;break;case"Par":{let i=e.left,n=e.right;t=aM(aA(i,r),aA(n,r));break}case"Seq":t=aA(e.left,aA(e.right,r));break;case"Single":t=e,n=ix(r,n)}break}case"Single":if(r=a$(r,t),iw(i))return[r,n];t=i.head,i=i.tail}throw Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},aP=(e,t)=>{if(iw(e))return iI(aJ(t));if(aH(t))return e;let r=aX(e.head),i=aV(t);return 1===r.length&&1===i.length&&n.equals(r[0],i[0])?ix(aY(e.head,aJ(t)),e.tail):ix(aJ(t),e)},aD=Symbol.for("effect/RequestBlock/Entry");class aL{request;result;listeners;ownerId;state;[aD]=aU;constructor(e,t,r,i,n){this.request=e,this.result=t,this.listeners=r,this.ownerId=i,this.state=n}}let aU={_R:e=>e},az=Symbol.for("effect/RequestBlock/RequestBlockParallel"),aj={_R:e=>e};class aW{map;[az]=aj;constructor(e){this.map=e}}let aq=()=>new aW(eF()),a$=(e,t)=>new aW(eH(e.map,t.dataSource,e=>u.orElseSome(u.map(e,M(t.blockedRequest)),()=>_(t.blockedRequest)))),aB=(e,t)=>new aW(eZ(e.map,t.map,(e,t,r)=>eU(e,r,u.match(eN(e,r),{onNone:()=>t,onSome:e=>L(t,e)})))),aH=e=>id(e.map),aV=e=>Array.from(ej(e.map)),aJ=e=>aQ(eG(e.map,e=>_(e))),aG=Symbol.for("effect/RequestBlock/RequestBlockSequential"),aK={_R:e=>e};class aZ{map;[aG]=aK;constructor(e){this.map=e}}let aQ=e=>new aZ(e),aY=(e,t)=>new aZ(eZ(t.map,e.map,(e,t,r)=>eU(e,r,u.match(eN(e,r),{onNone:()=>E(),onSome:e=>L(e,t)})))),aX=e=>Array.from(ej(e.map));e.s(["empty",0,{_tag:"Empty"},"flatten",0,e=>{let t=iI(e),r=iC();for(;;){let[e,i]=iN(t,[aq(),iC()],([e,t],r)=>{let[i,n]=aN(r);return[aB(e,i),iR(t,n)]});if(r=aP(r,e),iw(i))return iP(r);t=i}throw Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},"isEntry",0,e=>(0,f.hasProperty)(e,aD),"makeEntry",0,e=>new aL(e.request,e.result,e.listeners,e.ownerId,e.state),"par",0,aM,"reduce",0,(e,t)=>{let r=iI(e),i=iC();for(;i_(r);){let e=r.head;switch(e._tag){case"Empty":i=ix(el.right(t.emptyCase()),i),r=r.tail;break;case"Par":i=ix(el.left({_tag:"ParCase"}),i),r=ix(e.left,ix(e.right,r.tail));break;case"Seq":i=ix(el.left({_tag:"SeqCase"}),i),r=ix(e.left,ix(e.right,r.tail));break;case"Single":{let n=t.singleCase(e.dataSource,e.blockedRequest);i=ix(el.right(n),i),r=r.tail}}}let n=iN(i,iC(),(e,r)=>{switch(r._tag){case"Left":{let i=iL(e),n=iL(iU(e)),a=iU(iU(e));switch(r.left._tag){case"ParCase":return ix(t.parCase(i,n),a);case"SeqCase":return ix(t.seqCase(i,n),a)}}case"Right":return ix(r.right,e)}});if(iw(n))throw Error("BUG: BlockedRequests.reduce - please report an issue at https://github.com/Effect-TS/effect/issues");return n.head},"seq",0,aA,"sequentialCollectionToChunk",0,e=>Array.from(e.map),"single",0,(e,t)=>({_tag:"Single",dataSource:e,blockedRequest:t})],215139);let a0="Pending",a1="Done",a2=Symbol.for("effect/Deferred"),a6={_E:e=>e,_A:e=>e},a3=e=>({_tag:a0,joiners:e}),a4=e=>({_tag:a1,effect:e});e.s(["DeferredTypeId",0,a2,"deferredVariance",0,a6,"done",0,a4,"pending",0,a3],957502);var a5=e.i(25560);class a8{self;called=!1;constructor(e){this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(e){return{value:e,done:!0}}throw(e){throw e}[Symbol.iterator](){return new a8(this.self)}}e.s(["SingleShotGen",()=>a8],167804);let a7=Symbol.for("effect/Effect");class a9{patch;op;_op=a5.OP_REVERT_FLAGS;constructor(e,t){this.patch=e,this.op=t}}class se{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[a7]=iz.effectVariance;constructor(e){this._op=e}[n.symbol](e){return this===e}[o.symbol](){return o.cached(this,o.random(this))}pipe(){return(0,p.pipeArguments)(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:(0,l.toJSON)(this.effect_instruction_i0),effect_instruction_i1:(0,l.toJSON)(this.effect_instruction_i1),effect_instruction_i2:(0,l.toJSON)(this.effect_instruction_i2)}}toString(){return(0,l.format)(this.toJSON())}[l.NodeInspectSymbol](){return this.toJSON()}[Symbol.iterator](){return new a8(new aF.YieldWrap(this))}}class st{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[a7]=iz.effectVariance;constructor(e){this._op=e,this._tag=e}[n.symbol](e){return lm(e)&&"Failure"===e._op&&n.equals(this.effect_instruction_i0,e.effect_instruction_i0)}[o.symbol](){return(0,s.pipe)(o.string(this._tag),o.combine(o.hash(this.effect_instruction_i0)),o.cached(this))}get cause(){return this.effect_instruction_i0}pipe(){return(0,p.pipeArguments)(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return(0,l.format)(this.toJSON())}[l.NodeInspectSymbol](){return this.toJSON()}[Symbol.iterator](){return new a8(new aF.YieldWrap(this))}}class sr{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[a7]=iz.effectVariance;constructor(e){this._op=e,this._tag=e}[n.symbol](e){return lm(e)&&"Success"===e._op&&n.equals(this.effect_instruction_i0,e.effect_instruction_i0)}[o.symbol](){return(0,s.pipe)(o.string(this._tag),o.combine(o.hash(this.effect_instruction_i0)),o.cached(this))}get value(){return this.effect_instruction_i0}pipe(){return(0,p.pipeArguments)(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:(0,l.toJSON)(this.value)}}toString(){return(0,l.format)(this.toJSON())}[l.NodeInspectSymbol](){return this.toJSON()}[Symbol.iterator](){return new a8(new aF.YieldWrap(this))}}let si=e=>(0,f.hasProperty)(e,a7),sn=e=>{let t=new se(a5.OP_WITH_RUNTIME);return t.effect_instruction_i0=e,t},sa=(0,s.dual)(3,(e,t,r)=>s0(i=>sC(e,e=>sC(sv(sK(()=>i(t(e)))),t=>sK(()=>r(e,t)).pipe(sR({onFailure:e=>{switch(t._tag){case a5.OP_FAILURE:return s_(tk(t.effect_instruction_i0,e));case a5.OP_SUCCESS:return s_(e)}},onSuccess:()=>t})))))),ss=(0,s.dual)(2,(e,t)=>sC(e,()=>sG(t))),so=e=>ss(e,void 0),sl=function(){let e=new se(a5.OP_COMMIT);switch(arguments.length){case 2:e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break;case 3:e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break;case 4:e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break;default:throw Error((0,tc.getBugErrorMessage)("you're not supposed to end up here"))}return e},su=(e,t=ip)=>{let r,i=new se(a5.OP_ASYNC);return i.effect_instruction_i0=t=>{r=e(t)},i.effect_instruction_i1=t,s$(i,e=>si(r)?r:s1)},sc=(e,t=ip)=>sK(()=>su(e,t)),sp=(e,t=ip)=>sl(e,function(){let e,r,i,n;function a(t){e?e(t):void 0===r&&(r=t)}let s=new se(a5.OP_ASYNC);return s.effect_instruction_i0=t=>{e=t,r&&t(r)},s.effect_instruction_i1=t,1!==this.effect_instruction_i0.length?(n=new AbortController,i=(0,aF.internalCall)(()=>this.effect_instruction_i0(a,n.signal))):i=(0,aF.internalCall)(()=>this.effect_instruction_i0(a)),i||n?s$(s,e=>(n&&n.abort(),i??s1)):s}),sf=(0,s.dual)(2,(e,t)=>{let r=new se(a5.OP_ON_FAILURE);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),sd=(0,s.dual)(2,(e,t)=>sO(e,{onFailure:t,onSuccess:sG})),sh=(0,s.dual)(3,(e,t,r)=>sf(e,e=>{let i=tM(e);switch(i._tag){case"Left":return t(i.left)?r(i.left):s_(e);case"Right":return s_(i.right)}})),sm=(0,s.dual)(2,(e,t)=>sf(e,e=>{let r=tM(e);switch(r._tag){case"Left":return(0,s.pipe)(t(r.left),u.getOrElse(()=>s_(e)));case"Right":return s_(r.right)}})),sg=Symbol.for("effect/OriginalAnnotation"),sy=(e,t)=>u.isSome(t)?new Proxy(e,{has:(e,t)=>t===re||t===sg||t in e,get:(r,i)=>i===re?t.value:i===sg?e:r[i]}):e,sb=e=>!(0,f.isObject)(e)||re in e?s_(tE(e)):sn(t=>s_(tE(sy(e,ue(t))))),sS=e=>sC(sZ(e),sb),sv=e=>sT(e,{onFailure:lv,onSuccess:lF}),sE=e=>!(0,f.isObject)(e)||re in e?s_(tv(e)):sn(t=>s_(tv(sy(e,ue(t))))),sw=e=>sC(sZ(e),sE),s_=e=>{let t=new st(a5.OP_FAILURE);return t.effect_instruction_i0=e,t},sk=e=>sC(sZ(e),s_),sx=sn(e=>sG(e.id())),sC=(0,s.dual)(2,(e,t)=>{let r=new se(a5.OP_ON_SUCCESS);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),sI=(0,s.dual)(2,(e,t)=>sC(e,e=>{let r="function"==typeof t?t(e):t;return si(r)?r:(0,f.isPromiseLike)(r)?su(e=>{r.then(t=>e(sG(t)),t=>e(sE(new lh(t,"An unknown error occurred in Effect.andThen"))))}):sG(r)})),sT=(0,s.dual)(2,(e,t)=>sR(e,{onFailure:e=>sG(t.onFailure(e)),onSuccess:e=>sG(t.onSuccess(e))})),sR=(0,s.dual)(2,(e,t)=>{let r=new se(a5.OP_ON_SUCCESS_AND_FAILURE);return r.effect_instruction_i0=e,r.effect_instruction_i1=t.onFailure,r.effect_instruction_i2=t.onSuccess,r}),sO=(0,s.dual)(2,(e,t)=>sR(e,{onFailure:e=>{if(tR(e).length>0)return s_(tD(e));let r=tT(e);return r.length>0?t.onFailure(J(r)):s_(e)},onSuccess:t.onSuccess})),sF=(0,s.dual)(2,(e,t)=>sK(()=>{let r=i.fromIterable(e),n=i.allocate(r.length),a=0;return ss(s6({while:()=>a<r.length,body:()=>t(r[a],a),step:e=>{n[a++]=e}}),n)})),sM=(0,s.dual)(2,(e,t)=>sK(()=>{let r=i.fromIterable(e),n=0;return s6({while:()=>n<r.length,body:()=>t(r[n],n),step:()=>{n++}})})),sA=(0,s.dual)(e=>"boolean"==typeof e[0]||si(e[0]),(e,t)=>si(e)?sC(e,e=>e?t.onTrue():t.onFalse()):e?t.onTrue():t.onFalse()),sN=sC(sx,e=>sP(e)),sP=e=>s_(tw(e)),sD=e=>{let t=new se(a5.OP_UPDATE_RUNTIME_FLAGS);return t.effect_instruction_i0=ao(1),t.effect_instruction_i1=()=>e,t},sL=(0,s.dual)(2,(e,t)=>s0(r=>sC(sv(r(e)),e=>lH(t,e)))),sU=(0,s.dual)(2,(e,t)=>sC(e,e=>sZ(()=>t(e)))),sz=(0,s.dual)(2,(e,t)=>sO(e,{onFailure:e=>sw(()=>t.onFailure(e)),onSuccess:e=>sZ(()=>t.onSuccess(e))})),sj=(0,s.dual)(2,(e,t)=>sR(e,{onFailure:e=>{let r=tM(e);switch(r._tag){case"Left":return sw(()=>t(r.left));case"Right":return s_(r.right)}},onSuccess:sG})),sW=(0,s.dual)(2,(e,t)=>sq(e,e=>lg(e)?s1:t(e.effect_instruction_i0))),sq=(0,s.dual)(2,(e,t)=>s0(r=>sR(r(e),{onFailure:e=>{let r=lv(e);return sR(t(r),{onFailure:t=>lv(tk(e,t)),onSuccess:()=>r})},onSuccess:e=>{let r=lF(e);return or(t(r),r)}}))),s$=(0,s.dual)(2,(e,t)=>sq(e,lR({onFailure:e=>tI(e)?so(t(tO(e))):s1,onSuccess:()=>s1}))),sB=(0,s.dual)(2,(e,t)=>sY(e,t,sG)),sH=(0,s.dual)(2,(e,t)=>sO(e,{onFailure:e=>sb(t(e)),onSuccess:sG})),sV=i.partitionMap,sJ=sn((e,t)=>sG(t.runtimeFlags)),sG=e=>{let t=new sr(a5.OP_SUCCESS);return t.effect_instruction_i0=e,t},sK=e=>{let t=new se(a5.OP_COMMIT);return t.commit=e,t},sZ=e=>{let t=new se(a5.OP_SYNC);return t.effect_instruction_i0=e,t},sQ=(0,s.dual)(e=>3===e.length||2===e.length&&!((0,f.isObject)(e[1])&&"onlyEffect"in e[1]),(e,t)=>sC(e,e=>{let r="function"==typeof t?t(e):t;return si(r)?ss(r,e):(0,f.isPromiseLike)(r)?su(t=>{r.then(r=>t(sG(e)),e=>t(sE(new lh(e,"An unknown error occurred in Effect.tap"))))}):sG(e)})),sY=(0,s.dual)(3,(e,t,r)=>sR(e,{onFailure:e=>tR(e).length>0?s_(u.getOrThrow(tP(e))):t(),onSuccess:r})),sX=e=>{let t=new se(a5.OP_UPDATE_RUNTIME_FLAGS);return t.effect_instruction_i0=al(1),t.effect_instruction_i1=()=>e,t},s0=e=>sl(e,function(){let e=new se(a5.OP_UPDATE_RUNTIME_FLAGS);return e.effect_instruction_i0=al(1),e.effect_instruction_i1=e=>aE(e)?(0,aF.internalCall)(()=>this.effect_instruction_i0(sD)):(0,aF.internalCall)(()=>this.effect_instruction_i0(sX)),e}),s1=sG(void 0),s2=(0,s.dual)(2,(e,t)=>sC(t,t=>t?(0,s.pipe)(e,sU(u.some)):sG(u.none()))),s6=e=>{let t=new se(a5.OP_WHILE);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},s3=e=>sK(()=>{let t=new se(a5.OP_ITERATOR);return t.effect_instruction_i0=e(),t}),s4=(0,s.dual)(2,(e,t)=>oM(e,oH,t)),s5=(0,s.dual)(2,(e,t)=>oM(e,oV,t)),s8=(0,s.dual)(2,(e,t)=>{let r=new se(a5.OP_UPDATE_RUNTIME_FLAGS);return r.effect_instruction_i0=t,r.effect_instruction_i1=()=>e,r}),s7=(0,s.dual)(2,(e,t)=>oM(e,o0,t)),s9=(0,s.dual)(2,(e,t)=>oM(e,o1,t)),oe=(0,s.dual)(2,(e,t)=>sC(e,e=>sU(t,t=>[e,t]))),ot=(0,s.dual)(2,(e,t)=>sC(e,e=>ss(t,e))),or=(0,s.dual)(2,(e,t)=>sC(e,()=>t)),oi=(0,s.dual)(3,(e,t,r)=>sC(e,e=>sU(t,t=>r(e,t)))),on=sc(()=>{let e=setInterval(()=>{},0x80000000-1);return sZ(()=>clearInterval(e))}),oa=(0,s.dual)(2,(e,t)=>sC(e.interruptAsFork(t),()=>e.await)),os={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return(0,p.pipeArguments)(this,arguments)}},oo={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return(0,p.pipeArguments)(this,arguments)}},ol={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return(0,p.pipeArguments)(this,arguments)}},ou={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return(0,p.pipeArguments)(this,arguments)}},oc={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return(0,p.pipeArguments)(this,arguments)}},op={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return(0,p.pipeArguments)(this,arguments)}},of={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return(0,p.pipeArguments)(this,arguments)}},od={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return(0,p.pipeArguments)(this,arguments)}},oh=[os,of,op,oc,ou,ol,oo,od],om=Symbol.for("effect/FiberRef"),og={_A:e=>e},oy=e=>sn(t=>lF(t.getFiberRef(e))),ob=(0,s.dual)(2,(e,t)=>o_(e,e=>[e,t])),oS=(0,s.dual)(2,(e,t)=>o_(e,e=>[e,t(e)])),ov=(0,s.dual)(2,(e,t)=>o_(e,e=>[e,u.getOrElse(t(e),()=>e)])),oE=(0,s.dual)(2,(e,t)=>sC(oy(e),t)),ow=(0,s.dual)(2,(e,t)=>o_(e,()=>[void 0,t])),o_=(0,s.dual)(2,(e,t)=>sn(r=>{let[i,n]=t(r.getFiberRef(e));return r.setFiberRef(e,n),sG(i)})),ok=(0,s.dual)(2,(e,t)=>o_(e,e=>[void 0,t(e)])),ox=(0,s.dual)(2,(e,t)=>o_(e,e=>[void 0,u.getOrElse(t(e),()=>e)])),oC=(0,s.dual)(2,(e,t)=>o_(e,e=>{let r=t(e);return[r,r]})),oI=(0,s.dual)(2,(e,t)=>o_(e,e=>{let r=u.getOrElse(t(e),()=>e);return[r,r]})),oT=Symbol.for("effect/RequestResolver"),oR={_A:e=>e,_R:e=>e};class oO{runAll;target;[oT]=oR;constructor(e,t){this.runAll=e,this.target=t}[o.symbol](){return o.cached(this,this.target?o.hash(this.target):o.random(this))}[n.symbol](e){return this.target?oF(e)&&n.equals(this.target,e.target):this===e}identified(...e){return new oO(this.runAll,k(e))}pipe(){return(0,p.pipeArguments)(this,arguments)}}let oF=e=>(0,f.hasProperty)(e,oT),oM=(0,s.dual)(3,(e,t,r)=>sa(ot(oy(t),ow(t,r)),()=>e,e=>ow(t,e))),oA=(0,s.dual)(3,(e,t,r)=>oE(t,i=>oM(e,t,r(i)))),oN=(e,t)=>oD(e,{differ:ae(),fork:t?.fork??s.identity,join:t?.join}),oP=e=>{let t=n4();return oD(e,{differ:t,fork:t.empty})},oD=(e,t)=>({...iz.CommitPrototype,[om]:og,initial:e,commit(){return oy(this)},diff:(e,r)=>t.differ.diff(e,r),combine:(e,r)=>t.differ.combine(e,r),patch:e=>r=>t.differ.patch(e,r),fork:t.fork,join:t.join??((e,t)=>t)}),oL=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentContext"),()=>oP(rr.empty())),oU=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>oN(0)),oz=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>oN(2048)),oj=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>oN(eF())),oW=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentLogLevel"),()=>oN(oc)),oq=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentLogSpan"),()=>oN(iC())),o$=(0,s.dual)(2,(e,t)=>oM(e,oU,t)),oB=(0,s.dual)(2,(e,t)=>oM(e,oz,t)),oH=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentConcurrency"),()=>oN("unbounded")),oV=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>oN(!0)),oJ=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>oN(u.some(op))),oG=(0,eu.globalValue)(Symbol.for("effect/FiberRef/versionMismatchErrorLogLevel"),()=>oN(u.some(ou))),oK=(0,s.dual)(2,(e,t)=>oM(e,oJ,t)),oZ=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>{var e;let t;return e=i.empty(),oD(e,{differ:t=n7(ae()),fork:t.empty})}),oQ=oy(oZ),oY=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>oN(u.none(),{fork:()=>u.none(),join:(e,t)=>e})),oX=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>oN(tS,{fork:()=>tS,join:(e,t)=>e})),o0=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>oN(!0)),o1=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>oN(!0)),o2=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>oN(eF())),o6=(0,eu.globalValue)(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>oN(E())),o3=Symbol.for("effect/Scope"),o4=Symbol.for("effect/CloseableScope"),o5=(0,s.dual)(2,(e,t)=>{let r=(0,s.pipe)(e,tF,u.map(t));switch(r._tag){case"None":return(0,s.pipe)(tR(e),V,u.match({onNone:()=>{let t=i.fromIterable(tO(e)).flatMap(e=>i.fromIterable(ia(e)).map(e=>`#${e}`));return new lr(t?`Interrupted by fibers: ${t.join(", ")}`:void 0)},onSome:s.identity}));case"Some":return r.value}}),o8=function(){class e extends globalThis.Error{commit(){return sE(this)}toJSON(){let e={...this};return this.message&&(e.message=this.message),this.cause&&(e.cause=this.cause),e}[l.NodeInspectSymbol](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split("\n").slice(1).join("\n")}`:this.toString():"Bun"in globalThis?t6(tv(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,iz.StructuralCommitPrototype),e}(),o7=(e,t)=>{class r extends o8{_tag=t}return Object.assign(r.prototype,e),r.prototype.name=t,r},o9=Symbol.for("effect/Cause/errors/RuntimeException"),le=o7({[o9]:o9},"RuntimeException"),lt=Symbol.for("effect/Cause/errors/InterruptedException"),lr=o7({[lt]:lt},"InterruptedException"),li=Symbol.for("effect/Cause/errors/IllegalArgument"),ln=o7({[li]:li},"IllegalArgumentException"),la=Symbol.for("effect/Cause/errors/NoSuchElement"),ls=o7({[la]:la},"NoSuchElementException"),lo=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),ll=o7({[lo]:lo},"InvalidPubSubCapacityException"),lu=Symbol.for("effect/Cause/errors/ExceededCapacityException"),lc=o7({[lu]:lu},"ExceededCapacityException"),lp=Symbol.for("effect/Cause/errors/Timeout"),lf=o7({[lp]:lp},"TimeoutException"),ld=Symbol.for("effect/Cause/errors/UnknownException"),lh=function(){class e extends o8{_tag="UnknownException";error;constructor(e,t){super(t??"An unknown error occurred",{cause:e}),this.error=e}}return Object.assign(e.prototype,{[ld]:ld,name:"UnknownException"}),e}(),lm=e=>si(e)&&"_tag"in e&&("Success"===e._tag||"Failure"===e._tag),lg=e=>"Success"===e._tag,ly=(0,s.dual)(2,(e,t)=>{switch(e._tag){case a5.OP_FAILURE:return lv(e.effect_instruction_i0);case a5.OP_SUCCESS:return lF(t)}}),lb=(0,s.dual)(2,(e,t)=>{switch(e._tag){case a5.OP_FAILURE:return!1;case a5.OP_SUCCESS:return t(e.effect_instruction_i0)}}),lS=e=>lv(tv(e)),lv=e=>{let t=new st(a5.OP_FAILURE);return t.effect_instruction_i0=e,t},lE=(0,s.dual)(2,(e,t)=>{switch(e._tag){case a5.OP_FAILURE:return lv(e.effect_instruction_i0);case a5.OP_SUCCESS:return t(e.effect_instruction_i0)}}),lw=(0,s.dual)(2,(e,t)=>{switch(e._tag){case a5.OP_FAILURE:return sG(lv(e.effect_instruction_i0));case a5.OP_SUCCESS:return t(e.effect_instruction_i0)}}),l_=(0,s.dual)(2,(e,t)=>{switch(e._tag){case a5.OP_FAILURE:return sG(lv(e.effect_instruction_i0));case a5.OP_SUCCESS:return sv(t(e.effect_instruction_i0))}}),lk=(0,s.dual)(2,(e,t)=>{switch(e._tag){case a5.OP_FAILURE:return t(e.effect_instruction_i0);case a5.OP_SUCCESS:return e.effect_instruction_i0}}),lx=(0,s.dual)(2,(e,t)=>{switch(e._tag){case a5.OP_FAILURE:return lv(e.effect_instruction_i0);case a5.OP_SUCCESS:return lF(t(e.effect_instruction_i0))}}),lC=(0,s.dual)(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case a5.OP_FAILURE:return lv((0,s.pipe)(e.effect_instruction_i0,tz(t)));case a5.OP_SUCCESS:return lF(r(e.effect_instruction_i0))}}),lI=(0,s.dual)(2,(e,t)=>{switch(e._tag){case a5.OP_FAILURE:return lv((0,s.pipe)(e.effect_instruction_i0,tz(t)));case a5.OP_SUCCESS:return lF(e.effect_instruction_i0)}}),lT=(0,s.dual)(2,(e,t)=>{switch(e._tag){case a5.OP_FAILURE:return lv(t(e.effect_instruction_i0));case a5.OP_SUCCESS:return lF(e.effect_instruction_i0)}}),lR=(0,s.dual)(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case a5.OP_FAILURE:return t(e.effect_instruction_i0);case a5.OP_SUCCESS:return r(e.effect_instruction_i0)}}),lO=(0,s.dual)(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case a5.OP_FAILURE:return t(e.effect_instruction_i0);case a5.OP_SUCCESS:return r(e.effect_instruction_i0)}}),lF=e=>{let t=new sr(a5.OP_SUCCESS);return t.effect_instruction_i0=e,t},lM=lF(void 0),lA=(0,s.dual)(2,(e,t)=>lz(e,t,{onSuccess:(e,t)=>[e,t],onFailure:tk})),lN=(0,s.dual)(2,(e,t)=>lz(e,t,{onSuccess:(e,t)=>e,onFailure:tk})),lP=(0,s.dual)(2,(e,t)=>lz(e,t,{onSuccess:(e,t)=>t,onFailure:tk})),lD=(0,s.dual)(2,(e,t)=>lz(e,t,{onSuccess:(e,t)=>[e,t],onFailure:t_})),lL=(0,s.dual)(2,(e,t)=>lz(e,t,{onSuccess:(e,t)=>e,onFailure:t_})),lU=(0,s.dual)(2,(e,t)=>lz(e,t,{onSuccess:(e,t)=>t,onFailure:t_})),lz=(0,s.dual)(3,(e,t,{onFailure:r,onSuccess:i})=>{switch(e._tag){case a5.OP_FAILURE:switch(t._tag){case a5.OP_SUCCESS:return lv(e.effect_instruction_i0);case a5.OP_FAILURE:return lv(r(e.effect_instruction_i0,t.effect_instruction_i0))}case a5.OP_SUCCESS:switch(t._tag){case a5.OP_SUCCESS:return lF(i(e.effect_instruction_i0,t.effect_instruction_i0));case a5.OP_FAILURE:return lv(t.effect_instruction_i0)}}}),lj=e=>({...iz.CommitPrototype,[a2]:a6,state:rJ(a3([])),commit(){return lq(this)},blockingOn:e}),lW=e=>sZ(()=>lj(e)),lq=e=>sc(t=>{let r=rK(e.state);switch(r._tag){case a1:return t(r.effect);case a0:return r.joiners.push(t),l1(e,t)}},e.blockingOn),l$=(0,s.dual)(2,(e,t)=>sL(t,e)),lB=(0,s.dual)(2,(e,t)=>sZ(()=>{let r=rK(e.state);switch(r._tag){case a1:return!1;case a0:rZ(e.state,a4(t));for(let e=0,i=r.joiners.length;e<i;e++)r.joiners[e](t);return!0}})),lH=(0,s.dual)(2,(e,t)=>lB(e,t)),lV=(0,s.dual)(2,(e,t)=>lB(e,sE(t))),lJ=(0,s.dual)(2,(e,t)=>lB(e,sw(t))),lG=(0,s.dual)(2,(e,t)=>lB(e,s_(t))),lK=(0,s.dual)(2,(e,t)=>lB(e,sk(t))),lZ=(0,s.dual)(2,(e,t)=>lB(e,sb(t))),lQ=(0,s.dual)(2,(e,t)=>lB(e,sS(t))),lY=(0,s.dual)(2,(e,t)=>lB(e,sP(t))),lX=(0,s.dual)(2,(e,t)=>lB(e,sG(t))),l0=(0,s.dual)(2,(e,t)=>lB(e,sZ(t))),l1=(e,t)=>sZ(()=>{let r=rK(e.state);if(r._tag===a0){let e=r.joiners.indexOf(t);e>=0&&r.joiners.splice(e,1)}}),l2=sn(e=>lF(e.currentContext)),l6=()=>l2,l3=e=>sC(l6(),e),l4=(0,s.dual)(2,(e,t)=>oM(oL,t)(e)),l5=(0,s.dual)(2,(e,t)=>oA(oL,e=>rr.merge(e,t))(e)),l8=(0,s.dual)(2,(e,t)=>l3(r=>l4(e,t(r)))),l7=(0,s.dual)(2,(e,t)=>sC(e,e=>sC(t.predicate(e),r=>r?sG(e):t.orElse(e)))),l9=(0,s.dual)(2,(e,t)=>l7(e,{predicate:t.predicate,orElse:e=>sE(t.orFailWith(e))})),ue=e=>{let t=e.currentSpan;return void 0!==t&&"Span"===t._tag?u.some(t):u.none()},ut={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:lM},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}};e.s(["CloseableScopeTypeId",0,o4,"EffectTypeId",0,a7,"ExceededCapacityException",0,lc,"ExceededCapacityExceptionTypeId",0,lu,"FiberRefTypeId",0,om,"IllegalArgumentException",0,ln,"IllegalArgumentExceptionTypeId",0,li,"InterruptedException",0,lr,"InterruptedExceptionTypeId",0,lt,"InvalidPubSubCapacityException",0,ll,"InvalidPubSubCapacityExceptionTypeId",0,lo,"NoSuchElementException",0,ls,"NoSuchElementExceptionTypeId",0,la,"RevertFlags",()=>a9,"RuntimeException",0,le,"RuntimeExceptionTypeId",0,o9,"ScopeTypeId",0,o3,"TimeoutException",0,lf,"TimeoutExceptionTypeId",0,lp,"UnknownException",0,lh,"UnknownExceptionTypeId",0,ld,"YieldableError",0,o8,"acquireUseRelease",0,sa,"allLogLevels",0,oh,"andThen",0,sI,"as",0,ss,"asVoid",0,so,"async",()=>sp,"asyncInterrupt",0,sc,"blocked",0,(e,t)=>{let r=new se("Blocked");return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r},"capture",0,sy,"catchAll",0,sd,"catchAllCause",0,sf,"catchIf",0,sh,"catchSome",0,sm,"causeSquash",0,e=>o5(s.identity)(e),"causeSquashWith",0,o5,"checkInterruptible",0,e=>sn((t,r)=>e(aE(r.runtimeFlags))),"context",0,l6,"contextWithEffect",0,l3,"currentConcurrency",0,oH,"currentContext",0,oL,"currentForkScopeOverride",0,oY,"currentInterruptedCause",0,oX,"currentLogAnnotations",0,oj,"currentLogLevel",0,oW,"currentLogSpan",0,oq,"currentMaxOpsBeforeYield",0,oz,"currentMetricLabels",0,oZ,"currentRequestBatching",0,oV,"currentSchedulingPriority",0,oU,"currentSpanFromFiber",0,ue,"currentTracerEnabled",0,o0,"currentTracerSpanAnnotations",0,o2,"currentTracerSpanLinks",0,o6,"currentTracerTimingEnabled",0,o1,"currentUnhandledErrorLogLevel",0,oJ,"currentVersionMismatchErrorLogLevel",0,oG,"custom",0,sl,"deferredAwait",0,lq,"deferredComplete",0,l$,"deferredCompleteWith",0,lB,"deferredDie",0,lZ,"deferredDieSync",0,lQ,"deferredDone",0,lH,"deferredFail",0,lV,"deferredFailCause",0,lG,"deferredFailCauseSync",0,lK,"deferredFailSync",0,lJ,"deferredInterrupt",0,e=>sC(sx,t=>lB(e,sP(t))),"deferredInterruptWith",0,lY,"deferredIsDone",0,e=>sZ(()=>rK(e.state)._tag===a1),"deferredMake",0,()=>sC(sx,e=>lW(e)),"deferredMakeAs",0,lW,"deferredPoll",0,e=>sZ(()=>{let t=rK(e.state);switch(t._tag){case a1:return u.some(t.effect);case a0:return u.none()}}),"deferredSucceed",0,lX,"deferredSync",0,l0,"deferredUnsafeDone",0,(e,t)=>{let r=rK(e.state);if(r._tag===a0){rZ(e.state,a4(t));for(let e=0,i=r.joiners.length;e<i;e++)r.joiners[e](t)}},"deferredUnsafeMake",0,lj,"die",0,sb,"dieMessage",0,e=>sk(()=>tE(new le(e))),"dieSync",0,sS,"either",0,e=>sO(e,{onFailure:e=>sG(el.left(e)),onSuccess:e=>sG(el.right(e))}),"exit",0,sv,"exitAs",0,ly,"exitAsVoid",0,e=>ly(e,void 0),"exitCauseOption",0,e=>{switch(e._tag){case a5.OP_FAILURE:return u.some(e.effect_instruction_i0);case a5.OP_SUCCESS:return u.none()}},"exitCollectAll",0,(e,t)=>{var r,n;let a;return r=e,n=t?.parallel?t_:tk,H(a=k(r))?(0,s.pipe)(Y(a),i.reduce((0,s.pipe)(J(a),lx(_)),(e,t)=>(0,s.pipe)(e,lz(t,{onSuccess:(e,t)=>(0,s.pipe)(e,A(t)),onFailure:n}))),lx(I),lx(e=>C(e)),u.some):u.none()},"exitDie",0,e=>lv(tE(e)),"exitExists",0,lb,"exitFail",0,lS,"exitFailCause",0,lv,"exitFlatMap",0,lE,"exitFlatMapEffect",0,lw,"exitFlatten",0,e=>(0,s.pipe)(e,lE(s.identity)),"exitForEachEffect",0,l_,"exitFromEither",0,e=>{switch(e._tag){case"Left":return lS(e.left);case"Right":return lF(e.right)}},"exitFromOption",0,e=>{switch(e._tag){case"None":return lS(void 0);case"Some":return lF(e.value)}},"exitGetOrElse",0,lk,"exitInterrupt",0,e=>lv(tw(e)),"exitIsExit",0,lm,"exitIsFailure",0,e=>"Failure"===e._tag,"exitIsInterrupted",0,e=>{switch(e._tag){case a5.OP_FAILURE:return tC(e.effect_instruction_i0);case a5.OP_SUCCESS:return!1}},"exitIsSuccess",0,lg,"exitMap",0,lx,"exitMapBoth",0,lC,"exitMapError",0,lI,"exitMapErrorCause",0,lT,"exitMatch",0,lR,"exitMatchEffect",0,lO,"exitSucceed",0,lF,"exitVoid",0,lM,"exitZip",0,lA,"exitZipLeft",0,lN,"exitZipPar",0,lD,"exitZipParLeft",0,lL,"exitZipParRight",0,lU,"exitZipRight",0,lP,"exitZipWith",0,lz,"fail",0,sE,"failCause",0,s_,"failCauseSync",0,sk,"failSync",0,sw,"fiberId",0,sx,"fiberIdWith",0,e=>sn(t=>e(t.id())),"fiberRefDelete",0,e=>sn(t=>(t.unsafeDeleteFiberRef(e),s1)),"fiberRefGet",0,oy,"fiberRefGetAndSet",0,ob,"fiberRefGetAndUpdate",0,oS,"fiberRefGetAndUpdateSome",0,ov,"fiberRefGetWith",0,oE,"fiberRefLocally",0,oM,"fiberRefLocallyWith",0,oA,"fiberRefModify",0,o_,"fiberRefModifySome",0,(e,t,r)=>o_(e,e=>u.getOrElse(r(e),()=>[t,e])),"fiberRefReset",0,e=>ow(e,e.initial),"fiberRefSet",0,ow,"fiberRefUnsafeMake",0,oN,"fiberRefUnsafeMakeContext",0,oP,"fiberRefUnsafeMakeHashSet",0,e=>{let t=n5();return oD(e,{differ:t,fork:t.empty})},"fiberRefUnsafeMakePatch",0,oD,"fiberRefUnsafeMakeRuntimeFlags",0,e=>oD(e,{differ:aO,fork:aO.empty}),"fiberRefUpdate",0,ok,"fiberRefUpdateAndGet",0,oC,"fiberRefUpdateSome",0,ox,"fiberRefUpdateSomeAndGet",0,oI,"filterEffectOrElse",0,l7,"filterEffectOrFail",0,l9,"flatMap",0,sC,"flatten",0,e=>sC(e,s.identity),"flip",0,e=>sO(e,{onFailure:sG,onSuccess:sE}),"fnUntraced",0,(e,...t)=>Object.defineProperty(0===t.length?function(...t){return s3(()=>e.apply(this,t))}:function(...r){let i=s3(()=>e.apply(this,r));for(let e of t)i=e(i,...r);return i},"length",{value:e.length,configurable:!0}),"forEachSequential",0,sF,"forEachSequentialDiscard",0,sM,"fromIterator",0,s3,"gen",0,function(){let e=1==arguments.length?arguments[0]:arguments[1].bind(arguments[0]);return s3(()=>e(s.pipe))},"if_",0,sA,"interrupt",0,sN,"interruptAsFiber",0,oa,"interruptFiber",0,e=>sC(sx,t=>(0,s.pipe)(e,oa(t))),"interruptWith",0,sP,"interruptible",0,sD,"interruptibleMask",0,e=>sl(e,function(){let e=new se(a5.OP_UPDATE_RUNTIME_FLAGS);return e.effect_instruction_i0=ao(1),e.effect_instruction_i1=e=>aE(e)?(0,aF.internalCall)(()=>this.effect_instruction_i0(sD)):(0,aF.internalCall)(()=>this.effect_instruction_i0(sX)),e}),"intoDeferred",0,sL,"isEffect",0,si,"isExceededCapacityException",0,e=>(0,f.hasProperty)(e,lu),"isIllegalArgumentException",0,e=>(0,f.hasProperty)(e,li),"isInterruptedException",0,e=>(0,f.hasProperty)(e,lt),"isNoSuchElementException",0,e=>(0,f.hasProperty)(e,la),"isRuntimeException",0,e=>(0,f.hasProperty)(e,o9),"isTimeoutException",0,e=>(0,f.hasProperty)(e,lp),"isUnknownException",0,e=>(0,f.hasProperty)(e,ld),"logLevelAll",0,os,"logLevelDebug",0,op,"logLevelError",0,ol,"logLevelFatal",0,oo,"logLevelInfo",0,oc,"logLevelNone",0,od,"logLevelTrace",0,of,"logLevelWarning",0,ou,"map",0,sU,"mapBoth",0,sz,"mapError",0,sj,"mapInputContext",0,l8,"matchCause",0,sT,"matchCauseEffect",0,sR,"matchEffect",0,sO,"metricLabels",0,oQ,"never",0,on,"noopSpan",0,e=>Object.assign(Object.create(ut),e),"onError",0,sW,"onExit",0,sq,"onInterrupt",0,s$,"orDie",0,e=>sH(e,s.identity),"orDieWith",0,sH,"orElse",0,sB,"originalInstance",0,e=>(0,f.hasProperty)(e,sg)?e[sg]:e,"partitionMap",0,sV,"provideContext",0,l4,"provideSomeContext",0,l5,"runRequestBlock",0,e=>{let t=new se("RunBlocked");return t.effect_instruction_i0=e,t},"runtimeFlags",0,sJ,"scopeAddFinalizer",0,(e,t)=>e.addFinalizer(()=>so(t)),"scopeAddFinalizerExit",0,(e,t)=>e.addFinalizer(t),"scopeClose",0,(e,t)=>e.close(t),"scopeFork",0,(e,t)=>e.fork(t),"step",0,e=>{let t=new se("OnStep");return t.effect_instruction_i0=e,t},"succeed",0,sG,"suspend",0,sK,"sync",0,sZ,"tap",0,sQ,"timeoutExceptionFromDuration",0,e=>new lf(`Operation timed out after '${rB(e)}'`),"transplant",0,e=>sn(t=>{let r=t.getFiberRef(oY),i=(0,s.pipe)(r,u.getOrElse(()=>t.scope()));return e(oM(oY,u.some(i)))}),"uninterruptible",0,sX,"uninterruptibleMask",0,s0,"unsafeAsync",0,su,"updateRuntimeFlags",0,e=>{let t=new se(a5.OP_UPDATE_RUNTIME_FLAGS);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},"void",()=>s1,"whenEffect",0,s2,"whileLoop",0,s6,"withConcurrency",0,s4,"withFiberRuntime",0,sn,"withMaxOpsBeforeYield",0,oB,"withRequestBatching",0,s5,"withRuntimeFlags",0,s8,"withSchedulingPriority",0,o$,"withTracerEnabled",0,s7,"withTracerTiming",0,s9,"withUnhandledErrorLogLevel",0,oK,"yieldNow",0,e=>{let t=new se(a5.OP_YIELD);return void 0!==e?.priority?o$(t,e.priority):t},"zip",0,oe,"zipLeft",0,ot,"zipRight",0,or,"zipWith",0,oi],580611)},710284,e=>{"use strict";var t=e.i(129627),r=e.i(580611);t.CauseTypeId,r.RuntimeExceptionTypeId,r.InterruptedExceptionTypeId,r.IllegalArgumentExceptionTypeId,r.NoSuchElementExceptionTypeId,r.InvalidPubSubCapacityExceptionTypeId,r.ExceededCapacityExceptionTypeId;let i=r.TimeoutExceptionTypeId;r.UnknownExceptionTypeId,r.YieldableError;let n=t.empty,a=t.fail,s=t.die,o=t.interrupt,l=t.parallel,u=t.sequential,c=t.isCause,p=t.isEmptyType,f=t.isFailType,d=t.isDieType;t.isInterruptType,t.isSequentialType,t.isParallelType,t.size,t.isEmpty,t.isFailure,t.isDie;let h=t.isInterrupted,m=t.isInterruptedOnly;t.failures,t.defects;let g=t.interruptors;t.failureOption;let y=t.failureOrCause,b=t.flipCauseOption;t.dieOption,t.interruptOption,t.keepDefects,t.linearize,t.stripFailures;let S=t.stripSomeDefects;t.as;let v=t.map;t.flatMap,t.andThen,t.flatten,t.contains;let E=r.causeSquash;r.causeSquashWith,t.find,t.filter,t.match;let w=t.reduce,_=t.reduceWithContext;r.InterruptedException,r.isInterruptedException;let k=r.IllegalArgumentException;r.isIllegalArgumentException;let x=r.NoSuchElementException,C=r.isNoSuchElementException,I=r.RuntimeException,T=r.isRuntimeException;r.TimeoutException,r.isTimeoutException,r.UnknownException,r.isUnknownException,r.ExceededCapacityException,r.isExceededCapacityException;let R=t.pretty;t.prettyErrors,r.originalInstance,e.s(["IllegalArgumentException",0,k,"NoSuchElementException",0,x,"RuntimeException",0,I,"TimeoutExceptionTypeId",0,i,"die",0,s,"empty",0,n,"fail",0,a,"failureOrCause",0,y,"flipCauseOption",0,b,"interrupt",0,o,"interruptors",0,g,"isCause",0,c,"isDieType",0,d,"isEmptyType",0,p,"isFailType",0,f,"isInterrupted",0,h,"isInterruptedOnly",0,m,"isNoSuchElementException",0,C,"isRuntimeException",0,T,"map",0,v,"parallel",0,l,"pretty",0,R,"reduce",0,w,"reduceWithContext",0,_,"sequential",0,u,"squash",0,E,"stripSomeDefects",0,S])},541581,e=>{"use strict";var t=e.i(435146),r=e.i(964665),i=e.i(842862),n=e.i(100808);let a="InvalidData",s="MissingData",o="SourceUnavailable",l="Unsupported",u=Symbol.for("effect/ConfigError"),c={_tag:"ConfigError",[u]:u},p=(e,t)=>{let r=Object.create(c);return r._op="And",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},f=(e,t)=>{let r=Object.create(c);return r._op="Or",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},d=(e,r,n={pathDelim:"."})=>{let s=Object.create(c);return s._op=a,s.path=e,s.message=r,Object.defineProperty(s,"toString",{enumerable:!1,value(){let e=(0,i.pipe)(this.path,t.join(n.pathDelim));return`(Invalid data at ${e}: "${this.message}")`}}),s},h=(e,r,n={pathDelim:"."})=>{let a=Object.create(c);return a._op=s,a.path=e,a.message=r,Object.defineProperty(a,"toString",{enumerable:!1,value(){let e=(0,i.pipe)(this.path,t.join(n.pathDelim));return`(Missing data at ${e}: "${this.message}")`}}),a},m=(e,r,n,a={pathDelim:"."})=>{let s=Object.create(c);return s._op=o,s.path=e,s.message=r,s.cause=n,Object.defineProperty(s,"toString",{enumerable:!1,value(){let e=(0,i.pipe)(this.path,t.join(a.pathDelim));return`(Source unavailable at ${e}: "${this.message}")`}}),s},g=(e,r,n={pathDelim:"."})=>{let a=Object.create(c);return a._op=l,a.path=e,a.message=r,Object.defineProperty(a,"toString",{enumerable:!1,value(){let e=(0,i.pipe)(this.path,t.join(n.pathDelim));return`(Unsupported operation at ${e}: "${this.message}")`}}),a},y=(0,i.dual)(2,(e,t)=>{switch(e._op){case"And":return p(y(e.left,t),y(e.right,t));case"Or":return f(y(e.left,t),y(e.right,t));case a:return d([...t,...e.path],e.message);case s:return h([...t,...e.path],e.message);case o:return m([...t,...e.path],e.message,e.cause);case l:return g([...t,...e.path],e.message)}}),b={andCase:(e,t,r)=>t&&r,orCase:(e,t,r)=>t&&r,invalidDataCase:i.constFalse,missingDataCase:i.constTrue,sourceUnavailableCase:i.constFalse,unsupportedCase:i.constFalse},S=(0,i.dual)(3,(e,t,i)=>{let n=[e],u=[];for(;n.length>0;){let e=n.pop();switch(e._op){case"And":n.push(e.right),n.push(e.left),u.push(r.left({_op:"AndCase"}));break;case"Or":n.push(e.right),n.push(e.left),u.push(r.left({_op:"OrCase"}));break;case a:u.push(r.right(i.invalidDataCase(t,e.path,e.message)));break;case s:u.push(r.right(i.missingDataCase(t,e.path,e.message)));break;case o:u.push(r.right(i.sourceUnavailableCase(t,e.path,e.message,e.cause)));break;case l:u.push(r.right(i.unsupportedCase(t,e.path,e.message)))}}let c=[];for(;u.length>0;){let e=u.pop();switch(e._op){case"Left":switch(e.left._op){case"AndCase":{let e=c.pop(),r=c.pop(),n=i.andCase(t,e,r);c.push(n);break}case"OrCase":{let e=c.pop(),r=c.pop(),n=i.orCase(t,e,r);c.push(n)}}break;case"Right":c.push(e.right)}}if(0===c.length)throw Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return c.pop()});e.s(["And",0,p,"ConfigErrorTypeId",0,u,"InvalidData",0,d,"MissingData",0,h,"Or",0,f,"SourceUnavailable",0,m,"Unsupported",0,g,"isAnd",0,e=>"And"===e._op,"isConfigError",0,e=>(0,n.hasProperty)(e,u),"isInvalidData",0,e=>e._op===a,"isMissingData",0,e=>e._op===s,"isMissingDataOnly",0,e=>S(e,void 0,b),"isOr",0,e=>"Or"===e._op,"isSourceUnavailable",0,e=>e._op===o,"isUnsupported",0,e=>e._op===l,"prefixed",0,y,"reduceWithContext",0,S],541581)},433366,e=>{"use strict";var t=e.i(541581);t.ConfigErrorTypeId,t.And,t.Or,t.MissingData;let r=t.InvalidData;t.SourceUnavailable,t.Unsupported,t.isConfigError,t.isAnd,t.isOr,t.isInvalidData,t.isMissingData;let i=t.isMissingDataOnly;t.isSourceUnavailable,t.isUnsupported,t.prefixed,t.reduceWithContext,e.s(["InvalidData",0,r,"isMissingDataOnly",0,i])},931499,e=>{"use strict";var t=e.i(266493),r=e.i(842862),i=e.i(480467);e.i(753126);var n=e.i(129248);e.i(100808).isNumber,t.number;let a=n.number,s=n.greaterThanOrEqualTo(a),o=n.clamp(a),l=(0,r.dual)(2,(e,t)=>{let r=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,n=r>i?r:i;return parseInt(e.toFixed(n).replace(".",""))%parseInt(t.toFixed(n).replace(".",""))/Math.pow(10,n)});e.s(["Order",0,a,"clamp",0,o,"greaterThanOrEqualTo",0,s,"nextPow2",0,e=>Math.max(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))),2),"parse",0,e=>{if("NaN"===e)return i.some(NaN);if("Infinity"===e)return i.some(1/0);if("-Infinity"===e)return i.some(-1/0);if(""===e.trim())return i.none;let t=Number(e);return Number.isNaN(t)?i.none:i.some(t)},"remainder",0,l,"sign",0,e=>a(e,0)])},436518,930559,874264,e=>{"use strict";var t=e.i(435146),r=e.i(777865),i=e.i(964665),n=e.i(842862),a=e.i(214250),s=e.i(838927),o=e.i(931499),l=e.i(65632),u=e.i(787039),c=e.i(100808);c.isRegExp;let p=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&");e.s(["escape",0,p],930559);var f=e.i(541581),d=e.i(807816);let h={_tag:"Empty"},m=(0,n.dual)(2,(e,t)=>({_tag:"AndThen",first:e,second:t})),g=(0,n.dual)(2,(e,t)=>m(e,{_tag:"MapName",f:t})),y=(0,n.dual)(2,(e,t)=>m(e,{_tag:"Nested",name:t})),b=(0,n.dual)(2,(e,t)=>m(e,{_tag:"Unnested",name:t})),S=(0,n.dual)(2,(e,r)=>{let a=d.of(r),s=e;for(;d.isCons(a);){let e=a.head;switch(e._tag){case"Empty":a=a.tail;break;case"AndThen":a=d.cons(e.first,d.cons(e.second,a.tail));break;case"MapName":s=t.map(s,e.f),a=a.tail;break;case"Nested":s=t.prepend(s,e.name),a=a.tail;break;case"Unnested":if(!(0,n.pipe)(t.head(s),l.contains(e.name)))return i.left(f.MissingData(s,`Expected ${e.name} to be in path in ConfigProvider#unnested`));s=t.tailNonEmpty(s),a=a.tail}}return i.right(s)});var v=e.i(580611);let E="Constant",w="Fail",_="Fallback",k="Described",x="Lazy",C="MapOrFail",I="Nested",T="Primitive",R="Sequence",O="HashMap",F="ZipWith";e.s(["OP_CONSTANT",0,E,"OP_DESCRIBED",0,k,"OP_FAIL",0,w,"OP_FALLBACK",0,_,"OP_HASHMAP",0,O,"OP_LAZY",0,x,"OP_MAP_OR_FAIL",0,C,"OP_NESTED",0,I,"OP_PRIMITIVE",0,T,"OP_SEQUENCE",0,R,"OP_ZIP_WITH",0,F],874264);let M=e=>e.toLowerCase(),A=e=>e.toUpperCase(),N=(e,t,r)=>t instanceof RegExp?e.replace(t,r):t.reduce((e,t)=>e.replace(t,r),e),P=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],D=/[^A-Z0-9]+/gi,L=(e,t={})=>{let{delimiter:r=" ",splitRegexp:i=P,stripRegexp:n=D,transform:a=M}=t,s=N(N(e,i,"$1\0$2"),n,"\0"),o=0,l=s.length;for(;"\0"===s.charAt(o);)o++;for(;"\0"===s.charAt(l-1);)l--;return s.slice(o,l).split("\0").map(a).join(r)},U=(e,t)=>L(e,{delimiter:"_",transform:A,...t}),z=(e,t)=>L(e,{delimiter:"-",...t}),j=(e,t)=>L(e,{delimiter:"_",...t}),W=(e,t)=>[...e,...t],q=Symbol.for("effect/ConfigProvider"),$=r.GenericTag("effect/ConfigProvider"),B=Symbol.for("effect/ConfigProviderFlat"),H=e=>({[q]:q,pipe(){return(0,u.pipeArguments)(this,arguments)},...e}),V=e=>({[B]:B,patch:e.patch,load:(t,r,i=!0)=>e.load(t,r,i),enumerateChildren:e.enumerateChildren}),J=e=>H({load:r=>v.flatMap(K(e,t.empty(),r,!1),e=>l.match(t.head(e),{onNone:()=>v.fail(f.MissingData(t.empty(),`Expected a single value having structure: ${r}`)),onSome:v.succeed})),flattened:e}),G=(e,r)=>{let{pathDelim:i,seqDelim:a}=Object.assign({seqDelim:",",pathDelim:"."},r),o=e=>(0,n.pipe)(e,t.join(i)),u=e=>e.split(i),c=ec(e,e=>u(e),o);return J(V({load:(e,t,r=!0)=>{let i=o(e),s=c.has(i)?l.some(c.get(i)):l.none();return(0,n.pipe)(s,v.mapError(()=>f.MissingData(e,`Expected ${i} to exist in the provided map`)),v.flatMap(i=>en(i,e,t,a,r)))},enumerateChildren:e=>v.sync(()=>{let r=t.fromIterable(c.keys()).map(u).filter(r=>{for(let i=0;i<e.length;i++){let a=(0,n.pipe)(e,t.unsafeGet(i)),s=r[i];if(void 0===s||a!==s)return!1}return!0}).flatMap(t=>t.slice(e.length,e.length+1));return s.fromIterable(r)}),patch:h}))},K=(e,r,s,o)=>{switch(s._tag){case E:return v.succeed(t.of(s.value));case k:return v.suspend(()=>K(e,r,s.config,o));case w:return v.fail(f.MissingData(r,s.message));case _:return(0,n.pipe)(v.suspend(()=>K(e,r,s.first,o)),v.catchAll(t=>s.condition(t)?(0,n.pipe)(K(e,r,s.second,o),v.catchAll(e=>v.fail(f.Or(t,e)))):v.fail(t)));case x:return v.suspend(()=>K(e,r,s.config(),o));case C:return v.suspend(()=>(0,n.pipe)(K(e,r,s.original,o),v.flatMap(v.forEachSequential(e=>(0,n.pipe)(s.mapOrFail(e),v.mapError(f.prefixed(((e,t)=>{let r=t;if("Nested"===r._tag){let t=e.slice();for(;"Nested"===r._tag;)t.push(r.name),r=r.config;return t}return e})(r,s.original))))))));case I:return v.suspend(()=>K(e,W(r,t.of(s.name)),s.config,o));case T:return(0,n.pipe)(S(r,e.patch),v.flatMap(r=>(0,n.pipe)(e.load(r,s,o),v.flatMap(e=>{if(0===e.length){let e=(0,n.pipe)(t.last(r),l.getOrElse(()=>"<n/a>"));return v.fail(f.MissingData([],`Expected ${s.description} with name ${e}`))}return v.succeed(e)}))));case R:return(0,n.pipe)(S(r,e.patch),v.flatMap(i=>(0,n.pipe)(e.enumerateChildren(i),v.flatMap(es),v.flatMap(i=>0===i.length?v.suspend(()=>v.map(K(e,r,s.config,!0),t.of)):(0,n.pipe)(v.forEachSequential(i,i=>K(e,t.append(r,`[${i}]`),s.config,!0)),v.map(e=>{let r=t.flatten(e);return 0===r.length?t.of(t.empty()):t.of(r)}))))));case O:return v.suspend(()=>(0,n.pipe)(S(r,e.patch),v.flatMap(r=>(0,n.pipe)(e.enumerateChildren(r),v.flatMap(i=>(0,n.pipe)(i,v.forEachSequential(i=>K(e,W(r,t.of(i)),s.valueConfig,o)),v.map(e=>0===e.length?t.of(a.empty()):(0,n.pipe)(ea(e),t.map(e=>a.fromIterable(t.zip(t.fromIterable(i),e)))))))))));case F:return v.suspend(()=>(0,n.pipe)(K(e,r,s.left,o),v.either,v.flatMap(a=>(0,n.pipe)(K(e,r,s.right,o),v.either,v.flatMap(e=>{if(i.isLeft(a)&&i.isLeft(e))return v.fail(f.And(a.left,e.left));if(i.isLeft(a)&&i.isRight(e))return v.fail(a.left);if(i.isRight(a)&&i.isLeft(e))return v.fail(e.left);if(i.isRight(a)&&i.isRight(e)){var o,u;let c,p,f=(0,n.pipe)(r,t.join(".")),d=Z(r,f),[h,m]=(o=(0,n.pipe)(a.right,t.map(i.right)),u=(0,n.pipe)(e.right,t.map(i.right)),c=t.unfold(o.length,e=>e>=u.length?l.none():l.some([d(e),e+1])),p=t.unfold(u.length,e=>e>=o.length?l.none():l.some([d(e),e+1])),[W(o,c),W(u,p)]);return(0,n.pipe)(h,t.zip(m),v.forEachSequential(([e,t])=>(0,n.pipe)(v.zip(e,t),v.map(([e,t])=>s.zip(e,t)))))}throw Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},Z=(e,t)=>r=>i.left(f.MissingData(e,`The element at index ${r} in a sequence at path "${t}" was missing`)),Q=(0,n.dual)(2,(e,t)=>J(Y(e.flattened,t))),Y=(e,t)=>V({load:(t,r,i=!0)=>e.load(t,r,i),enumerateChildren:t=>e.enumerateChildren(t),patch:g(e.patch,t)}),X=(0,n.dual)(2,(e,t)=>J(V({load:(t,r)=>e.flattened.load(t,r,!0),enumerateChildren:t=>e.flattened.enumerateChildren(t),patch:y(e.flattened.patch,t)}))),ee=(0,n.dual)(2,(e,t)=>J(V({load:(t,r)=>e.flattened.load(t,r,!0),enumerateChildren:t=>e.flattened.enumerateChildren(t),patch:b(e.flattened.patch,t)}))),et=(0,n.dual)(2,(e,t)=>J(er(e.flattened,()=>t().flattened))),er=(e,t)=>V({load:(r,i,a)=>(0,n.pipe)(S(r,e.patch),v.flatMap(t=>e.load(t,i,a)),v.catchAll(e=>(0,n.pipe)(v.sync(t),v.flatMap(t=>(0,n.pipe)(S(r,t.patch),v.flatMap(e=>t.load(e,i,a)),v.catchAll(t=>v.fail(f.Or(e,t)))))))),enumerateChildren:r=>(0,n.pipe)(S(r,e.patch),v.flatMap(t=>e.enumerateChildren(t)),v.either,v.flatMap(e=>(0,n.pipe)(v.sync(t),v.flatMap(t=>(0,n.pipe)(S(r,t.patch),v.flatMap(e=>t.enumerateChildren(e)),v.either,v.flatMap(t=>{if(i.isLeft(e)&&i.isLeft(t))return v.fail(f.And(e.left,t.left));if(i.isLeft(e)&&i.isRight(t))return v.succeed(t.right);if(i.isRight(e)&&i.isLeft(t))return v.succeed(e.right);if(i.isRight(e)&&i.isRight(t))return v.succeed((0,n.pipe)(e.right,s.union(t.right)));throw Error("BUG: ConfigProvider.orElseFlat - please report an issue at https://github.com/Effect-TS/effect/issues")})))))),patch:h}),ei=(0,n.dual)(3,(e,r,i)=>{let n=t.reduce(r,e,(e,t)=>ee(e,t));return et(t.reduceRight(r,i(n),(e,t)=>X(e,t)),()=>e)}),en=(e,r,i,a,s)=>s?(0,n.pipe)(e.split(RegExp(`\\s*${p(a)}\\s*`)),v.forEachSequential(e=>i.parse(e.trim())),v.mapError(f.prefixed(r))):(0,n.pipe)(i.parse(e),v.mapBoth({onFailure:f.prefixed(r),onSuccess:t.of})),ea=e=>Object.keys(e[0]).map(t=>e.map(e=>e[t])),es=e=>(0,n.pipe)(v.forEachSequential(e,eu),v.mapBoth({onFailure:()=>t.empty(),onSuccess:t.sort(o.Order)}),v.either,v.map(i.merge)),eo=/(^.+)(\[(\d+)\])$/,el=/^(\[(\d+)\])$/,eu=e=>{let t=e.match(el);if(null!==t){let e=t[2];return(0,n.pipe)(void 0!==e&&e.length>0?l.some(e):l.none(),l.flatMap(ef))}return l.none()},ec=(e,r,i)=>{let a=new Map;for(let[s,o]of e){let e=(0,n.pipe)(r(s),t.flatMap(e=>l.match(ep(e),{onNone:()=>t.of(e),onSome:([e,r])=>t.make(e,`[${r}]`)})));a.set(i(e),o)}return a},ep=e=>{let t=e.match(eo);if(null!==t){let e=t[1],r=t[3],i=void 0!==e&&e.length>0?l.some(e):l.none(),a=(0,n.pipe)(void 0!==r&&r.length>0?l.some(r):l.none(),l.flatMap(ef));return l.all([i,a])}return l.none()},ef=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?l.none():l.some(t)};e.s(["ConfigProviderTypeId",0,q,"FlatConfigProviderTypeId",0,B,"configProviderTag",0,$,"constantCase",0,e=>Q(e,U),"fromEnv",0,e=>{let{pathDelim:r,seqDelim:i}=Object.assign({},{pathDelim:"_",seqDelim:","},e),a=()=>"u">typeof process&&"env"in process&&"object"==typeof process.env?process.env:{};return J(V({load:(e,s,o=!0)=>{let u=(0,n.pipe)(e,t.join(r)),c=a(),p=u in c?l.some(c[u]):l.none();return(0,n.pipe)(p,v.mapError(()=>f.MissingData(e,`Expected ${u} to exist in the process context`)),v.flatMap(t=>en(t,e,s,i,o)))},enumerateChildren:e=>v.sync(()=>{let i=Object.keys(a()).map(e=>e.toUpperCase().split(r)).filter(r=>{for(let i=0;i<e.length;i++){let a=(0,n.pipe)(e,t.unsafeGet(i)),s=r[i];if(void 0===s||a!==s)return!1}return!0}).flatMap(t=>t.slice(e.length,e.length+1));return s.fromIterable(i)}),patch:h}))},"fromFlat",0,J,"fromJson",0,e=>{var r;let i,n,a;return G(new Map(t.map((r=e,i=(e,r)=>"string"==typeof r?t.make([e,r]):"number"==typeof r||"boolean"==typeof r?t.make([e,String(r)]):t.isArray(r)?n(e,r):"object"==typeof r&&null!==r?a(e,r):t.empty(),n=(e,r)=>t.match(r,{onEmpty:()=>t.make([e,"<nil>"]),onNonEmpty:t.flatMap((r,n)=>i(t.append(e,{_tag:"KeyIndex",index:n}),r))}),(a=(e,r)=>Object.entries(r).filter(([,e])=>c.isNotNullable(e)).flatMap(([r,n])=>{let a=t.append(e,{_tag:"KeyName",name:r}),s=i(a,n);return t.isEmptyReadonlyArray(s)?t.make([a,""]):s}))(t.empty(),r)),([e,t])=>[(e=>{let t=[],r=0;for(;r<e.length;){let i=e[r];if("KeyName"===i._tag)if(r+1<e.length){let n=e[r+1];"KeyIndex"===n._tag?(t.push(`${i.name}[${n.index}]`),r+=2):(t.push(i.name),r+=1)}else t.push(i.name),r+=1}return t})(e).join("\uFEFF"),t])),{pathDelim:"\uFEFF",seqDelim:"\uFEFF"})},"fromMap",0,G,"kebabCase",0,e=>Q(e,z),"lowerCase",0,e=>Q(e,M),"make",0,H,"makeFlat",0,V,"mapInputPath",0,Q,"nested",0,X,"orElse",0,et,"snakeCase",0,e=>Q(e,j),"unnested",0,ee,"upperCase",0,e=>Q(e,A),"within",0,ei],436518)},374132,932213,389630,972075,601009,e=>{"use strict";let t,r,i,n;var a=e.i(435146),s=e.i(777865),o=e.i(649488),l=e.i(842862),u=e.i(402409),c=e.i(580611);let p=Symbol.for("effect/Clock"),f=s.GenericTag("effect/Clock"),d=0x80000000-1,h={unsafeSchedule(e,t){let r=o.toMillis(t);if(r>d)return l.constFalse;let i=!1,n=setTimeout(()=>{i=!0,e()},r);return()=>(clearTimeout(n),!i)}},m=(r=BigInt(1e6),"u"<typeof performance?()=>BigInt(Date.now())*r:()=>(void 0===t&&(t=BigInt(Date.now())*r-BigInt(Math.round(1e6*performance.now()))),t+BigInt(Math.round(1e6*performance.now())))),g=function(){let e="object"==typeof process&&"hrtime"in process&&"function"==typeof process.hrtime.bigint?process.hrtime:void 0;if(!e)return m;let t=m()-e.bigint();return()=>t+e.bigint()}();class y{[p]=p;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return g()}currentTimeMillis=c.sync(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=c.sync(()=>this.unsafeCurrentTimeNanos());scheduler(){return c.succeed(h)}sleep(e){return c.async(t=>{let r=h.unsafeSchedule(()=>t(c.void),e);return c.asVoid(c.sync(r))})}}let b=()=>new y;e.s(["ClockTypeId",0,p,"clockTag",0,f,"make",0,b],932213);var S=e.i(436518);let v=Symbol.for("effect/Console"),E=s.GenericTag("effect/Console"),w={[v]:v,assert:(e,...t)=>c.sync(()=>{console.assert(e,...t)}),clear:c.sync(()=>{console.clear()}),count:e=>c.sync(()=>{console.count(e)}),countReset:e=>c.sync(()=>{console.countReset(e)}),debug:(...e)=>c.sync(()=>{console.debug(...e)}),dir:(e,t)=>c.sync(()=>{console.dir(e,t)}),dirxml:(...e)=>c.sync(()=>{console.dirxml(...e)}),error:(...e)=>c.sync(()=>{console.error(...e)}),group:e=>e?.collapsed?c.sync(()=>console.groupCollapsed(e?.label)):c.sync(()=>console.group(e?.label)),groupEnd:c.sync(()=>{console.groupEnd()}),info:(...e)=>c.sync(()=>{console.info(...e)}),log:(...e)=>c.sync(()=>{console.log(...e)}),table:(e,t)=>c.sync(()=>{console.table(e,t)}),time:e=>c.sync(()=>console.time(e)),timeEnd:e=>c.sync(()=>console.timeEnd(e)),timeLog:(e,...t)=>c.sync(()=>{console.timeLog(e,...t)}),trace:(...e)=>c.sync(()=>{console.trace(...e)}),warn:(...e)=>c.sync(()=>{console.warn(...e)}),unsafe:console};e.s(["consoleTag",0,E,"defaultConsole",0,w],389630);var _=e.i(526886),k=e.i(408043),x=e.i(686434);let C=Symbol.for("effect/Random"),I=s.GenericTag("effect/Random");class T{seed;[C]=C;PRNG;constructor(e){this.seed=e,this.PRNG=new x.PCGRandom(e)}get next(){return c.sync(()=>this.PRNG.number())}get nextBoolean(){return c.map(this.next,e=>e>.5)}get nextInt(){return c.sync(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(e,t){return c.map(this.next,r=>(t-e)*r+e)}nextIntBetween(e,t){return c.sync(()=>this.PRNG.integer(t-e)+e)}shuffle(e){return R(e,e=>this.nextIntBetween(0,e))}}let R=(e,t)=>c.suspend(()=>(0,l.pipe)(c.sync(()=>Array.from(e)),c.flatMap(e=>{let r=[];for(let t=e.length;t>=2;t-=1)r.push(t);return(0,l.pipe)(r,c.forEachSequentialDiscard(r=>(0,l.pipe)(t(r),c.map(t=>O(e,r-1,t)))),c.as(_.fromIterable(e)))}))),O=(e,t,r)=>{let i=e[t];return e[t]=e[r],e[r]=i,e},F=e=>new T(k.hash(e));class M{values;[C]=C;index=0;constructor(e){if(this.values=e,0===e.length)throw Error("Requires at least one value")}getNextValue(){let e=this.values[this.index];return this.index=(this.index+1)%this.values.length,e}get next(){return c.sync(()=>{let e=this.getNextValue();return"number"==typeof e?Math.max(0,Math.min(1,e)):k.hash(e)/0x7fffffff})}get nextBoolean(){return c.sync(()=>{let e=this.getNextValue();return"boolean"==typeof e?e:k.hash(e)%2==0})}get nextInt(){return c.sync(()=>{let e=this.getNextValue();return"number"==typeof e&&Number.isFinite(e)?Math.round(e):Math.abs(k.hash(e))})}nextRange(e,t){return c.map(this.next,r=>(t-e)*r+e)}nextIntBetween(e,t){return c.sync(()=>{let r=this.getNextValue();return"number"==typeof r&&Number.isFinite(r)?Math.max(e,Math.min(t-1,Math.round(r))):e+Math.abs(k.hash(r))%(t-e)})}shuffle(e){return R(e,e=>this.nextIntBetween(0,e))}}e.s(["RandomTypeId",0,C,"fixed",0,e=>new M(e),"make",0,F,"randomTag",0,I],972075);let A=Symbol.for("effect/Tracer"),N=e=>({[A]:A,...e}),P=s.GenericTag("effect/Tracer"),D=s.GenericTag("effect/ParentSpan"),L=(n=(i="abcdef0123456789").length,function(e){let t="";for(let r=0;r<e;r++)t+=i.charAt(Math.floor(Math.random()*n));return t});class U{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor(e,t,r,i,n,a){this.name=e,this.parent=t,this.context=r,this.startTime=n,this.kind=a,this.status={_tag:"Started",startTime:n},this.attributes=new Map,this.traceId="Some"===t._tag?t.value.traceId:L(32),this.spanId=L(16),this.links=Array.from(i)}end(e,t){this.status={_tag:"Ended",endTime:e,exit:t,startTime:this.status.startTime}}attribute(e,t){this.attributes.set(e,t)}event(e,t,r){this.events.push([e,t,r??{}])}addLinks(e){this.links.push(...e)}}let z=N({span:(e,t,r,i,n,a)=>new U(e,t,r,i,n,a),context:e=>e()}),j=s.Reference()("effect/Tracer/DisablePropagation",{defaultValue:l.constFalse});e.s(["DisablePropagation",0,j,"TracerTypeId",0,A,"addSpanStackTrace",0,e=>{if(e?.captureStackTrace===!1||e?.captureStackTrace!==void 0&&"boolean"!=typeof e.captureStackTrace)return e;let t=Error.stackTraceLimit;Error.stackTraceLimit=3;let r=Error();Error.stackTraceLimit=t;let i=!1;return{...e,captureStackTrace:()=>{if(!1!==i)return i;if(void 0!==r.stack){let e=r.stack.split("\n");if(void 0!==e[3])return i=e[3].trim()}}}},"externalSpan",0,e=>({_tag:"ExternalSpan",spanId:e.spanId,traceId:e.traceId,sampled:e.sampled??!0,context:e.context??s.empty()}),"make",0,N,"nativeTracer",0,z,"spanTag",0,D,"tracerTag",0,P],601009);let W=(0,l.pipe)(s.empty(),s.add(f,b()),s.add(E,w),s.add(I,F(Math.random())),s.add(S.configProviderTag,S.fromEnv()),s.add(P,z)),q=(0,u.globalValue)(Symbol.for("effect/DefaultServices/currentServices"),()=>c.fiberRefUnsafeMakeContext(W)),$=e=>c.withFiberRuntime(t=>e(t.currentDefaultServices)),B=e=>$(t=>e(t.unsafeMap.get(f.key))),H=B(e=>e.currentTimeMillis),V=B(e=>e.currentTimeNanos),J=(0,l.dual)(2,(e,t)=>c.fiberRefLocallyWith(q,s.add(f,t))(e)),G=(0,l.dual)(2,(e,t)=>c.fiberRefLocallyWith(q,s.add(S.configProviderTag,t))(e)),K=e=>$(t=>e(t.unsafeMap.get(S.configProviderTag.key))),Z=e=>$(t=>e(t.unsafeMap.get(I.key))),Q=(0,l.dual)(2,(e,t)=>c.fiberRefLocallyWith(q,s.add(I,t))(e)),Y=Z(e=>e.next),X=Z(e=>e.nextInt),ee=Z(e=>e.nextBoolean),et=(0,l.dual)(2,(e,t)=>c.fiberRefLocallyWith(q,s.add(P,t))(e));e.s(["choice",0,e=>{let t=a.fromIterable(e);return c.map(0===t.length?c.fail(new c.NoSuchElementException("Cannot select a random element from an empty array")):Z(e=>e.nextIntBetween(0,t.length)),e=>t[e])},"clockWith",0,B,"config",0,e=>K(t=>t.load(e)),"configProviderWith",0,K,"currentServices",0,q,"currentTimeMillis",0,H,"currentTimeNanos",0,V,"next",0,Y,"nextBoolean",0,ee,"nextInt",0,X,"nextIntBetween",0,(e,t)=>Z(r=>r.nextIntBetween(e,t)),"nextRange",0,(e,t)=>Z(r=>r.nextRange(e,t)),"randomWith",0,Z,"shuffle",0,e=>Z(t=>t.shuffle(e)),"sleep",0,e=>{let t=o.decode(e);return B(e=>e.sleep(t))},"tracerWith",0,e=>$(t=>e(t.unsafeMap.get(P.key))),"withClock",0,J,"withConfigProvider",0,G,"withRandom",0,Q,"withTracer",0,et],374132)},293889,e=>{"use strict";e.i(526886);var t=e.i(433366);e.i(649488);var r=e.i(964665),i=e.i(842862);e.i(838927),e.i(65632);var n=e.i(100808),a=e.i(541581);e.i(580611);var s=e.i(374132),o=e.i(874995),l=e.i(874264),u=e.i(376799);e.i(435146);let c=Symbol.for("effect/Secret");({...u.proto,[c]:c});let p=Symbol.for("effect/Config"),f={...o.CommitPrototype,[p]:{_A:e=>e},commit(){return s.config(this)}},d=(0,i.dual)(2,(e,t)=>m(e,e=>r.right(t(e)))),h=(0,i.dual)(2,(e,t)=>m(e,e=>{try{return r.right(t(e))}catch(e){return r.left(a.InvalidData([],e instanceof Error?e.message:`${e}`))}})),m=(0,i.dual)(2,(e,t)=>{let r=Object.create(f);return r._tag=l.OP_MAP_OR_FAIL,r.original=e,r.mapOrFail=t,r}),g=(0,i.dual)(2,(e,t)=>{let r=Object.create(f);return r._tag=l.OP_NESTED,r.name=t,r.config=e,r}),y=(0,i.dual)(2,(e,t)=>{let r=Object.create(f);return r._tag=l.OP_FALLBACK,r.first=e,r.second=E(t),r.condition=i.constTrue,r}),b=(0,i.dual)(2,(e,t)=>{let r=Object.create(f);return r._tag=l.OP_FALLBACK,r.first=e,r.second=E(t.orElse),r.condition=t.if,r}),S=(e,t)=>{let r=Object.create(f);return r._tag=l.OP_PRIMITIVE,r.description=e,r.parse=t,r},v=e=>{let t=Object.create(f);return t._tag=l.OP_CONSTANT,t.value=e,t.parse=()=>r.right(e),t},E=e=>{let t=Object.create(f);return t._tag=l.OP_LAZY,t.config=e,t},w=(0,i.dual)(2,(e,r)=>b(e,{orElse:()=>v(r),if:t.isMissingDataOnly}));(e,t,r)=>{let i=Object.create(f);return i._tag=l.OP_ZIP_WITH,i.left=e,i.right=t,i.zip=r,i},e.s(["boolean",0,e=>{let t=S("a boolean property",e=>{switch(e){case"true":case"yes":case"on":case"1":return r.right(!0);case"false":case"no":case"off":case"0":return r.right(!1);default:{let t=a.InvalidData([],`Expected a boolean value but received ${e}`);return r.left(t)}}});return void 0===e?t:g(t,e)},"literal",0,(...e)=>t=>{let i=e.map(String).join(", "),n=S(`one of (${i})`,t=>{let n=e.find(e=>String(e)===t);return void 0===n?r.left(a.InvalidData([],`Expected one of (${i}) but received ${t}`)):r.right(n)});return void 0===t?n:g(n,t)},"map",0,d,"mapAttempt",0,h,"mapOrFail",0,m,"nested",0,g,"orElse",0,y,"string",0,e=>{let t=S("a text property",r.right);return void 0===e?t:g(t,e)},"succeed",0,v,"withDefault",0,w],293889)},64317,e=>{"use strict";let t;var r=e.i(580611),i=e.i(260082),n=e.i(874995);e.i(100808);let a=i.struct,s=i.Structural;i.Structural;let o=(t=Symbol.for("effect/Data/Error/plainArgs"),class extends r.YieldableError{constructor(e){super(e?.message,e?.cause?{cause:e.cause}:void 0),e&&(Object.assign(this,e),Object.defineProperty(this,t,{value:e,enumerable:!1}))}toJSON(){return{...this[t],...this}}});e.s(["Class",0,s,"Error",0,o,"TaggedError",0,e=>{let t=class extends o{_tag=e};return t.prototype.name=e,t},"array",0,e=>Object.setPrototypeOf(e.slice(0),i.ArrayProto),"struct",0,a,"tagged",0,e=>t=>{let r=void 0===t?Object.create(n.StructuralPrototype):a(t);return r._tag=e,r}])},321172,e=>{"use strict";var t=e.i(842862),r=e.i(580611),i=e.i(931499),n=e.i(129248);let a=r.logLevelAll,s=r.logLevelFatal,o=r.logLevelError,l=r.logLevelWarning,u=r.logLevelInfo,c=r.logLevelDebug,p=r.logLevelTrace,f=r.logLevelNone,d=r.allLogLevels,h=(0,t.pipe)(i.Order,n.mapInput(e=>e.ordinal)),m=n.greaterThan(h);e.s(["Debug",0,c,"Error",0,o,"Fatal",0,s,"Info",0,u,"Trace",0,p,"Warning",0,l,"allLevels",0,d,"fromLiteral",0,e=>{switch(e){case"All":return a;case"Debug":return c;case"Error":return o;case"Fatal":return s;case"Info":return u;case"Trace":return p;case"None":return f;case"Warning":return l}},"greaterThan",0,m])},330709,385510,213979,568819,973165,684823,868225,423616,742502,374536,803327,64176,939798,395649,368171,874559,137696,12653,190512,322813,628555,764120,276406,e=>{"use strict";let t,r,i;var n=e.i(266493),a=e.i(842862),s=e.i(129248),o=e.i(100808);o.isBoolean,n.boolean,s.boolean;let l=e=>!e;(e,t)=>!e&&t||e&&!t,e.s(["not",0,l],330709);var u=e.i(435146),c=e.i(526886),p=e.i(777865),f=e.i(580611);e.i(957502).DeferredTypeId;let d=f.deferredMake;f.deferredMakeAs;let h=f.deferredAwait;f.deferredComplete,f.deferredCompleteWith;let m=f.deferredDone,g=f.deferredFail;f.deferredFailSync;let y=f.deferredFailCause;f.deferredFailCauseSync,f.deferredDie,f.deferredDieSync;let b=f.deferredInterrupt;f.deferredInterruptWith;let S=f.deferredIsDone,v=f.deferredPoll,E=f.deferredSucceed;f.deferredSync;let w=f.deferredUnsafeMake,_=f.deferredUnsafeDone;e.s(["await",()=>h,"done",0,m,"fail",0,g,"failCause",0,y,"interrupt",0,b,"isDone",0,S,"make",0,d,"poll",0,v,"succeed",0,E,"unsafeDone",0,_,"unsafeMake",0,w],385510);var k=e.i(680465);let x="Sequential",C="Parallel",I="ParallelN",T={_tag:x},R={_tag:C},O=e=>({_tag:I,parallelism:e}),F=e=>e._tag===x,M=e=>e._tag===C,A=(0,a.dual)(2,(e,t)=>{switch(e._tag){case x:return t.onSequential();case C:return t.onParallel();case I:return t.onParallelN(e.parallelism)}});e.s(["isParallel",0,M,"isParallelN",0,e=>e._tag===I,"isSequential",0,F,"match",0,A,"parallel",0,R,"parallelN",0,O,"sequential",0,T],213979),e.s(["parallel",0,R,"parallelN",0,O,"sequential",0,T],568819);var N=e.i(500577),P=e.i(945831),D=e.i(838927),L=e.i(65632),U=e.i(787039);function z(e){return new q(e)}function j(){return z(new Map)}let W=Symbol.for("effect/FiberRefs");class q{locals;[W]=W;constructor(e){this.locals=e}pipe(){return(0,U.pipeArguments)(this,arguments)}}let $=(0,a.dual)(3,(e,t,r)=>{let i=new Map(e.locals);return r.locals.forEach((e,r)=>{let n=e[0][1];if(!e[0][0][P.symbol](t)){if(!i.has(r)){if(P.equals(n,r.initial))return;i.set(r,[[t,r.join(r.initial,n)]]);return}let a=i.get(r),[s,o]=((e,t,r,i=!1)=>{let n,a=t,s=r,o=i;for(;void 0===n;)if(u.isNonEmptyReadonlyArray(a)&&u.isNonEmptyReadonlyArray(s)){let e=u.headNonEmpty(a)[0],t=u.tailNonEmpty(a),r=u.headNonEmpty(s)[0],i=u.headNonEmpty(s)[1],l=u.tailNonEmpty(s);e.startTimeMillis<r.startTimeMillis?(s=l,o=!0):e.startTimeMillis>r.startTimeMillis?a=t:e.id<r.id?(s=l,o=!0):e.id>r.id?a=t:n=[i,o]}else n=[e.initial,!0];return n})(r,a,e);if(o){let e=r.diff(s,n),o=a[0][1],l=r.join(o,r.patch(e)(o));if(!P.equals(o,l)){let e,n=a[0][0];e=n[P.symbol](t)?[[n,l],...a.slice(1)]:[[t,l],...a],i.set(r,e)}}}}),new q(i)}),B=(0,a.dual)(2,(e,t)=>{let r=new Map;return H(e,r,t),new q(r)}),H=(e,t,r)=>{e.locals.forEach((e,i)=>{let n=e[0][1],a=i.patch(i.fork)(n);P.equals(n,a)?t.set(i,e):t.set(i,[[r,a],...e])})},V=e=>D.fromIterable(e.locals.keys()),J=e=>f.forEachSequentialDiscard(V(e),t=>f.fiberRefSet(t,Z(e,t))),G=(0,a.dual)(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new q(r)}),K=(0,a.dual)(2,(e,t)=>e.locals.has(t)?L.some(u.headNonEmpty(e.locals.get(t))[1]):L.none()),Z=(0,a.dual)(2,(e,t)=>(0,a.pipe)(K(e,t),L.getOrElse(()=>t.initial))),Q=(0,a.dual)(2,(e,{fiberId:t,fiberRef:r,value:i})=>{if(0===e.locals.size)return new q(new Map([[r,[[t,i]]]]));let n=new Map(e.locals);return Y(n,t,r,i),new q(n)}),Y=(e,t,r,i)=>{let n,a=e.get(r)??[];if(u.isNonEmptyReadonlyArray(a)){let[e,r]=u.headNonEmpty(a);if(e[P.symbol](t))if(P.equals(r,i))return;else n=[[t,i],...a.slice(1)];else n=[[t,i],...a]}else n=[[t,i]];e.set(r,n)},X=(0,a.dual)(2,(e,{entries:t,forkAs:r})=>{if(0===e.locals.size)return new q(new Map(t));let i=new Map(e.locals);return void 0!==r&&H(e,i,r),t.forEach(([e,t])=>{1===t.length?Y(i,t[0][0],e,t[0][1]):t.forEach(([t,r])=>{Y(i,t,e,r)})}),new q(i)});e.s(["FiberRefsSym",0,W,"delete_",0,G,"empty",()=>j,"fiberRefs",0,V,"forkAs",0,B,"get",0,K,"getOrDefault",0,Z,"joinAs",0,$,"setAll",0,J,"unsafeMake",()=>z,"updateAs",0,Q,"updateManyAs",0,X],973165),e.s(["delete",()=>G,"empty",0,j,"get",0,K,"getOrDefault",0,Z,"joinAs",0,$,"setAll",0,J,"updateAs",0,Q,"updateManyAs",0,X],684823);let ee="Empty",et="Remove",er="Update",ei="AndThen",en={_tag:ee},ea=(e,t)=>{let r=new Map(e.locals),i=en;for(let[e,n]of t.locals.entries()){let t=u.headNonEmpty(n)[1],a=r.get(e);if(void 0!==a){let r=u.headNonEmpty(a)[1];(0,P.equals)(r,t)||(i=es({_tag:er,fiberRef:e,patch:e.diff(r,t)})(i))}else i=es({_tag:"Add",fiberRef:e,value:t})(i);r.delete(e)}for(let[e]of r.entries())i=es({_tag:et,fiberRef:e})(i);return i},es=(0,a.dual)(2,(e,t)=>({_tag:ei,first:e,second:t})),eo=(0,a.dual)(3,(e,t,r)=>{let i=r,n=u.of(e);for(;u.isNonEmptyReadonlyArray(n);){let e=u.headNonEmpty(n),r=u.tailNonEmpty(n);switch(e._tag){case ee:n=r;break;case"Add":i=Q(i,{fiberId:t,fiberRef:e.fiberRef,value:e.value}),n=r;break;case et:i=G(i,e.fiberRef),n=r;break;case er:{let a=Z(i,e.fiberRef);i=Q(i,{fiberId:t,fiberRef:e.fiberRef,value:e.fiberRef.patch(e.patch)(a)}),n=r;break}case ei:n=u.prepend(e.first)(u.prepend(e.second)(r))}}return i});e.s(["diff",0,ea,"patch",0,eo],868225);var el=e.i(408043);let eu="effect/FiberStatus",ec=Symbol.for(eu),ep="Done",ef="Running",ed="Suspended",eh=el.string(`${eu}-${ep}`);class em{[ec]=ec;_tag=ep;[el.symbol](){return eh}[P.symbol](e){return eS(e)&&e._tag===ep}}class eg{runtimeFlags;[ec]=ec;_tag=ef;constructor(e){this.runtimeFlags=e}[el.symbol](){return(0,a.pipe)(el.hash(eu),el.combine(el.hash(this._tag)),el.combine(el.hash(this.runtimeFlags)),el.cached(this))}[P.symbol](e){return eS(e)&&e._tag===ef&&this.runtimeFlags===e.runtimeFlags}}class ey{runtimeFlags;blockingOn;[ec]=ec;_tag=ed;constructor(e,t){this.runtimeFlags=e,this.blockingOn=t}[el.symbol](){return(0,a.pipe)(el.hash(eu),el.combine(el.hash(this._tag)),el.combine(el.hash(this.runtimeFlags)),el.combine(el.hash(this.blockingOn)),el.cached(this))}[P.symbol](e){return eS(e)&&e._tag===ed&&this.runtimeFlags===e.runtimeFlags&&P.equals(this.blockingOn,e.blockingOn)}}let eb=new em,eS=e=>(0,o.hasProperty)(e,ec),ev=e=>new eg(e);var eE=e.i(402409),ew=e.i(214250),e_=e.i(580537),ek=e.i(321172),ex=e.i(700157),eC=e.i(727606),eI=k;let eT=Symbol.for("effect/Readable");e.s(["TypeId",0,eT],423616);let eR=Symbol.for("effect/Ref"),eO={_A:e=>e};class eF extends eI.Class{ref;commit(){return this.get}[eR]=eO;[eT]=eT;constructor(e){super(),this.ref=e,this.get=f.sync(()=>eC.get(this.ref))}get;modify(e){return f.sync(()=>{let t=eC.get(this.ref),[r,i]=e(t);return t!==i&&eC.set(i)(this.ref),r})}}let eM=e=>new eF(eC.make(e)),eA=e=>f.sync(()=>eM(e)),eN=e=>e.get,eP=(0,a.dual)(2,(e,t)=>e.modify(()=>[void 0,t])),eD=(0,a.dual)(2,(e,t)=>e.modify(e=>[e,t])),eL=(0,a.dual)(2,(e,t)=>e.modify(e=>[e,t(e)])),eU=(0,a.dual)(2,(e,t)=>e.modify(e=>{let r=t(e);switch(r._tag){case"None":return[e,e];case"Some":return[e,r.value]}})),ez=(0,a.dual)(2,(e,t)=>e.modify(()=>[t,t])),ej=(0,a.dual)(2,(e,t)=>e.modify(t)),eW=(0,a.dual)(3,(e,t,r)=>e.modify(e=>{let i=r(e);switch(i._tag){case"None":return[t,e];case"Some":return i.value}})),eq=(0,a.dual)(2,(e,t)=>e.modify(e=>[void 0,t(e)])),e$=(0,a.dual)(2,(e,t)=>e.modify(e=>{let r=t(e);return[r,r]})),eB=(0,a.dual)(2,(e,t)=>e.modify(e=>[void 0,L.match(t(e),{onNone:()=>e,onSome:e=>e})])),eH=(0,a.dual)(2,(e,t)=>e.modify(e=>{let r=t(e);switch(r._tag){case"None":return[e,e];case"Some":return[r.value,r.value]}}));e.s(["RefTypeId",0,eR,"get",0,eN,"getAndSet",0,eD,"getAndUpdate",0,eL,"getAndUpdateSome",0,eU,"make",0,eA,"modify",0,ej,"modifySome",0,eW,"refVariance",0,eO,"set",0,eP,"setAndGet",0,ez,"unsafeMake",0,eM,"update",0,eq,"updateAndGet",0,e$,"updateSome",0,eB,"updateSomeAndGet",0,eH],742502),e.s(["get",0,eN,"getAndSet",0,eD,"make",0,eA,"modify",0,ej,"set",0,eP,"update",0,eq],374536);var eV=e.i(248726);class eJ{buckets=[];scheduleTask(e,t){let r,i=this.buckets.length,n=0;for(;n<i;n++)if(this.buckets[n][0]<=t)r=this.buckets[n];else break;r&&r[0]===t?r[1].push(e):n===i?this.buckets.push([t,[e]]):this.buckets.splice(n,0,[t,[e]])}}class eG{maxNextTickBeforeTimer;running=!1;tasks=new eJ;constructor(e){this.maxNextTickBeforeTimer=e}starveInternal(e){let t=this.tasks.buckets;for(let[e,r]of(this.tasks.buckets=[],t))for(let e=0;e<r.length;e++)r[e]();0===this.tasks.buckets.length?this.running=!1:this.starve(e)}starve(e=0){e>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(e+1))}shouldYield(e){return e.currentOpCount>e.getFiberRef(f.currentMaxOpsBeforeYield)&&e.getFiberRef(f.currentSchedulingPriority)}scheduleTask(e,t){this.tasks.scheduleTask(e,t),this.running||(this.running=!0,this.starve())}}let eK=(0,eE.globalValue)(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new eG(2048));class eZ{tasks=new eJ;deferred=!1;scheduleTask(e,t){this.deferred?eK.scheduleTask(e,t):this.tasks.scheduleTask(e,t)}shouldYield(e){return e.currentOpCount>e.getFiberRef(f.currentMaxOpsBeforeYield)&&e.getFiberRef(f.currentSchedulingPriority)}flush(){for(;this.tasks.buckets.length>0;){let e=this.tasks.buckets;for(let[t,r]of(this.tasks.buckets=[],e))for(let e=0;e<r.length;e++)r[e]()}this.deferred=!0}}let eQ=(0,eE.globalValue)(Symbol.for("effect/FiberRef/currentScheduler"),()=>f.fiberRefUnsafeMake(eK)),eY=(0,a.dual)(2,(e,t)=>f.fiberRefLocally(e,eQ,t));e.s(["SyncScheduler",()=>eZ,"currentScheduler",0,eQ,"withScheduler",0,eY],803327);var eX=e.i(686434),e0=e.i(215139),e1=e.i(129627),e2=e.i(932213);let e6=(0,eE.globalValue)(Symbol.for("effect/FiberRef/currentRequestMap"),()=>(0,f.fiberRefUnsafeMake)(new Map)),e3=(e,t,r,i)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return f.fiberRefGetWith(f.currentConcurrency,e=>"unbounded"===e?r():e>1?i(e):t());default:return e>1?i(e):t()}},e4=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return f.fiberRefGetWith(f.currentConcurrency,e=>"unbounded"===e||e>1?r():t());default:return e>1?r():t()}};var e5=e.i(436518),e8=e.i(374132);e2.ClockTypeId,e2.make;let e7=e8.sleep,e9=e8.currentTimeMillis,te=e8.currentTimeNanos,tt=e8.clockWith,tr=e2.clockTag;e.s(["Clock",0,tr,"clockWith",0,tt,"currentTimeMillis",0,e9,"currentTimeNanos",0,te,"sleep",0,e7],64176);var ti=e.i(649488),tn=e.i(807816);let ta=e=>e.replace(/[\s="]/g,"_"),ts=e=>t=>{let r=ta(t.label);return`${r}=${e-t.startTime}ms`};var to=e.i(601009);to.TracerTypeId;let tl=to.spanTag;to.tracerTag,to.make;let tu=to.externalSpan,tc=e8.tracerWith;to.DisablePropagation,e.s(["ParentSpan",0,tl,"externalSpan",0,tu,"tracerWith",0,tc],939798);var tp=e.i(717222);let tf="effect/MetricLabel",td=Symbol.for(tf);class th{key;value;[td]=td;_hash;constructor(e,t){this.key=e,this.value=t,this._hash=el.string(tf+this.key+this.value)}[el.symbol](){return this._hash}[P.symbol](e){return tg(e)&&this.key===e.key&&this.value===e.value}pipe(){return(0,U.pipeArguments)(this,arguments)}}let tm=(e,t)=>new th(e,t),tg=e=>(0,o.hasProperty)(e,td);var ty=e.i(399683);let tb=(0,a.dual)(e=>f.isEffect(e[0]),function(){let e=arguments;return f.fiberRefLocallyWith(e[0],f.currentLogAnnotations,"string"==typeof e[1]?ew.set(e[1],e[2]):t=>Object.entries(e[1]).reduce((e,[t,r])=>ew.set(e,t,r),t))}),tS=e=>f.map(e,L.some),tv=e=>{let t,r;return"function"==typeof e?t=e:(t=e.try,r=e.catch),f.suspend(()=>{try{return f.succeed((0,eX.internalCall)(t))}catch(e){return f.fail(r?(0,eX.internalCall)(()=>r(e)):new f.UnknownException(e,"An unknown error occurred in Effect.try"))}})},tE=(0,a.dual)(3,(e,t,r)=>f.catchAll(e,e=>o.hasProperty(e,t)&&e[t]===r.failure?r.onFailure(e):f.fail(e))),tw=(0,a.dual)(2,(e,t)=>f.catchAllCause(e,e=>{let r=e1.find(e,e=>e1.isDieType(e)?L.some(e):L.none());switch(r._tag){case"None":return f.failCause(e);case"Some":return t(r.value.defect)}})),t_=(0,a.dual)(2,(e,t)=>f.matchCauseEffect(e,{onFailure:e=>{let r=t(e);switch(r._tag){case"None":return f.failCause(e);case"Some":return r.value}},onSuccess:f.succeed})),tk=(0,a.dual)(2,(e,t)=>f.catchAllCause(e,e=>{let r=e1.find(e,e=>e1.isDieType(e)?L.some(e):L.none());switch(r._tag){case"None":return f.failCause(e);case"Some":{let i=t(r.value.defect);return"Some"===i._tag?i.value:f.failCause(e)}}})),tx=(0,a.dual)(e=>f.isEffect(e[0]),(e,...t)=>{let r,i=t[t.length-1];return r=2===t.length?o.isTagged(t[0]):e=>{let r=o.hasProperty(e,"_tag")?e._tag:void 0;if(!r)return!1;for(let e=0;e<t.length-1;e++)if(t[e]===r)return!0;return!1},f.catchIf(e,r,i)}),tC=(0,a.dual)(2,(e,t)=>{let r;return f.catchIf(e,e=>(r??=Object.keys(t),o.hasProperty(e,"_tag")&&o.isString(e._tag)&&r.includes(e._tag)),e=>t[e._tag](e))}),tI=tt(f.succeed),tT=(0,a.dual)(2,(e,t)=>f.zipRight(e7(t),e)),tR=e=>f.withFiberRuntime((t,r)=>e({id:t.id(),status:r,interruptors:e1.interruptors(t.getFiberRef(f.currentInterruptedCause))})),tO=tR(e=>D.size(e.interruptors)>0?f.interrupt:f.void),tF=tR(f.succeed),tM=f.succeed({}),tA=tp.bind(f.map,f.flatMap),tN=tp.bindTo(f.map),tP=tp.let_(f.map),tD=(0,a.dual)(2,(e,t)=>f.suspend(()=>{let r,i=e[Symbol.iterator](),n=[],a=f.succeed(!1),s=0;for(;(r=i.next())&&!r.done;){let e=r.value,i=s++;a=f.flatMap(a,r=>r?(n.push(e),f.succeed(!0)):t(e,i))}return f.map(a,()=>n)})),tL=(0,a.dual)(2,(e,t)=>f.suspend(()=>{let r,i=e[Symbol.iterator](),n=[],a=f.succeed(!0),s=0;for(;(r=i.next())&&!r.done;){let e=r.value,i=s++;a=f.flatMap(a,r=>f.map(r?t(e,i):f.succeed(!1),t=>(t||n.push(e),t)))}return f.map(a,()=>n)})),tU=e=>f.orElse(e,()=>f.flatMap(f.yieldNow(),()=>tU(e))),tz=(0,a.dual)(2,(e,t)=>f.map(f.forEachSequential(e,a.identity),u.filterMap(t))),tj=(0,a.dual)(3,(e,t,r)=>tq(e,t,e=>f.dieSync(()=>r(e)))),tW=(0,a.dual)(3,(e,t,r)=>tq(e,t,()=>f.dieMessage(r))),tq=(0,a.dual)(3,(e,t,r)=>f.flatMap(e,e=>t(e)?f.succeed(e):r(e))),t$=(0,a.dual)(3,(e,t,r)=>f.suspend(()=>t(e)?f.succeed(e):f.fail(r(e)))),tB=(0,a.dual)(e=>f.isEffect(e[0]),(e,t,r)=>tq(e,t,e=>void 0===r?f.fail(new f.NoSuchElementException):f.failSync(()=>r(e)))),tH=(0,a.dual)(2,(e,t)=>f.suspend(()=>{let r=e[Symbol.iterator](),i=r.next();return i.done?f.succeed(L.none()):tV(r,0,t,i.value)})),tV=(e,t,r,i)=>f.flatMap(r(i,t),n=>{if(n)return f.succeed(L.some(i));let a=e.next();return a.done?f.succeed(L.none()):tV(e,t+1,r,a.value)}),tJ=(0,a.dual)(2,(e,t)=>f.flip(t(f.flip(e)))),tG=(0,a.dual)(2,(e,t)=>f.matchEffect(e,{onFailure:e=>f.succeed(t.onFailure(e)),onSuccess:e=>f.succeed(t.onSuccess(e))})),tK=(0,a.dual)(2,(e,t)=>f.suspend(()=>tZ(e[Symbol.iterator](),0,t))),tZ=(e,t,r)=>{let i=e.next();return i.done?f.succeed(!0):f.flatMap(r(i.value,t),i=>i?tZ(e,t+1,r):f.succeed(i))},tQ=e=>{let t=f.flatMap(f.flatMap(e,()=>f.yieldNow()),()=>t);return t},tY=f.withFiberRuntime(e=>f.succeed(e.getFiberRefs())),tX=e=>tG(e,{onFailure:a.constVoid,onSuccess:a.constVoid}),t0=(e,t)=>f.suspend(()=>t.while(e)?f.flatMap(t.body(e),e=>t0(e,t)):f.succeed(e)),t1=e=>(...t)=>{let r,i=L.fromNullable(e);for(let e=0,i=t.length;e<i;e++){let i=t[e];e1.isCause(i)&&(r=void 0!==r?e1.sequential(r,i):i,t=[...t.slice(0,e),...t.slice(e+1)],e--)}return void 0===r&&(r=e1.empty),f.withFiberRuntime(e=>(e.log(t,r,i),f.void))},t2=t1(),t6=t1(ek.Trace),t3=t1(ek.Debug),t4=t1(ek.Info),t5=t1(ek.Warning),t8=t1(ek.Error),t7=t1(ek.Fatal),t9=(0,a.dual)(2,(e,t)=>f.flatMap(e9,r=>f.fiberRefLocallyWith(e,f.currentLogSpan,tn.prepend({label:t,startTime:r})))),re=f.fiberRefGet(f.currentLogAnnotations),rt=(e,t,r,i)=>f.suspend(()=>t(e)?f.flatMap(i(e),n=>f.map(rt(r(e),t,r,i),tn.prepend(n))):f.sync(()=>tn.empty())),rr=(e,t,r,i)=>f.suspend(()=>t(e)?f.flatMap(i(e),()=>rr(r(e),t,r,i)):f.void),ri=(0,a.dual)(3,(e,t,r)=>f.suspend(()=>{let i,n=e[Symbol.iterator](),a=[],s=f.succeed(t),o=0;for(;!(i=n.next()).done;){let e=o++,t=i.value;s=f.flatMap(s,i=>f.map(r(i,t,e),([e,t])=>(a.push(t),e)))}return f.map(s,e=>[e,a])})),rn=(0,a.dual)(2,(e,t)=>f.matchCauseEffect(e,{onFailure:e=>f.failCauseSync(()=>t(e)),onSuccess:f.succeed})),ra=e=>f.map(eA(!0),t=>f.asVoid(f.whenEffect(e,eD(t,!1)))),rs=(0,a.dual)(2,(e,t)=>f.orElse(e,()=>f.failSync(t))),ro=(0,a.dual)(2,(e,t)=>f.orElse(e,()=>f.sync(t))),rl=e=>rD((t,r)=>(0,a.pipe)(e,eo(t,r))),ru=(0,a.dual)(3,(e,t,r)=>f.contextWithEffect(i=>f.provideContext(e,p.add(i,t,r)))),rc=(0,a.dual)(3,(e,t,r)=>f.contextWithEffect(i=>f.flatMap(r,r=>f.provideContext(e,(0,a.pipe)(i,p.add(t,r)))))),rp=e8.randomWith(f.succeed),rf=(0,a.dual)(3,(e,t,r)=>u.fromIterable(e).reduce((e,t,i)=>f.flatMap(e,e=>r(e,t,i)),f.succeed(t))),rd=(0,a.dual)(3,(e,t,r)=>u.fromIterable(e).reduceRight((e,t,i)=>f.flatMap(e,e=>r(t,e,i)),f.succeed(t))),rh=(0,a.dual)(3,(e,t,r)=>f.flatMap(f.sync(()=>e[Symbol.iterator]()),e=>rm(e,0,t,r.while,r.body))),rm=(e,t,r,i,n)=>{let a=e.next();return!a.done&&i(r)?f.flatMap(n(r,a.value,t),r=>rm(e,t+1,r,i,n)):f.succeed(r)},rg=(0,a.dual)(2,(e,t)=>f.suspend(()=>ry(e,t))),ry=(e,t)=>f.flatMap(e,r=>t<=0?f.succeed(r):f.zipRight(f.yieldNow(),ry(e,t-1))),rb=f.succeed(L.none()),rS=(0,a.dual)(3,(e,t,r)=>f.flatMap(t,i=>f.flatMap(e,e=>f.map(t,t=>[r(i,t),e])))),rv=(0,a.dual)(e=>f.isEffect(e[0]),function(){return rE(arguments[0],"string"==typeof arguments[1]?[tm(arguments[1],arguments[2])]:Object.entries(arguments[1]).map(([e,t])=>tm(e,t)))}),rE=(0,a.dual)(2,(e,t)=>f.fiberRefLocallyWith(e,f.currentMetricLabels,e=>u.union(e,t))),rw=(0,a.dual)(2,(e,t)=>f.suspend(()=>{let r,i=e[Symbol.iterator](),n=[],a=f.succeed(!1),s=0;for(;(r=i.next())&&!r.done;){let e=r.value,i=s++;a=f.flatMap(a,r=>r?f.succeed(!0):(n.push(e),t(e,i)))}return f.map(a,()=>n)})),r_=(0,a.dual)(2,(e,t)=>f.suspend(()=>{let r,i=e[Symbol.iterator](),n=[],s=f.succeed(!0),o=0;for(;(r=i.next())&&!r.done;){let e=r.value,i=o++;s=f.flatMap(s,r=>(0,a.pipe)(r?t(e,i):f.succeed(!1),f.map(t=>(t&&n.push(e),t))))}return f.map(s,()=>n)})),rk=(0,a.dual)(2,(e,{onFailure:t,onSuccess:r})=>f.matchCauseEffect(e,{onFailure:e=>{let r=e1.failureOrCause(e);switch(r._tag){case"Left":return f.zipRight(t(r.left),f.failCause(e));case"Right":return f.failCause(e)}},onSuccess:e=>f.as(r(e),e)})),rx=(0,a.dual)(2,(e,t)=>f.catchAllCause(e,e=>L.match(e1.keepDefects(e),{onNone:()=>f.failCause(e),onSome:r=>f.zipRight(t(r),f.failCause(e))}))),rC=(0,a.dual)(2,(e,t)=>f.matchCauseEffect(e,{onFailure:e=>{let r=e1.failureOrCause(e);switch(r._tag){case"Left":return f.zipRight(t(r.left),f.failCause(e));case"Right":return f.failCause(e)}},onSuccess:f.succeed})),rI=(0,a.dual)(3,(e,t,r)=>rC(e,e=>o.isTagged(e,t)?r(e):f.void)),rT=(0,a.dual)(2,(e,t)=>f.matchCauseEffect(e,{onFailure:e=>f.zipRight(t(e),f.failCause(e)),onSuccess:f.succeed})),rR=(0,a.dual)(2,(e,t)=>rS(e,t,(e,t)=>ti.nanos(t-e))),rO=tc(f.succeed),rF=e=>{let t,r;"function"==typeof e?t=e:(t=e.try,r=e.catch);let i=e=>r?f.failSync(()=>r(e)):f.fail(new f.UnknownException(e,"An unknown error occurred in Effect.tryPromise"));return t.length>=1?f.async((e,r)=>{try{t(r).then(t=>e(f.exitSucceed(t)),t=>e(i(t)))}catch(t){e(i(t))}}):f.async(e=>{try{t().then(t=>e(f.exitSucceed(t)),t=>e(i(t)))}catch(t){e(i(t))}})},rM=(0,a.dual)(2,(e,t)=>f.flatMap(e,e=>tv({try:()=>t.try(e),catch:t.catch}))),rA=(0,a.dual)(2,(e,t)=>f.flatMap(e,e=>rF({try:t.try.length>=1?r=>t.try(e,r):()=>t.try(e),catch:t.catch}))),rN=(0,a.dual)(2,(e,t)=>f.suspend(()=>t()?rb:tS(e))),rP=(0,a.dual)(2,(e,t)=>f.flatMap(t,t=>t?rb:tS(e))),rD=e=>f.withFiberRuntime(t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),f.void)),rL=(0,a.dual)(3,(e,t,r)=>f.mapInputContext(e,e=>p.add(e,t,r(p.unsafeGet(e,t))))),rU=(0,a.dual)(2,(e,t)=>f.suspend(()=>t()?f.map(e,L.some):f.succeed(L.none()))),rz=(0,a.dual)(3,(e,t,r)=>f.flatMap(f.fiberRefGet(t),t=>r(t)?f.map(e,e=>[t,L.some(e)]):f.succeed([t,L.none()]))),rj=(0,a.dual)(3,(e,t,r)=>f.flatMap(eN(t),t=>r(t)?f.map(e,e=>[t,L.some(e)]):f.succeed([t,L.none()]))),rW=(0,a.dual)(2,(e,t)=>t(e)),rq=e=>new Proxy({},{get:(t,r,i)=>(...t)=>f.flatMap(e,e=>e[r](...t))}),r$=e=>new Proxy({},{get:(t,r,i)=>f.flatMap(e,e=>f.isEffect(e[r])?e[r]:f.succeed(e[r]))}),rB=e=>f.flatMap(f.context(),p.getOption(e)),rH=(0,a.dual)(e=>f.isEffect(e[0]),function(){let e=arguments;return f.fiberRefLocallyWith(e[0],f.currentTracerSpanAnnotations,"string"==typeof e[1]?ew.set(e[1],e[2]):t=>Object.entries(e[1]).reduce((e,[t,r])=>ew.set(e,t,r),t))}),rV=rB(to.spanTag),rJ=f.flatMap(f.context(),e=>{let t=e.unsafeMap.get(to.spanTag.key);return void 0!==t&&"Span"===t._tag?f.succeed(t):f.fail(new f.NoSuchElementException)}),rG=(0,a.dual)(e=>f.isEffect(e[0]),(e,t,r)=>f.fiberRefLocallyWith(e,f.currentTracerSpanLinks,c.append({_tag:"SpanLink",span:t,attributes:r??{}}))),rK=BigInt(0),rZ=L.flatMap(e=>p.get(e.context,to.DisablePropagation)?"Span"===e._tag?rZ(e.parent):L.none():L.some(e)),rQ=(e,t,r)=>{let i,n=!e.getFiberRef(f.currentTracerEnabled)||r.context&&p.get(r.context,to.DisablePropagation),a=e.getFiberRef(f.currentContext),s=r.parent?L.some(r.parent):r.root?L.none():rZ(p.getOption(a,to.spanTag));if(n)i=f.noopSpan({name:t,parent:s,context:p.add(r.context??p.empty(),to.DisablePropagation,!0)});else{let n=e.getFiberRef(e8.currentServices),a=p.get(n,to.tracerTag),o=p.get(n,tr),l=e.getFiberRef(f.currentTracerTimingEnabled),d=e.getFiberRefs(),h=K(d,f.currentTracerSpanAnnotations),m=K(d,f.currentTracerSpanLinks),g="Some"===m._tag?void 0!==r.links?[...c.toReadonlyArray(m.value),...r.links??[]]:c.toReadonlyArray(m.value):r.links??u.empty();i=a.span(t,s,r.context??p.empty(),g,l?o.unsafeCurrentTimeNanos():rK,r.kind??"internal"),"Some"===h._tag&&ew.forEach(h.value,(e,t)=>i.attribute(t,e)),void 0!==r.attributes&&Object.entries(r.attributes).forEach(([e,t])=>i.attribute(e,t))}return"function"==typeof r.captureStackTrace&&e1.spanToTrace.set(i,r.captureStackTrace),i},rY=f.fiberRefGet(f.currentTracerSpanAnnotations),rX=f.fiberRefGet(f.currentTracerSpanLinks),r0=(e,t,r,i)=>f.sync(()=>{"Ended"!==e.status._tag&&(f.exitIsFailure(t)&&e1.spanToTrace.has(e)&&e.attribute("code.stacktrace",e1.spanToTrace.get(e)()),e.end(i?r.unsafeCurrentTimeNanos():rK,t))}),r1=(e,...t)=>{let r=to.addSpanStackTrace(1===t.length?void 0:t[0]),i=t[t.length-1];return f.withFiberRuntime(t=>{let n=rQ(t,e,r),a=t.getFiberRef(f.currentTracerTimingEnabled),s=p.get(t.getFiberRef(e8.currentServices),e2.clockTag);return f.onExit(i(n),e=>r0(n,e,s,a))})},r2=(0,a.dual)(2,(e,t)=>ru(e,to.spanTag,t)),r6=function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=to.addSpanStackTrace(e?arguments[2]:arguments[1]);if(e){let e=arguments[0];return r1(t,r,t=>r2(e,t))}return e=>r1(t,r,t=>r2(e,t))};e.s(["Do",0,tM,"_catch",0,tE,"allowInterrupt",0,tO,"annotateCurrentSpan",0,function(){let e=arguments;return tX(f.flatMap(rJ,t=>f.sync(()=>{if("string"==typeof e[0])t.attribute(e[0],e[1]);else for(let r in e[0])t.attribute(r,e[0][r])})))},"annotateLogs",0,tb,"annotateSpans",0,rH,"asSome",0,tS,"asSomeError",0,e=>f.mapError(e,L.some),"bind",0,tA,"bindTo",0,tN,"catchAllDefect",0,tw,"catchSomeCause",0,t_,"catchSomeDefect",0,tk,"catchTag",0,tx,"catchTags",0,tC,"cause",0,e=>f.matchCause(e,{onFailure:a.identity,onSuccess:()=>e1.empty}),"clock",0,tI,"clockWith",0,tt,"contextWith",0,e=>f.map(f.context(),e),"currentParentSpan",0,rV,"currentSpan",0,rJ,"delay",0,tT,"descriptor",0,tF,"descriptorWith",0,tR,"diffFiberRefs",0,e=>rS(e,tY,ea),"dropUntil",0,tD,"dropWhile",0,tL,"endSpan",0,r0,"eventually",0,tU,"every",0,tK,"fiberRefs",0,tY,"filterMap",0,tz,"filterOrDie",0,tj,"filterOrDieMessage",0,tW,"filterOrElse",0,tq,"filterOrFail",0,tB,"findFirst",0,tH,"firstSuccessOf",0,e=>f.suspend(()=>{let t=c.fromIterable(e);return c.isNonEmpty(t)?(0,a.pipe)(c.tailNonEmpty(t),u.reduce(c.headNonEmpty(t),(e,t)=>f.orElse(e,()=>t))):f.dieSync(()=>new f.IllegalArgumentException("Received an empty collection of effects"))}),"flipWith",0,tJ,"forever",0,tQ,"fromNullable",0,e=>null==e?f.fail(new f.NoSuchElementException):f.succeed(e),"functionWithSpan",0,e=>function(){let t=e.captureStackTrace??!1;if(!1!==e.captureStackTrace){let e=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=Error();Error.stackTraceLimit=e;let i=!1;t=()=>!1!==i?i:r.stack?i=r.stack.trim().split("\n").slice(2).join("\n").trim():void 0}return f.suspend(()=>{let r="function"==typeof e.options?e.options.apply(null,arguments):e.options;return r6(f.suspend(()=>(0,eX.internalCall)(()=>e.body.apply(this,arguments))),r.name,{...r,captureStackTrace:t})})},"head",0,e=>f.flatMap(e,e=>{let t=e[Symbol.iterator]().next();return t.done?f.fail(new f.NoSuchElementException):f.succeed(t.value)}),"ignore",0,tX,"ignoreLogged",0,e=>f.matchCauseEffect(e,{onFailure:e=>t3(e,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>f.void}),"inheritFiberRefs",0,e=>rD((t,r)=>$(r,t,e)),"isFailure",0,e=>tG(e,{onFailure:a.constTrue,onSuccess:a.constFalse}),"isSuccess",0,e=>tG(e,{onFailure:a.constFalse,onSuccess:a.constTrue}),"iterate",0,t0,"labelMetrics",0,rE,"let_",0,tP,"liftPredicate",0,t$,"linkSpanCurrent",0,function(){let e=arguments,t=Array.isArray(e[0])?e[0]:[{_tag:"SpanLink",span:e[0],attributes:e[1]??{}}];return tX(f.flatMap(rJ,e=>f.sync(()=>e.addLinks(t))))},"linkSpans",0,rG,"log",0,t2,"logAnnotations",0,re,"logDebug",0,t3,"logError",0,t8,"logFatal",0,t7,"logInfo",0,t4,"logTrace",0,t6,"logWarning",0,t5,"logWithLevel",0,t1,"loop",0,(e,t)=>t.discard?rr(e,t.while,t.step,t.body):f.map(rt(e,t.while,t.step,t.body),u.fromIterable),"makeSpan",0,(e,t)=>(t=to.addSpanStackTrace(t),f.withFiberRuntime(r=>f.succeed(rQ(r,e,t)))),"mapAccum",0,ri,"mapErrorCause",0,rn,"match",0,tG,"memoize",0,e=>(0,a.pipe)(f.deferredMake(),f.flatMap(t=>(0,a.pipe)(rS(e,f.zip(tY,f.runtimeFlags),([e,t],[r,i])=>[ea(e,r),ty.diff(t,i)]),f.intoDeferred(t),ra,f.map(e=>f.zipRight(e,(0,a.pipe)(f.deferredAwait(t),f.flatMap(([e,t])=>f.as(f.zip(rl(e[0]),f.updateRuntimeFlags(e[1])),t)))))))),"merge",0,e=>f.matchEffect(e,{onFailure:e=>f.succeed(e),onSuccess:f.succeed}),"negate",0,e=>f.map(e,e=>!e),"none",0,e=>f.flatMap(e,e=>{switch(e._tag){case"None":return f.void;case"Some":return f.fail(new f.NoSuchElementException)}}),"once",0,ra,"option",0,e=>f.matchEffect(e,{onFailure:()=>f.succeed(L.none()),onSuccess:e=>f.succeed(L.some(e))}),"optionFromOptional",0,e=>f.catchAll(f.map(e,L.some),e=>f.isNoSuchElementException(e)?rb:f.fail(e)),"orElseFail",0,rs,"orElseSucceed",0,ro,"parallelErrors",0,e=>f.matchCauseEffect(e,{onFailure:e=>{let t=u.fromIterable(e1.failures(e));return 0===t.length?f.failCause(e):f.fail(t)},onSuccess:f.succeed}),"patchFiberRefs",0,rl,"promise",0,e=>e.length>=1?f.async((t,r)=>{try{e(r).then(e=>t(f.exitSucceed(e)),e=>t(f.exitDie(e)))}catch(e){t(f.exitDie(e))}}):f.async(t=>{try{e().then(e=>t(f.exitSucceed(e)),e=>t(f.exitDie(e)))}catch(e){t(f.exitDie(e))}}),"provideService",0,ru,"provideServiceEffect",0,rc,"random",0,rp,"reduce",0,rf,"reduceRight",0,rd,"reduceWhile",0,rh,"repeatN",0,rg,"sandbox",0,e=>f.matchCauseEffect(e,{onFailure:f.fail,onSuccess:f.succeed}),"serviceConstants",0,r$,"serviceFunction",0,(e,t)=>(...r)=>f.map(e,e=>t(e)(...r)),"serviceFunctionEffect",0,(e,t)=>(...r)=>f.flatMap(e,e=>t(e)(...r)),"serviceFunctions",0,rq,"serviceMembers",0,e=>({functions:rq(e),constants:r$(e)}),"serviceOption",0,e=>f.map(f.context(),p.getOption(e)),"serviceOptional",0,rB,"setFiberRefs",0,e=>f.suspend(()=>J(e)),"sleep",0,e7,"spanAnnotations",0,rY,"spanLinks",0,rX,"succeedNone",0,rb,"succeedSome",0,e=>f.succeed(L.some(e)),"summarized",0,rS,"tagMetrics",0,rv,"takeUntil",0,rw,"takeWhile",0,r_,"tapBoth",0,rk,"tapDefect",0,rx,"tapError",0,rC,"tapErrorCause",0,rT,"tapErrorTag",0,rI,"timed",0,e=>rR(e,te),"timedWith",0,rR,"tracer",0,rO,"tryMap",0,rM,"tryMapPromise",0,rA,"tryPromise",0,rF,"try_",0,tv,"unless",0,rN,"unlessEffect",0,rP,"unsafeMakeSpan",0,rQ,"unsandbox",0,e=>rn(e,e1.flatten),"updateFiberRefs",0,rD,"updateService",0,rL,"useSpan",0,r1,"when",0,rU,"whenFiberRef",0,rz,"whenRef",0,rj,"withLogSpan",0,t9,"withMetric",0,rW,"withParentSpan",0,r2,"withSpan",0,r6],395649);var r3=e.i(389630),r4=e.i(964665);let r5=f.exitIsExit,r8=f.exitIsFailure,r7=f.exitIsSuccess,r9=f.exitIsInterrupted;f.exitAs,f.exitAsVoid,f.exitCauseOption;let ie=f.exitCollectAll,it=f.exitDie;f.exitExists;let ir=f.exitFail,ii=f.exitFailCause;f.exitFlatMap,f.exitFlatMapEffect;let ia=f.exitFlatten,is=f.exitForEachEffect;f.exitFromEither,f.exitFromOption,f.exitGetOrElse;let io=f.exitInterrupt,il=f.exitMap,iu=f.exitMapBoth;f.exitMapError,f.exitMapErrorCause;let ic=f.exitMatch,ip=f.exitMatchEffect,id=f.exitSucceed,ih=f.exitVoid,im=f.exitZip;f.exitZipLeft;let ig=f.exitZipRight;f.exitZipPar,f.exitZipParLeft,f.exitZipParRight;let iy=f.exitZipWith;e.s(["all",0,ie,"die",0,it,"fail",0,ir,"failCause",0,ii,"flatten",0,ia,"forEachEffect",0,is,"interrupt",0,io,"isExit",0,r5,"isFailure",0,r8,"isInterrupted",0,r9,"isSuccess",0,r7,"map",0,il,"mapBoth",0,iu,"match",0,ic,"matchEffect",0,ip,"succeed",0,id,"void",()=>ih,"zip",0,im,"zipRight",0,ig,"zipWith",0,iy],368171);var ib=e.i(931499),iS=e.i(874995);let iv="InterruptSignal",iE="Stateful",iw="Resume",i_="YieldNow",ik=e=>({_tag:iv,cause:e}),ix=e=>({_tag:iE,onFiber:e}),iC=e=>({_tag:iw,effect:e}),iI=()=>({_tag:i_}),iT=Symbol.for("effect/FiberScope");class iR{[iT]=iT;fiberId=N.none;roots=new Set;add(e,t){this.roots.add(t),t.addObserver(()=>{this.roots.delete(t)})}}class iO{fiberId;parent;[iT]=iT;constructor(e,t){this.fiberId=e,this.parent=t}add(e,t){this.parent.tell(ix(e=>{e.addChild(t),t.addObserver(()=>{e.removeChild(t)})}))}}let iF=e=>new iO(e.id(),e),iM=(0,eE.globalValue)(Symbol.for("effect/FiberScope/Global"),()=>new iR);e.s(["globalScope",0,iM,"unsafeMake",0,iF],874559);let iA=Symbol.for("effect/Fiber"),iN={_E:e=>e,_A:e=>e},iP={[iA]:iN,pipe(){return(0,U.pipeArguments)(this,arguments)}},iD=Symbol.for("effect/Fiber"),iL=(0,a.pipe)(s.tuple(ib.Order,ib.Order),s.mapInput(e=>[e.id().startTimeMillis,e.id().id])),iU=e=>iD in e,iz=e=>e.await,ij=e=>({...iS.CommitPrototype,commit(){return iV(this)},...iP,id:()=>N.none,await:f.succeed(e),children:f.succeed([]),inheritAll:f.void,poll:f.succeed(L.some(e)),interruptAsFork:()=>f.void}),iW=e=>f.map(e.status,t=>({id:e.id(),status:t})),iq=e=>ij(ii(e)),i$=e=>e.inheritAll,iB=(0,a.dual)(2,(e,t)=>(0,a.pipe)(f.forEachSequentialDiscard(e,iH(t)),f.zipRight((0,a.pipe)(e,f.forEachSequentialDiscard(iz))))),iH=(0,a.dual)(2,(e,t)=>e.interruptAsFork(t)),iV=e=>f.zipLeft(f.flatten(e.await),e.inheritAll),iJ=(0,a.dual)(2,(e,t)=>iG(e,e=>f.sync(()=>t(e)))),iG=(0,a.dual)(2,(e,t)=>({...iS.CommitPrototype,commit(){return iV(this)},...iP,id:()=>e.id(),await:f.flatMap(e.await,is(t)),children:e.children,inheritAll:e.inheritAll,poll:f.flatMap(e.poll,e=>{switch(e._tag){case"None":return f.succeed(L.none());case"Some":return(0,a.pipe)(is(e.value,t),f.map(L.some))}}),interruptAsFork:t=>e.interruptAsFork(t)})),iK=(0,a.dual)(2,(e,t)=>f.map(e.await,ic({onFailure:e=>iq(e),onSuccess:e=>t(e)}))),iZ=(0,a.dual)(2,(e,{onFiber:t,onRuntimeFiber:r})=>iU(e)?r(e):t(e)),iQ={...iS.CommitPrototype,commit(){return iV(this)},...iP,id:()=>N.none,await:f.never,children:f.succeed([]),inheritAll:f.never,poll:f.succeed(L.none()),interruptAsFork:()=>f.never},iY=(0,a.dual)(2,(e,t)=>({...iS.CommitPrototype,commit(){return iV(this)},...iP,id:()=>N.getOrElse(e.id(),t.id()),await:f.zipWith(e.await,t.await,(e,t)=>r7(e)?e:t),children:e.children,inheritAll:f.zipRight(t.inheritAll,e.inheritAll),poll:f.zipWith(e.poll,t.poll,(e,t)=>{switch(e._tag){case"None":return L.none();case"Some":return r7(e.value)?e:t}}),interruptAsFork:r=>(0,a.pipe)(f.interruptAsFiber(e,r),f.zipRight((0,a.pipe)(t,f.interruptAsFiber(r))),f.asVoid)})),iX=(0,a.dual)(2,(e,t)=>iY(iJ(e,r4.left),iJ(t,r4.right))),i0=()=>Array.from(iM.roots),i1=f.sync(i0),i2=e=>ij(id(e)),i6=i2(void 0),i3="effect/FiberCurrent";e.s(["FiberTypeId",0,iA,"Order",0,iL,"RuntimeFiberTypeId",0,iD,"_await",0,iz,"children",0,e=>e.children,"currentFiberURI",0,i3,"done",0,ij,"dump",0,iW,"dumpAll",0,e=>f.forEachSequential(e,iW),"fail",0,e=>ij(ir(e)),"failCause",0,iq,"fiberVariance",0,iN,"fromEffect",0,e=>f.map(f.exit(e),ij),"getCurrentFiber",0,()=>L.fromNullable(globalThis[i3]),"id",0,e=>e.id(),"inheritAll",0,i$,"interruptAll",0,e=>f.flatMap(f.fiberId,t=>(0,a.pipe)(e,iB(t))),"interruptAllAs",0,iB,"interruptAsFork",0,iH,"interrupted",0,e=>ij(io(e)),"isFiber",0,e=>(0,o.hasProperty)(e,iA),"isRuntimeFiber",0,iU,"join",0,iV,"map",0,iJ,"mapEffect",0,iG,"mapFiber",0,iK,"match",0,iZ,"never",0,iQ,"orElse",0,iY,"orElseEither",0,iX,"poll",0,e=>e.poll,"pretty",0,e=>f.flatMap(e9,t=>f.map(iW(e),e=>{var r;let i,n,{days:a,hours:s,milliseconds:o,minutes:l,seconds:u}={days:(i=(r=t-e.id.startTimeMillis)>0?Math.floor:Math.ceil)(r/864e5),hours:i(r/36e5)%24,minutes:i(r/6e4)%60,seconds:i(r/1e3)%60,milliseconds:i(r)%1e3,microseconds:i(1e3*r)%1e3,nanoseconds:i(1e6*r)%1e3},c=(0===a?"":`${a}d`)+(0===a&&0===s?"":`${s}h`)+(0===a&&0===s&&0===l?"":`${l}m`)+(0===a&&0===s&&0===l&&0===u?"":`${u}s`)+`${o}ms`,p=e.status._tag===ed?(n=N.ids(e.status.blockingOn),D.size(n)>0?"waiting on "+Array.from(n).map(e=>`${e}`).join(", "):""):"",f=(e=>{if(e._tag===ep)return"Done";if(e._tag===ef)return"Running";let t=ty.interruptible(e.runtimeFlags)?"interruptible":"uninterruptible";return`Suspended(${t})`})(e.status);return`[Fiber](#${e.id.id}) (${c}) ${p}
   Status: ${f}`})),"roots",0,i1,"status",0,e=>e.status,"succeed",0,i2,"unsafeRoots",0,i0,"void",()=>i6],137696);var i4=e.i(720369);let i5=Symbol.for("effect/Logger"),i8={_Message:e=>e,_Output:e=>e},i7=e=>({[i5]:i8,log:e,pipe(){return(0,U.pipeArguments)(this,arguments)}}),i9=(0,a.dual)(2,(e,t)=>i7(r=>e.log({...r,message:t(r.message)}))),ne=(0,a.dual)(2,(e,t)=>i7(r=>e.log(t(r)))),nt=(0,a.dual)(2,(e,t)=>i7(r=>t(r.logLevel)?L.some(e.log(r)):L.none())),nr=(0,a.dual)(2,(e,t)=>i7(r=>t(e.log(r)))),ni={[i5]:i8,log:a.constVoid,pipe(){return(0,U.pipeArguments)(this,arguments)}},nn=e=>({[i5]:i8,log:({message:t})=>e(t),pipe(){return(0,U.pipeArguments)(this,arguments)}}),na=(0,a.dual)(2,(e,t)=>i7(r=>[e.log(r),t.log(r)])),ns=(0,a.dual)(2,(e,t)=>nr(na(e,t),e=>e[0])),no=(0,a.dual)(2,(e,t)=>nr(na(e,t),e=>e[1])),nl=/^[^\s"=]*$/,nu=(e,t)=>({annotations:r,cause:i,date:n,fiberId:a,logLevel:s,message:o,spans:l})=>{let c=t=>t.match(nl)?t:e(t),p=(e,t)=>`${ta(e)}=${c(t)}`,f=(e,t)=>" "+p(e,t),d=p("timestamp",n.toISOString());d+=f("level",s.label),d+=f("fiber",i4.threadName(a));let h=u.ensure(o);for(let e=0;e<h.length;e++)d+=f("message",e_.toStringUnknown(h[e],t));for(let e of(e1.isEmptyType(i)||(d+=f("cause",e1.pretty(i,{renderErrorCause:!0}))),l))d+=" "+ts(n.getTime())(e);for(let[e,i]of r)d+=f(e,e_.toStringUnknown(i,t));return d},nc=i7(nu(e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`)),np=i7(nu(JSON.stringify,0)),nf=i7(({annotations:e,cause:t,date:r,fiberId:i,logLevel:n,message:a,spans:s})=>{let o=r.getTime(),l={},c={};if(ew.size(e)>0)for(let[t,r]of e)l[t]=nd(r);if(tn.isCons(s))for(let e of s)c[e.label]=o-e.startTime;let p=u.ensure(a);return{message:1===p.length?nd(p[0]):p.map(nd),logLevel:n.label,timestamp:r.toISOString(),cause:e1.isEmpty(t)?void 0:e1.pretty(t,{renderErrorCause:!0}),annotations:l,spans:c,fiberId:i4.threadName(i)}}),nd=e=>{switch(typeof e){case"bigint":case"function":case"symbol":return String(e);default:return e_.toJSON(e)}},nh=nr(nf,e_.stringifyCircular),nm=(e,...t)=>{let r="";for(let e=0;e<t.length;e++)r+=`\x1b[${t[e]}m`;return r+e+"\x1b[0m"},ng=(e,...t)=>e,ny={None:[],All:[],Trace:["90"],Debug:["34"],Info:["32"],Warning:["33"],Error:["31"],Fatal:["101","30"]},nb={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},nS=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`,nv="object"==typeof process&&null!==process&&"object"==typeof process.stdout&&null!==process.stdout,nE=nv&&!0===process.stdout.isTTY,nw=nv||"Deno"in globalThis,n_=e=>{let t=e?.mode??"auto",r="browser"===("auto"===t?nw?"tty":"browser":t),i="boolean"==typeof e?.colors?e.colors:nE||r,n=e?.formatDate??nS;return r?nx({colors:i,formatDate:n}):nk({colors:i,formatDate:n,stderr:e?.stderr===!0})},nk=e=>{let t="object"==typeof process&&"isBun"in process&&!0===process.isBun,r=e.colors?nm:ng;return i7(({annotations:i,cause:n,context:a,date:s,fiberId:o,logLevel:l,message:c,spans:f})=>{let d=Z(a,e8.currentServices),h=p.get(d,r3.consoleTag).unsafe,m=!0===e.stderr?h.error:h.log,g=u.ensure(c),y=r(`[${e.formatDate(s)}]`,"37")+` ${r(l.label,...ny[l._tag])}`+` (${i4.threadName(o)})`;if(tn.isCons(f)){let e=ts(s.getTime());for(let t of f)y+=" "+e(t)}y+=":";let b=0;if(g.length>0){let e=nd(g[0]);"string"==typeof e&&(y+=" "+r(e,"1","36"),b++)}if(m(y),t||h.group(),e1.isEmpty(n)||m(e1.pretty(n,{renderErrorCause:!0})),b<g.length)for(;b<g.length;b++)m(e_.redact(g[b]));if(ew.size(i)>0)for(let[e,t]of i)m(r(`${e}:`,"1","37"),e_.redact(t));t||h.groupEnd()})},nx=e=>{let t=e.colors?"%c":"";return i7(({annotations:r,cause:i,context:n,date:a,fiberId:s,logLevel:o,message:l,spans:c})=>{let f=Z(n,e8.currentServices),d=p.get(f,r3.consoleTag).unsafe,h=u.ensure(l),m=`${t}[${e.formatDate(a)}]`,g=[];if(e.colors&&g.push("color:gray"),m+=` ${t}${o.label}${t} (${i4.threadName(s)})`,e.colors&&g.push(nb[o._tag],""),tn.isCons(c)){let e=ts(a.getTime());for(let t of c)m+=" "+e(t)}m+=":";let y=0;if(h.length>0){let r=nd(h[0]);"string"==typeof r&&(m+=` ${t}${r}`,e.colors&&g.push("color:deepskyblue"),y++)}if(d.groupCollapsed(m,...g),e1.isEmpty(i)||d.error(e1.pretty(i,{renderErrorCause:!0})),y<h.length)for(;y<h.length;y++)d.log(e_.redact(h[y]));if(ew.size(r)>0)for(let[t,i]of r){let r=e_.redact(i);e.colors?d.log(`%c${t}:`,"color:gray",r):d.log(`${t}:`,r)}d.groupEnd()})},nC=(0,eE.globalValue)("effect/Logger/prettyLoggerDefault",()=>n_());e.s(["LoggerTypeId",0,i5,"filterLogLevel",0,nt,"isLogger",0,e=>"object"==typeof e&&null!=e&&i5 in e,"jsonLogger",0,nh,"logfmtLogger",0,np,"makeLogger",0,i7,"map",0,nr,"mapInput",0,i9,"mapInputOptions",0,ne,"none",0,ni,"prettyLogger",0,n_,"prettyLoggerDefault",0,nC,"simple",0,nn,"stringLogger",0,nc,"structuredLogger",0,nf,"succeed",0,e=>nn(()=>e),"sync",0,e=>nn(e),"zip",0,na,"zipLeft",0,ns,"zipRight",0,no],12653);let nI="effect/MetricBoundaries",nT=Symbol.for(nI);class nR{values;[nT]=nT;constructor(e){this.values=e,this._hash=(0,a.pipe)(el.string(nI),el.combine(el.array(this.values)))}_hash;[el.symbol](){return this._hash}[P.symbol](e){return nO(e)&&P.equals(this.values,e.values)}pipe(){return(0,U.pipeArguments)(this,arguments)}}let nO=e=>(0,o.hasProperty)(e,nT),nF=Symbol.for("effect/MetricKeyType"),nM="effect/MetricKeyType/Counter",nA=Symbol.for(nM),nN="effect/MetricKeyType/Frequency",nP=Symbol.for(nN),nD="effect/MetricKeyType/Gauge",nL=Symbol.for(nD),nU="effect/MetricKeyType/Histogram",nz=Symbol.for(nU),nj=Symbol.for("effect/MetricKeyType/Summary"),nW={_In:e=>e,_Out:e=>e};class nq{incremental;bigint;[nF]=nW;[nA]=nA;constructor(e,t){this.incremental=e,this.bigint=t,this._hash=el.string(nM)}_hash;[el.symbol](){return this._hash}[P.symbol](e){return nB(e)}pipe(){return(0,U.pipeArguments)(this,arguments)}}el.symbol,P.symbol,el.symbol,P.symbol;class n${boundaries;[nF]=nW;[nz]=nz;constructor(e){this.boundaries=e,this._hash=(0,a.pipe)(el.string(nU),el.combine(el.hash(this.boundaries)))}_hash;[el.symbol](){return this._hash}[P.symbol](e){return nH(e)&&P.equals(this.boundaries,e.boundaries)}pipe(){return(0,U.pipeArguments)(this,arguments)}}el.symbol,P.symbol;let nB=e=>(0,o.hasProperty)(e,nA),nH=e=>(0,o.hasProperty)(e,nz),nV=Symbol.for("effect/MetricKey"),nJ={_Type:e=>e},nG=u.getEquivalence(P.equals);class nK{name;keyType;description;tags;[nV]=nJ;constructor(e,t,r,i=[]){this.name=e,this.keyType=t,this.description=r,this.tags=i,this._hash=(0,a.pipe)(el.string(this.name+this.description),el.combine(el.hash(this.keyType)),el.combine(el.array(this.tags)))}_hash;[el.symbol](){return this._hash}[P.symbol](e){return nZ(e)&&this.name===e.name&&P.equals(this.keyType,e.keyType)&&P.equals(this.description,e.description)&&nG(this.tags,e.tags)}pipe(){return(0,U.pipeArguments)(this,arguments)}}let nZ=e=>(0,o.hasProperty)(e,nV),nQ=(0,a.dual)(2,(e,t)=>0===t.length?e:new nK(e.name,e.keyType,e.description,u.union(e.tags,t))),nY=Symbol.for("effect/MutableHashMap"),nX={[nY]:nY,[Symbol.iterator](){return new n0(this)},toString(){return(0,e_.format)(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(e_.toJSON)}},[e_.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,U.pipeArguments)(this,arguments)}};class n0{self;referentialIterator;bucketIterator;constructor(e){this.self=e,this.referentialIterator=e.referential[Symbol.iterator]()}next(){if(void 0!==this.bucketIterator)return this.bucketIterator.next();let e=this.referentialIterator.next();return e.done?(this.bucketIterator=new n1(this.self.buckets.values()),this.next()):e}[Symbol.iterator](){return new n0(this.self)}}class n1{backing;constructor(e){this.backing=e}currentBucket;next(){if(void 0===this.currentBucket){let e=this.backing.next();if(e.done)return e;this.currentBucket=e.value[Symbol.iterator]()}let e=this.currentBucket.next();return e.done?(this.currentBucket=void 0,this.next()):e}}let n2=()=>{let e=Object.create(nX);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e},n6=(0,a.dual)(2,(e,t)=>{if(!1===P.isEqual(t))return e.referential.has(t)?L.some(e.referential.get(t)):L.none();let r=t[el.symbol](),i=e.buckets.get(r);return void 0===i?L.none():n3(e,i,t)}),n3=(e,t,r,i=!1)=>{for(let n=0,a=t.length;n<a;n++)if(r[P.symbol](t[n][0])){let r=t[n][1];return i&&(t.splice(n,1),e.bucketsSize--),L.some(r)}return L.none()},n4=(0,a.dual)(2,(e,t)=>L.isSome(n6(e,t))),n5=(0,a.dual)(3,(e,t,r)=>{if(!1===P.isEqual(t))return e.referential.set(t,r),e;let i=t[el.symbol](),n=e.buckets.get(i);return void 0===n?e.buckets.set(i,[[t,r]]):(n8(e,n,t),n.push([t,r])),e.bucketsSize++,e}),n8=(e,t,r)=>{for(let i=0,n=t.length;i<n;i++)if(r[P.symbol](t[i][0])){t.splice(i,1),e.bucketsSize--;return}},n7=(0,a.dual)(2,(e,t)=>{if(!1===P.isEqual(t))return e.referential.delete(t),e;let r=t[el.symbol](),i=e.buckets.get(r);return void 0===i||(n8(e,i,t),0===i.length&&e.buckets.delete(r)),e});e.s(["empty",0,n2,"get",0,n6,"has",0,n4,"remove",0,n7,"set",0,n5,"size",0,e=>e.referential.size+e.bucketsSize],190512);let n9=Symbol.for("effect/MetricState"),ae="effect/MetricState/Counter",at=Symbol.for(ae),ar="effect/MetricState/Frequency",ai=Symbol.for(ar),an="effect/MetricState/Gauge",aa=Symbol.for(an),as="effect/MetricState/Histogram",ao=Symbol.for(as),al="effect/MetricState/Summary",au=Symbol.for(al),ac={_A:e=>e};class ap{count;[n9]=ac;[at]=at;constructor(e){this.count=e}[el.symbol](){return(0,a.pipe)(el.hash(ae),el.combine(el.hash(this.count)),el.cached(this))}[P.symbol](e){return ay(e)&&this.count===e.count}pipe(){return(0,U.pipeArguments)(this,arguments)}}let af=u.getEquivalence(P.equals);class ad{occurrences;[n9]=ac;[ai]=ai;constructor(e){this.occurrences=e}_hash;[el.symbol](){return(0,a.pipe)(el.string(ar),el.combine(el.array(u.fromIterable(this.occurrences.entries()))),el.cached(this))}[P.symbol](e){return ab(e)&&af(u.fromIterable(this.occurrences.entries()),u.fromIterable(e.occurrences.entries()))}pipe(){return(0,U.pipeArguments)(this,arguments)}}class ah{value;[n9]=ac;[aa]=aa;constructor(e){this.value=e}[el.symbol](){return(0,a.pipe)(el.hash(an),el.combine(el.hash(this.value)),el.cached(this))}[P.symbol](e){return aS(e)&&this.value===e.value}pipe(){return(0,U.pipeArguments)(this,arguments)}}class am{buckets;count;min;max;sum;[n9]=ac;[ao]=ao;constructor(e,t,r,i,n){this.buckets=e,this.count=t,this.min=r,this.max=i,this.sum=n}[el.symbol](){return(0,a.pipe)(el.hash(as),el.combine(el.hash(this.buckets)),el.combine(el.hash(this.count)),el.combine(el.hash(this.min)),el.combine(el.hash(this.max)),el.combine(el.hash(this.sum)),el.cached(this))}[P.symbol](e){return av(e)&&P.equals(this.buckets,e.buckets)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return(0,U.pipeArguments)(this,arguments)}}class ag{error;quantiles;count;min;max;sum;[n9]=ac;[au]=au;constructor(e,t,r,i,n,a){this.error=e,this.quantiles=t,this.count=r,this.min=i,this.max=n,this.sum=a}[el.symbol](){return(0,a.pipe)(el.hash(al),el.combine(el.hash(this.error)),el.combine(el.hash(this.quantiles)),el.combine(el.hash(this.count)),el.combine(el.hash(this.min)),el.combine(el.hash(this.max)),el.combine(el.hash(this.sum)),el.cached(this))}[P.symbol](e){return aE(e)&&this.error===e.error&&P.equals(this.quantiles,e.quantiles)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return(0,U.pipeArguments)(this,arguments)}}let ay=e=>(0,o.hasProperty)(e,at),ab=e=>(0,o.hasProperty)(e,ai),aS=e=>(0,o.hasProperty)(e,aa),av=e=>(0,o.hasProperty)(e,ao),aE=e=>(0,o.hasProperty)(e,au),aw=Symbol.for("effect/MetricHook"),a_={_In:e=>e,_Out:e=>e},ak=e=>({[aw]:a_,pipe(){return(0,U.pipeArguments)(this,arguments)},...e}),ax=BigInt(0),aC=(e,t,r,i,n,a)=>{let s=e,o=t,l=r,c=i,p=n,f=a,d=e,h=t,m=r,g=i,y=n,b=a;for(;;){if(!u.isNonEmptyReadonlyArray(f))return{quantile:p,value:L.none(),consumed:c,rest:[]};if(1===p)return{quantile:p,value:L.some(u.lastNonEmpty(f)),consumed:c+f.length,rest:[]};let e=u.headNonEmpty(f),t=u.span(f,t=>t===e),r=p*o,i=s/2*r,n=c+t[0].length,a=Math.abs(n-r);if(n<r-i){d=s,h=o,m=u.head(f),g=n,y=p,b=t[1],s=d,o=h,l=m,c=g,p=y,f=b;continue}if(n>r+i)return{quantile:p,value:L.isNone(l)?L.some(e):l,consumed:c,rest:f};switch(l._tag){case"None":d=s,h=o,m=u.head(f),g=n,y=p,b=t[1],s=d,o=h,l=m,c=g,p=y,f=b;continue;case"Some":if(a<Math.abs(r-l.value)){d=s,h=o,m=u.head(f),g=n,y=p,b=t[1],s=d,o=h,l=m,c=g,p=y,f=b;continue}return{quantile:p,value:L.some(l.value),consumed:c,rest:f}}}throw Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},aI=Symbol.for("effect/MetricPair"),aT={_Type:e=>e},aR=(e,t)=>({[aI]:aT,metricKey:e,metricState:t,pipe(){return(0,U.pipeArguments)(this,arguments)}}),aO=Symbol.for("effect/MetricRegistry");class aF{[aO]=aO;map=n2();snapshot(){let e=[];for(let[t,r]of this.map)e.push(aR(t,r.get()));return e}get(e){let t,r,i,n=(0,a.pipe)(this.map,n6(e),L.getOrUndefined);if(null!=n)return n;if(nB(e.keyType))return this.getCounter(e);if(t=e.keyType,(0,o.hasProperty)(t,nL))return this.getGauge(e);if(r=e.keyType,(0,o.hasProperty)(r,nP))return this.getFrequency(e);if(nH(e.keyType))return this.getHistogram(e);if(i=e.keyType,(0,o.hasProperty)(i,nj))return this.getSummary(e);throw Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}getCounter(e){let t=(0,a.pipe)(this.map,n6(e),L.getOrUndefined);if(null==t){let r,i,n,s=(r=e.keyType.bigint?ax:0,i=e.keyType.incremental?e.keyType.bigint?e=>e>=ax:e=>e>=0:e=>!0,ak({get:()=>new ap(r),update:n=e=>{i(e)&&(r+=e)},modify:n}));(0,a.pipe)(this.map,n4(e))||(0,a.pipe)(this.map,n5(e,s)),t=s}return t}getFrequency(e){let t=(0,a.pipe)(this.map,n6(e),L.getOrUndefined);if(null==t){let r=(e=>{let t=new Map;for(let r of e.keyType.preregisteredWords)t.set(r,0);let r=e=>{let r=t.get(e)??0;t.set(e,r+1)};return ak({get:()=>new ad(t),update:r,modify:r})})(e);(0,a.pipe)(this.map,n4(e))||(0,a.pipe)(this.map,n5(e,r)),t=r}return t}getGauge(e){let t=(0,a.pipe)(this.map,n6(e),L.getOrUndefined);if(null==t){let r,i=(r=e.keyType.bigint?BigInt(0):0,ak({get:()=>new ah(r),update:e=>{r=e},modify:e=>{r+=e}}));(0,a.pipe)(this.map,n4(e))||(0,a.pipe)(this.map,n5(e,i)),t=i}return t}getHistogram(e){let t=(0,a.pipe)(this.map,n6(e),L.getOrUndefined);if(null==t){let r,i,n,s,o,l,c,p,f,d=(n=new Uint32Array((i=(r=e.keyType.boundaries.values).length)+1),s=new Float32Array(i),o=0,l=0,c=Number.MAX_VALUE,p=5e-324,(0,a.pipe)(r,u.sort(ib.Order),u.map((e,t)=>{s[t]=e})),ak({get:()=>{let e;return new am((e={buckets:(()=>{let e=u.allocate(i),t=0;for(let r=0;r<i;r++){let i=s[r];t+=n[r],e[r]=[i,t]}return e})(),count:o,min:c,max:p,sum:l}).buckets,e.count,e.min,e.max,e.sum)},update:f=e=>{let t=0,r=i;for(;t!==r;){let i=Math.floor(t+(r-t)/2);e<=s[i]?r=i:t=i,r===t+1&&(e<=s[t]?r=t:t=r)}n[t]=n[t]+1,o+=1,l+=e,e<c&&(c=e),e>p&&(p=e)},modify:f}));(0,a.pipe)(this.map,n4(e))||(0,a.pipe)(this.map,n5(e,d)),t=d}return t}getSummary(e){let t=(0,a.pipe)(this.map,n6(e),L.getOrUndefined);if(null==t){let r=(e=>{let{error:t,maxAge:r,maxSize:i,quantiles:n}=e.keyType,s=(0,a.pipe)(n,u.sort(ib.Order)),o=u.allocate(i),l=0,c=0,p=0,f=0,d=0,h=(e,t)=>{i>0&&(o[(l+=1)%i]=[t,e]),f=0===c?e:Math.min(f,e),d=0===c?e:Math.max(d,e),c+=1,p+=e};return ak({get:()=>{let e;return e={error:t,quantiles:(e=>{let n=[],a=0;for(;a!==i-1;){let t=o[a];if(null!=t){let[i,a]=t,s=ti.millis(e-i);ti.greaterThanOrEqualTo(s,ti.zero)&&ti.lessThanOrEqualTo(s,r)&&n.push(a)}a+=1}return((e,t,r)=>{let i=r.length;if(!u.isNonEmptyReadonlyArray(t))return u.empty();let n=t[0],a=t.slice(1),s=aC(e,i,L.none(),0,n,r),o=u.of(s);return a.forEach(t=>{o.push(aC(e,i,s.value,s.consumed,t,s.rest))}),u.map(o,e=>[e.quantile,e.value])})(t,s,u.sort(n,ib.Order))})(Date.now()),count:c,min:f,max:d,sum:p},new ag(e.error,e.quantiles,e.count,e.min,e.max,e.sum)},update:([e,t])=>h(e,t),modify:([e,t])=>h(e,t)})})(e);(0,a.pipe)(this.map,n4(e))||(0,a.pipe)(this.map,n5(e,r)),t=r}return t}}let aM=Symbol.for("effect/Metric"),aA={_Type:e=>e,_In:e=>e,_Out:e=>e},aN=(0,eE.globalValue)(Symbol.for("effect/Metric/globalMetricRegistry"),()=>new aF),aP=function(e,t,r,i){let n=Object.assign(e=>f.tap(e,e=>aj(n,e)),{[aM]:aA,keyType:e,unsafeUpdate:t,unsafeValue:r,unsafeModify:i,register(){return this.unsafeValue([]),this},pipe(){return(0,U.pipeArguments)(this,arguments)}});return n},aD=((e,t)=>aP(e.keyType,(r,i)=>e.unsafeUpdate(t(r),i),e.unsafeValue,(r,i)=>e.unsafeModify(t(r),i)),(e,t)=>aL(new nK(e,new nq(t?.incremental??!1,t?.bigint??!1),L.fromNullable(t?.description)))),aL=e=>{let t,r=new WeakMap,i=i=>{if(0===i.length)return void 0!==t?t:t=aN.get(e);let n=r.get(i);return void 0!==n||(n=aN.get(nQ(e,i)),r.set(i,n)),n};return aP(e.keyType,(e,t)=>i(t).update(e),e=>i(e).get(),(e,t)=>i(t).modify(e))},aU=((e,t)=>aP(e.keyType,e.unsafeUpdate,r=>t(e.unsafeValue(r)),e.unsafeModify),(0,a.dual)(3,(e,t,r)=>az(e,[tm(t,r)]))),az=(0,a.dual)(2,(e,t)=>aP(e.keyType,(r,i)=>e.unsafeUpdate(r,u.union(t,i)),r=>e.unsafeValue(u.union(t,r)),(r,i)=>e.unsafeModify(r,u.union(t,i)))),aj=((e,t,r)=>{let i=e=>aj(t,r(e));return rx(e,e=>f.forEachSequentialDiscard(e1.defects(e),i))},(0,a.dual)(2,(e,t)=>f.fiberRefGetWith(f.currentMetricLabels,r=>f.sync(()=>e.unsafeUpdate(t,r)))));var aW=e.i(25560),aq=e.i(972075);let a$=Symbol.for("effect/Request"),aB={...iS.StructuralPrototype,[a$]:{_E:e=>e,_A:e=>e}},aH=function(){function e(e){e&&Object.assign(this,e)}return e.prototype=aB,e}(),aV=(0,a.dual)(2,(e,t)=>f.fiberRefGetWith(e6,r=>f.sync(()=>{if(r.has(e)){let i=r.get(e);i.state.completed||(i.state.completed=!0,f.deferredUnsafeDone(i.result,t))}}))),aJ=(0,a.dual)(2,(e,t)=>f.matchEffect(t,{onFailure:t=>aV(e,f.exitFail(t)),onSuccess:t=>aV(e,f.exitSucceed(t))})),aG=(0,a.dual)(2,(e,t)=>aV(e,f.exitFail(t))),aK=(0,a.dual)(2,(e,t)=>aV(e,f.exitFailCause(t))),aZ=(0,a.dual)(2,(e,t)=>aV(e,f.exitSucceed(t)));class aQ{count=0;observers=new Set;interrupted=!1;addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}increment(){this.count++,this.observers.forEach(e=>e(this.count))}decrement(){this.count--,this.observers.forEach(e=>e(this.count))}}e.s(["Class",0,aH,"Listeners",()=>aQ,"RequestTypeId",0,a$,"TaggedClass",0,e=>class extends aH{_tag=e},"complete",0,aV,"completeEffect",0,aJ,"fail",0,aG,"failCause",0,aK,"isRequest",0,e=>(0,o.hasProperty)(e,a$),"of",0,()=>e=>Object.assign(Object.create(aB),e),"succeed",0,aZ,"tagged",0,e=>t=>{let r=Object.assign(Object.create(aB),t);return r._tag=e,r}],322813);let aY=0;class aX{self;stack;direction;count=0;constructor(e,t,r){this.self=e,this.stack=t,this.direction=r}clone(){return new aX(this.self,this.stack.slice(),this.direction)}reversed(){return new aX(this.self,this.stack.slice(),this.direction===aY?1:aY)}next(){let e=this.entry;switch(this.count++,this.direction===aY?this.moveNext():this.movePrev(),e._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:e.value}}}get key(){return this.stack.length>0?L.some(this.stack[this.stack.length-1].key):L.none()}get value(){return this.stack.length>0?L.some(this.stack[this.stack.length-1].value):L.none()}get entry(){return L.map(u.last(this.stack),e=>[e.key,e.value])}get index(){let e=0,t=this.stack;if(0===t.length){let e=this.self._root;return null!=e?e.count:0}null!=t[t.length-1].left&&(e=t[t.length-1].left.count);for(let r=t.length-2;r>=0;--r)t[r+1]===t[r].right&&(++e,null!=t[r].left&&(e+=t[r].left.count));return e}moveNext(){let e=this.stack;if(0===e.length)return;let t=e[e.length-1];if(null!=t.right)for(t=t.right;null!=t;)e.push(t),t=t.left;else for(e.pop();e.length>0&&e[e.length-1].right===t;)t=e[e.length-1],e.pop()}get hasNext(){let e=this.stack;if(0===e.length)return!1;if(null!=e[e.length-1].right)return!0;for(let t=e.length-1;t>0;--t)if(e[t-1].left===e[t])return!0;return!1}movePrev(){let e=this.stack;if(0===e.length)return;let t=e[e.length-1];if(null!=t&&null!=t.left)for(t=t.left;null!=t;)e.push(t),t=t.right;else for(e.pop();e.length>0&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}get hasPrev(){let e=this.stack;if(0===e.length)return!1;if(null!=e[e.length-1].left)return!0;for(let t=e.length-1;t>0;--t)if(e[t-1].right===e[t])return!0;return!1}}let a0=({color:e,count:t,key:r,left:i,right:n,value:a})=>({color:e,key:r,value:a,left:i,right:n,count:t});function a1(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e.color=t.color,e.count=t.count}let a2=({count:e,key:t,left:r,right:i,value:n},a)=>({color:a,key:t,value:n,left:r,right:i,count:e}),a6=e=>{e.count=1+(e.left?.count??0)+(e.right?.count??0)};var a3=e.i(456239);let a4="effect/RedBlackTree",a5=Symbol.for(a4),a8={[a5]:{_Key:e=>e,_Value:e=>e},[el.symbol](){let e=el.hash(a4);for(let t of this)e^=(0,a.pipe)(el.hash(t[0]),el.combine(el.hash(t[1])));return el.cached(this,e)},[P.symbol](e){if(a9(e)){if((this._root?.count??0)!==(e._root?.count??0))return!1;let t=Array.from(e);return Array.from(this).every((e,r)=>{let i=t[r];return P.equals(e[0],i[0])&&P.equals(e[1],i[1])})}return!1},[Symbol.iterator](){let e=[],t=this._root;for(;null!=t;)e.push(t),t=t.left;return new aX(this,e,aY)},toString(){return(0,e_.format)(this.toJSON())},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(e_.toJSON)}},[e_.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,U.pipeArguments)(this,arguments)}},a7=(e,t)=>{let r=Object.create(a8);return r._ord=e,r._root=t,r},a9=e=>(0,o.hasProperty)(e,a5),se=(0,a.dual)(2,(e,t)=>{let r=a7(t,void 0);for(let[t,i]of e)r=si(r,t,i);return r}),st=(0,a.dual)(2,(e,t)=>{let r=e._ord,i=e._root;for(;void 0!==i;){let e=r(t,i.key);if(P.equals(t,i.key))return L.some(i.value);i=e<=0?i.left:i.right}return L.none()}),sr=(0,a.dual)(2,(e,t)=>L.isSome(st(e,t))),si=(0,a.dual)(3,(e,t,r)=>{let i=e._ord,n=e._root,a=[],s=[];for(;null!=n;){let e=i(t,n.key);a.push(n),s.push(e),n=e<=0?n.left:n.right}a.push({color:0,key:t,value:r,left:void 0,right:void 0,count:1});for(let e=a.length-2;e>=0;--e){let t=a[e];s[e]<=0?a[e]={color:t.color,key:t.key,value:t.value,left:a[e+1],right:t.right,count:t.count+1}:a[e]={color:t.color,key:t.key,value:t.value,left:t.left,right:a[e+1],count:t.count+1}}for(let e=a.length-1;e>1;--e){let t=a[e-1],r=a[e];if(1===t.color||1===r.color)break;let i=a[e-2];if(i.left===t)if(t.left===r){let n=i.right;if(n&&0===n.color)t.color=1,i.right=a2(n,1),i.color=0,e-=1;else{if(i.color=0,i.left=t.right,t.color=1,t.right=i,a[e-2]=t,a[e-1]=r,a6(i),a6(t),e>=3){let r=a[e-3];r.left===i?r.left=t:r.right=t}break}}else{let n=i.right;if(n&&0===n.color)t.color=1,i.right=a2(n,1),i.color=0,e-=1;else{if(t.right=r.left,i.color=0,i.left=r.right,r.color=1,r.left=t,r.right=i,a[e-2]=r,a[e-1]=t,a6(i),a6(t),a6(r),e>=3){let t=a[e-3];t.left===i?t.left=r:t.right=r}break}}else if(t.right===r){let n=i.left;if(n&&0===n.color)t.color=1,i.left=a2(n,1),i.color=0,e-=1;else{if(i.color=0,i.right=t.left,t.color=1,t.left=i,a[e-2]=t,a[e-1]=r,a6(i),a6(t),e>=3){let r=a[e-3];r.right===i?r.right=t:r.left=t}break}}else{let n=i.left;if(n&&0===n.color)t.color=1,i.left=a2(n,1),i.color=0,e-=1;else{if(t.left=r.right,i.color=0,i.right=r.left,r.color=1,r.right=t,r.left=i,a[e-2]=r,a[e-1]=t,a6(i),a6(t),a6(r),e>=3){let t=a[e-3];t.right===i?t.right=r:t.left=r}break}}}return a[0].color=1,a7(e._ord,a[0])}),sn=(e,t)=>{let r=e[Symbol.iterator](),i=0;return{[Symbol.iterator]:()=>sn(e,t),next:()=>{i++;let e=r.key;switch(t===aY?r.moveNext():r.movePrev(),e._tag){case"None":return{done:!0,value:i};case"Some":return{done:!1,value:e.value}}}}},sa=(0,a.dual)(2,(e,t)=>{let r=e._root;void 0!==r&&so(r,(e,r)=>(t(e,r),L.none()))}),ss=(0,a.dual)(2,(e,t)=>{if(!sr(e,t))return e;let r=e._ord,i=e._root,n=[];for(;void 0!==i;){let e=r(t,i.key);n.push(i),i=P.equals(t,i.key)?void 0:e<=0?i.left:i.right}if(0===n.length)return e;let a=Array(n.length),s=n[n.length-1];a[a.length-1]={color:s.color,key:s.key,value:s.value,left:s.left,right:s.right,count:s.count};for(let e=n.length-2;e>=0;--e)(s=n[e]).left===n[e+1]?a[e]={color:s.color,key:s.key,value:s.value,left:a[e+1],right:s.right,count:s.count}:a[e]={color:s.color,key:s.key,value:s.value,left:s.left,right:a[e+1],count:s.count};if(void 0!==(s=a[a.length-1]).left&&void 0!==s.right){let e=a.length;for(s=s.left;null!=s.right;)a.push(s),s=s.right;let t=a[e-1];a.push({color:s.color,key:t.key,value:t.value,left:s.left,right:s.right,count:s.count}),a[e-1].key=s.key,a[e-1].value=s.value;for(let t=a.length-2;t>=e;--t)s=a[t],a[t]={color:s.color,key:s.key,value:s.value,left:s.left,right:a[t+1],count:s.count};a[e-1].left=a[e]}if(0===(s=a[a.length-1]).color){let e=a[a.length-2];e.left===s?e.left=void 0:e.right===s&&(e.right=void 0),a.pop();for(let e=0;e<a.length;++e)a[e].count--}else if(void 0!==s.left||void 0!==s.right){void 0!==s.left?a1(s,s.left):void 0!==s.right&&a1(s,s.right),s.color=1;for(let e=0;e<a.length-1;++e)a[e].count--}else{if(1===a.length)return a7(r,void 0);for(let e=0;e<a.length;++e)a[e].count--;let e=a[a.length-2];sl(a),e.left===s?e.left=void 0:e.right=void 0}return a7(r,a[0])}),so=(e,t)=>{let r,i=e,n=!1;for(;!n;)if(null!=i)r=a3.make(i,r),i=i.left;else if(null!=r){let e=t(r.value.key,r.value.value);if(L.isSome(e))return e;i=r.value.right,r=r.previous}else n=!0;return L.none()},sl=e=>{let t,r,i,n;for(let a=e.length-1;a>=0;--a){if(t=e[a],0===a){t.color=1;return}if((r=e[a-1]).left===t){if(void 0!==(i=r.right)&&void 0!==i.right&&0===i.right.color){if(n=(i=r.right=a0(i)).right=a0(i.right),r.right=i.left,i.left=r,i.right=n,i.color=r.color,t.color=1,r.color=1,n.color=1,a6(r),a6(i),a>1){let t=e[a-2];t.left===r?t.left=i:t.right=i}e[a-1]=i;return}if(void 0!==i&&void 0!==i.left&&0===i.left.color){if(n=(i=r.right=a0(i)).left=a0(i.left),r.right=n.left,i.left=n.right,n.left=r,n.right=i,n.color=r.color,r.color=1,i.color=1,t.color=1,a6(r),a6(i),a6(n),a>1){let t=e[a-2];t.left===r?t.left=n:t.right=n}e[a-1]=n;return}if(void 0!==i&&1===i.color)if(0===r.color){r.color=1,r.right=a2(i,0);return}else{r.right=a2(i,0);continue}if(void 0!==i){if(r.right=(i=a0(i)).left,i.left=r,i.color=r.color,r.color=0,a6(r),a6(i),a>1){let t=e[a-2];t.left===r?t.left=i:t.right=i}e[a-1]=i,e[a]=r,a+1<e.length?e[a+1]=t:e.push(t),a+=2}}else{if(void 0!==(i=r.left)&&void 0!==i.left&&0===i.left.color){if(n=(i=r.left=a0(i)).left=a0(i.left),r.left=i.right,i.right=r,i.left=n,i.color=r.color,t.color=1,r.color=1,n.color=1,a6(r),a6(i),a>1){let t=e[a-2];t.right===r?t.right=i:t.left=i}e[a-1]=i;return}if(void 0!==i&&void 0!==i.right&&0===i.right.color){if(n=(i=r.left=a0(i)).right=a0(i.right),r.left=n.right,i.right=n.left,n.right=r,n.left=i,n.color=r.color,r.color=1,i.color=1,t.color=1,a6(r),a6(i),a6(n),a>1){let t=e[a-2];t.right===r?t.right=n:t.left=n}e[a-1]=n;return}if(void 0!==i&&1===i.color)if(0===r.color){r.color=1,r.left=a2(i,0);return}else{r.left=a2(i,0);continue}if(void 0!==i){if(r.left=(i=a0(i)).right,i.right=r,i.color=r.color,r.color=0,a6(r),a6(i),a>1){let t=e[a-2];t.right===r?t.right=i:t.left=i}e[a-1]=i,e[a]=r,a+1<e.length?e[a+1]=t:e.push(t),a+=2}}}},su=Symbol.for("effect/SortedSet"),sc={[su]:{_A:e=>e},[el.symbol](){return(0,a.pipe)(el.hash(this.keyTree),el.combine(el.hash(su)),el.cached(this))},[P.symbol](e){return sf(e)&&P.equals(this.keyTree,e.keyTree)},[Symbol.iterator](){return sn(this.keyTree,aY)},toString(){return(0,e_.format)(this.toJSON())},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(e_.toJSON)}},[e_.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,U.pipeArguments)(this,arguments)}},sp=e=>{let t=Object.create(sc);return t.keyTree=e,t},sf=e=>(0,o.hasProperty)(e,su),sd=a.dual(2,(e,t)=>sp(se(Array.from(e).map(e=>[e,!0]),t))),sh=a.dual(2,(e,t)=>sr(e.keyTree,t)?e:sp(si(e.keyTree,t,!0))),sm=a.dual(2,(e,t)=>{for(let r of e)if(!t(r))return!1;return!0}),sg=((e,t)=>sa(e.keyTree,t),a.dual(2,(e,t)=>sr(e.keyTree,t))),sy=a.dual(2,(e,t)=>sm(e,e=>sg(t,e))),sb=a.dual(2,(e,t)=>sp(ss(e.keyTree,t)));e.s(["add",0,sh,"fromIterable",0,sd,"getEquivalence",0,()=>(e,t)=>sy(e,t)&&sy(t,e),"isSortedSet",0,sf,"remove",0,sb,"values",0,e=>sn(e.keyTree,aY)],628555);let sS=Symbol.for("effect/Supervisor"),sv={_T:e=>e};class sE{underlying;value0;[sS]=sv;constructor(e,t){this.underlying=e,this.value0=t}get value(){return this.value0}onStart(e,t,r,i){this.underlying.onStart(e,t,r,i)}onEnd(e,t){this.underlying.onEnd(e,t)}onEffect(e,t){this.underlying.onEffect(e,t)}onSuspend(e){this.underlying.onSuspend(e)}onResume(e){this.underlying.onResume(e)}map(e){return new sE(this,(0,a.pipe)(this.value,f.map(e)))}zip(e){return new sw(this,e)}}class sw{left;right;_tag="Zip";[sS]=sv;constructor(e,t){this.left=e,this.right=t}get value(){return f.zip(this.left.value,this.right.value)}onStart(e,t,r,i){this.left.onStart(e,t,r,i),this.right.onStart(e,t,r,i)}onEnd(e,t){this.left.onEnd(e,t),this.right.onEnd(e,t)}onEffect(e,t){this.left.onEffect(e,t),this.right.onEffect(e,t)}onSuspend(e){this.left.onSuspend(e),this.right.onSuspend(e)}onResume(e){this.left.onResume(e),this.right.onResume(e)}map(e){return new sE(this,(0,a.pipe)(this.value,f.map(e)))}zip(e){return new sw(this,e)}}let s_=e=>(0,o.hasProperty)(e,sS)&&(0,o.isTagged)(e,"Zip");class sk{[sS]=sv;fibers=new Set;get value(){return f.sync(()=>Array.from(this.fibers))}onStart(e,t,r,i){this.fibers.add(i)}onEnd(e,t){this.fibers.delete(t)}onEffect(e,t){}onSuspend(e){}onResume(e){}map(e){return new sE(this,(0,a.pipe)(this.value,f.map(e)))}zip(e){return new sw(this,e)}onRun(e,t){return e()}}class sx{effect;[sS]=sv;constructor(e){this.effect=e}get value(){return this.effect}onStart(e,t,r,i){}onEnd(e,t){}onEffect(e,t){}onSuspend(e){}onResume(e){}map(e){return new sE(this,(0,a.pipe)(this.value,f.map(e)))}zip(e){return new sw(this,e)}onRun(e,t){return e()}}let sC=f.sync(()=>new sk),sI=(0,eE.globalValue)("effect/Supervisor/none",()=>new sx(f.void));e.s(["Zip",()=>sw,"isZip",0,s_,"none",0,sI,"track",0,sC],764120);var sT=e.i(472167),sR=e.i(997617),sO=e.i(679986),sF=e.i(57105),sM=e.i(890115),sA=e.i(968484),sN=e.i(587212);sT.DifferTypeId,sR.ChunkPatchTypeId,sO.ContextPatchTypeId,sF.HashMapPatchTypeId,sM.HashSetPatchTypeId,sA.OrPatchTypeId,sN.ReadonlyArrayPatchTypeId;let sP=sT.make;sT.environment,sT.chunk,sT.hashMap,sT.hashSet,sT.orElseEither,sT.readonlyArray,sT.transform,sT.update,sT.updateWith,sT.zip;let sD="Empty",sL="AddSupervisor",sU="RemoveSupervisor",sz="AndThen",sj={_tag:sD},sW=(e,t)=>({_tag:sz,first:e,second:t}),sq=(e,t)=>P.equals(e,t)?sI:s_(e)?sq(e.left,t).zip(sq(e.right,t)):e,s$=e=>P.equals(e,sI)?D.empty():s_(e)?(0,a.pipe)(s$(e.left),D.union(s$(e.right))):D.make(e),sB=sP({empty:sj,patch:(e,t)=>((e,t)=>{let r=e,i=t;for(;c.isNonEmpty(i);){let e=c.headNonEmpty(i);switch(e._tag){case sD:i=c.tailNonEmpty(i);break;case sL:r=r.zip(e.supervisor),i=c.tailNonEmpty(i);break;case sU:r=sq(r,e.supervisor),i=c.tailNonEmpty(i);break;case sz:i=c.prepend(e.first)(c.prepend(e.second)(c.tailNonEmpty(i)))}}return r})(t,c.of(e)),combine:sW,diff:(e,t)=>{if(P.equals(e,t))return sj;let r=s$(e),i=s$(t),n=(0,a.pipe)(i,D.difference(r),D.reduce(sj,(e,t)=>sW(e,{_tag:sL,supervisor:t}))),s=(0,a.pipe)(r,D.difference(i),D.reduce(sj,(e,t)=>sW(e,{_tag:sU,supervisor:t})));return sW(n,s)}});var sH=e.i(347133);let sV=aD("effect_fiber_started",{incremental:!0}),sJ=aD("effect_fiber_active"),sG=aD("effect_fiber_successes",{incremental:!0}),sK=aD("effect_fiber_failures",{incremental:!0}),sZ=aU((t={start:.5,factor:2,count:35},aL((r=(0,a.pipe)(u.makeBy(t.count-1,e=>t.start*Math.pow(t.factor,e)),c.unsafeFromArray,e=>new nR((0,a.pipe)(e,u.appendAll(c.of(1/0)),u.dedupe))),new nK("effect_fiber_lifetimes",new n$(r),L.fromNullable(i))))),"time_unit","milliseconds"),sQ="Continue",sY="Yield",sX={_E:e=>e,_A:e=>e},s0=e=>{throw Error(`BUG: FiberRuntime - ${e_.toStringUnknown(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},s1=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),s2=(0,eE.globalValue)("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),s6={[aW.OP_ON_SUCCESS]:(e,t,r)=>(0,eX.internalCall)(()=>t.effect_instruction_i1(r)),OnStep:(e,t,r)=>f.exitSucceed(f.exitSucceed(r)),[aW.OP_ON_SUCCESS_AND_FAILURE]:(e,t,r)=>(0,eX.internalCall)(()=>t.effect_instruction_i2(r)),[aW.OP_REVERT_FLAGS]:(e,t,r)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),ty.interruptible(e.currentRuntimeFlags)&&e.isInterrupted())?f.exitFailCause(e.getInterruptedCause()):f.exitSucceed(r),[aW.OP_WHILE]:(e,t,r)=>((0,eX.internalCall)(()=>t.effect_instruction_i2(r)),(0,eX.internalCall)(()=>t.effect_instruction_i0()))?(e.pushStack(t),(0,eX.internalCall)(()=>t.effect_instruction_i1())):f.void,[aW.OP_ITERATOR]:(e,t,r)=>{let i=(0,eX.internalCall)(()=>t.effect_instruction_i0.next(r));return i.done?f.exitSucceed(i.value):(e.pushStack(t),(0,eX.yieldWrapGet)(i.value))}},s3={[iv]:(e,t,r,i)=>(e.processNewInterruptSignal(i.cause),ty.interruptible(t)?f.exitFailCause(i.cause):r),[iw]:(e,t,r,i)=>{throw Error("It is illegal to have multiple concurrent run loops in a single fiber")},[iE]:(e,t,r,i)=>(i.onFiber(e,ev(t)),r),[i_]:(e,t,r,i)=>f.flatMap(f.yieldNow(),()=>r)},s4=sH.getCurrentVersion();class s5 extends k.Class{[iA]=iN;[iD]=sX;_fiberRefs;_fiberId;_queue=[];_children=null;_observers=[];_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(e,t,r){if(super(),this.currentRuntimeFlags=r,this._fiberId=e,this._fiberRefs=t,ty.runtimeMetrics(r)){const e=this.getFiberRef(f.currentMetricLabels);sV.unsafeUpdate(1,e),sJ.unsafeUpdate(1,e)}this.refreshRefCache()}commit(){return iV(this)}id(){return this._fiberId}resume(e){this.tell(iC(e))}get status(){return this.ask((e,t)=>t)}get runtimeFlags(){return this.ask((e,t)=>t._tag===ep?e.currentRuntimeFlags:t.runtimeFlags)}scope(){return iF(this)}get children(){return this.ask(e=>Array.from(e.getChildren()))}getChildren(){return null===this._children&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(f.currentInterruptedCause)}fiberRefs(){return this.ask(e=>e.getFiberRefs())}ask(e){return f.suspend(()=>{let t=f.deferredUnsafeMake(this._fiberId);return this.tell(ix((r,i)=>{f.deferredUnsafeDone(t,f.sync(()=>e(r,i)))})),f.deferredAwait(t)})}tell(e){this._queue.push(e),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return f.async(e=>{let t=t=>e(f.succeed(t));return this.tell(ix((e,r)=>{null!==e._exitValue?t(this._exitValue):e.addObserver(t)})),f.sync(()=>this.tell(ix((e,r)=>{e.removeObserver(t)})))},this.id())}get inheritAll(){return f.withFiberRuntime((e,t)=>{let r=e.id(),i=e.getFiberRefs(),n=t.runtimeFlags,s=$(i,r,this.getFiberRefs());e.setFiberRefs(s);let o=e.getFiberRef(o4),l=(0,a.pipe)(ty.diff(n,o),eV.exclude(ty.Interruption),eV.exclude(ty.WindDown));return f.updateRuntimeFlags(l)})}get poll(){return f.sync(()=>L.fromNullable(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(e){return f.sync(()=>this.tell(ik(e1.interrupt(e))))}unsafeInterruptAsFork(e){this.tell(ik(e1.interrupt(e)))}addObserver(e){null!==this._exitValue?e(this._exitValue):this._observers.push(e)}removeObserver(e){this._observers=this._observers.filter(t=>t!==e)}getFiberRefs(){return this.setFiberRef(o4,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(e){this._fiberRefs=G(this._fiberRefs,e)}getFiberRef(e){return this._fiberRefs.locals.has(e)?this._fiberRefs.locals.get(e)[0][1]:e.initial}setFiberRef(e,t){this._fiberRefs=Q(this._fiberRefs,{fiberId:this._fiberId,fiberRef:e,value:t}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(e8.currentServices),this.currentTracer=this.currentDefaultServices.unsafeMap.get(to.tracerTag.key),this.currentSupervisor=this.getFiberRef(o5),this.currentScheduler=this.getFiberRef(eQ),this.currentContext=this.getFiberRef(f.currentContext),this.currentSpan=this.currentContext.unsafeMap.get(to.spanTag.key)}setFiberRefs(e){this._fiberRefs=e,this.refreshRefCache()}addChild(e){this.getChildren().add(e)}removeChild(e){this.getChildren().delete(e)}transferChildren(e){let t=this._children;if(this._children=null,null!==t&&t.size>0)for(let r of t)null===r._exitValue&&e.add(this.currentRuntimeFlags,r)}drainQueueOnCurrentThread(){let e=!0;for(;e;){let t=sQ,r=globalThis[i3];globalThis[i3]=this;try{for(;t===sQ;)t=0===this._queue.length?"Done":this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[i3]=r}this._queue.length>0&&!this._running?(this._running=!0,t===sY?(this.drainQueueLaterOnExecutor(),e=!1):e=!0):e=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(f.currentSchedulingPriority))}drainQueueWhileRunning(e,t){let r=t;for(;this._queue.length>0;){let t=this._queue.splice(0,1)[0];r=s3[t._tag](this,e,r,t)}return r}isInterrupted(){return!e1.isEmpty(this.getFiberRef(f.currentInterruptedCause))}addInterruptedCause(e){let t=this.getFiberRef(f.currentInterruptedCause);this.setFiberRef(f.currentInterruptedCause,e1.sequential(t,e))}processNewInterruptSignal(e){this.addInterruptedCause(e),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(null===this._children||0===this._children.size)return!1;let e=!1;for(let t of this._children)t.tell(ik(e1.interrupt(this.id()))),e=!0;return e}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let e=this._children.values();this._children=null;let t=!1;return f.whileLoop({while:()=>!t,body:()=>{let r=e.next();return r.done?f.sync(()=>{t=!0}):f.asVoid(r.value.await)},step:()=>{}})}return null}reportExitValue(e){if(ty.runtimeMetrics(this.currentRuntimeFlags)){let t=this.getFiberRef(f.currentMetricLabels),r=this.id().startTimeMillis,i=Date.now();switch(sZ.unsafeUpdate(i-r,t),sJ.unsafeUpdate(-1,t),e._tag){case aW.OP_SUCCESS:sG.unsafeUpdate(1,t);break;case aW.OP_FAILURE:sK.unsafeUpdate(1,t)}}if("Failure"===e._tag){let t=this.getFiberRef(f.currentUnhandledErrorLogLevel);e1.isInterruptedOnly(e.cause)||"Some"!==t._tag||this.log("Fiber terminated with an unhandled error",e.cause,t)}}setExitValue(e){this._exitValue=e,this.reportExitValue(e);for(let t=this._observers.length-1;t>=0;t--)this._observers[t](e);this._observers=[]}getLoggers(){return this.getFiberRef(oa)}log(e,t,r){let i=L.isSome(r)?r.value:this.getFiberRef(f.currentLogLevel),n=this.getFiberRef(s8);if(ek.greaterThan(n,i))return;let a=this.getFiberRef(f.currentLogSpan),s=this.getFiberRef(f.currentLogAnnotations),o=this.getLoggers(),l=this.getFiberRefs();if(D.size(o)>0){let r=new Date(p.get(this.getFiberRef(e8.currentServices),e2.clockTag).unsafeCurrentTimeMillis());e_.withRedactableContext(l,()=>{for(let n of o)n.log({fiberId:this.id(),logLevel:i,message:e,cause:t,context:l,spans:a,annotations:s,date:r})})}}evaluateMessageWhileSuspended(e){switch(e._tag){case i_:return sY;case iv:return this.processNewInterruptSignal(e.cause),null!==this._asyncInterruptor&&(this._asyncInterruptor(f.exitFailCause(e.cause)),this._asyncInterruptor=null),sQ;case iw:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(e.effect),sQ;case iE:return e.onFiber(this,null!==this._exitValue?eb:new ey(this.currentRuntimeFlags,this._asyncBlockingOn)),sQ;default:return s0(e)}}evaluateEffect(e){this.currentSupervisor.onResume(this);try{let t=ty.interruptible(this.currentRuntimeFlags)&&this.isInterrupted()?f.exitFailCause(this.getInterruptedCause()):e;for(;null!==t;){let e=t,r=this.runLoop(e);if(r===s1){let e=s2.currentOp;s2.currentOp=null,e._op===aW.OP_YIELD?ty.cooperativeYielding(this.currentRuntimeFlags)?(this.tell(iI()),this.tell(iC(f.exitVoid)),t=null):t=f.exitVoid:e._op===aW.OP_ASYNC&&(t=null)}else{this.currentRuntimeFlags=(0,a.pipe)(this.currentRuntimeFlags,ty.enable(ty.WindDown));let e=this.interruptAllChildren();null!==e?t=f.flatMap(e,()=>r):(0===this._queue.length?this.setExitValue(r):this.tell(iC(r)),t=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(e){if(this._running)this.tell(iC(e));else{this._running=!0;let t=globalThis[i3];globalThis[i3]=this;try{this.evaluateEffect(e)}finally{this._running=!1,globalThis[i3]=t,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(e){this.tell(iC(e))}patchRuntimeFlags(e,t){let r=ty.patch(e,t);return globalThis[i3]=this,this.currentRuntimeFlags=r,r}initiateAsync(e,t){let r=!1,i=e=>{r||(r=!0,this.tell(iC(e)))};ty.interruptible(e)&&(this._asyncInterruptor=i);try{t(i)}catch(e){i(f.failCause(e1.die(e)))}}pushStack(e){this._stack.push(e),"OnStep"===e._op&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let e=this._stack.pop();if(e)return"OnStep"===e._op&&this._steps.pop(),e}getNextSuccessCont(){let e=this.popStack();for(;e;){if(e._op!==aW.OP_ON_FAILURE)return e;e=this.popStack()}}getNextFailCont(){let e=this.popStack();for(;e;){if(e._op!==aW.OP_ON_SUCCESS&&e._op!==aW.OP_WHILE&&e._op!==aW.OP_ITERATOR)return e;e=this.popStack()}}[aW.OP_TAG](e){return f.sync(()=>p.unsafeGet(this.currentContext,e))}Left(e){return f.fail(e.left)}None(e){return f.fail(new f.NoSuchElementException)}Right(e){return f.exitSucceed(e.right)}Some(e){return f.exitSucceed(e.value)}Micro(e){return f.unsafeAsync(t=>{let r=t,i=ex.runFork(ex.provideContext(e,this.currentContext));return i.addObserver(e=>{if("Success"===e._tag)return r(f.exitSucceed(e.value));switch(e.cause._tag){case"Interrupt":return r(f.exitFailCause(e1.interrupt(N.none)));case"Fail":return r(f.fail(e.cause.error));case"Die":return r(f.die(e.cause.defect))}}),f.unsafeAsync(e=>{r=t=>{e(f.void)},i.unsafeInterrupt()})})}[aW.OP_SYNC](e){let t=(0,eX.internalCall)(()=>e.effect_instruction_i0()),r=this.getNextSuccessCont();return void 0!==r?(r._op in s6||s0(r),s6[r._op](this,r,t)):(s2.currentOp=f.exitSucceed(t),s1)}[aW.OP_SUCCESS](e){let t=this.getNextSuccessCont();return void 0!==t?(t._op in s6||s0(t),s6[t._op](this,t,e.effect_instruction_i0)):(s2.currentOp=e,s1)}[aW.OP_FAILURE](e){let t=e.effect_instruction_i0,r=this.getNextFailCont();if(void 0===r)return s2.currentOp=f.exitFailCause(t),s1;switch(r._op){case aW.OP_ON_FAILURE:case aW.OP_ON_SUCCESS_AND_FAILURE:if(!(ty.interruptible(this.currentRuntimeFlags)&&this.isInterrupted()))return(0,eX.internalCall)(()=>r.effect_instruction_i1(t));return f.exitFailCause(e1.stripFailures(t));case"OnStep":if(!(ty.interruptible(this.currentRuntimeFlags)&&this.isInterrupted()))return f.exitSucceed(f.exitFailCause(t));return f.exitFailCause(e1.stripFailures(t));case aW.OP_REVERT_FLAGS:if(this.patchRuntimeFlags(this.currentRuntimeFlags,r.patch),ty.interruptible(this.currentRuntimeFlags)&&this.isInterrupted())return f.exitFailCause(e1.sequential(t,this.getInterruptedCause()));return f.exitFailCause(t);default:s0(r)}}[aW.OP_WITH_RUNTIME](e){return(0,eX.internalCall)(()=>e.effect_instruction_i0(this,ev(this.currentRuntimeFlags)))}Blocked(e){let t=this.getFiberRefs(),r=this.currentRuntimeFlags;if(this._steps.length>0){let i=[],n=this._steps[this._steps.length-1],a=this.popStack();for(;a&&"OnStep"!==a._op;)i.push(a),a=this.popStack();this.setFiberRefs(n.refs),this.currentRuntimeFlags=n.flags;let s=ea(n.refs,t),o=ty.diff(n.flags,r);return f.exitSucceed(f.blocked(e.effect_instruction_i0,f.withFiberRuntime(t=>{for(;i.length>0;)t.pushStack(i.pop());return t.setFiberRefs(eo(t.id(),t.getFiberRefs())(s)),t.currentRuntimeFlags=ty.patch(o)(t.currentRuntimeFlags),e.effect_instruction_i1})))}return f.uninterruptibleMask(t=>f.flatMap(o_(f.runRequestBlock(e.effect_instruction_i0)),()=>t(e.effect_instruction_i1)))}RunBlocked(e){let t;return t=e.effect_instruction_i0,f.forEachSequentialDiscard(e0.flatten(t),e=>ov(e0.sequentialCollectionToChunk(e),([e,t])=>{let r=new Map,i=[];for(let e of t)for(let t of(i.push(c.toReadonlyArray(e)),e))r.set(t.request,t);let n=i.flat();return f.fiberRefLocally(li(e.runAll(i),n,()=>n.forEach(e=>{e.listeners.interrupted=!0})),e6,r)},!1,!1))}[aW.OP_UPDATE_RUNTIME_FLAGS](e){let t=e.effect_instruction_i0,r=this.currentRuntimeFlags,i=ty.patch(r,t);if(ty.interruptible(i)&&this.isInterrupted())return f.exitFailCause(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,t),!e.effect_instruction_i1)return f.exitVoid;{let t=ty.diff(i,r);return this.pushStack(new f.RevertFlags(t,e)),(0,eX.internalCall)(()=>e.effect_instruction_i1(r))}}[aW.OP_ON_SUCCESS](e){return this.pushStack(e),e.effect_instruction_i0}OnStep(e){return this.pushStack(e),e.effect_instruction_i0}[aW.OP_ON_FAILURE](e){return this.pushStack(e),e.effect_instruction_i0}[aW.OP_ON_SUCCESS_AND_FAILURE](e){return this.pushStack(e),e.effect_instruction_i0}[aW.OP_ASYNC](e){return this._asyncBlockingOn=e.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,e.effect_instruction_i0),s2.currentOp=e,s1}[aW.OP_YIELD](e){return this._isYielding=!1,s2.currentOp=e,s1}[aW.OP_WHILE](e){let t=e.effect_instruction_i0,r=e.effect_instruction_i1;return t()?(this.pushStack(e),r()):f.exitVoid}[aW.OP_ITERATOR](e){return s6[aW.OP_ITERATOR](this,e,void 0)}[aW.OP_COMMIT](e){return(0,eX.internalCall)(()=>e.commit())}runLoop(e){let t=e;for(this.currentOpCount=0;;){if((this.currentRuntimeFlags&ty.OpSupervision)!=0&&this.currentSupervisor.onEffect(this,t),this._queue.length>0&&(t=this.drainQueueWhileRunning(this.currentRuntimeFlags,t)),!this._isYielding){this.currentOpCount+=1;let e=this.currentScheduler.shouldYield(this);if(!1!==e){this._isYielding=!0,this.currentOpCount=0;let r=t;t=f.flatMap(f.yieldNow({priority:e}),()=>r)}}try{if((t=this.currentTracer.context(()=>{if(s4!==t[f.EffectTypeId]._V){let e=this.getFiberRef(f.currentVersionMismatchErrorLogLevel);if("Some"===e._tag){let r=t[f.EffectTypeId]._V;this.log(`Executing an Effect versioned ${r} with a Runtime of version ${sH.getCurrentVersion()}, you may want to dedupe the effect dependencies, you can use the language service plugin to detect this at compile time: https://github.com/Effect-TS/language-service`,e1.empty,e)}}return this[t._op](t)},this))===s1){let e=s2.currentOp;if(e._op===aW.OP_YIELD||e._op===aW.OP_ASYNC)return s1;return s2.currentOp=null,e._op===aW.OP_SUCCESS||e._op===aW.OP_FAILURE?e:f.exitFailCause(e1.die(e))}}catch(e){t=(t===s1||o.hasProperty(t,"_op"))&&t._op in this?f.isInterruptedException(e)?f.exitFailCause(e1.sequential(e1.die(e),e1.interrupt(N.none))):f.die(e):f.dieMessage(`Not a valid effect: ${e_.toStringUnknown(t)}`)}}}run=()=>{this.drainQueueOnCurrentThread()}}let s8=(0,eE.globalValue)("effect/FiberRef/currentMinimumLogLevel",()=>f.fiberRefUnsafeMake(ek.fromLiteral("Info"))),s7=e=>i7(t=>{let r=Z(t.context,e8.currentServices);p.get(r,r3.consoleTag).unsafe.log(e.log(t))}),s9=(0,eE.globalValue)(Symbol.for("effect/Logger/defaultLogger"),()=>s7(nc)),oe=(0,eE.globalValue)(Symbol.for("effect/Logger/jsonLogger"),()=>s7(nh)),ot=(0,eE.globalValue)(Symbol.for("effect/Logger/logFmtLogger"),()=>s7(np)),or=(0,eE.globalValue)(Symbol.for("effect/Logger/prettyLogger"),()=>nC),oi=(0,eE.globalValue)(Symbol.for("effect/Logger/structuredLogger"),()=>s7(nf)),on=(0,eE.globalValue)(Symbol.for("effect/Logger/tracerLogger"),()=>i7(({annotations:e,cause:t,context:r,fiberId:i,logLevel:n,message:a})=>{let s=p.getOption(Z(r,f.currentContext),to.spanTag);if("None"===s._tag||"ExternalSpan"===s.value._tag)return;let o=p.unsafeGet(Z(r,e8.currentServices),e2.clockTag),l={};for(let[t,r]of e)l[t]=r;l["effect.fiberId"]=N.threadName(i),l["effect.logLevel"]=n.label,null!==t&&"Empty"!==t._tag&&(l["effect.cause"]=e1.pretty(t,{renderErrorCause:!0})),s.value.event(e_.toStringUnknown(Array.isArray(a)?a[0]:a),o.unsafeCurrentTimeNanos(),l)})),oa=(0,eE.globalValue)(Symbol.for("effect/FiberRef/currentLoggers"),()=>f.fiberRefUnsafeMakeHashSet(D.make(s9,on))),os=(0,a.dual)(3,(e,t,r)=>f.flatMap(oK,i=>{let n=[],s=f.suspend(()=>{if(0===n.length)return f.void;let e=n;return n=[],r(e)});return f.uninterruptibleMask(r=>(0,a.pipe)(e7(t),f.zipRight(s),tQ,r,o_,f.flatMap(e=>f.scopeAddFinalizer(i,f.interruptFiber(e))),f.zipRight(oc(()=>s)),f.as(i7(t=>{n.push(e.log(t))}))))})),oo=(0,a.dual)(2,(e,t)=>{let r="string"==typeof t?ek.fromLiteral(t):t;return f.withFiberRuntime(t=>{let i=t.getFiberRef(s8);return ek.greaterThan(i,r)?f.succeed(L.none()):f.map(e,L.some)})}),ol=(0,a.dual)(e=>f.isEffect(e[0]),(e,t)=>f.uninterruptible(f.tap(e,e=>oc(r=>t(e,r))))),ou=(0,a.dual)(e=>f.isEffect(e[0]),(e,t)=>lr(e,oc(e=>t(e)))),oc=e=>f.withFiberRuntime(t=>{let r=t.getFiberRefs(),i=ty.disable(t.currentRuntimeFlags,ty.Interruption);return f.flatMap(oK,t=>f.scopeAddFinalizerExit(t,t=>f.withFiberRuntime(n=>{let a=n.getFiberRefs(),s=n.currentRuntimeFlags,o=ea(a,r),l=ty.diff(s,i),u=ea(r,a);return n.setFiberRefs(eo(o,n.id(),r)),lr(f.withRuntimeFlags(e(t),l),f.sync(()=>{n.setFiberRefs(eo(u,n.id(),n.getFiberRefs()))}))})))}),op=Symbol.for("effect/Effect/existsPar/found"),of=(0,a.dual)(e=>o.isIterable(e[0])&&!f.isEffect(e[0]),(e,t,r)=>e4(r?.concurrency,()=>f.suspend(()=>od(e[Symbol.iterator](),0,t)),()=>f.matchEffect(ob(e,(e,r)=>f.if_(t(e,r),{onTrue:()=>f.fail(op),onFalse:()=>f.void}),r),{onFailure:e=>e===op?f.succeed(!0):f.fail(e),onSuccess:()=>f.succeed(!1)}))),od=(e,t,r)=>{let i=e.next();return i.done?f.succeed(!1):f.flatMap(r(i.value,t),i=>i?f.succeed(i):od(e,t+1,r))},oh=(0,a.dual)(e=>o.isIterable(e[0])&&!f.isEffect(e[0]),(e,t,r)=>{let i=r?.negate?(e,r)=>f.map(t(e,r),l):t;return e4(r?.concurrency,()=>f.suspend(()=>u.fromIterable(e).reduceRight((e,t,r)=>f.zipWith(e,f.suspend(()=>i(t,r)),(e,r)=>r?[t,...e]:e),f.sync(()=>[]))),()=>f.map(ob(e,(e,t)=>f.map(i(e,t),t=>t?L.some(e):L.none()),r),u.getSomes))}),om=(e,t)=>{let[r,i]=(e=>{if(Array.isArray(e)||o.isIterable(e))return[e,L.none()];let t=Object.keys(e),r=t.length;return[t.map(t=>e[t]),L.some(e=>{let i={};for(let n=0;n<r;n++)i[t[n]]=e[n];return i})]})(e);if(t?.mode==="validate"){let e=[];for(let t of r)e.push(f.either(t));return f.flatMap(ob(e,a.identity,{concurrency:t?.concurrency,batching:t?.batching,concurrentFinalizers:t?.concurrentFinalizers}),e=>{let r=L.none(),n=e.length,a=Array(n),s=Array(n),o=!1;for(let t=0;t<n;t++){let i=e[t];"Left"===i._tag?(a[t]=L.some(i.left),o=!0):(s[t]=i.right,a[t]=r)}return o?"Some"===i._tag?f.fail(i.value(a)):f.fail(a):t?.discard?f.void:"Some"===i._tag?f.succeed(i.value(s)):f.succeed(s)})}if(t?.mode==="either"){let e=[];for(let t of r)e.push(f.either(t));return t?.discard?ob(e,a.identity,{concurrency:t?.concurrency,batching:t?.batching,discard:!0,concurrentFinalizers:t?.concurrentFinalizers}):f.map(ob(e,a.identity,{concurrency:t?.concurrency,batching:t?.batching,concurrentFinalizers:t?.concurrentFinalizers}),e=>"Some"===i._tag?i.value(e):e)}return t?.discard!==!0&&"Some"===i._tag?f.map(ob(r,a.identity,t),i.value):ob(r,a.identity,t)},og=(0,a.dual)(2,(e,t)=>Array.from({length:t},()=>e)),oy=(0,a.dual)(e=>f.isEffect(e[0]),(e,t,r)=>om(og(e,t),r)),ob=(0,a.dual)(e=>o.isIterable(e[0]),(e,t,r)=>f.withFiberRuntime(i=>{let n=r?.batching===!0||r?.batching==="inherit"&&i.getFiberRef(f.currentRequestBatching);return r?.discard?e3(r.concurrency,()=>oP(T,r?.concurrentFinalizers)(r=>n?ov(e,(e,i)=>r(t(e,i)),!0,!1,1):f.forEachSequentialDiscard(e,(e,i)=>r(t(e,i)))),()=>oP(R,r?.concurrentFinalizers)(r=>ov(e,(e,i)=>r(t(e,i)),n,!1)),i=>oP(O(i),r?.concurrentFinalizers)(r=>ov(e,(e,i)=>r(t(e,i)),n,!1,i))):e3(r?.concurrency,()=>oP(T,r?.concurrentFinalizers)(r=>n?oE(e,1,(e,i)=>r(t(e,i)),!0):f.forEachSequential(e,(e,i)=>r(t(e,i)))),()=>oP(R,r?.concurrentFinalizers)(r=>oS(e,(e,i)=>r(t(e,i)),n)),i=>oP(O(i),r?.concurrentFinalizers)(r=>oE(e,i,(e,i)=>r(t(e,i)),n)))})),oS=(e,t,r)=>f.suspend(()=>{let i=u.fromIterable(e),n=Array(i.length);return f.zipRight(ov(i,(e,r)=>f.flatMap(t(e,r),e=>f.sync(()=>n[r]=e)),r,!1),f.succeed(n))}),ov=(e,t,r,i,n)=>f.uninterruptibleMask(a=>f.transplant(s=>f.withFiberRuntime(o=>{let l=Array.from(e).reverse(),u=l.length;if(0===u)return f.void;let c=0,p=!1,d=n?Math.min(l.length,n):l.length,h=new Set,m=[],g=[],y=[],b=[],S=()=>{let e=m.filter(({exit:e})=>"Failure"===e._tag).sort((e,t)=>e.index<t.index?-1:+(e.index!==t.index)).map(({exit:e})=>e);return 0===e.length&&e.push(f.exitVoid),e},v=(e,t=!1)=>{let r=f.uninterruptible(s(e)),i=oC(r,o,o.currentRuntimeFlags,iM);return o.currentScheduler.scheduleTask(()=>{t&&i.unsafeInterruptAsFork(o.id()),i.resume(r)},0),i},E=()=>{i||(u-=l.length,l=[]),p=!0,h.forEach(e=>{e.currentScheduler.scheduleTask(()=>{e.unsafeInterruptAsFork(o.id())},0)})},w=r?f.step:f.exit,_=v(f.async(e=>{let i=(e,t)=>{"Blocked"===e._op?b.push(e):(m.push({index:t,exit:e}),"Failure"!==e._op||p||E())},s=()=>{if(l.length>0){let d=l.pop(),E=c++,_=e=>{if(l.length>0&&(i(e,E),l.length>0)){let e;return e=l.pop(),E=c++,f.flatMap(f.yieldNow(),()=>f.flatMap(w(a(t(e,E))),_))}return f.succeed(e)},k=v(f.flatMap(w(a(t(d,E))),_));g.push(k),h.add(k),p&&k.currentScheduler.scheduleTask(()=>{k.unsafeInterruptAsFork(o.id())},0),k.addObserver(t=>{let a;if(a="Failure"===t._op?t:t.effect_instruction_i0,y.push(k),h.delete(k),i(a,E),m.length===u)e(f.succeed(L.getOrElse(f.exitCollectAll(S(),{parallel:!0}),()=>f.exitVoid)));else if(b.length+m.length===u){let t=S(),i=b.map(e=>e.effect_instruction_i0).reduce(e0.par);e(f.succeed(f.blocked(i,ov([L.getOrElse(f.exitCollectAll(t,{parallel:!0}),()=>f.exitVoid),...b.map(e=>e.effect_instruction_i1)],e=>e,r,!0,n))))}else s()})}};for(let e=0;e<d;e++)s()}));return f.asVoid(f.onExit(f.flatten(a(iV(_))),f.exitMatch({onFailure:e=>{E();let t=b.length+1,r=Math.min("number"==typeof n?n:b.length,b.length),i=Array.from(b);return f.async(n=>{let a=[],s=0,o=0,l=(r,o)=>l=>{a[r]=l,++s===t&&n(f.exitSucceed(f.exitFailCause(e))),i.length>0&&o&&u()},u=()=>{v(i.pop(),!0).addObserver(l(o,!0)),o++};_.addObserver(l(o,!1)),o++;for(let e=0;e<r;e++)u()})},onSuccess:()=>f.forEachSequential(y,e=>e.inheritAll)})))}))),oE=(e,t,r,i)=>f.suspend(()=>{let n=u.fromIterable(e),a=Array(n.length);return f.zipRight(ov(n,(e,t)=>f.map(r(e,t),e=>a[t]=e),i,!1,t),f.succeed(a))}),ow=e=>f.withFiberRuntime((t,r)=>f.succeed(ox(e,t,r.runtimeFlags))),o_=e=>oT(e,iM),ok=(0,a.dual)(2,(e,t)=>ow(f.onError(e,e=>{let r=e1.failureOrCause(e);switch(r._tag){case"Left":return t(r.left);case"Right":return f.failCause(r.right)}}))),ox=(e,t,r,i=null)=>{let n=oI(e,t,r,i);return n.resume(e),n},oC=(e,t,r,i=null)=>oI(e,t,r,i),oI=(e,t,r,i=null)=>{let n=N.unsafeMake(),s=B(t.getFiberRefs(),n),o=new s5(n,s,r),l=Z(s,f.currentContext),u=o.currentSupervisor;return u.onStart(l,e,L.some(t),o),o.addObserver(e=>u.onEnd(e,o)),(null!==i?i:(0,a.pipe)(t.getFiberRef(f.currentForkScopeOverride),L.getOrElse(()=>t.scope()))).add(r,o),o},oT=(e,t)=>f.withFiberRuntime((r,i)=>f.succeed(ox(e,r,i.runtimeFlags,t))),oR=(0,a.dual)(e=>o.isFunction(e[2]),(e,t,r,i)=>e4(i?.concurrency,()=>u.fromIterable(e).reduce((e,t,i)=>f.zipWith(e,t,(e,t)=>r(e,t,i)),f.succeed(t)),()=>f.flatMap(eA(t),t=>f.flatMap(ob(e,(e,i)=>f.flatMap(e,e=>eq(t,t=>r(t,e,i))),i),()=>eN(t))))),oO=(0,a.dual)(e=>o.isIterable(e[0]),(e,t,r)=>(0,a.pipe)(ob(e,(e,r)=>f.either(t(e,r)),r),f.map(e=>f.partitionMap(e,a.identity)))),oF=(0,a.dual)(e=>o.isIterable(e[0]),(e,t,r)=>f.flatMap(oO(e,t,{concurrency:r?.concurrency,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),([e,t])=>u.isNonEmptyArray(e)?f.fail(e):r?.discard?f.void:f.succeed(t))),oM=(0,a.dual)(e=>o.isIterable(e[0])&&!f.isEffect(e[0]),(e,t,r,i)=>e4(i?.concurrency,()=>u.fromIterable(e).reduce((e,t,i)=>f.zipWith(e,t,(e,t)=>r(e,t,i)),t),()=>f.suspend(()=>(0,a.pipe)(oR([t,...e],L.none(),(e,t,i)=>{switch(e._tag){case"None":return L.some(t);case"Some":return L.some(r(e.value,t,i))}},i),f.map(e=>{switch(e._tag){case"None":throw Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/effect/issues");case"Some":return e.value}}))))),oA=e=>f.contextWithEffect(t=>L.match(p.getOption(t,oG),{onNone:()=>e,onSome:t=>{switch(t.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return f.flatMap(f.scopeFork(t,R),t=>oX(e,t))}}})),oN=e=>t=>f.contextWithEffect(r=>L.match(p.getOption(r,oG),{onNone:()=>t,onSome:r=>"ParallelN"===r.strategy._tag&&r.strategy.parallelism===e?t:f.flatMap(f.scopeFork(r,O(e)),e=>oX(t,e))})),oP=(e,t)=>r=>f.contextWithEffect(i=>L.match(p.getOption(i,oG),{onNone:()=>r(a.identity),onSome:i=>{if(!0!==t)return r(a.identity);{let t="Parallel"===e._tag?oA:"Sequential"===e._tag?oU:oN(e.parallelism);switch(i.strategy._tag){case"Parallel":return t(r(oA));case"Sequential":return t(r(oU));case"ParallelN":return t(r(oN(i.strategy.parallelism)))}}}})),oD=e=>f.flatMap(oG,e),oL=e=>f.flatMap(oY(),t=>f.onExit(e(t),e=>t.close(e))),oU=e=>f.contextWithEffect(t=>L.match(p.getOption(t,oG),{onNone:()=>e,onSome:t=>{switch(t.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return f.flatMap(f.scopeFork(t,T),t=>oX(e,t))}}})),oz=e=>o6(f.currentMetricLabels,t=>u.union(t,e)),oj=(0,a.dual)(2,(e,t)=>oL(r=>f.flatMap(oX(e,r),t))),oW=(0,a.dual)(e=>f.isEffect(e[1]),(e,t,r)=>oq(e,t,(e,t)=>[e,t],r)),oq=(0,a.dual)(e=>f.isEffect(e[1]),(e,t,r,i)=>f.flatten(oJ(f.exit(e),f.exit(t),(e,t)=>f.exitZipWith(e,t,{onSuccess:r,onFailure:(e,t)=>i?.concurrent?e1.parallel(e,t):e1.sequential(e,t)}),i))),o$=(0,a.dual)(e=>o.isIterable(e[0]),(e,t,r)=>f.flip(ob(e,(e,r)=>f.flip(t(e,r)),r))),oB=(0,a.dual)(e=>f.isEffect(e[1]),(e,t,r)=>oJ(e,t,(e,t)=>[e,t],r)),oH=(0,a.dual)(e=>f.isEffect(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||!1===r.batching)?f.zipLeft(e,t):oJ(e,t,(e,t)=>e,r)),oV=(0,a.dual)(e=>f.isEffect(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||!1===r.batching)?f.zipRight(e,t):oJ(e,t,(e,t)=>t,r)),oJ=(0,a.dual)(e=>f.isEffect(e[1]),(e,t,r,i)=>f.map(om([e,t],{concurrency:i?.concurrent?2:1,batching:i?.batching,concurrentFinalizers:i?.concurrentFinalizers}),([e,t])=>r(e,t))),oG=p.GenericTag("effect/Scope"),oK=oG,oZ={[f.ScopeTypeId]:f.ScopeTypeId,[f.CloseableScopeTypeId]:f.CloseableScopeTypeId,pipe(){return(0,U.pipeArguments)(this,arguments)},fork(e){return f.sync(()=>{var t;let r=oQ(e);if("Closed"===this.state._tag)return r.state=this.state,r;let i={};return this.state.finalizers.set(i,e=>r.close(e)),t=e=>f.sync(()=>{"Open"===this.state._tag&&this.state.finalizers.delete(i)}),"Open"===r.state._tag&&r.state.finalizers.set({},t),r})},close(e){return f.suspend(()=>{if("Closed"===this.state._tag)return f.void;let t=Array.from(this.state.finalizers.values()).reverse();return(this.state={_tag:"Closed",exit:e},0===t.length)?f.void:F(this.strategy)?(0,a.pipe)(f.forEachSequential(t,t=>f.exit(t(e))),f.flatMap(e=>(0,a.pipe)(f.exitCollectAll(e),L.map(f.exitAsVoid),L.getOrElse(()=>f.exitVoid)))):M(this.strategy)?(0,a.pipe)(oS(t,t=>f.exit(t(e)),!1),f.flatMap(e=>(0,a.pipe)(f.exitCollectAll(e,{parallel:!0}),L.map(f.exitAsVoid),L.getOrElse(()=>f.exitVoid)))):(0,a.pipe)(oE(t,this.strategy.parallelism,t=>f.exit(t(e)),!1),f.flatMap(e=>(0,a.pipe)(f.exitCollectAll(e,{parallel:!0}),L.map(f.exitAsVoid),L.getOrElse(()=>f.exitVoid))))})},addFinalizer(e){return f.suspend(()=>"Closed"===this.state._tag?e(this.state.exit):(this.state.finalizers.set({},e),f.void))}},oQ=(e=T)=>{let t=Object.create(oZ);return t.strategy=e,t.state={_tag:"Open",finalizers:new Map},t},oY=(e=T)=>f.sync(()=>oQ(e)),oX=(0,a.dual)(2,(e,t)=>f.mapInputContext(e,p.merge(p.make(oG,t)))),o0=(0,a.dual)(2,(e,t)=>(0,a.pipe)(e,oX(t),f.onExit(e=>t.close(e)))),o1=e=>f.fiberRefUnsafeMakePatch(e,{differ:sB,fork:sj}),o2=(0,a.dual)(2,(e,t)=>f.asVoid(ol(f.flatMap(f.fiberRefGet(e),r=>f.as(f.fiberRefSet(e,t),r)),t=>f.fiberRefSet(e,t)))),o6=(0,a.dual)(2,(e,t)=>f.fiberRefGetWith(e,r=>o2(e,t(r)))),o3=e=>ol(f.tap(f.sync(e),e=>f.fiberRefUpdate(e,a.identity)),e=>f.fiberRefDelete(e)),o4=f.fiberRefUnsafeMakeRuntimeFlags(ty.none),o5=o1(sI),o8=e=>({...k.CommitPrototype,commit(){return iV(this)},[iA]:iN,id:()=>u.fromIterable(e).reduce((e,t)=>N.combine(e,t.id()),N.none),await:f.exit(oS(e,e=>f.flatten(e.await),!1)),children:f.map(oS(e,e=>e.children,!1),u.flatten),inheritAll:f.forEachSequentialDiscard(e,e=>e.inheritAll),poll:f.map(f.forEachSequential(e,e=>e.poll),u.reduceRight(L.some(f.exitSucceed([])),(e,t)=>{switch(t._tag){case"None":return L.none();case"Some":switch(e._tag){case"None":return L.none();case"Some":return L.some(f.exitZipWith(t.value,e.value,{onSuccess:(e,t)=>[e,...t],onFailure:e1.parallel}))}}})),interruptAsFork:t=>f.forEachSequentialDiscard(e,e=>e.interruptAsFork(t))}),o7=(0,a.dual)(3,(e,t,r)=>le(e,t,{onSelfWin:(e,t)=>f.flatMap(e.await,i=>{switch(i._tag){case aW.OP_SUCCESS:return f.flatMap(e.inheritAll,()=>r.onSelfDone(i,t));case aW.OP_FAILURE:return r.onSelfDone(i,t)}}),onOtherWin:(e,t)=>f.flatMap(e.await,i=>{switch(i._tag){case aW.OP_SUCCESS:return f.flatMap(e.inheritAll,()=>r.onOtherDone(i,t));case aW.OP_FAILURE:return r.onOtherDone(i,t)}})})),o9=(0,a.dual)(2,(e,t)=>f.fiberIdWith(r=>o7(e,t,{onSelfDone:(e,t)=>f.exitMatchEffect(e,{onFailure:e=>(0,a.pipe)(iV(t),rn(t=>e1.parallel(e,t))),onSuccess:e=>(0,a.pipe)(t,f.interruptAsFiber(r),f.as(e))}),onOtherDone:(e,t)=>f.exitMatchEffect(e,{onFailure:e=>(0,a.pipe)(iV(t),rn(t=>e1.parallel(t,e))),onSuccess:e=>(0,a.pipe)(t,f.interruptAsFiber(r),f.as(e))})}))),le=(0,a.dual)(3,(e,t,r)=>f.withFiberRuntime((i,n)=>{let a=n.runtimeFlags,s=eC.make(!0),o=oI(e,i,a,r.selfScope),l=oI(t,i,a,r.otherScope);return f.async(i=>{o.addObserver(()=>lt(o,l,r.onSelfWin,s,i)),l.addObserver(()=>lt(l,o,r.onOtherWin,s,i)),o.startFork(e),l.startFork(t)},N.combine(o.id(),l.id()))})),lt=(e,t,r,i,n)=>{eC.compareAndSet(!0,!1)(i)&&n(r(e,t))},lr=(0,a.dual)(2,(e,t)=>f.uninterruptibleMask(r=>f.matchCauseEffect(r(e),{onFailure:e=>f.matchCauseEffect(t,{onFailure:t=>f.failCause(e1.sequential(e,t)),onSuccess:()=>f.failCause(e)}),onSuccess:e=>f.as(t,e)}))),li=(e,t,r)=>f.fiberIdWith(i=>f.flatMap(f.flatMap(o_(f.interruptible(e)),e=>f.async(i=>{let n=t.map(e=>e.listeners.count),a=()=>{n.every(e=>0===e)&&t.every(e=>"Pending"===e.result.state.current._tag||!!("Done"===e.result.state.current._tag&&f.exitIsExit(e.result.state.current.effect)&&"Failure"===e.result.state.current.effect._tag&&e1.isInterrupted(e.result.state.current.effect.cause)))&&(s.forEach(e=>e()),r?.(),i(f.interruptFiber(e)))};e.addObserver(e=>{s.forEach(e=>e()),i(e)});let s=t.map((e,t)=>{let r=e=>{n[t]=e,a()};return e.listeners.addObserver(r),()=>e.listeners.removeObserver(r)});return a(),f.sync(()=>{s.forEach(e=>e())})})),()=>f.suspend(()=>{let e=t.flatMap(e=>e.state.completed?[]:[e]);return f.forEachSequentialDiscard(e,e=>aV(e.request,f.exitInterrupt(i)))}))),ln=(0,a.dual)(2,(e,t)=>f.fiberRefGetWith(e6,r=>f.suspend(()=>li(e,u.fromIterable(t).flatMap(e=>r.has(e)?[r.get(e)]:[]))))),la=(e,t)=>(t=to.addSpanStackTrace(t),f.uninterruptible(f.withFiberRuntime(r=>{let i=p.unsafeGet(r.getFiberRef(f.currentContext),oG),n=rQ(r,e,t),a=r.getFiberRef(f.currentTracerTimingEnabled),s=p.get(r.getFiberRef(e8.currentServices),e2.clockTag);return f.as(f.scopeAddFinalizerExit(i,e=>r0(n,e,s,a)),n)})));e.s(["FiberRuntime",()=>s5,"acquireRelease",0,ol,"acquireReleaseInterruptible",0,ou,"addFinalizer",0,oc,"all",0,om,"allSuccesses",0,(e,t)=>f.map(om(u.fromIterable(e).map(f.exit),t),u.filterMap(e=>f.exitIsSuccess(e)?L.some(e.effect_instruction_i0):L.none())),"allWith",0,e=>t=>om(t,e),"annotateLogsScoped",0,function(){if("string"==typeof arguments[0])return o6(f.currentLogAnnotations,ew.set(arguments[0],arguments[1]));let e=Object.entries(arguments[0]);return o6(f.currentLogAnnotations,ew.mutate(t=>{for(let r=0;r<e.length;r++){let[i,n]=e[r];ew.set(t,i,n)}return t}))},"batchedLogger",0,os,"currentLoggers",0,oa,"currentMinimumLogLevel",0,s8,"currentRuntimeFlags",0,o4,"currentSupervisor",0,o5,"daemonChildren",0,e=>f.fiberRefLocally(f.currentForkScopeOverride,L.some(iM))(e),"defaultLogger",0,s9,"disconnect",0,e=>f.uninterruptibleMask(t=>f.fiberIdWith(r=>f.flatMap(o_(t(e)),e=>(0,a.pipe)(t(iV(e)),f.onInterrupt(()=>(0,a.pipe)(e,iH(r))))))),"ensuring",0,lr,"exists",0,of,"fiberAll",0,o8,"fiberAwaitAll",0,e=>ob(e,iz),"fiberInterruptFork",0,e=>f.asVoid(o_(f.interruptFiber(e))),"fiberJoinAll",0,e=>iV(o8(e)),"fiberRefLocallyScoped",0,o2,"fiberRefLocallyScopedWith",0,o6,"fiberRefMake",0,(e,t)=>o3(()=>f.fiberRefUnsafeMake(e,t)),"fiberRefMakeContext",0,e=>o3(()=>f.fiberRefUnsafeMakeContext(e)),"fiberRefMakeRuntimeFlags",0,e=>o3(()=>f.fiberRefUnsafeMakeRuntimeFlags(e)),"fiberRefMakeWith",0,o3,"fiberRefUnsafeMakeSupervisor",0,o1,"fiberScoped",0,e=>ol(f.succeed(e),f.interruptFiber),"filter",0,oh,"finalizersMask",0,e=>t=>oP(e,!0)(t),"forEach",0,ob,"forEachConcurrentDiscard",0,ov,"forEachParUnbounded",0,oS,"fork",0,ow,"forkDaemon",0,o_,"forkWithErrorHandler",0,ok,"interruptWhenPossible",0,ln,"jsonLogger",0,oe,"labelMetricsScoped",0,oz,"logFmtLogger",0,ot,"loggerWithConsoleError",0,e=>i7(t=>{let r=Z(t.context,e8.currentServices);p.get(r,r3.consoleTag).unsafe.error(e.log(t))}),"loggerWithConsoleLog",0,s7,"loggerWithLeveledLog",0,e=>i7(t=>{let r=Z(t.context,e8.currentServices),i=p.get(r,r3.consoleTag).unsafe;switch(t.logLevel._tag){case"Debug":return i.debug(e.log(t));case"Info":return i.info(e.log(t));case"Trace":return i.trace(e.log(t));case"Warning":return i.warn(e.log(t));case"Error":case"Fatal":return i.error(e.log(t));default:return i.log(e.log(t))}}),"loggerWithSpanAnnotations",0,e=>ne(e,e=>{let t=L.flatMap(K(e.context,f.currentContext),p.getOption(to.spanTag));return"None"===t._tag?e:{...e,annotations:(0,a.pipe)(e.annotations,ew.set("effect.traceId",t.value.traceId),ew.set("effect.spanId",t.value.spanId),"Span"===t.value._tag?ew.set("effect.spanName",t.value.name):a.identity)}}),"makeSpanScoped",0,la,"mergeAll",0,oR,"parallelFinalizers",0,oA,"partition",0,oO,"prettyLogger",0,or,"race",0,o9,"raceAll",0,e=>{let t=c.fromIterable(e);if(!c.isNonEmpty(t))return f.dieSync(()=>new f.IllegalArgumentException("Received an empty collection of effects"));let r=c.headNonEmpty(t),i=c.tailNonEmpty(t),n=e=>(0,a.pipe)(i$(e[1]),f.as(e[0]));return(0,a.pipe)(f.deferredMake(),f.flatMap(e=>(0,a.pipe)(eA(i.length),f.flatMap(t=>f.uninterruptibleMask(s=>(0,a.pipe)(ow(f.interruptible(r)),f.flatMap(r=>(0,a.pipe)(i,f.forEachSequential(e=>ow(f.interruptible(e))),f.map(e=>c.unsafeFromArray(e)),f.map(e=>(0,a.pipe)(e,c.prepend(r))),f.tap(r=>(0,a.pipe)(r,u.reduce(f.void,(i,n)=>{let s,o,l,p;return(0,a.pipe)(i,f.zipRight((0,a.pipe)(iz(n),f.flatMap((s=r,o=n,l=e,p=t,e=>f.exitMatchEffect(e,{onFailure:e=>(0,a.pipe)(ej(p,t=>[0===t?(0,a.pipe)(f.deferredFailCause(l,e),f.asVoid):f.void,t-1]),f.flatten),onSuccess:e=>(0,a.pipe)(f.deferredSucceed(l,[e,o]),f.flatMap(e=>e?(0,a.pipe)(c.fromIterable(s),u.reduce(f.void,(e,t)=>t===o?e:(0,a.pipe)(e,f.zipLeft(f.interruptFiber(t))))):f.void))}))),ow,f.asVoid)))}))),f.flatMap(t=>(0,a.pipe)(s((0,a.pipe)(h(e),f.flatMap(n))),f.onInterrupt(()=>(0,a.pipe)(t,u.reduce(f.void,(e,t)=>(0,a.pipe)(e,f.zipLeft(f.interruptFiber(t))))))))))))))))},"raceFibersWith",0,le,"raceWith",0,o7,"reduceEffect",0,oM,"replicate",0,og,"replicateEffect",0,oy,"scope",0,oK,"scopeExtend",0,oX,"scopeMake",0,oY,"scopeTag",0,oG,"scopeUse",0,o0,"scopeWith",0,oD,"scopedEffect",0,e=>f.flatMap(oY(),t=>o0(e,t)),"scopedWith",0,oL,"sequentialFinalizers",0,oU,"structuredLogger",0,oi,"tagMetricsScoped",0,(e,t)=>oz([tm(e,t)]),"tracerLogger",0,on,"unsafeFork",0,ox,"using",0,oj,"validate",0,oW,"validateAll",0,oF,"validateFirst",0,o$,"validateWith",0,oq,"whenLogLevel",0,oo,"withClockScoped",0,e=>o6(e8.currentServices,p.add(e2.clockTag,e)),"withConfigProviderScoped",0,e=>o6(e8.currentServices,p.add(e5.configProviderTag,e)),"withEarlyRelease",0,e=>oD(t=>f.flatMap(f.scopeFork(t,T),t=>(0,a.pipe)(e,oX(t),f.map(e=>[f.fiberIdWith(e=>f.scopeClose(t,f.exitInterrupt(e))),e])))),"withRandomScoped",0,e=>o6(e8.currentServices,p.add(aq.randomTag,e)),"withRuntimeFlagsScoped",0,e=>e===eV.empty?f.void:(0,a.pipe)(f.runtimeFlags,f.flatMap(t=>{let r=ty.patch(t,e),i=ty.diff(r,t);return(0,a.pipe)(f.updateRuntimeFlags(e),f.zipRight(oc(()=>f.updateRuntimeFlags(i))),f.asVoid)}),f.uninterruptible),"withSpanScoped",0,function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=to.addSpanStackTrace(e?arguments[2]:arguments[1]);if(e){let e=arguments[0];return f.flatMap(la(t,to.addSpanStackTrace(r)),t=>ru(e,to.spanTag,t))}return e=>f.flatMap(la(t,to.addSpanStackTrace(r)),t=>ru(e,to.spanTag,t))},"withTracerScoped",0,e=>o6(e8.currentServices,p.add(to.tracerTag,e)),"zipLeftOptions",0,oH,"zipOptions",0,oB,"zipRightOptions",0,oV,"zipWithOptions",0,oJ],276406)},625552,405889,165039,741840,e=>{"use strict";var t=e.i(580611),r=e.i(276406);t.ScopeTypeId,t.CloseableScopeTypeId;let i=r.scopeTag,n=t.scopeAddFinalizer,a=t.scopeAddFinalizerExit,s=t.scopeClose,o=r.scopeExtend,l=t.scopeFork;r.scopeUse;let u=r.scopeMake;e.s(["Scope",0,i,"addFinalizer",0,n,"addFinalizerExit",0,a,"close",0,s,"extend",0,o,"fork",0,l,"make",0,u],625552);var c=e.i(649488),p=e.i(680465),f=e.i(945831),d=e.i(368171),h=e.i(500577),m=e.i(842862),g=e.i(408043),y=e.i(190512),b=e.i(65632),S=e.i(787039),v=e.i(100808),E=e.i(423616),w=e.i(803327),_=e.i(129627),k=e.i(395649),x=e.i(137696),C=e.i(874559),I=e.i(742502),T=e.i(764120);class R{permits;waiters=new Set;taken=0;constructor(e){this.permits=e}get free(){return this.permits-this.taken}take=e=>t.asyncInterrupt(r=>{if(this.free<e){let i=()=>{this.free<e||(this.waiters.delete(i),this.taken+=e,r(t.succeed(e)))};return this.waiters.add(i),t.sync(()=>{this.waiters.delete(i)})}return this.taken+=e,r(t.succeed(e))});updateTaken=e=>t.withFiberRuntime(r=>(this.taken=e(this.taken),this.waiters.size>0&&r.getFiberRef(w.currentScheduler).scheduleTask(()=>{let e=this.waiters.values(),t=e.next();for(;!1===t.done&&this.free>0;)t.value(),t=e.next()},r.getFiberRef(t.currentSchedulingPriority)),t.succeed(this.free)));release=e=>this.updateTaken(t=>t-e);releaseAll=this.updateTaken(e=>0);withPermits=e=>i=>t.uninterruptibleMask(n=>t.flatMap(n(this.take(e)),e=>r.ensuring(n(i),this.release(e))));withPermitsIfAvailable=e=>i=>t.uninterruptibleMask(n=>t.suspend(()=>this.free<e?k.succeedNone:(this.taken+=e,r.ensuring(n(k.asSome(i)),this.release(e)))))}let O=e=>new R(e);class F extends p.Class{isOpen;waiters=[];scheduled=!1;constructor(e){super(),this.isOpen=e}commit(){return this.await}unsafeSchedule(e){return this.scheduled||0===this.waiters.length||(this.scheduled=!0,e.currentScheduler.scheduleTask(this.flushWaiters,e.getFiberRef(t.currentSchedulingPriority))),t.void}flushWaiters=()=>{this.scheduled=!1;let e=this.waiters;this.waiters=[];for(let r=0;r<e.length;r++)e[r](t.exitVoid)};open=t.withFiberRuntime(e=>this.isOpen?t.void:(this.isOpen=!0,this.unsafeSchedule(e)));unsafeOpen(){this.isOpen||(this.isOpen=!0,this.flushWaiters())}release=t.withFiberRuntime(e=>this.isOpen?t.void:this.unsafeSchedule(e));await=t.asyncInterrupt(e=>this.isOpen?e(t.void):(this.waiters.push(e),t.sync(()=>{let t=this.waiters.indexOf(e);-1!==t&&this.waiters.splice(t,1)})));unsafeClose(){this.isOpen=!1}close=t.sync(()=>{this.isOpen=!1});whenOpen=e=>t.zipRight(this.await,e)}let M=e=>new F(e??!1),A=(0,m.dual)(2,(e,r)=>t.map(N(e,r),e=>e[0])),N=(0,m.dual)(2,(e,r)=>{let i=c.decode(r);return t.flatMap(t.context(),r=>t.map(ee(b.none()),n=>[t.provideContext(D(e,i,n),r),L(n)]))}),P=(e,r,i)=>{let n=c.toMillis(c.decode(r));return(0,m.pipe)(t.deferredMake(),t.tap(r=>t.intoDeferred(e,r)),t.map(e=>b.some([i+n,e])))},D=(e,r,i)=>t.uninterruptibleMask(n=>(0,m.pipe)(k.clockWith(e=>e.currentTimeMillis),t.flatMap(t=>er(i,i=>{switch(i._tag){case"None":return b.some(P(e,r,t));case"Some":{let[n]=i.value;return n-t<=0?b.some(P(e,r,t)):b.none()}}})),t.flatMap(e=>b.isNone(e)?t.dieMessage("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):n(t.deferredAwait(e.value[1]))))),L=e=>I.set(e,b.none()),U=(0,m.dual)(2,(e,t)=>z(e,e=>t(r.fiberAll(e)))),z=(0,m.dual)(2,(e,i)=>t.flatMap(T.track,n=>(0,m.pipe)(H(e,n),r.ensuring(t.flatMap(n.value,i))))),j=(0,m.dual)(e=>v.isIterable(e[0]),(e,i)=>i?.discard?t.forEachSequentialDiscard(e,r.fork):t.map(t.forEachSequential(e,r.fork),r.fiberAll)),W=(0,m.dual)(2,(e,i)=>t.withFiberRuntime((n,a)=>{let s=r.unsafeFork(e,n,a.runtimeFlags,C.globalScope);if("Open"===i.state._tag){let e={};i.state.finalizers.set(e,()=>t.fiberIdWith(e=>f.equals(e,s.id())?t.void:t.asVoid(t.interruptFiber(s)))),s.addObserver(()=>{"Closed"!==i.state._tag&&i.state.finalizers.delete(e)})}else s.unsafeInterruptAsFork(n.id());return t.succeed(s)})),q=Symbol.for("effect/Effect/memoizeFunction.key");class ${a;eq;[q]=q;constructor(e,t){this.a=e,this.eq=t}[f.symbol](e){if(v.hasProperty(e,q))if(this.eq)return this.eq(this.a,e.a);else return f.equals(this.a,e.a);return!1}[g.symbol](){return this.eq?0:g.cached(this,g.hash(this.a))}}let B=(0,m.dual)(2,(e,i)=>(0,m.pipe)(t.exit(e),r.race(t.exit(i)),e=>t.flatten(e))),H=(0,m.dual)(2,(e,i)=>t.fiberRefLocallyWith(r.currentSupervisor,e=>e.zip(i))(e)),V=(0,m.dual)(2,(e,r)=>J(e,{onTimeout:()=>t.timeoutExceptionFromDuration(r),duration:r})),J=(0,m.dual)(2,(e,{duration:r,onTimeout:i})=>t.flatten(Z(e,{onTimeout:()=>t.failSync(i),onSuccess:t.succeed,duration:r}))),G=(0,m.dual)(2,(e,{duration:r,onTimeout:i})=>t.flatten(Z(e,{onTimeout:()=>t.failCauseSync(i),onSuccess:t.succeed,duration:r}))),K=(0,m.dual)(2,(e,t)=>Z(e,{duration:t,onSuccess:b.some,onTimeout:b.none})),Z=(0,m.dual)(2,(e,{duration:i,onSuccess:n,onTimeout:a})=>t.fiberIdWith(s=>t.uninterruptibleMask(o=>r.raceFibersWith(o(e),t.interruptible(k.sleep(i)),{onSelfWin:(e,r)=>t.flatMap(e.await,i=>"Success"===i._tag?t.flatMap(e.inheritAll,()=>t.as(t.interruptAsFiber(r,s),n(i.value))):t.flatMap(t.interruptAsFiber(r,s),()=>t.exitFailCause(i.cause))),onOtherWin:(e,r)=>t.flatMap(e.await,i=>"Success"===i._tag?t.flatMap(e.inheritAll,()=>t.as(t.interruptAsFiber(r,s),a())):t.flatMap(t.interruptAsFiber(r,s),()=>t.exitFailCause(i.cause))),otherScope:C.globalScope})))),Q=Symbol.for("effect/Ref/SynchronizedRef"),Y={_A:e=>e};class X extends p.Class{ref;withLock;[Q]=Y;[I.RefTypeId]=I.refVariance;[E.TypeId]=E.TypeId;constructor(e,t){super(),this.ref=e,this.withLock=t,this.get=I.get(this.ref)}get;commit(){return this.get}modify(e){return this.modifyEffect(r=>t.succeed(e(r)))}modifyEffect(e){return this.withLock((0,m.pipe)(t.flatMap(I.get(this.ref),e),t.flatMap(([e,r])=>t.as(I.set(this.ref,r),e))))}}let ee=e=>t.sync(()=>et(e)),et=e=>new X(I.unsafeMake(e),O(1).withPermits(1)),er=(0,m.dual)(2,(e,r)=>e.modifyEffect(e=>{let i=r(e);switch(i._tag){case"None":return t.succeed([e,e]);case"Some":return t.map(i.value,e=>[e,e])}})),ei=(0,m.dual)(2,(e,t)=>es(e,t,(e,t)=>[e,t])),en=(0,m.dual)(2,(e,t)=>es(e,t,(e,t)=>e)),ea=(0,m.dual)(2,(e,t)=>es(e,t,(e,t)=>t)),es=(0,m.dual)(3,(e,i,n)=>({...p.CommitPrototype,commit(){return x.join(this)},[x.FiberTypeId]:x.fiberVariance,id:()=>(0,m.pipe)(e.id(),h.getOrElse(i.id())),await:(0,m.pipe)(e.await,t.flatten,r.zipWithOptions(t.flatten(i.await),n,{concurrent:!0}),t.exit),children:e.children,inheritAll:t.zipRight(i.inheritAll,e.inheritAll),poll:t.zipWith(e.poll,i.poll,(e,t)=>(0,m.pipe)(e,b.flatMap(e=>(0,m.pipe)(t,b.map(t=>d.zipWith(e,t,{onSuccess:n,onFailure:_.parallel})))))),interruptAsFork:r=>t.zipRight(e.interruptAsFork(r),i.interruptAsFork(r)),pipe(){return(0,S.pipeArguments)(this,arguments)}})),eo=(0,m.dual)(e=>t.isEffect(e[0]),(e,i,n)=>t.flatMap(e,e=>r.all(i(e),n).pipe(t.map(t=>Object.assign({},e,t)))));e.s(["awaitAllChildren",0,e=>z(e,r.fiberAwaitAll),"bindAll",0,eo,"cached",0,A,"cachedFunction",0,(e,i)=>(0,m.pipe)(t.sync(()=>y.empty()),t.flatMap(ee),t.map(n=>a=>(0,m.pipe)(n.modifyEffect(n=>{let s=(0,m.pipe)(n,y.get(new $(a,i)));return b.isNone(s)?(0,m.pipe)(t.deferredMake(),t.tap(i=>(0,m.pipe)(k.diffFiberRefs(e(a)),t.intoDeferred(i),r.fork)),t.map(e=>[e,(0,m.pipe)(n,y.set(new $(a,i),e))])):t.succeed([s.value,n])}),t.flatMap(t.deferredAwait),t.flatMap(([e,r])=>(0,m.pipe)(k.patchFiberRefs(e),t.as(r)))))),"cachedInvalidateWithTTL",0,N,"ensuringChild",0,U,"ensuringChildren",0,z,"forkAll",0,j,"forkIn",0,W,"forkScoped",0,e=>r.scopeWith(t=>W(e,t)),"fromFiber",0,e=>x.join(e),"fromFiberEffect",0,e=>t.suspend(()=>t.flatMap(e,x.join)),"makeLatch",0,e=>t.sync(()=>M(e)),"makeSemaphore",0,e=>t.sync(()=>O(e)),"makeSynchronized",0,ee,"raceFirst",0,B,"supervised",0,H,"timeout",0,V,"timeoutFail",0,J,"timeoutFailCause",0,G,"timeoutOption",0,K,"timeoutTo",0,Z,"unsafeMakeLatch",0,M,"unsafeMakeSemaphore",0,O,"unsafeMakeSynchronized",0,et,"zipFiber",0,ei,"zipLeftFiber",0,en,"zipRightFiber",0,ea,"zipWithFiber",0,es],405889);var el=e.i(777865);x.FiberTypeId,x.RuntimeFiberTypeId,x.Order,x.isFiber,x.isRuntimeFiber,x.id;let eu=x._await;r.fiberAwaitAll,x.children,r.fiberAll,x.done,x.dump,x.dumpAll,x.fail,x.failCause,x.fromEffect;let ec=x.getCurrentFiber,ep=x.inheritAll,ef=t.interruptFiber;x.interrupted;let ed=t.interruptAsFiber;x.interruptAsFork,x.interruptAll;let eh=x.interruptAllAs;r.fiberInterruptFork;let em=x.join;r.fiberJoinAll,x.map,x.mapEffect,x.mapFiber,x.match,x.never,x.orElse,x.orElseEither;let eg=x.poll;x.pretty,x.roots,x.unsafeRoots,r.fiberScoped,x.status,x.succeed,x.void,e.s(["await",()=>eu,"getCurrentFiber",0,ec,"inheritAll",0,ep,"interrupt",0,ef,"interruptAllAs",0,eh,"interruptAs",0,ed,"join",0,em,"poll",0,eg],165039);var ey=e.i(684823),eb=e.i(580537),eS=e.i(213979),ev=e.i(25560),eE=e.i(399683);let ew=e=>function(){if(1==arguments.length){let t=arguments[0];return(r,...i)=>e(t,r,...i)}return e.apply(this,arguments)},e_=ew((e,i,n)=>{let a=h.unsafeMake(),o=[[t.currentContext,[[a,e.context]]]];n?.scheduler&&o.push([w.currentScheduler,[[a,n.scheduler]]]);let u=ey.updateManyAs(e.fiberRefs,{entries:o,forkAs:a});n?.updateRefs&&(u=n.updateRefs(u,a));let c=new r.FiberRuntime(a,u,e.runtimeFlags),p=i;n?.scope&&(p=t.flatMap(l(n.scope,eS.sequential),e=>t.zipRight(t.scopeAddFinalizer(e,t.fiberIdWith(e=>(0,f.equals)(e,c.id())?t.void:t.interruptAsFiber(c,e))),t.onExit(i,t=>s(e,t)))));let d=c.currentSupervisor;return d!==T.none&&(d.onStart(e.context,p,b.none(),c),c.addObserver(e=>d.onEnd(e,c))),C.globalScope.add(e.runtimeFlags,c),n?.immediate===!1?c.resume(p):c.start(p),c}),ek=ew((e,t,r={})=>{let i=e_(e,t,r);return r.onExit&&i.addObserver(e=>{r.onExit(e)}),(t,r)=>ek(e)((0,m.pipe)(i,ed(t??h.none)),{...r,onExit:r?.onExit?e=>r.onExit(d.flatten(e)):void 0})}),ex=ew((e,t)=>{let r=eM(e)(t);if("Failure"===r._tag)throw eO(r.effect_instruction_i0);return r.effect_instruction_i0});class eC extends Error{fiber;_tag="AsyncFiberException";constructor(e){super(`Fiber #${e.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=e,this.name=this._tag,this.stack=this.message}}let eI=Symbol.for("effect/Runtime/FiberFailure"),eT=Symbol.for("effect/Runtime/FiberFailure/Cause");class eR extends Error{[eI];[eT];constructor(e){const t=_.prettyErrors(e)[0];super(t?.message||"An error has occurred"),this[eI]=eI,this[eT]=e,this.name=t?`(FiberFailure) ${t.name}`:"FiberFailure",t?.stack&&(this.stack=t.stack)}toJSON(){return{_id:"FiberFailure",cause:this[eT].toJSON()}}toString(){return"(FiberFailure) "+_.pretty(this[eT],{renderErrorCause:!0})}[eb.NodeInspectSymbol](){return this.toString()}}let eO=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new eR(e);return Error.stackTraceLimit=t,r},eF=e=>{switch(e._op){case"Failure":case"Success":return e;case"Left":return t.exitFail(e.left);case"Right":return t.exitSucceed(e.right);case"Some":return t.exitSucceed(e.value);case"None":return t.exitFail(t.NoSuchElementException())}},eM=ew((e,r)=>{let i,n,a=eF(r);if(a)return a;let s=new w.SyncScheduler,o=e_(e)(r,{scheduler:s});s.flush();let l=o.unsafePoll();return l?l:t.exitDie(t.capture((i=Error.stackTraceLimit,Error.stackTraceLimit=0,n=new eC(o),Error.stackTraceLimit=i,n),t.currentSpanFromFiber(o)))}),eA=ew((e,t,r)=>eN(e,t,r).then(e=>{switch(e._tag){case ev.OP_SUCCESS:return e.effect_instruction_i0;case ev.OP_FAILURE:throw eO(e.effect_instruction_i0)}})),eN=ew((e,t,r)=>new Promise(i=>{let n=eF(t);n&&i(n);let a=e_(e)(t);a.addObserver(e=>{i(e)}),r?.signal!==void 0&&(r.signal.aborted?a.unsafeInterruptAsFork(a.id()):r.signal.addEventListener("abort",()=>{a.unsafeInterruptAsFork(a.id())},{once:!0}))}));class eP{context;runtimeFlags;fiberRefs;constructor(e,t,r){this.context=e,this.runtimeFlags=t,this.fiberRefs=r}pipe(){return(0,S.pipeArguments)(this,arguments)}}let eD=e=>new eP(e.context,e.runtimeFlags,e.fiberRefs),eL=()=>t.withFiberRuntime((e,r)=>t.succeed(new eP(e.getFiberRef(t.currentContext),r.runtimeFlags,e.getFiberRefs()))),eU=eE.make(eE.Interruption,eE.CooperativeYielding,eE.RuntimeMetrics),ez=eD({context:el.empty(),runtimeFlags:eU,fiberRefs:ey.empty()}),ej=(0,m.dual)(2,(e,t)=>eD({context:e.context,runtimeFlags:t(e.runtimeFlags),fiberRefs:e.fiberRefs})),eW=(0,m.dual)(2,(e,t)=>ej(e,eE.disable(t))),eq=(0,m.dual)(2,(e,t)=>ej(e,eE.enable(t))),e$=(0,m.dual)(2,(e,t)=>eD({context:t(e.context),runtimeFlags:e.runtimeFlags,fiberRefs:e.fiberRefs})),eB=(0,m.dual)(3,(e,t,r)=>e$(e,el.add(t,r))),eH=(0,m.dual)(2,(e,t)=>eD({context:e.context,runtimeFlags:e.runtimeFlags,fiberRefs:t(e.fiberRefs)})),eV=(0,m.dual)(3,(e,t,r)=>eH(e,ey.updateAs({fiberId:h.none,fiberRef:t,value:r}))),eJ=(0,m.dual)(2,(e,t)=>eH(e,ey.delete(t))),eG=ek(ez),eK=e_(ez),eZ=eA(ez),eQ=eN(ez),eY=ex(ez),eX=eM(ez);e.s(["FiberFailureCauseId",0,eT,"asyncEffect",0,e=>t.suspend(()=>{let i;return t.flatMap(t.deferredMake(),n=>t.flatMap(eL(),a=>t.uninterruptibleMask(s=>t.zipRight(r.fork(s(t.matchCauseEffect(e(e=>ek(a)(t.intoDeferred(e,n))),{onFailure:e=>t.deferredFailCause(n,e),onSuccess:e=>(i=e,t.void)}))),s(t.onInterrupt(t.deferredAwait(n),()=>i??t.void))))))}),"defaultRuntime",0,ez,"defaultRuntimeFlags",0,eU,"deleteFiberRef",0,eJ,"disableRuntimeFlag",0,eW,"enableRuntimeFlag",0,eq,"fiberFailure",0,eO,"isAsyncFiberException",0,e=>v.isTagged(e,"AsyncFiberException")&&"fiber"in e,"isFiberFailure",0,e=>v.hasProperty(e,eI),"make",0,eD,"provideService",0,eB,"runtime",0,eL,"setFiberRef",0,eV,"unsafeFork",0,e_,"unsafeForkEffect",0,eK,"unsafeRunCallback",0,ek,"unsafeRunEffect",0,eG,"unsafeRunPromise",0,eA,"unsafeRunPromiseEffect",0,eZ,"unsafeRunPromiseExit",0,eN,"unsafeRunPromiseExitEffect",0,eQ,"unsafeRunSync",0,ex,"unsafeRunSyncEffect",0,eY,"unsafeRunSyncExit",0,eM,"unsafeRunSyncExitEffect",0,eX,"updateContext",0,e$,"updateFiberRefs",0,eH,"updateRuntimeFlags",0,ej],741840)},885858,550526,645278,907476,82431,e=>{"use strict";var t=e.i(710284),r=e.i(64176),i=e.i(777865),n=e.i(649488),a=e.i(868225),s=e.i(842862),o=e.i(214250),l=e.i(787039),u=e.i(100808),c=e.i(526886),p=e.i(65632);let f=Symbol.for("effect/ScheduleInterval"),d={[f]:f,startMillis:0,endMillis:0},h=(e,t)=>e>t?d:{[f]:f,startMillis:e,endMillis:t},m=(0,s.dual)(2,(e,t)=>g(e,t)===e),g=(0,s.dual)(2,(e,t)=>e.endMillis<=t.startMillis?e:t.endMillis<=e.startMillis?t:e.startMillis<t.startMillis?e:t.startMillis<e.startMillis?t:e.endMillis<=t.endMillis?e:t),y=(0,s.dual)(2,(e,t)=>h(Math.max(e.startMillis,t.startMillis),Math.min(e.endMillis,t.endMillis))),b=e=>e.startMillis>=e.endMillis;e.s(["after",0,e=>h(e,1/0),"empty",0,d,"intersect",0,y,"isEmpty",0,b,"lessThan",0,m,"make",0,h,"size",0,e=>n.millis(e.endMillis-e.startMillis)],550526);var S=e.i(965766);let v=Symbol.for("effect/ScheduleIntervals"),E=e=>({[v]:v,intervals:e}),w=(0,s.dual)(2,(e,t)=>c.isNonEmpty(t.intervals)?c.isNonEmpty(e.intervals)?c.headNonEmpty(e.intervals).startMillis<c.headNonEmpty(t.intervals).startMillis?_(c.tailNonEmpty(e.intervals),t.intervals,c.headNonEmpty(e.intervals),c.empty()):_(e.intervals,c.tailNonEmpty(t.intervals),c.headNonEmpty(t.intervals),c.empty()):t:e),_=(e,t,r,i)=>{let n=e,a=t,o=r,l=i;for(;c.isNonEmpty(n)||c.isNonEmpty(a);)if(!c.isNonEmpty(n)&&c.isNonEmpty(a))o.endMillis<c.headNonEmpty(a).startMillis?(l=(0,s.pipe)(l,c.prepend(o)),o=c.headNonEmpty(a)):o=h(o.startMillis,c.headNonEmpty(a).endMillis),a=c.tailNonEmpty(a),n=c.empty();else if(c.isNonEmpty(n)&&c.isEmpty(a))o.endMillis<c.headNonEmpty(n).startMillis?(l=(0,s.pipe)(l,c.prepend(o)),o=c.headNonEmpty(n)):o=h(o.startMillis,c.headNonEmpty(n).endMillis),a=c.empty(),n=c.tailNonEmpty(n);else if(c.isNonEmpty(n)&&c.isNonEmpty(a))c.headNonEmpty(n).startMillis<c.headNonEmpty(a).startMillis?(o.endMillis<c.headNonEmpty(n).startMillis?(l=(0,s.pipe)(l,c.prepend(o)),o=c.headNonEmpty(n)):o=h(o.startMillis,c.headNonEmpty(n).endMillis),n=c.tailNonEmpty(n)):(o.endMillis<c.headNonEmpty(a).startMillis?(l=(0,s.pipe)(l,c.prepend(o)),o=c.headNonEmpty(a)):o=h(o.startMillis,c.headNonEmpty(a).endMillis),a=c.tailNonEmpty(a));else throw Error((0,S.getBugErrorMessage)("Intervals.unionLoop"));return E((0,s.pipe)(l,c.prepend(o),c.reverse))},k=(0,s.dual)(2,(e,t)=>x(e.intervals,t.intervals,c.empty())),x=(e,t,r)=>{let i=e,n=t,a=r;for(;c.isNonEmpty(i)&&c.isNonEmpty(n);){let e=(0,s.pipe)(c.headNonEmpty(i),y(c.headNonEmpty(n))),t=b(e)?a:(0,s.pipe)(a,c.prepend(e));(0,s.pipe)(c.headNonEmpty(i),m(c.headNonEmpty(n)))?i=c.tailNonEmpty(i):n=c.tailNonEmpty(n),a=t}return E(c.reverse(a))},C=e=>(0,s.pipe)(e.intervals,c.head,p.getOrElse(()=>d)).startMillis,I=(0,s.dual)(2,(e,t)=>C(e)<C(t)),T=(0,s.dual)(2,(e,t)=>I(e,t)?t:e);e.s(["end",0,e=>(0,s.pipe)(e.intervals,c.head,p.getOrElse(()=>d)).endMillis,"intersect",0,k,"isNonEmpty",0,e=>c.isNonEmpty(e.intervals),"lessThan",0,I,"make",0,E,"max",0,T,"start",0,C,"union",0,w],645278);let R="Continue",O="Done",F=e=>({_tag:R,intervals:e}),M=e=>e._tag===O;e.s(["continue",()=>F,"continueWith",0,e=>({_tag:R,intervals:E(c.of(e))}),"done",0,{_tag:O},"isContinue",0,e=>e._tag===R,"isDone",0,M],907476);var A=e.i(625552),N=e.i(395649),P=e.i(580611),D=e.i(405889),L=e.i(276406);let U=Symbol.for("effect/ManagedRuntime");e.s(["TypeId",0,U],82431);var z=e.i(25560);let j="Fresh",W="ProvideMerge";var q=e.i(742502),$=e.i(741840),B=e.i(399683);let H=(0,s.dual)(2,(e,t)=>e.modifyEffect(t));var V=e.i(601009);let J=Symbol.for("effect/Layer"),G={[J]:{_RIn:e=>e,_E:e=>e,_ROut:e=>e},pipe(){return(0,l.pipeArguments)(this,arguments)}},K=Symbol.for("effect/Layer/MemoMap"),Z=i.Reference()("effect/Layer/CurrentMemoMap",{defaultValue:()=>et()}),Q=e=>(0,u.hasProperty)(e,J),Y=e=>e._op_layer===j;class X{ref;[K];constructor(e){this.ref=e,this[K]=K}getOrElseMemoize(e,t){return(0,s.pipe)(H(this.ref,r=>{let i=r.get(e);if(void 0!==i){let[e,n]=i,a=(0,s.pipe)(e,P.flatMap(([e,t])=>(0,s.pipe)(N.patchFiberRefs(e),P.as(t))),P.onExit(P.exitMatch({onFailure:()=>P.void,onSuccess:()=>P.scopeAddFinalizerExit(t,n)})));return P.succeed([a,r])}return(0,s.pipe)(q.make(0),P.flatMap(i=>(0,s.pipe)(P.deferredMake(),P.flatMap(n=>(0,s.pipe)(q.make(()=>P.void),P.map(a=>{let o=P.uninterruptibleMask(o=>(0,s.pipe)(L.scopeMake(),P.flatMap(l=>(0,s.pipe)(o(P.flatMap(en(e,l,!0),e=>N.diffFiberRefs(e(this)))),P.exit,P.flatMap(o=>{switch(o._tag){case z.OP_FAILURE:return(0,s.pipe)(P.deferredFailCause(n,o.effect_instruction_i0),P.zipRight(P.scopeClose(l,o)),P.zipRight(P.failCause(o.effect_instruction_i0)));case z.OP_SUCCESS:return(0,s.pipe)(q.set(a,e=>(0,s.pipe)(P.scopeClose(l,e),P.whenEffect(q.modify(i,e=>[1===e,e-1])),P.asVoid)),P.zipRight(q.update(i,e=>e+1)),P.zipRight(P.scopeAddFinalizerExit(t,t=>(0,s.pipe)(P.sync(()=>r.delete(e)),P.zipRight(q.get(a)),P.flatMap(e=>e(t))))),P.zipRight(P.deferredSucceed(n,o.effect_instruction_i0)),P.as(o.effect_instruction_i0[1]))}}))))),l=[(0,s.pipe)(P.deferredAwait(n),P.onExit(P.exitMatchEffect({onFailure:()=>P.void,onSuccess:()=>q.update(i,e=>e+1)}))),e=>(0,s.pipe)(q.get(a),P.flatMap(t=>t(e)))];return[o,Y(e)?r:r.set(e,l)]}))))))}),P.flatten)}}let ee=P.suspend(()=>P.map(D.makeSynchronized(new Map),e=>new X(e))),et=()=>new X(D.unsafeMakeSynchronized(new Map)),er=(0,s.dual)(2,(e,t)=>P.flatMap(ee,r=>ei(e,r,t))),ei=(0,s.dual)(3,(e,t,r)=>P.flatMap(en(e,r),e=>N.provideService(e(t),Z,t))),en=(e,t,r=!1)=>{switch(e._op_layer){case"Locally":return P.sync(()=>r=>e.f(r.getOrElseMemoize(e.self,t)));case"ExtendScope":return P.sync(()=>t=>L.scopeWith(r=>t.getOrElseMemoize(e.layer,r)));case"Fold":return P.sync(()=>r=>(0,s.pipe)(r.getOrElseMemoize(e.layer,t),P.matchCauseEffect({onFailure:i=>r.getOrElseMemoize(e.failureK(i),t),onSuccess:i=>r.getOrElseMemoize(e.successK(i),t)})));case"Fresh":return P.sync(()=>r=>(0,s.pipe)(e.layer,er(t)));case"FromEffect":return r?P.sync(()=>t=>e.effect):P.sync(()=>r=>r.getOrElseMemoize(e,t));case"Provide":return P.sync(()=>r=>(0,s.pipe)(r.getOrElseMemoize(e.first,t),P.flatMap(i=>(0,s.pipe)(r.getOrElseMemoize(e.second,t),P.provideContext(i)))));case"Scoped":return r?P.sync(()=>r=>L.scopeExtend(e.effect,t)):P.sync(()=>r=>r.getOrElseMemoize(e,t));case"Suspend":return P.sync(()=>r=>r.getOrElseMemoize(e.evaluate(),t));case"ProvideMerge":return P.sync(()=>r=>(0,s.pipe)(r.getOrElseMemoize(e.first,t),P.zipWith(r.getOrElseMemoize(e.second,t),e.zipK)));case"ZipWith":return P.sync(()=>r=>(0,s.pipe)(r.getOrElseMemoize(e.first,t),L.zipWithOptions(r.getOrElseMemoize(e.second,t),e.zipK,{concurrent:!0})))}},ea=(0,s.dual)(2,(e,t)=>eC(e,{onFailure:t,onSuccess:ez})),es=(0,s.dual)(2,(e,t)=>ex(e,{onFailure:t,onSuccess:ez})),eo=e=>ep(t.die(e)),el=()=>ey(P.context()),eu=e=>ep(t.fail(e)),ec=e=>ef(()=>t.fail(e())),ep=e=>ey(P.failCause(e)),ef=e=>ey(P.failCauseSync(e)),ed=(0,s.dual)(2,(e,t)=>eC(e,{onFailure:eu,onSuccess:t})),eh=(0,s.dual)(2,(e,t)=>ed(e,i.get(t))),em=e=>{let t=Object.create(G);return t._op_layer=j,t.layer=e,t},eg=(0,s.dual)(2,(e,t)=>{let r=i.isTag(e),n=r?e:t,a=r?t:e;return ey(P.map(a,e=>i.make(n,e)))});function ey(e){let t=Object.create(G);return t._op_layer="FromEffect",t.effect=e,t}let eb=(0,s.dual)(3,(e,t,r)=>eS(e,P.fiberRefLocally(t,r))),eS=(0,s.dual)(2,(e,t)=>{let r=Object.create(G);return r._op_layer="Locally",r.self=e,r.f=t,r}),ev=(0,s.dual)(3,(e,t,r)=>eS(e,P.fiberRefLocallyWith(t,r))),eE=(e,t)=>eU(e,new Proxy({...t},{get(t,r,i){if(r in t)return t[r];let n=Error.stackTraceLimit;Error.stackTraceLimit=2;let a=Error(`${e.key}: Unimplemented method "${r.toString()}"`);return Error.stackTraceLimit=n,a.name="UnimplementedError",ew(a)},has:s.constTrue})),ew=e=>{let t=P.die(e);function r(){return t}return Object.assign(r,t),Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r},e_=(0,s.dual)(2,(e,t)=>ed(e,e=>ez(t(e)))),ek=(0,s.dual)(2,(e,t)=>ea(e,e=>ec(()=>t(e)))),ex=(0,s.dual)(2,(e,{onFailure:t,onSuccess:r})=>{let i=Object.create(G);return i._op_layer="Fold",i.layer=e,i.failureK=t,i.successK=r,i}),eC=(0,s.dual)(2,(e,{onFailure:r,onSuccess:i})=>ex(e,{onFailure:e=>{let i=t.failureOrCause(e);switch(i._tag){case"Left":return r(i.left);case"Right":return ep(i.right)}},onSuccess:i})),eI=(0,s.dual)(2,(e,t)=>eK(e,t,(e,t)=>i.merge(e,t))),eT=(...e)=>{let t=e[0];for(let r=1;r<e.length;r++)t=eI(t,e[r]);return t},eR=(0,s.dual)(2,(e,t)=>ea(e,t)),eO=(0,s.dual)(4,(e,t,r,n)=>e_(e,e=>i.make(r,n(i.unsafeGet(e,t))))),eF=(0,s.dual)(2,(e,t)=>eW(()=>{let r=i.GenericTag("effect/Layer/retry/{ state: unknown }");return(0,s.pipe)(eU(r,{state:t.initial}),ed(n=>eM(e,t,r,(0,s.pipe)(n,i.get(r)).state)))})),eM=(e,t,r,n)=>(0,s.pipe)(e,ea(a=>(0,s.pipe)(eA(t,r,a,n),ed(n=>em(eM(e,t,r,(0,s.pipe)(n,i.get(r)).state)))))),eA=(e,t,i,a)=>eg(t,(0,s.pipe)(r.currentTimeMillis,P.flatMap(t=>(0,s.pipe)(e.step(t,i,a),P.flatMap(([e,a,o])=>M(o)?P.fail(i):(0,s.pipe)(r.sleep(n.millis(C(o.intervals)-t)),P.as({state:e}))))))),eN=(0,s.dual)(2,(e,t)=>{let r=i.isTag(e),n=r?e:t,a=r?t:e;return eD(P.map(a,e=>i.make(n,e)))}),eP=e=>eD((0,s.pipe)(e,P.as(i.empty()))),eD=e=>{let t=Object.create(G);return t._op_layer="Scoped",t.effect=e,t},eL=eD(P.map(L.acquireRelease(L.scopeMake(),(e,t)=>e.close(t)),e=>i.make(A.Scope,e))),eU=(0,s.dual)(2,(e,t)=>{let r=i.isTag(e),n=r?e:t,a=r?t:e;return ey(P.succeed(i.make(n,a)))}),ez=e=>ey(P.succeed(e)),ej=ez(i.empty()),eW=e=>{let t=Object.create(G);return t._op_layer="Suspend",t.evaluate=e,t},eq=(0,s.dual)(2,(e,t)=>{let r=i.isTag(e),n=r?e:t,a=r?t:e;return ey(P.sync(()=>i.make(n,a())))}),e$=(0,s.dual)(2,(e,t)=>ed(e,e=>ey(P.as(t(e),e)))),eB=(0,s.dual)(2,(e,t)=>ea(e,e=>ey(P.flatMap(t(e),()=>P.fail(e))))),eH=(0,s.dual)(2,(e,t)=>es(e,e=>ey(P.flatMap(t(e),()=>P.failCause(e))))),eV=(0,s.dual)(2,(e,t)=>P.flatMap(L.scopeWith(r=>ei(e,t,r)),e=>(0,s.pipe)($.runtime(),P.provideContext(e)))),eJ=(0,s.dual)(2,(e,t)=>eW(()=>{let r=Object.create(G);return r._op_layer="Provide",r.first=Object.create(G,{_op_layer:{value:W,enumerable:!0},first:{value:el(),enumerable:!0},second:{value:Array.isArray(t)?eT(...t):t},zipK:{value:(e,t)=>(0,s.pipe)(e,i.merge(t))}}),r.second=e,r})),eG=(0,s.dual)(2,(e,t)=>{let r=Object.create(G);return r._op_layer=W,r.first=t,r.second=eJ(e,t),r.zipK=(e,t)=>(0,s.pipe)(e,i.merge(t)),r}),eK=(0,s.dual)(3,(e,t,r)=>eW(()=>{let i=Object.create(G);return i._op_layer="ZipWith",i.first=e,i.second=t,i.zipK=r,i})),eZ=e=>{let t=i.GenericTag("effect/Layer/unwrapScoped/Layer.Layer<R1, E1, A>");return ed(eN(t,e),e=>i.get(e,t))},eQ=(0,s.dual)(e=>Q(e[0]),function(){let e=arguments;return ev(e[0],P.currentLogAnnotations,"string"==typeof e[1]?o.set(e[1],e[2]):t=>Object.entries(e[1]).reduce((e,[t,r])=>o.set(e,t,r),t))}),eY=(0,s.dual)(e=>Q(e[0]),function(){let e=arguments;return ev(e[0],P.currentTracerSpanAnnotations,"string"==typeof e[1]?o.set(e[1],e[2]):t=>Object.entries(e[1]).reduce((e,[t,r])=>o.set(e,t,r),t))}),eX=(0,s.dual)(2,(e,t)=>eJ(e,ez(i.make(V.spanTag,t)))),e0=(0,s.dual)(2,(e,t)=>L.scopedWith(r=>P.flatMap(er(t,r),t=>P.provideSomeContext(e,t)))),e1=(0,s.dual)(2,(e,t)=>{let r=a.diff($.defaultRuntime.fiberRefs,t.fiberRefs),n=B.diff($.defaultRuntime.runtimeFlags,t.runtimeFlags);return P.uninterruptibleMask(s=>P.withFiberRuntime(o=>{let l=o.getFiberRef(P.currentContext),u=o.getFiberRefs(),c=a.patch(o.id(),u)(r),p=o.currentRuntimeFlags,f=B.patch(n)(p),d=a.diff(c,u),h=B.diff(f,p);return o.setFiberRefs(c),o.currentRuntimeFlags=f,L.ensuring(P.provideSomeContext(s(e),i.merge(l,t.context)),P.withFiberRuntime(e=>(e.setFiberRefs(a.patch(e.id(),e.getFiberRefs())(d)),e.currentRuntimeFlags=B.patch(h)(e.currentRuntimeFlags),P.void)))}))}),e2=(0,s.dual)(2,(e,t)=>Array.isArray(t)?e0(e,eT(...t)):Q(t)?e0(e,t):i.isContext(t)?P.provideSomeContext(e,t):U in t?P.flatMap(t.runtimeEffect,t=>e1(e,t)):e1(e,t));e.s(["CurrentMemoMap",0,Z,"LayerTypeId",0,J,"MemoMapTypeId",0,K,"annotateLogs",0,eQ,"annotateSpans",0,eY,"build",0,e=>L.scopeWith(t=>er(e,t)),"buildWithMemoMap",0,ei,"buildWithScope",0,er,"catchAll",0,ea,"catchAllCause",0,es,"context",0,el,"die",0,eo,"dieSync",0,e=>ef(()=>t.die(e())),"discard",0,e=>e_(e,()=>i.empty()),"effect_provide",0,e2,"empty",0,ej,"extendScope",0,e=>{let t=Object.create(G);return t._op_layer="ExtendScope",t.layer=e,t},"fail",0,eu,"failCause",0,ep,"failCauseSync",0,ef,"failSync",0,ec,"fiberRefLocally",0,eb,"fiberRefLocallyScoped",0,(e,t)=>eP(L.fiberRefLocallyScoped(e,t)),"fiberRefLocallyScopedWith",0,(e,t)=>eP(L.fiberRefLocallyScopedWith(e,t)),"fiberRefLocallyWith",0,ev,"flatMap",0,ed,"flatten",0,eh,"fresh",0,em,"fromEffect",0,eg,"fromEffectContext",()=>ey,"fromEffectDiscard",0,e=>ey(P.map(e,()=>i.empty())),"fromFunction",0,(e,t,r)=>ey(P.map(e,e=>i.make(t,r(e)))),"isFresh",0,Y,"isLayer",0,Q,"launch",0,e=>L.scopedEffect(P.zipRight(L.scopeWith(t=>(0,s.pipe)(e,er(t))),P.never)),"locallyEffect",0,eS,"makeMemoMap",0,ee,"map",0,e_,"mapError",0,ek,"match",0,eC,"matchCause",0,ex,"memoize",0,e=>L.scopeWith(t=>P.map(N.memoize(er(e,t)),ey)),"merge",0,eI,"mergeAll",0,eT,"mock",0,function(){return 1==arguments.length?e=>eE(arguments[0],e):eE(arguments[0],arguments[1])},"orDie",0,e=>ea(e,e=>eo(e)),"orElse",0,eR,"passthrough",0,e=>eI(el(),e),"project",0,eO,"provide",0,eJ,"provideMerge",0,eG,"retry",0,eF,"scope",0,eL,"scoped",0,eN,"scopedContext",0,eD,"scopedDiscard",0,eP,"service",0,e=>eg(e,e),"succeed",0,eU,"succeedContext",0,ez,"suspend",0,eW,"sync",0,eq,"syncContext",0,e=>ey(P.sync(e)),"tap",0,e$,"tapError",0,eB,"tapErrorCause",0,eH,"toRuntime",0,e=>(0,s.pipe)(L.scopeWith(t=>er(e,t)),P.flatMap(e=>(0,s.pipe)($.runtime(),P.provideContext(e)))),"toRuntimeWithMemoMap",0,eV,"unsafeMakeMemoMap",0,et,"unwrapEffect",0,e=>{let t=i.GenericTag("effect/Layer/unwrapEffect/Layer.Layer<R1, E1, A>");return ed(eg(t,e),e=>i.get(e,t))},"unwrapScoped",0,eZ,"withParentSpan",0,eX,"withSpan",0,function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=V.addSpanStackTrace(e?arguments[2]:arguments[1]);if(e){let e=arguments[0];return eZ(P.map(r?.onEnd?P.tap(L.makeSpanScoped(t,r),e=>L.addFinalizer(t=>r.onEnd(e,t))):L.makeSpanScoped(t,r),t=>eX(e,t)))}return e=>eZ(P.map(r?.onEnd?P.tap(L.makeSpanScoped(t,r),e=>L.addFinalizer(t=>r.onEnd(e,t))):L.makeSpanScoped(t,r),t=>eX(e,t)))},"zipWith",0,eK],885858)},162098,659809,473598,e=>{"use strict";var t=e.i(649488),r=e.i(842862),i=e.i(402409),n=e.i(215139),a=e.i(777865),s=e.i(385510),o=e.i(964665),l=e.i(945831),u=e.i(368171),c=e.i(408043),p=e.i(190512),f=e.i(526886),d=e.i(580537),h=e.i(787039);let m=Symbol.for("effect/MutableList"),g={[m]:m,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(null==t)return e=!0,this.return();let r=t.value;return t=t.next,{done:e,value:r}},return:t=>(e||(e=!0),{done:!0,value:t})}},toString(){return(0,d.format)(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(d.toJSON)}},[d.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,h.pipeArguments)(this,arguments)}},y=r.dual(2,(e,t)=>{let r={value:t,removed:!1,prev:void 0,next:void 0};return void 0===e.head&&(e.head=r),void 0===e.tail||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),b=Symbol.for("effect/MutableQueue"),S=Symbol.for("effect/mutable/MutableQueue/Empty"),v={[b]:b,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return(0,d.format)(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(d.toJSON)}},[d.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,h.pipeArguments)(this,arguments)}},E=e=>{let t,r=Object.create(v);return(t=Object.create(g)).head=void 0,t.tail=void 0,t._length=0,r.queue=t,r.capacity=e,r},w=()=>E(void 0),_=r.dual(2,(e,t)=>{let r=e.queue._length;return(void 0===e.capacity||r!==e.capacity)&&(y(t)(e.queue),!0)}),k=r.dual(2,(e,t)=>{let r,i=t[Symbol.iterator](),n=f.empty(),a=!0;for(;a&&(r=i.next())&&!r.done;)a=_(r.value)(e);for(;null!=r&&!r.done;)n=f.prepend(r.value)(n),r=i.next();return f.reverse(n)}),x=r.dual(2,(e,t)=>{if(0===e.queue._length)return t;var r,i,n=e.queue;let a=n.head;return void 0!==a?(r=n,!(i=a).removed&&(i.removed=!0,void 0!==i.prev&&void 0!==i.next?(i.prev.next=i.next,i.next.prev=i.prev):void 0!==i.prev?(r.tail=i.prev,i.prev.next=void 0):void 0!==i.next?(r.head=i.next,i.next.prev=void 0):(r.tail=void 0,r.head=void 0),r._length>0&&(r._length-=1)),a.value):void 0}),C=r.dual(2,(e,t)=>{let r=f.empty(),i=0;for(;i<t;){let t=x(S)(e);if(t===S)break;r=f.prepend(t)(r),i+=1}return f.reverse(r)});e.s(["EmptyMutableQueue",0,S,"bounded",0,e=>E(e),"capacity",0,e=>void 0===e.capacity?1/0:e.capacity,"isEmpty",0,e=>0===e.queue._length,"length",0,e=>e.queue._length,"offer",0,_,"offerAll",0,k,"poll",0,x,"pollUpTo",0,C,"unbounded",0,w],659809);var I=e.i(727606),T=e.i(65632),R=e.i(100808),O=e.i(395649),F=e.i(580611),M=e.i(260082),A=e.i(720369),N=e.i(276406);let P=(e,t,r,i)=>M.struct({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:i}),D=(e,t)=>M.struct({_tag:"Pending",key:e,deferred:t}),L=Symbol.for("effect/Cache/MapKey");class U{current;[L]=L;previous=void 0;next=void 0;constructor(e){this.current=e}[c.symbol](){return(0,r.pipe)(c.hash(this.current),c.combine(c.hash(this.previous)),c.combine(c.hash(this.next)),c.cached(this))}[l.symbol](e){return this===e||j(e)&&l.equals(this.current,e.current)&&l.equals(this.previous,e.previous)&&l.equals(this.next,e.next)}}let z=e=>new U(e),j=e=>(0,R.hasProperty)(e,L);class W{head=void 0;tail=void 0;add(e){if(e!==this.tail)if(void 0===this.tail)this.head=e,this.tail=e;else{let t=e.previous,r=e.next;void 0!==r&&(e.next=void 0,void 0!==t?(t.next=r,r.previous=t):(this.head=r,this.head.previous=void 0)),this.tail.next=e,e.previous=this.tail,this.tail=e}}remove(){let e=this.head;if(void 0!==e){let t=e.next;void 0!==t?(e.next=void 0,this.head=t,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return e}}let q=Symbol.for("effect/Cache"),$={_Key:e=>e,_Error:e=>e,_Value:e=>e},B=Symbol.for("effect/ConsumerCache"),H={_Key:e=>e,_Error:e=>e,_Value:e=>e},V=e=>({loadedMillis:e});class J{capacity;context;fiberId;lookup;timeToLive;[q]=$;[B]=H;cacheState;constructor(e,t,r,i,n){this.capacity=e,this.context=t,this.fiberId=r,this.lookup=i,this.timeToLive=n,this.cacheState=(()=>{let e,t;return e=p.empty(),t=new W,{map:e,keys:t,accesses:w(),updating:I.make(!1),hits:0,misses:0}})()}get(e){return F.map(this.getEither(e),o.merge)}get cacheStats(){return F.sync(()=>({hits:this.cacheState.hits,misses:this.cacheState.misses,size:p.size(this.cacheState.map)}))}getOption(e){return F.suspend(()=>T.match(p.get(this.cacheState.map,e),{onNone:()=>{let t=z(e);return this.trackAccess(t),this.trackMiss(),F.succeed(T.none())},onSome:e=>this.resolveMapValue(e)}))}getOptionComplete(e){return F.suspend(()=>T.match(p.get(this.cacheState.map,e),{onNone:()=>{let t=z(e);return this.trackAccess(t),this.trackMiss(),F.succeed(T.none())},onSome:e=>this.resolveMapValue(e,!0)}))}contains(e){return F.sync(()=>p.has(this.cacheState.map,e))}entryStats(e){return F.sync(()=>{let t=p.get(this.cacheState.map,e);if(T.isSome(t))switch(t.value._tag){case"Complete":{let e=t.value.entryStats.loadedMillis;return T.some(V(e))}case"Pending":break;case"Refreshing":{let e=t.value.complete.entryStats.loadedMillis;return T.some(V(e))}}return T.none()})}getEither(e){return F.suspend(()=>{let t,r,i=T.getOrUndefined(p.get(this.cacheState.map,e));return(void 0===i&&(r=s.unsafeMake(this.fiberId),t=z(e),p.has(this.cacheState.map,e)?i=T.getOrUndefined(p.get(this.cacheState.map,e)):p.set(this.cacheState.map,e,D(t,r))),void 0===i)?(this.trackAccess(t),this.trackMiss(),F.map(this.lookupValueOf(e,r),o.right)):F.flatMap(this.resolveMapValue(i),T.match({onNone:()=>this.getEither(e),onSome:e=>F.succeed(o.left(e))}))})}invalidate(e){return F.sync(()=>{p.remove(this.cacheState.map,e)})}invalidateWhen(e,t){return F.sync(()=>{let r=p.get(this.cacheState.map,e);T.isSome(r)&&"Complete"===r.value._tag&&"Success"===r.value.exit._tag&&t(r.value.exit.value)&&p.remove(this.cacheState.map,e)})}get invalidateAll(){return F.sync(()=>{this.cacheState.map=p.empty()})}refresh(e){return O.clockWith(t=>F.suspend(()=>{let i=s.unsafeMake(this.fiberId),n=T.getOrUndefined(p.get(this.cacheState.map,e));if(void 0===n&&(p.has(this.cacheState.map,e)?n=T.getOrUndefined(p.get(this.cacheState.map,e)):p.set(this.cacheState.map,e,D(z(e),i))),void 0===n)return F.asVoid(this.lookupValueOf(e,i));switch(n._tag){case"Complete":if(this.hasExpired(t,n.timeToLiveMillis)){let t=T.getOrUndefined(p.get(this.cacheState.map,e));return l.equals(t,n)&&p.remove(this.cacheState.map,e),F.asVoid(this.get(e))}return(0,r.pipe)(this.lookupValueOf(e,i),O.when(()=>{let t=T.getOrUndefined(p.get(this.cacheState.map,e));if(l.equals(t,n)){let t,r=(t=n,M.struct({_tag:"Refreshing",deferred:i,complete:t}));return p.set(this.cacheState.map,e,r),!0}return!1}),F.asVoid);case"Pending":case"Refreshing":return s.await(n.deferred)}}))}set(e,r){return O.clockWith(i=>F.sync(()=>{let n=i.unsafeCurrentTimeMillis(),a=u.succeed(r),s=P(z(e),a,V(n),n+t.toMillis(t.decode(this.timeToLive(a))));p.set(this.cacheState.map,e,s)}))}get size(){return F.sync(()=>p.size(this.cacheState.map))}get values(){return F.sync(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push(t[1].exit.value);return e})}get entries(){return F.sync(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push([t[0],t[1].exit.value]);return e})}get keys(){return F.sync(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push(t[0]);return e})}resolveMapValue(e,t=!1){return O.clockWith(r=>{switch(e._tag){case"Complete":if(this.trackAccess(e.key),this.hasExpired(r,e.timeToLiveMillis))return p.remove(this.cacheState.map,e.key.current),F.succeed(T.none());return this.trackHit(),F.map(e.exit,T.some);case"Pending":if(this.trackAccess(e.key),this.trackHit(),t)return F.succeed(T.none());return F.map(s.await(e.deferred),T.some);case"Refreshing":if(this.trackAccess(e.complete.key),this.trackHit(),this.hasExpired(r,e.complete.timeToLiveMillis)){if(t)return F.succeed(T.none());return F.map(s.await(e.deferred),T.some)}return F.map(e.complete.exit,T.some)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(e){if(_(this.cacheState.accesses,e),I.compareAndSet(this.cacheState.updating,!1,!0)){let e=!0;for(;e;){let t=x(this.cacheState.accesses,S);t===S?e=!1:this.cacheState.keys.add(t)}let t=p.size(this.cacheState.map);for(e=t>this.capacity;e;){let r=this.cacheState.keys.remove();void 0!==r?p.has(this.cacheState.map,r.current)&&(p.remove(this.cacheState.map,r.current),t-=1,e=t>this.capacity):e=!1}I.set(this.cacheState.updating,!1)}}hasExpired(e,t){return e.unsafeCurrentTimeMillis()>t}lookupValueOf(e,i){return O.clockWith(n=>F.suspend(()=>(0,r.pipe)(this.lookup(e),F.provideContext(this.context),F.exit,F.flatMap(r=>{let a=n.unsafeCurrentTimeMillis(),o=V(a),l=P(z(e),r,o,a+t.toMillis(t.decode(this.timeToLive(r))));return p.set(this.cacheState.map,e,l),F.zipRight(s.done(i,r),r)}),F.onInterrupt(()=>F.zipRight(s.interrupt(i),F.sync(()=>{p.remove(this.cacheState.map,e)}))))))}}let G=(e,r,i)=>new J(e,a.empty(),A.none,r,e=>t.decode(i(e)));e.s(["make",0,e=>{let r,i=t.decode(e.timeToLive);return r={capacity:e.capacity,lookup:e.lookup,timeToLive:()=>i},F.map(N.all([F.context(),F.fiberId]),([e,i])=>new J(r.capacity,e,i,r.lookup,e=>t.decode(r.timeToLive(e))))},"unsafeMakeWith",0,G],473598);var K=e.i(322813);let Z=(0,i.globalValue)(Symbol.for("effect/FiberRef/currentCache"),()=>F.fiberRefUnsafeMake(G(65536,()=>F.map(F.deferredMake(),e=>({listeners:new K.Listeners,handle:e})),()=>(0,t.seconds)(60)))),Q=(0,i.globalValue)(Symbol.for("effect/FiberRef/currentCacheEnabled"),()=>F.fiberRefUnsafeMake(!1)),Y=(0,r.dual)(2,(e,t)=>F.fiberRefLocally(e,Q,t)),X=(0,r.dual)(2,(e,t)=>F.fiberRefLocally(e,Z,t));e.s(["cacheRequest",0,(e,t)=>F.fiberRefGetWith(Q,r=>r?F.fiberRefGetWith(Z,r=>F.flatMap(r.getEither(e),e=>{switch(e._tag){case"Left":return F.void;case"Right":return F.deferredComplete(e.right.handle,t)}})):F.void),"currentCache",0,Z,"currentCacheEnabled",0,Q,"fromRequest",0,(e,t)=>F.flatMap(F.isEffect(t)?t:F.succeed(t),t=>F.fiberIdWith(r=>{let i=new Proxy(e,{});return F.fiberRefGetWith(Q,e=>{if(e){let e=F.fiberRefGetWith(Z,a=>F.flatMap(a.getEither(i),s=>{switch(s._tag){case"Left":if(s.left.listeners.interrupted)return F.flatMap(a.invalidateWhen(i,e=>e.handle===s.left.handle),()=>e);return s.left.listeners.increment(),F.uninterruptibleMask(e=>F.flatMap(F.exit(F.blocked(n.empty,e(F.deferredAwait(s.left.handle)))),e=>(s.left.listeners.decrement(),e)));case"Right":return s.right.listeners.increment(),F.uninterruptibleMask(e=>F.flatMap(F.exit(F.blocked(n.single(t,n.makeEntry({request:i,result:s.right.handle,listeners:s.right.listeners,ownerId:r,state:{completed:!1}})),e(F.deferredAwait(s.right.handle)))),()=>(s.right.listeners.decrement(),F.deferredAwait(s.right.handle))))}}));return e}let a=new K.Listeners;return a.increment(),F.flatMap(F.deferredMake(),e=>(0,N.ensuring)(F.blocked(n.single(t,n.makeEntry({request:i,result:e,listeners:a,ownerId:r,state:{completed:!1}})),F.deferredAwait(e)),F.sync(()=>a.decrement())))})})),"withRequestCache",0,X,"withRequestCaching",0,Y],162098)},405614,594867,923928,943597,900386,237270,e=>{"use strict";var t=e.i(842862),r=e.i(129627),i=e.i(777865),n=e.i(580611),a=e.i(374132),s=e.i(389630),o=e.i(276406),l=e.i(885858);a.currentServices,s.consoleTag;e.i(327184);var u=e.i(395649),c=e.i(405889),p=e.i(964665),f=e.i(100808),d=e.i(526886),h=e.i(64176),m=e.i(435146),g=e.i(64317),y=e.i(945831),b=e.i(266493),S=e.i(408043),v=e.i(580537),E=e.i(710284),w=e.i(649488),_=e.i(402409),k=e.i(65632),x=e.i(129248),C=e.i(787039);let I=Symbol.for("effect/DateTime"),T=Symbol.for("effect/DateTime/TimeZone"),R={[I]:I,pipe(){return(0,C.pipeArguments)(this,arguments)},[v.NodeInspectSymbol](){return this.toString()},toJSON(){return e_(this).toJSON()}},O={...R,_tag:"Utc",[S.symbol](){return S.cached(this,S.number(this.epochMillis))},[y.symbol](e){return D(e)&&"Utc"===e._tag&&this.epochMillis===e.epochMillis},toString(){return`DateTime.Utc(${e_(this).toJSON()})`}},F={...R,_tag:"Zoned",[S.symbol](){return(0,t.pipe)(S.number(this.epochMillis),S.combine(S.hash(this.zone)),S.cached(this))},[y.symbol](e){return D(e)&&"Zoned"===e._tag&&this.epochMillis===e.epochMillis&&y.equals(this.zone,e.zone)},toString(){return`DateTime.Zoned(${e7(this)})`}},M={[T]:T,[v.NodeInspectSymbol](){return this.toString()}},A={...M,_tag:"Named",[S.symbol](){return S.cached(this,S.string(`Named:${this.id}`))},[y.symbol](e){return U(e)&&"Named"===e._tag&&this.id===e.id},toString(){return`TimeZone.Named(${this.id})`},toJSON(){return{_id:"TimeZone",_tag:"Named",id:this.id}}},N={...M,_tag:"Offset",[S.symbol](){return S.cached(this,S.string(`Offset:${this.offset}`))},[y.symbol](e){return U(e)&&"Offset"===e._tag&&this.offset===e.offset},toString(){return`TimeZone.Offset(${eC(this.offset)})`},toJSON(){return{_id:"TimeZone",_tag:"Offset",offset:this.offset}}},P=(e,t,r)=>{let i=Object.create(F);return i.epochMillis=e,i.zone=t,Object.defineProperty(i,"partsUtc",{value:r,enumerable:!1,writable:!0}),Object.defineProperty(i,"adjustedEpochMillis",{value:void 0,enumerable:!1,writable:!0}),Object.defineProperty(i,"partsAdjusted",{value:void 0,enumerable:!1,writable:!0}),i},D=e=>f.hasProperty(e,I),L=e=>D(e[0]),U=e=>f.hasProperty(e,T),z=e=>U(e)&&"Named"===e._tag,j=e=>"Zoned"===e._tag,W=b.make((e,t)=>e.epochMillis===t.epochMillis),q=x.make((e,t)=>e.epochMillis<t.epochMillis?-1:+(e.epochMillis>t.epochMillis)),$=x.clamp(q),B=e=>{let t=Object.create(O);return t.epochMillis=e,Object.defineProperty(t,"partsUtc",{value:void 0,enumerable:!1,writable:!0}),t},H=e=>{let t=e.getTime();if(Number.isNaN(t))throw new E.IllegalArgumentException("Invalid date");return B(t)},V=e=>{if(D(e))return e;if(e instanceof Date)return H(e);if("object"==typeof e){let t=new Date(0);return eN(t,e),H(t)}return"string"!=typeof e||J(e)?H(new Date(e)):H(new Date(e+"Z"))},J=e=>/Z|[+-]\d{2}$|[+-]\d{2}:?\d{2}$|\]$/.test(e),G=(e,t)=>{let r;if(t?.timeZone===void 0&&D(e)&&j(e))return e;let i=V(e);if(i.epochMillis<-86399999568e5||i.epochMillis>86399999496e5)throw RangeError(`Epoch millis out of range: ${i.epochMillis}`);if(t?.timeZone===void 0)r=eo(-60*new Date(i.epochMillis).getTimezoneOffset()*1e3);else if(U(t?.timeZone))r=t.timeZone;else if("number"==typeof t?.timeZone)r=eo(t.timeZone);else{let e=ec(t.timeZone);if(k.isNone(e))throw new E.IllegalArgumentException(`Invalid time zone: ${t.timeZone}`);r=e.value}return t?.adjustForTimeZone!==!0?P(i.epochMillis,r,i.partsUtc):eL(i.epochMillis,r,t?.disambiguation??"compatible")},K=k.liftThrowable(G),Z=k.liftThrowable(V),Q=/^(.{17,35})\[(.+)\]$/,Y=n.map(h.currentTimeMillis,B),X=n.map(h.currentTimeMillis,e=>new Date(e)),ee=()=>B(Date.now()),et=(0,t.dual)(L,(e,t,r)=>r?.adjustForTimeZone===!0?eL(e.epochMillis,t,r?.disambiguation??"compatible"):P(e.epochMillis,t,e.partsUtc)),er=(0,t.dual)(L,(e,t,r)=>et(e,eo(t),r)),ei=(0,_.globalValue)("effect/DateTime/validZoneCache",()=>new Map),en={day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"longOffset",fractionalSecondDigits:3,hourCycle:"h23"},ea=e=>{let t=e.resolvedOptions().timeZone;if(ei.has(t))return ei.get(t);let r=Object.create(A);return r.id=t,r.format=e,ei.set(t,r),r},es=e=>{if(ei.has(e))return ei.get(e);try{return ea(new Intl.DateTimeFormat("en-US",{...en,timeZone:e}))}catch{throw new E.IllegalArgumentException(`Invalid time zone: ${e}`)}},eo=e=>{let t=Object.create(N);return t.offset=e,t},el=k.liftThrowable(es),eu=/^(?:GMT|[+-])/,ec=e=>{if(eu.test(e)){let t=ez(e);return null===t?k.none():k.some(eo(t))}return el(e)},ep=(0,t.dual)(L,(e,t,r)=>k.map(el(t),t=>et(e,t,r))),ef=(0,t.dual)(L,(e,t,r)=>et(e,es(t),r)),ed=(0,t.dual)(2,(e,t)=>eT(t)-eT(e)),eh=(0,t.dual)(2,(e,t)=>{let r=ed(e,t);return r>0?p.right(w.millis(r)):p.left(w.millis(-r))}),em=(0,t.dual)(2,(e,t)=>w.millis(Math.abs(ed(e,t)))),eg=x.min(q),ey=x.max(q),eb=x.greaterThan(q),eS=x.greaterThanOrEqualTo(q),ev=x.lessThan(q),eE=x.lessThanOrEqualTo(q),ew=x.between(q),e_=e=>new Date(e.epochMillis),ek=e=>{if("Utc"===e._tag)return new Date(e.epochMillis);if("Offset"===e.zone._tag)return new Date(e.epochMillis+e.zone.offset);if(void 0!==e.adjustedEpochMillis)return new Date(e.adjustedEpochMillis);let t=e.zone.format.formatToParts(e.epochMillis).filter(e=>"literal"!==e.type),r=new Date(0);return r.setUTCFullYear(Number(t[2].value),Number(t[0].value)-1,Number(t[1].value)),r.setUTCHours(Number(t[3].value),Number(t[4].value),Number(t[5].value),Number(t[6].value)),e.adjustedEpochMillis=r.getTime(),r},ex=e=>ek(e).getTime()-eT(e),eC=e=>{let t=Math.abs(e),r=Math.floor(t/36e5),i=Math.round(t%36e5/6e4);return 60===i&&(r+=1,i=0),`${e<0?"-":"+"}${String(r).padStart(2,"0")}:${String(i).padStart(2,"0")}`},eI=e=>eC(ex(e)),eT=e=>e.epochMillis,eR=e=>({millis:e.getUTCMilliseconds(),seconds:e.getUTCSeconds(),minutes:e.getUTCMinutes(),hours:e.getUTCHours(),day:e.getUTCDate(),weekDay:e.getUTCDay(),month:e.getUTCMonth()+1,year:e.getUTCFullYear()}),eO=e=>"Utc"===e._tag?eF(e):(void 0!==e.partsAdjusted||(e.partsAdjusted=eB(e,eR)),e.partsAdjusted),eF=e=>(void 0!==e.partsUtc||(e.partsUtc=eH(e,eR)),e.partsUtc),eM=(0,t.dual)(2,(e,t)=>eF(e)[t]),eA=(0,t.dual)(2,(e,t)=>eO(e)[t]),eN=(e,t)=>{if(void 0!==t.year&&e.setUTCFullYear(t.year),void 0!==t.month&&e.setUTCMonth(t.month-1),void 0!==t.day&&e.setUTCDate(t.day),void 0!==t.weekDay){let r=t.weekDay-e.getUTCDay();e.setUTCDate(e.getUTCDate()+r)}void 0!==t.hours&&e.setUTCHours(t.hours),void 0!==t.minutes&&e.setUTCMinutes(t.minutes),void 0!==t.seconds&&e.setUTCSeconds(t.seconds),void 0!==t.millis&&e.setUTCMilliseconds(t.millis)},eP=(0,t.dual)(2,(e,t)=>eW(e,e=>eN(e,t))),eD=(0,t.dual)(2,(e,t)=>eq(e,e=>eN(e,t))),eL=(e,t,r)=>{if("Offset"===t._tag)return P(e-t.offset,t);let i=ej(e-864e5,e,t),n=ej(e+864e5,e,t);if(i===n)return P(e-i,t);let a=i-n;if(i<n){if(ej(e-n,e,t)===n)return P(e-n,t);let a=P(e-i,t);if(e!==ek(a).getTime())switch(r){case"reject":{let r=new Date(e).toISOString();throw RangeError(`Gap time: ${r} does not exist in time zone ${t.id}`)}case"earlier":return P(e-n,t)}return a}if(ej(e-i,e,t)===i){if("earlier"===r||"compatible"===r||ej(e-i+a,e+a,t)===i)return P(e-i,t);if("reject"===r){let r=new Date(e).toISOString();throw RangeError(`Ambiguous time: ${r} occurs twice in time zone ${t.id}`)}}return P(e-n,t)},eU=/([+-])(\d{2}):(\d{2})$/,ez=e=>{let t=eU.exec(e);if(null===t)return null;let[,r,i,n]=t;return("+"===r?1:-1)*(60*Number(i)+Number(n))*6e4},ej=(e,t,r)=>{let i=r.format.formatToParts(e).find(e=>"timeZoneName"===e.type)?.value??"";if("GMT"===i)return 0;let n=ez(i);return null===n?ex(P(t,r)):n},eW=(0,t.dual)(L,(e,t,r)=>{if("Utc"===e._tag){let r=e_(e);return t(r),B(r.getTime())}let i=new Date(ek(e).getTime());return t(i),eL(i.getTime(),e.zone,r?.disambiguation??"compatible")}),eq=(0,t.dual)(2,(e,t)=>e$(e,e=>{let r=new Date(e);return t(r),r.getTime()})),e$=(0,t.dual)(2,(e,t)=>{let r=t(eT(e));return"Utc"===e._tag?B(r):P(r,e.zone)}),eB=(0,t.dual)(2,(e,t)=>t(ek(e))),eH=(0,t.dual)(2,(e,t)=>t(e_(e))),eV=(0,t.dual)(2,(e,t)=>"Utc"===e._tag?t.onUtc(e):t.onZoned(e)),eJ=(0,t.dual)(2,(e,t)=>e$(e,e=>e+w.toMillis(t))),eG=(0,t.dual)(2,(e,t)=>e$(e,e=>e-w.toMillis(t))),eK=(e,t)=>{e.setTime(e.getTime()+t)},eZ=(0,t.dual)(2,(e,t)=>eW(e,e=>{if(t.millis&&eK(e,t.millis),t.seconds&&eK(e,1e3*t.seconds),t.minutes&&eK(e,60*t.minutes*1e3),t.hours&&eK(e,60*t.hours*6e4),t.days&&e.setUTCDate(e.getUTCDate()+t.days),t.weeks&&e.setUTCDate(e.getUTCDate()+7*t.weeks),t.months){let r=e.getUTCDate();e.setUTCMonth(e.getUTCMonth()+t.months+1,0),r<e.getUTCDate()&&e.setUTCDate(r)}if(t.years){let r=e.getUTCDate(),i=e.getUTCMonth();e.setUTCFullYear(e.getUTCFullYear()+t.years,i+1,0),r<e.getUTCDate()&&e.setUTCDate(r)}})),eQ=(0,t.dual)(2,(e,t)=>{let r={};for(let e in t)r[e]=-1*t[e];return eZ(e,r)}),eY=(e,t,r)=>{switch(t){case"second":e.setUTCMilliseconds(0);break;case"minute":e.setUTCSeconds(0,0);break;case"hour":e.setUTCMinutes(0,0,0);break;case"day":e.setUTCHours(0,0,0,0);break;case"week":{let t=r?.weekStartsOn??0,i=e.getUTCDay();e.setUTCDate(e.getUTCDate()-(i-t+7)%7),e.setUTCHours(0,0,0,0);break}case"month":e.setUTCDate(1),e.setUTCHours(0,0,0,0);break;case"year":e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}},eX=(0,t.dual)(L,(e,t,r)=>eW(e,e=>eY(e,t,r))),e0=(e,t,r)=>{switch(t){case"second":e.setUTCMilliseconds(999);break;case"minute":e.setUTCSeconds(59,999);break;case"hour":e.setUTCMinutes(59,59,999);break;case"day":e.setUTCHours(23,59,59,999);break;case"week":{let t=r?.weekStartsOn??0,i=e.getUTCDay();e.setUTCDate(e.getUTCDate()-(i-t+7)%7+6),e.setUTCHours(23,59,59,999);break}case"month":e.setUTCMonth(e.getUTCMonth()+1,0),e.setUTCHours(23,59,59,999);break;case"year":e.setUTCMonth(11,31),e.setUTCHours(23,59,59,999)}},e1=(0,t.dual)(L,(e,t,r)=>eW(e,e=>e0(e,t,r))),e2=(0,t.dual)(L,(e,t,r)=>eW(e,e=>{if("milli"===t)return;let i=e.getTime(),n=new Date(i);eY(n,t,r);let a=n.getTime(),s=new Date(i);e0(s,t,r);let o=s.getTime()+1;i-a<o-i?e.setTime(a):e.setTime(o)})),e6=(0,t.dual)(L,(e,t)=>{try{var r;return new Intl.DateTimeFormat(t?.locale,{timeZone:"Utc"===e._tag?"UTC":(r=e.zone,"Named"===r._tag?r.id:eC(r.offset)),...t}).format(e.epochMillis)}catch{return new Intl.DateTimeFormat(t?.locale,{timeZone:"UTC",...t}).format(ek(e))}}),e3=(0,t.dual)(L,(e,t)=>new Intl.DateTimeFormat(t?.locale,t).format(e.epochMillis)),e4=(0,t.dual)(L,(e,t)=>new Intl.DateTimeFormat(t?.locale,{...t,timeZone:"UTC"}).format(e.epochMillis)),e5=(0,t.dual)(2,(e,t)=>t.format(e.epochMillis)),e8=e=>{let t=ek(e);return"Utc"===e._tag?t.toISOString():`${t.toISOString().slice(0,-1)}${eI(e)}`},e7=e=>"Offset"===e.zone._tag?e8(e):`${e8(e)}[${e.zone.id}]`;e.s(["Equivalence",0,W,"Order",0,q,"TimeZoneTypeId",0,T,"TypeId",0,I,"add",0,eZ,"addDuration",0,eJ,"between",0,ew,"clamp",0,$,"distance",0,ed,"distanceDuration",0,em,"distanceDurationEither",0,eh,"endOf",0,e1,"format",0,e6,"formatIntl",0,e5,"formatIso",0,e=>e_(e).toISOString(),"formatIsoDate",0,e=>ek(e).toISOString().slice(0,10),"formatIsoDateUtc",0,e=>e_(e).toISOString().slice(0,10),"formatIsoOffset",0,e8,"formatIsoZoned",0,e7,"formatLocal",0,e3,"formatUtc",0,e4,"getPart",0,eA,"getPartUtc",0,eM,"greaterThan",0,eb,"greaterThanOrEqualTo",0,eS,"isDateTime",0,D,"isFuture",0,e=>n.map(Y,ev(e)),"isPast",0,e=>n.map(Y,eb(e)),"isTimeZone",0,U,"isTimeZoneNamed",0,z,"isTimeZoneOffset",0,e=>U(e)&&"Offset"===e._tag,"isUtc",0,e=>"Utc"===e._tag,"isZoned",0,j,"lessThan",0,ev,"lessThanOrEqualTo",0,eE,"make",0,Z,"makeZoned",0,K,"makeZonedFromString",0,e=>{let t=Q.exec(e);if(null===t){let t=ez(e);return null!==t?K(e,{timeZone:t}):k.none()}let[,r,i]=t;return K(r,{timeZone:i})},"mapEpochMillis",0,e$,"match",0,eV,"max",0,ey,"min",0,eg,"mutate",0,eW,"mutateUtc",0,eq,"nearest",0,e2,"now",0,Y,"nowAsDate",0,X,"removeTime",0,e=>eB(e,e=>(e.setUTCHours(0,0,0,0),B(e.getTime()))),"setParts",0,eP,"setPartsUtc",0,eD,"setZone",0,et,"setZoneNamed",0,ep,"setZoneOffset",0,er,"startOf",0,eX,"subtract",0,eQ,"subtractDuration",0,eG,"toDate",0,ek,"toDateUtc",0,e_,"toEpochMillis",0,eT,"toParts",0,eO,"toPartsUtc",0,eF,"toUtc",0,e=>B(e.epochMillis),"unsafeFromDate",0,H,"unsafeIsFuture",0,e=>ev(ee(),e),"unsafeIsPast",0,e=>eb(ee(),e),"unsafeMake",0,V,"unsafeMakeZoned",0,G,"unsafeNow",0,ee,"unsafeSetZoneNamed",0,ef,"withDate",0,eB,"withDateUtc",0,eH,"zoneFromString",0,ec,"zoneMakeLocal",0,()=>ea(new Intl.DateTimeFormat("en-US",en)),"zoneMakeNamed",0,el,"zoneMakeNamedEffect",0,e=>u.try_({try:()=>es(e),catch:e=>e}),"zoneMakeOffset",0,eo,"zoneToString",0,e=>"Offset"===e._tag?eC(e.offset):e.id,"zoneUnsafeMakeNamed",0,es,"zonedOffset",0,ex,"zonedOffsetIso",0,eI],594867);var e9=e.i(931499);e.i(362573),f.isString;let te=b.string;x.string;let tt=e=>e.length>0;class tr{s;stripped;index;length;constructor(e,t=!1){this.s=e,this.stripped=t,this.index=0,this.length=e.length}next(){if(this.done)return{done:!0,value:void 0};let e=this.index;for(;!this.done&&!ti(this.s[this.index]);)this.index=this.index+1;let t=this.index;if(!this.done){let e=this.s[this.index];this.index=this.index+1,!this.done&&tn(e,this.s[this.index])&&(this.index=this.index+1),this.stripped||(t=this.index)}return{done:!1,value:this.s.substring(e,t)}}[Symbol.iterator](){return new tr(this.s,this.stripped)}get done(){return this.index>=this.length}}let ti=e=>{let t=e.charCodeAt(0);return 13===t||10===t},tn=(e,t)=>13===e.charCodeAt(0)&&10===t.charCodeAt(0);e.s(["Equivalence",0,te,"capitalize",0,e=>0===e.length?e:e[0].toUpperCase()+e.slice(1),"isNonEmpty",0,tt,"uncapitalize",0,e=>0===e.length?e:e[0].toLowerCase()+e.slice(1)],923928);let ta=Symbol.for("effect/Cron"),ts={[ta]:ta,[y.symbol](e){return to(e)&&tg(this,e)},[S.symbol](){return(0,t.pipe)(S.hash(this.tz),S.combine(S.array(m.fromIterable(this.seconds))),S.combine(S.array(m.fromIterable(this.minutes))),S.combine(S.array(m.fromIterable(this.hours))),S.combine(S.array(m.fromIterable(this.days))),S.combine(S.array(m.fromIterable(this.months))),S.combine(S.array(m.fromIterable(this.weekdays))),S.cached(this))},toString(){return(0,v.format)(this.toJSON())},toJSON(){return{_id:"Cron",tz:this.tz,seconds:m.fromIterable(this.seconds),minutes:m.fromIterable(this.minutes),hours:m.fromIterable(this.hours),days:m.fromIterable(this.days),months:m.fromIterable(this.months),weekdays:m.fromIterable(this.weekdays)}},[v.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,C.pipeArguments)(this,arguments)}},to=e=>(0,f.hasProperty)(e,ta),tl=e=>{let t=Object.create(ts);t.seconds=new Set(m.sort(e.seconds??[0],e9.Order)),t.minutes=new Set(m.sort(e.minutes,e9.Order)),t.hours=new Set(m.sort(e.hours,e9.Order)),t.days=new Set(m.sort(e.days,e9.Order)),t.months=new Set(m.sort(e.months,e9.Order)),t.weekdays=new Set(m.sort(e.weekdays,e9.Order)),t.tz=k.fromNullable(e.tz);let r=Array.from(t.seconds),i=Array.from(t.minutes),n=Array.from(t.hours),a=Array.from(t.days),s=Array.from(t.months),o=Array.from(t.weekdays);return t.first={second:r[0]??0,minute:i[0]??0,hour:n[0]??0,day:a[0]??1,month:(s[0]??1)-1,weekday:o[0]??0},t.next={second:tu(r,60),minute:tu(i,60),hour:tu(n,24),day:tu(a,32),month:tu(s,13),weekday:tu(o,7)},t},tu=(e,t)=>{let r,i=Array(t).fill(void 0);if(0===e.length)return i;let n=e.length-1;for(let a=t-1;a>=0;a--){for(;n>=0&&e[n]>=a;)r=e[n--];i[a]=r}return i},tc=Symbol.for("effect/Cron/errors/ParseError");class tp extends g.TaggedError("CronParseError"){[tc]=tc}let tf=e=>new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth()+1,0)).getUTCDate(),td=b.make((e,t)=>tm(e.seconds,t.seconds)&&tm(e.minutes,t.minutes)&&tm(e.hours,t.hours)&&tm(e.days,t.days)&&tm(e.months,t.months)&&tm(e.weekdays,t.weekdays)),th=b.array(b.number),tm=(e,t)=>th(m.fromIterable(e),m.fromIterable(t)),tg=(0,t.dual)(2,(e,t)=>td(e,t)),ty={min:0,max:59},tb={min:0,max:59},tS={min:0,max:23},tv={min:1,max:31},tE={min:1,max:12,aliases:{jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12}},tw={min:0,max:6,aliases:{sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6}},t_=(e,t)=>{let r=t.max-t.min+1,i=new Set;for(let n of e.split(",")){let[a,s]=tk(n);if("*"===a&&void 0===s)return p.right(new Set);if(void 0!==s){if(!Number.isInteger(s))return p.left(new tp({message:"Expected step value to be a positive integer",input:e}));if(s<1)return p.left(new tp({message:"Expected step value to be greater than 0",input:e}));if(s>t.max)return p.left(new tp({message:`Expected step value to be less than ${t.max}`,input:e}))}if("*"===a)for(let e=t.min;e<=t.max;e+=s??1)i.add(e);else{let[r,n]=tx(a,t.aliases);if(!Number.isInteger(r))return p.left(new tp({message:"Expected a positive integer",input:e}));if(r<t.min||r>t.max)return p.left(new tp({message:`Expected a value between ${t.min} and ${t.max}`,input:e}));if(void 0===n)i.add(r);else{if(!Number.isInteger(n))return p.left(new tp({message:"Expected a positive integer",input:e}));if(n<t.min||n>t.max)return p.left(new tp({message:`Expected a value between ${t.min} and ${t.max}`,input:e}));if(r>n)return p.left(new tp({message:"Invalid value range",input:e}));for(let e=r;e<=n;e+=s??1)i.add(e)}}if(i.size>=r)return p.right(new Set)}return p.right(i)},tk=e=>{let t=e.indexOf("/");return -1!==t?[e.slice(0,t),Number(e.slice(t+1))]:[e,void 0]},tx=(e,t)=>{let r=e.indexOf("-");return -1!==r?[tC(e.slice(0,r),t),tC(e.slice(r+1),t)]:[tC(e,t),void 0]};function tC(e,t){return t?.[e.toLocaleLowerCase()]??Number(e)}var tI=e.i(972075);tI.RandomTypeId;let tT=a.next;a.nextInt,a.nextBoolean,a.nextRange,a.nextIntBetween,a.shuffle,a.choice,a.randomWith,tI.randomTag,tI.make,tI.fixed;var tR=e.i(907476),tO=e.i(550526),tF=e.i(645278),tM=e.i(742502);let tA=Symbol.for("effect/Schedule"),tN=e=>(0,f.hasProperty)(e,tA),tP=Symbol.for("effect/ScheduleDriver"),tD={start:0,now:0,input:void 0,output:void 0,elapsed:w.zero,elapsedSincePrevious:w.zero,recurrence:0},tL=i.Reference()("effect/Schedule/CurrentIterationMetadata",{defaultValue:()=>tD}),tU={_Out:e=>e,_In:e=>e,_R:e=>e},tz={_Out:e=>e,_In:e=>e,_R:e=>e};class tj{initial;step;[tA]=tU;constructor(e,t){this.initial=e,this.step=t}pipe(){return(0,C.pipeArguments)(this,arguments)}}let tW=(e,t,r,i)=>tM.update(e,e=>0===e.recurrence?{now:t,input:r,output:i,recurrence:e.recurrence+1,elapsed:w.zero,elapsedSincePrevious:w.zero,start:t}:{now:t,input:r,output:i,recurrence:e.recurrence+1,elapsed:w.millis(t-e.start),elapsedSincePrevious:w.millis(t-e.now),start:e.start});class tq{schedule;ref;[tP]=tz;constructor(e,t){this.schedule=e,this.ref=t}get state(){return n.map(tM.get(this.ref),e=>e[1])}get last(){return n.flatMap(tM.get(this.ref),([e,t])=>{switch(e._tag){case"None":return n.failSync(()=>new n.NoSuchElementException);case"Some":return n.succeed(e.value)}})}iterationMeta=tM.unsafeMake(tD);get reset(){return tM.set(this.ref,[k.none(),this.schedule.initial]).pipe(n.zipLeft(tM.set(this.iterationMeta,tD)))}next(e){return(0,t.pipe)(n.map(tM.get(this.ref),e=>e[1]),n.flatMap(r=>(0,t.pipe)(h.currentTimeMillis,n.flatMap(i=>(0,t.pipe)(n.suspend(()=>this.schedule.step(i,e,r)),n.flatMap(([r,a,s])=>{let o=tM.set(this.ref,[k.some(a),r]);if(tR.isDone(s))return o.pipe(n.zipRight(n.fail(k.none())));let l=tF.start(s.intervals)-i;if(l<=0)return o.pipe(n.zipRight(tW(this.iterationMeta,i,e,a)),n.as(a));let c=w.millis(l);return(0,t.pipe)(o,n.zipRight(tW(this.iterationMeta,i,e,a)),n.zipRight(u.sleep(c)),n.as(a))}))))))}}let t$=(e,t)=>new tj(e,t),tB=(0,t.dual)(2,(e,t)=>tH(e,e=>n.sync(()=>t(e)))),tH=(0,t.dual)(2,(e,t)=>rf(e,(e,r)=>n.map(t(e),e=>w.sum(r,w.decode(e))))),tV=(0,t.dual)(2,(e,t)=>ru(tJ(e,t),p.merge)),tJ=(0,t.dual)(2,(e,t)=>t$([e.initial,t.initial,!0],(r,i,a)=>a[2]?n.flatMap(e.step(r,i,a[0]),([e,s,o])=>tR.isDone(o)?n.map(t.step(r,i,a[1]),([t,r,i])=>[[e,t,!1],p.right(r),i]):n.succeed([[e,a[1],!0],p.left(s),o])):n.map(t.step(r,i,a[1]),([e,t,r])=>[[a[0],e,!1],p.right(t),r]))),tG=(0,t.dual)(2,(e,t)=>ru(e,()=>t)),tK=e=>ru(e,t.constVoid),tZ=(0,t.dual)(2,(e,r)=>t$([e.initial,r.initial],(i,[a,s],o)=>n.zipWith(e.step(i,a,o[0]),r.step(i,s,o[1]),([e,r,i],[n,a,s])=>{if(tR.isContinue(i)&&tR.isContinue(s)){let o=(0,t.pipe)(i.intervals,tF.union(s.intervals));return[[e,n],[r,a],tR.continue(o)]}return[[e,n],[r,a],tR.done]}))),tQ=(0,t.dual)(2,(e,t)=>tY(e,(e,r)=>n.sync(()=>t(e,r)))),tY=(0,t.dual)(2,(e,t)=>t$(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),([e,r,a])=>tR.isDone(a)?n.succeed([e,r,tR.done]):n.map(t(i,r),t=>t?[e,r,a]:[e,r,tR.done])))),tX=e=>r_(e,d.empty(),(e,r)=>(0,t.pipe)(e,d.append(r))),t0=(0,t.dual)(2,(e,r)=>t$([e.initial,r.initial],(i,a,s)=>n.flatMap(e.step(i,a,s[0]),([e,a,o])=>n.map(r.step(i,a,s[1]),([r,i,n])=>tR.isDone(o)||tR.isDone(n)?[[e,r],i,tR.done]:[[e,r],i,tR.continue((0,t.pipe)(o.intervals,tF.max(n.intervals)))])))),t1=(0,t.dual)(2,(e,t)=>t6(e,e=>n.sync(()=>t(e)))),t2=(0,t.dual)(2,(e,t)=>t$(e.initial,(r,i,a)=>n.mapInputContext(e.step(r,i,a),t))),t6=(0,t.dual)(2,(e,t)=>t$(e.initial,(r,i,a)=>n.flatMap(t(i),t=>e.step(r,t,a)))),t3=(0,t.dual)(2,(e,t)=>t4(e,e=>n.sync(()=>t(e)))),t4=(0,t.dual)(2,(e,t)=>rf(e,(e,r)=>t(r))),t5=e=>tB(e,e=>e),t8=(0,t.dual)(2,(e,{onInput:t,onOutput:r})=>ru(t1(e,t),r)),t7=(0,t.dual)(2,(e,{onInput:t,onOutput:r})=>rc(t6(e,t),r)),t9=e=>(0,t.pipe)(tM.make([k.none(),e.initial]),n.map(t=>new tq(e,t))),re=e=>{let t=w.decode(e),r=w.toMillis(t);return t$(!0,(e,i,a)=>n.succeed(a?[!1,t,tR.continueWith(tO.after(e+r))]:[!1,w.zero,tR.done]))},rt=(0,t.dual)(2,(e,t)=>rM(e,t)),rr=(0,t.dual)(3,(e,t,r)=>rA(e,t,r)),ri=(0,t.dual)(2,(e,t)=>t$(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),([e,r,i])=>tR.isDone(i)?n.as(t,[e,r,i]):n.succeed([e,r,i])))),rn=()=>t$(void 0,(e,t,r)=>n.succeed([r,t,tR.continueWith(tO.after(e))])),ra=(0,t.dual)(2,(e,t)=>rs(e,t,tF.intersect)),rs=(0,t.dual)(3,(e,r,i)=>t$([e.initial,r.initial],(a,s,o)=>(0,t.pipe)(n.zipWith(e.step(a,s,o[0]),r.step(a,s,o[1]),(e,t)=>[e,t]),n.flatMap(([[t,a,o],[l,u,c]])=>tR.isContinue(o)&&tR.isContinue(c)?ro(e,r,s,t,a,o.intervals,l,u,c.intervals,i):n.succeed([[t,l],[a,u],tR.done]))))),ro=(e,r,i,a,s,o,l,u,c,p)=>{let f=p(o,c);return tF.isNonEmpty(f)?n.succeed([[a,l],[s,u],tR.continue(f)]):(0,t.pipe)(o,tF.lessThan(c))?n.flatMap(e.step(tF.end(o),i,a),([t,a,s])=>tR.isDone(s)?n.succeed([[t,l],[a,u],tR.done]):ro(e,r,i,t,a,s.intervals,l,u,c,p)):n.flatMap(r.step(tF.end(c),i,l),([t,l,u])=>tR.isDone(u)?n.succeed([[a,t],[s,l],tR.done]):ro(e,r,i,a,s,o,t,l,u.intervals,p))},rl=(0,t.dual)(2,(e,t)=>{let{max:r,min:i}=Object.assign({min:.8,max:1.2},t);return t4(e,e=>n.map(tT,t=>{let n=w.toMillis(e);return w.millis(n*i*(1-t)+n*r*t)}))}),ru=(0,t.dual)(2,(e,t)=>rc(e,e=>n.sync(()=>t(e)))),rc=(0,t.dual)(2,(e,t)=>t$(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),([e,r,i])=>n.map(t(r),t=>[e,t,i])))),rp=(0,t.dual)(2,(e,t)=>rf(e,(e,r)=>n.sync(()=>t(e,r)))),rf=(0,t.dual)(2,(e,t)=>t$(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),([e,i,a])=>{if(tR.isDone(a))return n.succeed([e,i,a]);let s=a.intervals,o=tO.size(tO.make(r,tF.start(s)));return n.map(t(i,o),t=>{let n=w.decode(t),a=tF.start(s),o=r+w.toMillis(n),l=o-a,u=Math.max(0,tF.end(s)+l),c=tO.make(o,u);return[e,i,tR.continueWith(c)]})}))),rd=(0,t.dual)(2,(e,t)=>t$(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),([e,r,i])=>n.as(t(r,i),[e,r,i])))),rh=e=>t$(e.initial,(r,i,a)=>(0,t.pipe)(e.step(r,i,a),n.map(([e,t,r])=>[e,i,r]))),rm=(0,t.dual)(2,(e,t)=>t$(e.initial,(r,i,a)=>n.provideContext(e.step(r,i,a),t))),rg=(0,t.dual)(3,(e,t,r)=>t$(e.initial,(a,s,o)=>n.contextWithEffect(l=>n.provideContext(e.step(a,s,o),i.add(l,t,r))))),ry=e=>rN(rn(),e),rb=e=>rP(rn(),e),rS=e=>{let t=w.decode(e);return rW(il,e=>w.lessThan(e,t))},rv=e=>rz(rn(),e),rE=e=>rj(rn(),e),rw=e=>rW(iu,t=>t<e),r_=(0,t.dual)(3,(e,t,r)=>rk(e,t,(e,t)=>n.sync(()=>r(e,t)))),rk=(0,t.dual)(3,(e,t,r)=>t$([e.initial,t],(t,i,[a,s])=>n.flatMap(e.step(t,i,a),([e,t,i])=>tR.isDone(i)?n.succeed([[e,s],s,i]):n.map(r(s,t),t=>[[e,t],s,i])))),rx=(0,t.dual)(2,(e,r)=>{let i=w.decode(r);return(0,t.pipe)(e,ra(il),rC(([,e])=>w.greaterThanOrEqualTo(e,i)),ru(e=>e[0]))}),rC=(0,t.dual)(2,(e,t)=>t$(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),([a,s,o])=>t(s)?e.step(r,i,e.initial):n.succeed([a,s,o])))),rI=(0,t.dual)(3,(e,r,i)=>(0,t.pipe)(rT(e,r,d.fromIterable(i),e.initial,d.empty()),n.map(e=>d.reverse(e)))),rT=(e,r,i,a,s)=>{if(!d.isNonEmpty(i))return n.succeed(s);let o=d.headNonEmpty(i),l=d.tailNonEmpty(i);return n.flatMap(e.step(r,o,a),([r,i,a])=>tR.isDone(a)?n.sync(()=>(0,t.pipe)(s,d.prepend(i))):rT(e,tF.start(a.intervals),l,r,d.prepend(s,i)))},rR=(0,t.dual)(2,(e,t)=>t$(e.initial,(r,i,a)=>n.zipRight(t(i),e.step(r,i,a)))),rO=(0,t.dual)(2,(e,t)=>t$(e.initial,(r,i,a)=>n.tap(e.step(r,i,a),([,e])=>t(e)))),rF=(e,t)=>t$(e,(e,r,i)=>n.sync(()=>[t(i),i,tR.continueWith(tO.after(e))])),rM=(0,t.dual)(2,(e,t)=>rA(e,t,tF.union)),rA=(0,t.dual)(3,(e,t,r)=>t$([e.initial,t.initial],(i,a,s)=>n.zipWith(e.step(i,a,s[0]),t.step(i,a,s[1]),([e,t,i],[n,a,s])=>{if(tR.isDone(i)&&tR.isDone(s))return[[e,n],[t,a],tR.done];if(tR.isDone(i)&&tR.isContinue(s))return[[e,n],[t,a],tR.continue(s.intervals)];if(tR.isContinue(i)&&tR.isDone(s))return[[e,n],[t,a],tR.continue(i.intervals)];if(tR.isContinue(i)&&tR.isContinue(s)){let o=r(i.intervals,s.intervals);return[[e,n],[t,a],tR.continue(o)]}throw Error("BUG: Schedule.unionWith - please report an issue at https://github.com/Effect-TS/effect/issues")}))),rN=(0,t.dual)(2,(e,t)=>tQ(e,(e,r)=>!t(e))),rP=(0,t.dual)(2,(e,t)=>tY(e,(e,r)=>u.negate(t(e)))),rD=(0,t.dual)(2,(e,t)=>tQ(e,(e,r)=>!t(r))),rL=(0,t.dual)(2,(e,t)=>tY(e,(e,r)=>u.negate(t(r)))),rU=(0,t.dual)(2,(e,t)=>r$(e,rS(t))),rz=(0,t.dual)(2,(e,t)=>tQ(e,(e,r)=>t(e))),rj=(0,t.dual)(2,(e,t)=>tY(e,(e,r)=>t(e))),rW=(0,t.dual)(2,(e,t)=>tQ(e,(e,r)=>t(r))),rq=(0,t.dual)(2,(e,t)=>tY(e,(e,r)=>t(r))),r$=(0,t.dual)(2,(e,t)=>ru(ra(e,t),e=>e[0])),rB=(0,t.dual)(2,(e,t)=>ru(ra(e,t),e=>e[1])),rH=(0,t.dual)(3,(e,t,r)=>ru(ra(e,t),([e,t])=>r(e,t))),rV=e=>{let t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),0).getTime()},rJ=e=>{let t=new Date(rV(e));return t.setSeconds(t.getSeconds()+1)},rG=e=>{let t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),0,0).getTime()},rK=e=>{let t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),0,0,0).getTime()},rZ=e=>{let t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime()},rQ=e=>{let t=new Date(rZ(e));return t.setDate(t.getDate()+1)},rY=(e,t,r)=>{let i=new Date(new Date(e).setDate(t));if(new Date(i.setMonth(i.getMonth()+r)).getDate()===t){let i=new Date(new Date(e).setDate(t));return i.setMonth(i.getMonth()+r)}return rY(e,t,r+1)},rX=Symbol.for("effect/Schedule/ScheduleDefect");class r0{error;[rX];constructor(e){this.error=e,this[rX]=rX}}let r1=e=>n.catchAll(e,e=>n.die(new r0(e))),r2=e=>k.match(r.find(e,e=>{let t;return r.isDieType(e)&&(t=e.defect,(0,f.hasProperty)(t,rX))?k.some(e.defect):k.none()}),{onNone:()=>e,onSome:e=>r.fail(e.error)}),r6=e=>n.catchAllCause(e,e=>n.failCause(r2(e))),r3=(0,t.dual)(2,(e,t)=>r5(e,t,(e,t)=>n.fail(e))),r4=(0,t.dual)(2,(e,t)=>{if(tN(t))return r3(e,t);let r=t.schedule??rh(iu),i=t.while?rj(r,e=>{let r=t.while(e);return"boolean"==typeof r?n.succeed(r):r1(r)}):r,a=t.until?rP(i,e=>{let r=t.until(e);return"boolean"==typeof r?n.succeed(r):r1(r)}):i;return r6(r3(e,t.times?ra(a,rw(t.times)).pipe(ru(e=>e[0])):a))}),r5=(0,t.dual)(3,(e,t,r)=>n.flatMap(t9(t),t=>n.matchEffect(e,{onFailure:e=>r(e,k.none()),onSuccess:i=>r8(u.provideServiceEffect(e,tL,tM.get(t.iterationMeta)),t,(e,i)=>u.provideServiceEffect(r(e,i),tL,tM.get(t.iterationMeta)),i)}))),r8=(e,t,r,i)=>n.matchEffect(t.next(i),{onFailure:()=>n.orDie(t.last),onSuccess:i=>n.matchEffect(e,{onFailure:e=>r(e,k.some(i)),onSuccess:i=>r8(e,t,r,i)})}),r7=(0,t.dual)(2,(e,t)=>it(e,t,(e,t)=>n.fail(e))),r9=(0,t.dual)(2,(e,t)=>tN(t)?r7(e,t):r6(r7(e,ie(t)))),ie=e=>{let t=e.schedule??iu,r=e.while?rj(t,t=>{let r=e.while(t);return"boolean"==typeof r?n.succeed(r):r1(r)}):t,i=e.until?rP(r,t=>{let r=e.until(t);return"boolean"==typeof r?n.succeed(r):r1(r)}):r;return e.times?ra(i,rw(e.times)):i},it=(0,t.dual)(3,(e,t,r)=>n.flatMap(t9(t),t=>ir(u.provideServiceEffect(e,tL,tM.get(t.iterationMeta)),t,(e,i)=>u.provideServiceEffect(r(e,i),tL,tM.get(t.iterationMeta))))),ir=(e,r,i)=>n.catchAll(e,a=>n.matchEffect(r.next(a),{onFailure:()=>(0,t.pipe)(r.last,n.orDie,n.flatMap(e=>i(a,e))),onSuccess:()=>ir(e,r,i)})),ii=(0,t.dual)(2,(e,t)=>ia(e,void 0,t)),ia=(0,t.dual)(3,(e,t,r)=>n.flatMap(t9(r),r=>is(u.provideServiceEffect(e,tL,tM.get(r.iterationMeta)),t,r))),is=(e,t,r)=>n.matchEffect(r.next(t),{onFailure:()=>n.orDie(r.last),onSuccess:()=>n.flatMap(e,t=>is(e,t,r))}),io=rF(0,e=>e+1),il=t$(k.none(),(e,t,r)=>{switch(r._tag){case"None":return n.succeed([k.some(e),w.zero,tR.continueWith(tO.after(e))]);case"Some":return n.succeed([k.some(r.value),w.millis(e-r.value),tR.continueWith(tO.after(e))])}}),iu=rF(0,e=>e+1),ic=tK(rw(1)),ip=tK(rw(0)),id=(0,t.dual)(2,(e,t)=>(0,c.forkScoped)(ii(e,t)));e.s(["CurrentIterationMetadata",0,tL,"ScheduleDriverTypeId",0,tP,"ScheduleTypeId",0,tA,"addDelay",0,tB,"addDelayEffect",0,tH,"andThen",0,tV,"andThenEither",0,tJ,"as",0,tG,"asVoid",0,tK,"bothInOut",0,tZ,"check",0,tQ,"checkEffect",0,tY,"collectAllInputs",0,()=>tX(rn()),"collectAllOutputs",0,tX,"collectUntil",0,e=>tX(ry(e)),"collectUntilEffect",0,e=>tX(rb(e)),"collectWhile",0,e=>tX(rv(e)),"collectWhileEffect",0,e=>tX(rE(e)),"compose",0,t0,"count",0,io,"cron",0,(e,r)=>{let i=to(e)?p.right(e):((e,t)=>{let r=e.split(" ").filter(tt);if(5!==r.length&&6!==r.length)return p.left(new tp({message:"Invalid number of segments in cron expression",input:e}));5===r.length&&r.unshift("0");let[i,n,a,s,o,l]=r,u=void 0===t||U(t)?p.right(t):p.fromOption(ec(t),()=>new tp({message:"Invalid time zone in cron expression",input:t}));return p.all({tz:u,seconds:t_(i,ty),minutes:t_(n,tb),hours:t_(a,tS),days:t_(s,tv),months:t_(o,tE),weekdays:t_(l,tw)}).pipe(p.map(tl))})(e,r);return t$([!0,[Number.MIN_SAFE_INTEGER,0,0]],(e,r,[a,s])=>{let o,l,u,c,f;if(e<s[0])return n.succeed([[!1,s],[s[1],s[2]],tR.continueWith(tO.make(s[1],s[2]))]);if(p.isLeft(i))return n.die(i.left);let d=i.right,h=new Date(e);a&&(l=G(h,{timeZone:k.getOrUndefined(d.tz)}).pipe(eO),(0===d.seconds.size||d.seconds.has(l.seconds))&&(0===d.minutes.size||d.minutes.has(l.minutes))&&(0===d.hours.size||d.hours.has(l.hours))&&(0===d.months.size||d.months.has(l.month))&&(0===d.days.size&&0===d.weekdays.size||(0===d.weekdays.size?d.days.has(l.day):0===d.days.size?d.weekdays.has(l.weekDay):d.days.has(l.day)||d.weekdays.has(l.weekDay))))&&(o=e);let m=rV(o=(u=k.getOrUndefined(d.tz),c=G(h??new Date,{timeZone:u}),f=void 0!==u&&z(u)&&"UTC"===u.id?t.constVoid:e=>{let t=G(e,{timeZone:c.zone,adjustForTimeZone:!0}).pipe(ek),r=e.getTime()-t.getTime();r>0&&e.setTime(e.getTime()+r)},e_(eW(c,e=>{e.setUTCSeconds(e.getUTCSeconds()+1,0);for(let t=0;t<1e4;t++){if(0!==d.seconds.size){let t=e.getUTCSeconds(),r=d.next.second[t];if(void 0===r){e.setUTCMinutes(e.getUTCMinutes()+1,d.first.second),f(e);continue}if(r>t){e.setUTCSeconds(r),f(e);continue}}if(0!==d.minutes.size){let t=e.getUTCMinutes(),r=d.next.minute[t];if(void 0===r){e.setUTCHours(e.getUTCHours()+1,d.first.minute,d.first.second),f(e);continue}if(r>t){e.setUTCMinutes(r,d.first.second),f(e);continue}}if(0!==d.hours.size){let t=e.getUTCHours(),r=d.next.hour[t];if(void 0===r){e.setUTCDate(e.getUTCDate()+1),e.setUTCHours(d.first.hour,d.first.minute,d.first.second),f(e);continue}if(r>t){e.setUTCHours(r,d.first.minute,d.first.second),f(e);continue}}if(0!==d.weekdays.size||0!==d.days.size){let t=1/0,r=1/0;if(0!==d.weekdays.size){let r=e.getUTCDay(),i=d.next.weekday[r];t=void 0===i?7-r+d.first.weekday:i-r}if(0!==d.days.size&&0!==t){let t=e.getUTCDate(),i=d.next.day[t];r=void 0===i?tf(e)-t+d.first.day:i-t}let i=Math.min(t,r);if(0!==i){e.setUTCDate(e.getUTCDate()+i),e.setUTCHours(d.first.hour,d.first.minute,d.first.second),f(e);continue}}if(0!==d.months.size){let t=e.getUTCMonth()+1,r=d.next.month[t];if(void 0===r){e.setUTCFullYear(e.getUTCFullYear()+1),e.setUTCMonth(d.first.month,d.first.day),e.setUTCHours(d.first.hour,d.first.minute,d.first.second),f(e);continue}if(r>t){e.setUTCMonth(r-1,d.first.day),e.setUTCHours(d.first.hour,d.first.minute,d.first.second),f(e);continue}}return}throw Error("Unable to find next cron date")}))).getTime()),g=rJ(o);return n.succeed([[!1,[o,m,g]],[m,g],tR.continueWith(tO.make(m,g))])})},"dayOfMonth",0,e=>t$([-1/0,0],(t,r,i)=>{var a,s,o;let l;if(!Number.isInteger(e)||e<1||31<e)return n.dieSync(()=>new n.IllegalArgumentException(`Invalid argument in: dayOfMonth(${e}). Must be in range 1...31`));let u=i[1],c=(a=t,s=e,o=0===u,(l=new Date(a)).getDate()===s&&o?a:l.getDate()<s?l.setDate(s):rY(a,s,1)),p=rZ(c),f=rQ(c),d=tO.make(p,f);return n.succeed([[f,u+1],u,tR.continueWith(d)])}),"dayOfWeek",0,e=>t$([Number.MIN_SAFE_INTEGER,0],(t,r,i)=>{if(!Number.isInteger(e)||e<1||7<e)return n.dieSync(()=>new n.IllegalArgumentException(`Invalid argument in: dayOfWeek(${e}). Must be in range 1 (Monday)...7 (Sunday)`));let a=i[1],s=((e,t,r)=>{let i=new Date(e);if(i.getDay()===t&&r)return e;let n=(7+t-i.getDay())%7;return i.setDate(i.getDate()+(0===n?7:n))})(t,e,0===a),o=rZ(s),l=rQ(s),u=tO.make(o,l);return n.succeed([[l,a+1],a,tR.continueWith(u)])}),"delayed",0,t3,"delayedEffect",0,t4,"delayedSchedule",0,t5,"delays",0,e=>t$(e.initial,(r,i,a)=>(0,t.pipe)(e.step(r,i,a),n.flatMap(([e,t,i])=>tR.isDone(i)?n.succeed([e,w.zero,i]):n.succeed([e,w.millis(tF.start(i.intervals)-r),i])))),"driver",0,t9,"duration",0,re,"either",0,rt,"eitherWith",0,rr,"elapsed",0,il,"ensuring",0,ri,"exponential",0,(e,t=2)=>{let r=w.decode(e);return t5(ru(iu,e=>w.times(r,Math.pow(t,e))))},"fibonacci",0,e=>{let r=w.decode(e);return t5((0,t.pipe)(rF([r,r],([e,t])=>[t,w.sum(e,t)]),ru(e=>e[0])))},"fixed",0,e=>{let t=w.decode(e),r=w.toMillis(t);return t$([k.none(),0],(e,i,[a,s])=>n.sync(()=>{switch(a._tag){case"None":return[[k.some([e,e+r]),s+1],s,tR.continueWith(tO.after(e+r))];case"Some":{let[i,n]=a.value,o=e>n+r,l=y.equals(t,w.zero)?t:w.millis(r-(e-i)%r),u=y.equals(l,w.zero)?t:l,c=o?e:e+w.toMillis(u);return[[k.some([i,c]),s+1],s,tR.continueWith(tO.after(c))]}}}))},"forever",0,iu,"fromDelay",0,e=>re(e),"fromDelays",0,(e,...t)=>t$([[e,...t].map(e=>w.decode(e)),!0],(e,t,[r,i])=>n.sync(()=>{if(i){let t=r[0],i=tO.after(e+w.toMillis(t));return r.length>=2?[[r.slice(1),!0],t,tR.continueWith(i)]:[[[t,...r.slice(1)],!1],t,tR.continueWith(i)]}return[[r,!1],w.zero,tR.done]})),"fromFunction",0,e=>ru(rn(),e),"fromRetryOptions",0,ie,"hourOfDay",0,e=>t$([-1/0,0],(t,r,i)=>{let a;if(!Number.isInteger(e)||e<0||23<e)return n.dieSync(()=>new n.IllegalArgumentException(`Invalid argument in: hourOfDay(${e}). Must be in range 0...23`));let s=i[1],o=((e,t,r)=>{let i=new Date(e);if(i.getHours()===t&&r)return e;if(i.getHours()<t)return i.setHours(t);let n=new Date(i.setHours(t));return n.setTime(n.getTime()+864e5)})(t,e,0===s),l=rK(o),u=(a=new Date(rK(o))).setHours(a.getHours()+1),c=tO.make(l,u);return n.succeed([[u,s+1],s,tR.continueWith(c)])}),"identity",0,rn,"intersect",0,ra,"intersectWith",0,rs,"isSchedule",0,tN,"jittered",0,e=>rl(e,{min:.8,max:1.2}),"jitteredWith",0,rl,"linear",0,e=>{let t=w.decode(e);return t5(ru(iu,e=>w.times(t,e+1)))},"makeWithState",0,t$,"map",0,ru,"mapBoth",0,t8,"mapBothEffect",0,t7,"mapEffect",0,rc,"mapInput",0,t1,"mapInputContext",0,t2,"mapInputEffect",0,t6,"minuteOfHour",0,e=>t$([Number.MIN_SAFE_INTEGER,0],(t,r,i)=>{let a;if(!Number.isInteger(e)||e<0||59<e)return n.dieSync(()=>new n.IllegalArgumentException(`Invalid argument in: minuteOfHour(${e}). Must be in range 0...59`));let s=i[1],o=((e,t,r)=>{let i=new Date(e);if(i.getMinutes()===t&&r)return e;if(i.getMinutes()<t)return i.setMinutes(t);let n=new Date(i.setMinutes(t));return n.setTime(n.getTime()+36e5)})(t,e,0===s),l=rG(o),u=(a=new Date(rG(o))).setMinutes(a.getMinutes()+1),c=tO.make(l,u);return n.succeed([[u,s+1],s,tR.continueWith(c)])}),"modifyDelay",0,rp,"modifyDelayEffect",0,rf,"onDecision",0,rd,"once",0,ic,"passthrough",0,rh,"provideContext",0,rm,"provideService",0,rg,"recurUntil",0,ry,"recurUntilEffect",0,rb,"recurUntilOption",0,e=>rD(ru(rn(),e),k.isSome),"recurUpTo",0,rS,"recurWhile",0,rv,"recurWhileEffect",0,rE,"recurs",0,rw,"reduce",0,r_,"reduceEffect",0,rk,"repeatOrElse_Effect",0,r5,"repeat_combined",0,r4,"repetitions",0,e=>r_(e,0,(e,t)=>e+1),"resetAfter",0,rx,"resetWhen",0,rC,"retryOrElse_Effect",0,it,"retry_Effect",0,r7,"retry_combined",0,r9,"run",0,rI,"scheduleDefectRefail",0,r6,"scheduleDefectRefailCause",0,r2,"scheduleForked",0,id,"scheduleFrom_Effect",0,ia,"schedule_Effect",0,ii,"secondOfMinute",0,e=>t$([-1/0,0],(t,r,i)=>{if(!Number.isInteger(e)||e<0||59<e)return n.dieSync(()=>new n.IllegalArgumentException(`Invalid argument in: secondOfMinute(${e}). Must be in range 0...59`));let a=i[1],s=((e,t,r)=>{let i=new Date(e);if(i.getSeconds()===t&&r)return e;if(i.getSeconds()<t)return i.setSeconds(t);let n=new Date(i.setSeconds(t));return n.setTime(n.getTime()+6e4)})(t,e,0===a),o=rV(s),l=rJ(s),u=tO.make(o,l);return n.succeed([[l,a+1],a,tR.continueWith(u)])}),"spaced",0,e=>tB(iu,()=>e),"stop",0,ip,"succeed",0,e=>ru(iu,()=>e),"sync",0,e=>ru(iu,e),"tapInput",0,rR,"tapOutput",0,rO,"unfold",0,rF,"union",0,rM,"unionWith",0,rA,"untilInput",0,rN,"untilInputEffect",0,rP,"untilOutput",0,rD,"untilOutputEffect",0,rL,"upTo",0,rU,"whileInput",0,rz,"whileInputEffect",0,rj,"whileOutput",0,rW,"whileOutputEffect",0,rq,"windowed",0,e=>{let t=w.decode(e),r=w.toMillis(t);return t$([k.none(),0],(e,t,[i,a])=>{switch(i._tag){case"None":return n.succeed([[k.some(e),a+1],a,tR.continueWith(tO.after(e+r))]);case"Some":return n.succeed([[k.some(i.value),a+1],a,tR.continueWith(tO.after(e+(r-(e-i.value)%r)))])}})},"zipLeft",0,r$,"zipRight",0,rB,"zipWith",0,rH],943597);let ih=(0,t.dual)(2,(e,t)=>n.suspend(()=>{let r,i=0;return n.flatMap(n.whileLoop({while:()=>i<t.steps.length&&(void 0===r||p.isLeft(r)),body:()=>{let a=t.steps[i],s=l.effect_provide(e,a.provide);if(r){let e=!1,t=s;s=r6(r7(s=n.suspend(()=>e?t:(e=!0,r)),im(a,!1)))}else{let e=im(a,!0);s=e?r6(r7(s,e)):s}return n.either(s)},step:e=>{r=e,i++}}),()=>r)})),im=(e,t)=>t?1!==e.attempts&&(e.schedule||e.attempts)?ie({schedule:e.schedule,while:e.while,times:e.attempts?e.attempts-1:void 0}):void 0:ie({schedule:e.schedule?e.schedule:e.attempts?void 0:ic,times:e.attempts,while:e.while});e.s(["scheduleFromStep",0,im,"withExecutionPlan",0,ih],900386),e.i(480467);var ig=e.i(162098),iy=e.i(741840),ib=e.i(601009),iS=e.i(215139);e.i(473598);var iv=e.i(322813);iv.RequestTypeId;let iE=iv.isRequest;iv.of,iv.tagged;let iw=iv.Class;iv.TaggedClass,iv.complete,o.interruptWhenPossible,iv.completeEffect,iv.fail,iv.failCause,iv.succeed,iS.isEntry,iS.makeEntry,e.s(["Class",0,iw,"isRequest",0,iE],237270);var i_=e.i(803327),ik=e.i(686434);let ix=n.EffectTypeId,iC=n.isEffect;c.cached,c.cachedInvalidateWithTTL;let iI=u.memoize;c.cachedFunction,u.once;let iT=o.all;o.allWith,o.allSuccesses;let iR=u.dropUntil,iO=u.dropWhile;u.takeUntil;let iF=u.takeWhile;u.every,o.exists;let iM=o.filter;u.filterMap;let iA=u.findFirst,iN=o.forEach;u.head,o.mergeAll,o.partition;let iP=u.reduce;u.reduceWhile,u.reduceRight,o.reduceEffect,o.replicate,o.replicateEffect,o.validateAll,o.validateFirst;let iD=n.async;iy.asyncEffect,n.custom;let iL=n.withFiberRuntime,iU=n.fail,iz=n.failSync,ij=n.failCause,iW=n.failCauseSync,iq=n.die,i$=n.dieMessage,iB=n.dieSync,iH=n.gen,iV=n.never;u.none;let iJ=u.promise,iG=n.succeed,iK=u.succeedNone;u.succeedSome;let iZ=n.suspend,iQ=n.sync,iY=n.void;n.yieldNow,u._catch;let iX=n.catchAll,i0=n.catchAllCause;u.catchAllDefect;let i1=n.catchIf;n.catchSome;let i2=u.catchSomeCause;u.catchSomeDefect;let i6=u.catchTag,i3=u.catchTags;u.cause,u.eventually;let i4=u.ignore,i5=u.ignoreLogged;u.parallelErrors,u.sandbox;let i8=u.try_,i7=u.tryMap;u.tryMapPromise;let i9=u.tryPromise;u.unsandbox,u.allowInterrupt,n.checkInterruptible,o.disconnect;let ne=n.interrupt;n.interruptWith;let nt=n.interruptible;n.interruptibleMask;let nr=n.onInterrupt,ni=n.uninterruptible,nn=n.uninterruptibleMask;u.liftPredicate;let na=n.as,ns=u.asSome;u.asSomeError;let no=n.asVoid;n.flip,u.flipWith;let nl=n.map;u.mapAccum;let nu=n.mapBoth,nc=n.mapError;u.mapErrorCause,u.merge,u.negate;let np=o.acquireRelease;o.acquireReleaseInterruptible;let nf=n.acquireUseRelease;o.addFinalizer;let nd=o.ensuring,nh=n.onError,nm=n.onExit;o.parallelFinalizers,o.sequentialFinalizers,o.finalizersMask;let ng=o.scope,ny=o.scopeWith,nb=o.scopedWith,nS=o.scopedEffect;o.using,o.withEarlyRelease,c.awaitAllChildren,o.daemonChildren,u.descriptor,u.descriptorWith,u.diffFiberRefs,c.ensuringChild,c.ensuringChildren,n.fiberId;let nv=n.fiberIdWith;o.fork;let nE=o.forkDaemon;c.forkAll;let nw=c.forkIn,n_=c.forkScoped;o.forkWithErrorHandler,c.fromFiber,c.fromFiberEffect,c.supervised,n.transplant,n.withConcurrency,i_.withScheduler,n.withSchedulingPriority,n.withMaxOpsBeforeYield;let nk=u.clock;u.clockWith,o.withClockScoped,a.withClock,u.delay,u.sleep,u.timed,u.timedWith,c.timeout,c.timeoutOption;let nx=c.timeoutFail,nC=c.timeoutFailCause;c.timeoutTo,a.configProviderWith,a.withConfigProvider,o.withConfigProviderScoped;let nI=n.context,nT=u.contextWith;n.contextWithEffect;let nR=n.mapInputContext,nO=l.effect_provide,nF=u.provideService,nM=u.provideServiceEffect;u.serviceFunction,u.serviceFunctionEffect;let nA=u.serviceFunctions;u.serviceConstants,u.serviceMembers,u.serviceOption,u.serviceOptional;let nN=u.updateService;u.Do;let nP=u.bind;c.bindAll;let nD=u.bindTo;u.let_,u.option;let nL=n.either,nU=n.exit,nz=n.intoDeferred,nj=n.if_;u.filterOrDie,u.filterOrDieMessage;let nW=u.filterOrElse,nq=u.filterOrFail;n.filterEffectOrElse,n.filterEffectOrFail,u.unless,u.unlessEffect;let n$=u.when;n.whenEffect,u.whenFiberRef,u.whenRef;let nB=n.flatMap,nH=n.andThen,nV=n.flatten,nJ=o.race;o.raceAll;let nG=c.raceFirst,nK=o.raceWith;u.summarized;let nZ=n.tap,nQ=u.tapBoth;u.tapDefect;let nY=u.tapError;u.tapErrorTag;let nX=u.tapErrorCause,n0=u.forever;u.iterate,u.loop,u.repeatN;let n1=n.whileLoop;u.fiberRefs,u.inheritFiberRefs;let n2=n.fiberRefLocally,n6=n.fiberRefLocallyWith;o.fiberRefLocallyScoped,o.fiberRefLocallyScopedWith,u.patchFiberRefs,u.setFiberRefs,u.updateFiberRefs,u.isFailure,u.isSuccess;let n3=u.match,n4=n.matchCause,n5=n.matchCauseEffect,n8=n.matchEffect,n7=u.log;u.logTrace;let n9=u.logDebug,ae=u.logInfo,at=u.logWarning,ar=u.logError;u.logFatal;let ai=u.withLogSpan,an=u.annotateLogs;o.annotateLogsScoped,u.logAnnotations,n.withUnhandledErrorLogLevel,o.whenLogLevel;let aa=n.orDie;n.orDieWith;let as=n.orElse;u.orElseFail,u.orElseSucceed,u.firstSuccessOf,u.random,a.randomWith,a.withRandom,o.withRandomScoped;let ao=iy.runtime;n.runtimeFlags,n.updateRuntimeFlags,n.withRuntimeFlags,o.withRuntimeFlagsScoped,u.tagMetrics,u.labelMetrics,o.tagMetricsScoped,o.labelMetricsScoped,n.metricLabels,u.withMetric,c.unsafeMakeSemaphore;let al=c.makeSemaphore,au=c.unsafeMakeLatch;c.makeLatch;let ac=iy.unsafeForkEffect;iy.unsafeRunEffect;let ap=iy.unsafeRunPromiseEffect;iy.unsafeRunPromiseExitEffect;let af=iy.unsafeRunSyncEffect;iy.unsafeRunSyncExitEffect,o.validate,o.validateWith;let ad=o.zipOptions,ah=o.zipLeftOptions,am=o.zipRightOptions,ag=o.zipWithOptions,ay=(0,t.dual)(2,(e,t)=>ag(e,t,(e,t)=>e(t)));n.blocked,n.runRequestBlock,n.step,ig.fromRequest,ig.cacheRequest,n.withRequestBatching,ig.withRequestCaching,ig.withRequestCache,u.tracer,a.tracerWith,a.withTracer,o.withTracerScoped,n.withTracerEnabled,n.withTracerTiming,u.annotateSpans,u.annotateCurrentSpan,u.currentSpan,u.currentParentSpan,u.spanAnnotations,u.spanLinks,u.linkSpans,u.linkSpanCurrent;let ab=u.makeSpan;o.makeSpanScoped;let aS=u.useSpan,av=u.withSpan;u.functionWithSpan,o.withSpanScoped;let aE=u.withParentSpan;function aw(e,t){return Object.defineProperty(t,"length",{value:e,configurable:!0})}function a_(e){let t,i;if((0,ik.isGeneratorFunction)(e.body))t=n.fromIterator(()=>e.body.apply(e.self,e.args));else try{t=e.body.apply(e.self,e.args)}catch(e){i=e,t=iq(e)}if(e.pipeables.length>0)try{for(let r of e.pipeables)t=r(t,...e.args)}catch(e){t=i?ij(r.sequential(r.die(i),r.die(e))):iq(e)}let a=!1,s=e.spanOptions&&"captureStackTrace"in e.spanOptions?e.spanOptions:{captureStackTrace:()=>{if(!1!==a)return a;if(e.errorCall.stack){let t=e.errorDef.stack.trim().split("\n"),r=e.errorCall.stack.trim().split("\n"),i=t.slice(2).join("\n").trim();i.includes("(")||(i=i.replace(/at (.*)/,"at ($1)"));let n=r.slice(2).join("\n").trim();return n.includes("(")||(n=n.replace(/at (.*)/,"at ($1)")),a=`${i}
${n}`}},...e.spanOptions};return av(t,e.spanName,s)}u.fromNullable,u.optionFromOptional,n.fnUntraced,e.s(["EffectTypeId",0,ix,"acquireRelease",0,np,"acquireUseRelease",0,nf,"all",0,iT,"andThen",0,nH,"annotateLogs",0,an,"ap",0,ay,"as",0,na,"asSome",0,ns,"asVoid",0,no,"async",0,iD,"bind",0,nP,"bindTo",0,nD,"cached",0,iI,"catchAll",0,iX,"catchAllCause",0,i0,"catchIf",0,i1,"catchSomeCause",0,i2,"catchTag",0,i6,"catchTags",0,i3,"clock",0,nk,"context",0,nI,"contextWith",0,nT,"die",0,iq,"dieMessage",0,i$,"dieSync",0,iB,"dropUntil",0,iR,"dropWhile",0,iO,"either",0,nL,"ensuring",0,nd,"exit",0,nU,"fail",0,iU,"failCause",0,ij,"failCauseSync",0,iW,"failSync",0,iz,"fiberIdWith",0,nv,"filter",0,iM,"filterOrElse",0,nW,"filterOrFail",0,nq,"findFirst",0,iA,"flatMap",0,nB,"flatten",0,nV,"fn",0,function(e,...t){let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let i=Error();if(Error.stackTraceLimit=r,"string"!=typeof e)return aw(e.length,function(...r){let n=Error.stackTraceLimit;Error.stackTraceLimit=2;let a=Error();return Error.stackTraceLimit=n,a_({self:this,body:e,args:r,pipeables:t,spanName:"<anonymous>",spanOptions:{context:ib.DisablePropagation.context(!0)},errorDef:i,errorCall:a})});let n=t[0];return(t,...r)=>aw(t.length,{[e](...a){let s=Error.stackTraceLimit;Error.stackTraceLimit=2;let o=Error();return Error.stackTraceLimit=s,a_({self:this,body:t,args:a,pipeables:r,spanName:e,spanOptions:n,errorDef:i,errorCall:o})}}[e])},"forEach",0,iN,"forever",0,n0,"forkDaemon",0,nE,"forkIn",0,nw,"forkScoped",0,n_,"gen",0,iH,"if",()=>nj,"ignore",0,i4,"ignoreLogged",0,i5,"interrupt",0,ne,"interruptible",0,nt,"intoDeferred",0,nz,"isEffect",0,iC,"locally",0,n2,"locallyWith",0,n6,"log",0,n7,"logDebug",0,n9,"logError",0,ar,"logInfo",0,ae,"logWarning",0,at,"logWithLevel",0,(e,...t)=>u.logWithLevel(e)(...t),"makeSemaphore",0,al,"makeSpan",0,ab,"map",0,nl,"mapBoth",0,nu,"mapError",0,nc,"mapInputContext",0,nR,"match",0,n3,"matchCause",0,n4,"matchCauseEffect",0,n5,"matchEffect",0,n8,"never",0,iV,"onError",0,nh,"onExit",0,nm,"onInterrupt",0,nr,"orDie",0,aa,"orElse",0,as,"promise",0,iJ,"provide",0,nO,"provideService",0,nF,"provideServiceEffect",0,nM,"race",0,nJ,"raceFirst",0,nG,"raceWith",0,nK,"reduce",0,iP,"repeat",0,r4,"retry",0,r9,"runFork",0,ac,"runPromise",0,ap,"runSync",0,af,"runtime",0,ao,"scope",0,ng,"scopeWith",0,ny,"scoped",0,nS,"scopedWith",0,nb,"serviceFunctions",0,nA,"succeed",0,iG,"succeedNone",0,iK,"suspend",0,iZ,"sync",0,iQ,"takeWhile",0,iF,"tap",0,nZ,"tapBoth",0,nQ,"tapError",0,nY,"tapErrorCause",0,nX,"timeoutFail",0,nx,"timeoutFailCause",0,nC,"try",()=>i8,"tryMap",0,i7,"tryPromise",0,i9,"uninterruptible",0,ni,"uninterruptibleMask",0,nn,"unsafeMakeLatch",0,au,"updateService",0,nN,"useSpan",0,aS,"void",()=>iY,"when",0,n$,"whileLoop",0,n1,"withFiberRuntime",0,iL,"withLogSpan",0,ai,"withParentSpan",0,aE,"zip",0,ad,"zipLeft",0,ah,"zipRight",0,am,"zipWith",0,ag],405614)},457602,e=>{"use strict";var t=e.i(777865),r=e.i(842862),i=e.i(838927),n=e.i(580611),a=e.i(276406),s=e.i(885858),o=e.i(399683);e.i(389668),e.i(764120);var l=e.i(601009);let u=(0,r.dual)(2,(e,t)=>n.fiberRefLocally(a.currentMinimumLogLevel,t)(e)),c=e=>s.scopedDiscard(a.fiberRefLocallyScopedWith(a.currentLoggers,i.add(e))),p=e=>s.unwrapEffect(n.map(e,c)),f=e=>s.unwrapScoped(n.map(e,c)),d=e=>s.scopedDiscard(a.fiberRefLocallyScopedWith(a.currentLoggers,i.remove(e))),h=(0,r.dual)(2,(e,t)=>s.flatMap(d(e),()=>c(t))),m=(0,r.dual)(2,(e,t)=>s.flatMap(d(e),()=>p(t))),g=(0,r.dual)(2,(e,t)=>s.flatMap(d(e),()=>f(t)));o.CooperativeYielding,o.Interruption,o.OpSupervision,o.RuntimeMetrics,o.WindDown,o.CooperativeYielding,o.Interruption,o.OpSupervision,o.RuntimeMetrics,o.WindDown,e.s(["addLogger",0,c,"addLoggerEffect",0,p,"addLoggerScoped",0,f,"minimumLogLevel",0,e=>s.scopedDiscard(a.fiberRefLocallyScoped(a.currentMinimumLogLevel,e)),"parentSpan",0,e=>s.succeedContext(t.make(l.spanTag,e)),"removeLogger",0,d,"replaceLogger",0,h,"replaceLoggerEffect",0,m,"replaceLoggerScoped",0,g,"setConfigProvider",0,e=>s.scopedDiscard(a.withConfigProviderScoped(e)),"setTracer",0,e=>s.scopedDiscard(a.withTracerScoped(e)),"span",0,(e,t)=>(t=l.addSpanStackTrace(t),s.scoped(l.spanTag,t?.onEnd?n.tap(a.makeSpanScoped(e,t),e=>a.addFinalizer(r=>t.onEnd(e,r))):a.makeSpanScoped(e,t))),"withMinimumLogLevel",0,u])},347064,e=>{"use strict";e.i(777865),e.i(842862),e.i(932213),e.i(580611),e.i(374132),e.i(276406);var t=e.i(885858),r=e.i(457602);e.i(162098),e.i(972075),e.i(803327),t.LayerTypeId,t.MemoMapTypeId,t.CurrentMemoMap,t.isLayer,t.isFresh,t.annotateLogs,t.annotateSpans,t.build;let i=t.buildWithScope;t.catchAll,t.catchAllCause;let n=t.context;t.die,t.dieSync,t.discard;let a=t.fromEffect,s=t.fromEffectDiscard;t.fromEffectContext,t.empty,t.extendScope,t.fail,t.failSync,t.failCause,t.failCauseSync,t.flatMap,t.flatten,t.fresh,t.mock,t.fromFunction,t.launch,t.map,t.mapError,t.match,t.matchCause,t.memoize;let o=t.merge,l=t.mergeAll;t.orDie,t.orElse,t.passthrough,t.project,t.locallyEffect;let u=t.fiberRefLocally;t.fiberRefLocallyWith;let c=t.fiberRefLocallyScoped;t.fiberRefLocallyScopedWith,t.retry,t.scope,t.scoped;let p=t.scopedDiscard;t.scopedContext,t.service;let f=t.succeed;t.succeedContext,t.suspend;let d=t.sync;t.syncContext,t.tap,t.tapError,t.tapErrorCause;let h=t.toRuntime,m=t.toRuntimeWithMemoMap,g=t.provide,y=t.provideMerge;t.zipWith;let b=t.unwrapEffect;t.unwrapScoped;let S=r.setConfigProvider;r.parentSpan,r.span,r.setTracer,t.withSpan,t.withParentSpan,t.makeMemoMap,t.buildWithMemoMap,e.s(["buildWithScope",0,i,"context",0,n,"effect",0,a,"effectDiscard",0,s,"locally",0,u,"locallyScoped",0,c,"merge",0,o,"mergeAll",0,l,"provide",0,g,"provideMerge",0,y,"scopedDiscard",0,p,"setConfigProvider",0,S,"succeed",0,f,"sync",0,d,"toRuntime",0,h,"toRuntimeWithMemoMap",0,m,"unwrapEffect",0,b])},411237,862396,e=>{"use strict";let t,r,i,n;var a,s,o,l,u,c,p=e.i(435146),f=e.i(945831),d=e.i(266493),h=e.i(842862),m=e.i(408043),g=e.i(580537),y=e.i(65632),b=e.i(129248),S=e.i(787039),v=e.i(100808);let E=Symbol.for("effect/BigDecimal"),w={[E]:E,[m.symbol](){let e=O(this);return(0,h.pipe)(m.hash(e.value),m.combine(m.number(e.scale)),m.cached(this))},[f.symbol](e){return _(e)&&U(this,e)},toString(){return`BigDecimal(${z(this)})`},toJSON(){return{_id:"BigDecimal",value:String(this.value),scale:this.scale}},[g.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,S.pipeArguments)(this,arguments)}},_=e=>(0,v.hasProperty)(e,E),k=(e,t)=>{let r=Object.create(w);return r.value=e,r.scale=t,r},x=(e,t)=>{if(e!==C&&e%T===C)throw RangeError("Value must be normalized");let r=k(e,t);return r.normalized=r,r},C=BigInt(0),I=BigInt(1),T=BigInt(10),R=x(C,0),O=e=>{if(void 0===e.normalized)if(e.value===C)e.normalized=R;else{let t=`${e.value}`,r=0;for(let e=t.length-1;e>=0;e--)if("0"===t[e])r++;else break;0===r&&(e.normalized=e);let i=BigInt(t.substring(0,t.length-r)),n=e.scale-r;e.normalized=x(i,n)}return e.normalized},F=(0,h.dual)(2,(e,t)=>t>e.scale?k(e.value*T**BigInt(t-e.scale),t):t<e.scale?k(e.value/T**BigInt(e.scale-t),t):e),M=(0,h.dual)(2,(e,t)=>t.value===C?e:e.value===C?t:e.scale>t.scale?k(F(t,e.scale).value+e.value,e.scale):e.scale<t.scale?k(F(e,t.scale).value+t.value,t.scale):k(e.value+t.value,e.scale)),A=b.make((e,t)=>{let r=b.number(D(e),D(t));return 0!==r?r:e.scale>t.scale?b.bigint(e.value,F(t,e.scale).value):e.scale<t.scale?b.bigint(F(e,t.scale).value,t.value):b.bigint(e.value,t.value)}),N=b.lessThan(A),P=b.greaterThan(A),D=e=>e.value===C?0:e.value<C?-1:1,L=d.make((e,t)=>e.scale>t.scale?F(t,e.scale).value===e.value:e.scale<t.scale?F(e,t.scale).value===t.value:e.value===t.value),U=(0,h.dual)(2,(e,t)=>L(e,t)),z=e=>{let t,r,i=O(e);if(Math.abs(i.scale)>=16)return j(i);let n=i.value<C,a=n?`${i.value}`.substring(1):`${i.value}`;if(i.scale>=a.length)t="0",r="0".repeat(i.scale-a.length)+a;else{let e=a.length-i.scale;if(e>a.length){let i=e-a.length;t=`${a}${"0".repeat(i)}`,r=""}else r=a.slice(e),t=a.slice(0,e)}let s=""===r?t:`${t}.${r}`;return n?`-${s}`:s},j=e=>{if(W(e))return"0e+0";let t=O(e),r=`${(t.value<C?k(-t.value,t.scale):t).value}`,i=r.slice(0,1),n=r.slice(1),a=`${q(t)?"-":""}${i}`;""!==n&&(a+=`.${n}`);let s=n.length-t.scale;return`${a}e${s>=0?"+":""}${s}`},W=e=>e.value===C,q=e=>e.value<C,$=e=>_(e[0]),B=((e,t=0)=>{let r=B(e,t);return e.value>C&&N(r,e)?M(r,k(1n,t)):r},(0,h.dual)($,(e,t=0)=>e.scale<=t?e:k(e.value/10n**BigInt(e.scale-t),t))),H=((e,t)=>e.scale<t?0n:e.value/10n**BigInt(e.scale-t)%10n,BigInt(0));v.isBigInt,d.bigint,b.bigint,(e,t)=>{for(;t!==H;){let r=t;t=e%t,e=r}return e};let V=e=>{try{return""===e.trim()?y.none():y.some(BigInt(e))}catch{return y.none()}};e.i(330709);var J=e.i(710284);e.i(526886);var G=e.i(293889),K=e.i(433366),Z=e.i(64317),Q=e.i(777865),Y=e.i(405614),X=e.i(594867);e.i(347064),X.TypeId,X.TimeZoneTypeId;let ee=X.isDateTime;X.isTimeZone;let et=X.isTimeZoneOffset,er=X.isTimeZoneNamed,ei=X.isUtc,en=X.isZoned,ea=X.Equivalence;X.Order,X.clamp;let es=X.unsafeFromDate,eo=X.unsafeMake,el=X.unsafeMakeZoned;X.makeZoned,X.make,X.makeZonedFromString,X.now,X.nowAsDate,X.unsafeNow,X.toUtc,X.setZone,X.setZoneOffset;let eu=X.zoneUnsafeMakeNamed,ec=X.zoneMakeOffset;X.zoneMakeNamed,X.zoneMakeNamedEffect,X.zoneMakeLocal,X.zoneFromString,X.zoneToString,X.setZoneNamed,X.unsafeSetZoneNamed,X.distance,X.distanceDurationEither,X.distanceDuration,X.min,X.max,X.greaterThan,X.greaterThanOrEqualTo,X.lessThan,X.lessThanOrEqualTo,X.between,X.isFuture,X.unsafeIsFuture,X.isPast,X.unsafeIsPast,X.toDateUtc,X.toDate,X.zonedOffset,X.zonedOffsetIso,X.toEpochMillis,X.removeTime,X.toParts,X.toPartsUtc,X.getPartUtc,X.getPart,X.setParts,X.setPartsUtc,X.mutate,X.mutateUtc,X.mapEpochMillis,X.withDate,X.withDateUtc,X.match,X.addDuration,X.subtractDuration,X.add,X.subtract,X.startOf,X.endOf,X.nearest,X.format,X.formatLocal,X.formatUtc,X.formatIntl,X.formatIso,X.formatIsoDate,X.formatIsoDateUtc,X.formatIsoOffset,X.formatIsoZoned;var ep=e.i(649488),ef=e.i(964665),ed=e.i(916947),eh=f,em=d,eg=e.i(368171);class ey extends Error{constructor(e=!1){super(),this.interruptExecution=e,this.footprint=ey.SharedFootPrint}static isFailure(e){return null!=e&&e.footprint===ey.SharedFootPrint}}ey.SharedFootPrint=Symbol.for("fast-check/PreconditionFailure");class eb{[Symbol.iterator](){return this}next(e){return{value:e,done:!0}}}eb.nil=new eb;let eS=Symbol.iterator;class ev{static nil(){return new ev(eb.nil)}static of(...e){return new ev(e[eS]())}constructor(e){this.g=e}next(){return this.g.next()}[Symbol.iterator](){return this.g}map(e){return new ev(function*(e,t){for(let r of e)yield t(r)}(this.g,e))}flatMap(e){return new ev(function*(e,t){for(let r of e)yield*t(r)}(this.g,e))}dropWhile(e){let t=!1;return this.flatMap(function*(r){(t||!e(r))&&(t=!0,yield r)})}drop(e){if(e<=0)return this;let t=0;return this.dropWhile(function(){return t++<e})}takeWhile(e){return new ev(function*(e,t){let r=e.next();for(;!r.done&&t(r.value);)yield r.value,r=e.next()}(this.g,e))}take(e){return new ev(function*(e,t){for(let r=0;r<t;++r){let t=e.next();if(t.done)break;yield t.value}}(this.g,e))}filter(e){return new ev(function*(e,t){for(let r of e)t(r)&&(yield r)}(this.g,e))}every(e){for(let t of this.g)if(!e(t))return!1;return!0}has(e){for(let t of this.g)if(e(t))return[!0,t];return[!1,null]}join(...e){return new ev(function*(e,t){for(let t=e.next();!t.done;t=e.next())yield t.value;for(let e of t)for(let t=e.next();!t.done;t=e.next())yield t.value}(this.g,e))}getNthOrLast(e){let t=e,r=null;for(let e of this.g){if(0==t--)return e;r=e}return r}}let eE=Symbol.for("fast-check/cloneMethod");function ew(e){return null!==e&&("object"==typeof e||"function"==typeof e)&&eE in e&&"function"==typeof e[eE]}let e_=Object.defineProperty;class ek{constructor(e,t,r){this.value_=e,this.context=t,this.hasToBeCloned=void 0!==r||ew(e),this.readOnce=!1,this.hasToBeCloned?e_(this,"value",{get:void 0!==r?r:this.getValue}):this.value=e}getValue(){return this.hasToBeCloned?this.readOnce?this.value_[eE]():(this.readOnce=!0,this.value_):this.value_}}let ex=Object.assign;class eC{filter(e){return new eR(this,e)}map(e,t){return new eT(this,e,t)}chain(e){return new eI(this,e)}noShrink(){return new eO(this)}noBias(){return new eF(this)}}class eI extends eC{constructor(e,t){super(),this.arb=e,this.chainer=t}generate(e,t){let r=e.clone(),i=this.arb.generate(e,t);return this.valueChainer(i,e,r,t)}canShrinkWithoutContext(e){return!1}shrink(e,t){return this.isSafeContext(t)?(!t.stoppedForOriginal?this.arb.shrink(t.originalValue,t.originalContext).map(e=>this.valueChainer(e,t.clonedMrng.clone(),t.clonedMrng,t.originalBias)):ev.nil()).join(t.chainedArbitrary.shrink(e,t.chainedContext).map(e=>{let r=ex(ex({},t),{chainedContext:e.context,stoppedForOriginal:!0});return new ek(e.value_,r)})):ev.nil()}valueChainer(e,t,r,i){let n=this.chainer(e.value_),a=n.generate(t,i),s={originalBias:i,originalValue:e.value_,originalContext:e.context,stoppedForOriginal:!1,chainedArbitrary:n,chainedContext:a.context,clonedMrng:r};return new ek(a.value_,s)}isSafeContext(e){return null!=e&&"object"==typeof e&&"originalBias"in e&&"originalValue"in e&&"originalContext"in e&&"stoppedForOriginal"in e&&"chainedArbitrary"in e&&"chainedContext"in e&&"clonedMrng"in e}}class eT extends eC{constructor(e,t,r){super(),this.arb=e,this.mapper=t,this.unmapper=r,this.bindValueMapper=e=>this.valueMapper(e)}generate(e,t){let r=this.arb.generate(e,t);return this.valueMapper(r)}canShrinkWithoutContext(e){if(void 0!==this.unmapper)try{let t=this.unmapper(e);return this.arb.canShrinkWithoutContext(t)}catch(e){}return!1}shrink(e,t){if(this.isSafeContext(t))return this.arb.shrink(t.originalValue,t.originalContext).map(this.bindValueMapper);if(void 0!==this.unmapper){let t=this.unmapper(e);return this.arb.shrink(t,void 0).map(this.bindValueMapper)}return ev.nil()}mapperWithCloneIfNeeded(e){let t=e.value,r=this.mapper(t);return e.hasToBeCloned&&("object"==typeof r&&null!==r||"function"==typeof r)&&Object.isExtensible(r)&&!ew(r)&&Object.defineProperty(r,eE,{get:()=>()=>this.mapperWithCloneIfNeeded(e)[0]}),[r,t]}valueMapper(e){let[t,r]=this.mapperWithCloneIfNeeded(e);return new ek(t,{originalValue:r,originalContext:e.context})}isSafeContext(e){return null!=e&&"object"==typeof e&&"originalValue"in e&&"originalContext"in e}}class eR extends eC{constructor(e,t){super(),this.arb=e,this.refinement=t,this.bindRefinementOnValue=e=>this.refinementOnValue(e)}generate(e,t){for(;;){let r=this.arb.generate(e,t);if(this.refinementOnValue(r))return r}}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)&&this.refinement(e)}shrink(e,t){return this.arb.shrink(e,t).filter(this.bindRefinementOnValue)}refinementOnValue(e){return this.refinement(e.value)}}class eO extends eC{constructor(e){super(),this.arb=e}generate(e,t){return this.arb.generate(e,t)}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)}shrink(e,t){return ev.nil()}noShrink(){return this}}class eF extends eC{constructor(e){super(),this.arb=e}generate(e,t){return this.arb.generate(e,void 0)}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)}shrink(e,t){return this.arb.shrink(e,t)}noBias(){return this}}let eM=Function.prototype.apply,eA=Symbol("apply");function eN(e,t,r){let i;return function(e){try{return e.apply}catch(e){return}}(e)===eM?e.apply(t,r):(e[eA]=eM,i=e[eA](t,r),delete e[eA],i)}let eP="u">typeof Array?Array:void 0;"u">typeof BigInt64Array&&BigInt64Array,"u">typeof BigUint64Array&&BigUint64Array;let eD="u">typeof Error?Error:void 0;"u">typeof Float32Array&&Float32Array,"u">typeof Float64Array&&Float64Array,"u">typeof Int8Array&&Int8Array,"u">typeof Int16Array&&Int16Array,"u">typeof Int32Array&&Int32Array;let eL="u">typeof String?String:void 0;"u">typeof Uint8Array&&Uint8Array,"u">typeof Uint8ClampedArray&&Uint8ClampedArray,"u">typeof Uint16Array&&Uint16Array,"u">typeof Uint32Array&&Uint32Array;let eU="u">typeof encodeURIComponent?encodeURIComponent:void 0,ez=Symbol;Array.prototype.forEach;let ej=Array.prototype.indexOf,eW=Array.prototype.join,eq=Array.prototype.map,e$=Array.prototype.filter,eB=Array.prototype.push;function eH(e,...t){return function(e){try{return e.join}catch(e){return}}(e)===eW?e.join(...t):eN(eW,e,t)}function eV(e,t){return function(e){try{return e.map}catch(e){return}}(e)===eq?e.map(t):eN(eq,e,[t])}Array.prototype.pop,Array.prototype.splice,Array.prototype.slice,Array.prototype.sort,Array.prototype.every;let eJ=Date.prototype.getTime,eG=Date.prototype.toISOString;Set.prototype.add,Set.prototype.has,WeakMap.prototype.set,WeakMap.prototype.get,Map.prototype.set,Map.prototype.get;let eK=String.prototype.split;String.prototype.startsWith,String.prototype.endsWith,String.prototype.substring,String.prototype.toLowerCase,String.prototype.toUpperCase,String.prototype.padStart;let eZ=String.prototype.charCodeAt;function eQ(e,...t){return function(e){try{return e.split}catch(e){return}}(e)===eK?e.split(...t):eN(eK,e,t)}function eY(e,t){return function(e){try{return e.charCodeAt}catch(e){return}}(e)===eZ?e.charCodeAt(t):eN(eZ,e,[t])}String.prototype.normalize,String.prototype.replace;let eX=Number.prototype.toString;Object.prototype.hasOwnProperty;let e0=Object.prototype.toString,e1=Math.log;function e2(e){return 2+~~(.4342944819032518*e1(e+1))}let e6={},e3=Symbol("UndefinedContextPlaceholder");function e4(e){return void 0!==e.context?e:e.hasToBeCloned?new ek(e.value_,e3,()=>e.value):new ek(e.value_,e3)}class e5{constructor(e,t){this.arb=e,this.predicate=t;const{asyncBeforeEach:r,asyncAfterEach:i,beforeEach:n,afterEach:a}=e6||{};if(void 0!==r&&void 0!==n)throw eD('Global "asyncBeforeEach" and "beforeEach" parameters can\'t be set at the same time when running async properties');if(void 0!==i&&void 0!==a)throw eD('Global "asyncAfterEach" and "afterEach" parameters can\'t be set at the same time when running async properties');this.beforeEachHook=r||n||e5.dummyHook,this.afterEachHook=i||a||e5.dummyHook}isAsync(){return!0}generate(e,t){return e4(this.arb.generate(e,null!=t?e2(t):void 0))}shrink(e){if(void 0===e.context&&!this.arb.canShrinkWithoutContext(e.value_))return ev.nil();let t=e.context!==e3?e.context:void 0;return this.arb.shrink(e.value_,t).map(e4)}async runBeforeEach(){await this.beforeEachHook()}async runAfterEach(){await this.afterEachHook()}async run(e,t){t||await this.beforeEachHook();try{let t=await this.predicate(e);return null==t||!0===t?null:{error:new eD("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(e){if(ey.isFailure(e))return e;if(e instanceof eD&&e.stack)return{error:e,errorMessage:e.stack};return{error:e,errorMessage:eL(e)}}finally{t||await this.afterEachHook()}}beforeEach(e){let t=this.beforeEachHook;return this.beforeEachHook=()=>e(t),this}afterEach(e){let t=this.afterEachHook;return this.afterEachHook=()=>e(t),this}}e5.dummyHook=()=>{};class e8{constructor(e,t){this.arb=e,this.predicate=t;const{beforeEach:r=e8.dummyHook,afterEach:i=e8.dummyHook,asyncBeforeEach:n,asyncAfterEach:a}=e6||{};if(void 0!==n)throw eD('"asyncBeforeEach" can\'t be set when running synchronous properties');if(void 0!==a)throw eD('"asyncAfterEach" can\'t be set when running synchronous properties');this.beforeEachHook=r,this.afterEachHook=i}isAsync(){return!1}generate(e,t){return e4(this.arb.generate(e,null!=t?e2(t):void 0))}shrink(e){if(void 0===e.context&&!this.arb.canShrinkWithoutContext(e.value_))return ev.nil();let t=e.context!==e3?e.context:void 0;return this.arb.shrink(e.value_,t).map(e4)}runBeforeEach(){this.beforeEachHook()}runAfterEach(){this.afterEachHook()}run(e,t){t||this.beforeEachHook();try{let t=this.predicate(e);return null==t||!0===t?null:{error:new eD("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(e){if(ey.isFailure(e))return e;if(e instanceof eD&&e.stack)return{error:e,errorMessage:e.stack};return{error:e,errorMessage:eL(e)}}finally{t||this.afterEachHook()}}beforeEach(e){let t=this.beforeEachHook;return this.beforeEachHook=()=>e(t),this}afterEach(e){let t=this.afterEachHook;return this.afterEachHook=()=>e(t),this}}function e7(e,t){for(var r=[],i=0;i!=t;++i)r.push(e.unsafeNext());return r}function e9(e,t){var r=e.clone();return[e7(r,t),r]}function te(e,t){for(var r=0;r!=t;++r)e.unsafeNext()}function tt(e,t){var r=e.clone();return te(r,t),r}e8.dummyHook=()=>{};var tr=-0x80000000-1,ti=function(e){return 214013*e+2531011|0},tn=function(e){return(e&tr)>>16},ta=function(){function e(e){this.seed=e}return e.prototype.clone=function(){return new e(this.seed)},e.prototype.next=function(){var t=new e(this.seed);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=ti(this.seed),t=tn(e),r=ti(e),i=tn(r);return this.seed=ti(r),0|tn(this.seed)+(i+(t<<15)<<15)},e.prototype.getState=function(){return[this.seed]},e}(),ts=Object.assign(function(e){return new ta(e)},{fromState:function(e){if(1!==e.length)throw Error("The state must have been produced by a congruential32 RandomGenerator");return new ta(e[0])}}),to=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return s},tl=function(e,t,r){if(r||2==arguments.length)for(var i,n=0,a=t.length;n<a;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},tu=function(){function e(e,t){this.states=e,this.index=t}return e.twist=function(t){for(var r=t.slice(),i=0;i!==e.N-e.M;++i){var n=(r[i]&e.MASK_UPPER)+(r[i+1]&e.MASK_LOWER);r[i]=r[i+e.M]^n>>>1^-(1&n)&e.A}for(var i=e.N-e.M;i!==e.N-1;++i){var a=(r[i]&e.MASK_UPPER)+(r[i+1]&e.MASK_LOWER);r[i]=r[i+e.M-e.N]^a>>>1^-(1&a)&e.A}var s=(r[e.N-1]&e.MASK_UPPER)+(r[0]&e.MASK_LOWER);return r[e.N-1]=r[e.M-1]^s>>>1^-(1&s)&e.A,r},e.seeded=function(t){var r=Array(e.N);r[0]=t;for(var i=1;i!==e.N;++i){var n=r[i-1]^r[i-1]>>>30;r[i]=Math.imul(e.F,n)+i|0}return r},e.from=function(t){return new e(e.twist(e.seeded(t)),0)},e.prototype.clone=function(){return new e(this.states,this.index)},e.prototype.next=function(){var t=new e(this.states,this.index);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var t=this.states[this.index];return t^=this.states[this.index]>>>e.U,t^=t<<e.S&e.B,t^=t<<e.T&e.C,t^=t>>>e.L,++this.index>=e.N&&(this.states=e.twist(this.states),this.index=0),t},e.prototype.getState=function(){return tl([this.index],to(this.states),!1)},e.fromState=function(t){if(!(t.length===e.N+1&&t[0]>=0&&t[0]<e.N))throw Error("The state must have been produced by a mersenne RandomGenerator");return new e(t.slice(1),t[0])},e.N=624,e.M=397,e.R=31,e.A=0x9908b0df,e.F=0x6c078965,e.U=11,e.S=7,e.B=0x9d2c5680,e.T=15,e.C=0xefc60000,e.L=18,e.MASK_LOWER=Math.pow(2,e.R)-1,e.MASK_UPPER=Math.pow(2,e.R),e}();let tc=Object.assign(function(e){return tu.from(e)},{fromState:function(e){return tu.fromState(e)}});var tp=function(){function e(e,t,r,i){this.s01=e,this.s00=t,this.s11=r,this.s10=i}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=this.s00^this.s00<<23,t=this.s01^(this.s01<<23|this.s00>>>9),r=e^this.s10^(e>>>18|t<<14)^(this.s10>>>5|this.s11<<27),i=t^this.s11^t>>>18^this.s11>>>5,n=this.s00+this.s10|0;return this.s01=this.s11,this.s00=this.s10,this.s11=i,this.s10=r,n},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var e=0,t=0,r=0,i=0,n=[0x635d2dff,0x8a5cd789,0x5c472f96,0x121fd215],a=0;4!==a;++a)for(var s=1;s;s<<=1)n[a]&s&&(e^=this.s01,t^=this.s00,r^=this.s11,i^=this.s10),this.unsafeNext();this.s01=e,this.s00=t,this.s11=r,this.s10=i},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e}(),tf=Object.assign(function(e){return new tp(-1,~e,0|e,0)},{fromState:function(e){if(4!==e.length)throw Error("The state must have been produced by a xorshift128plus RandomGenerator");return new tp(e[0],e[1],e[2],e[3])}}),td=function(){function e(e,t,r,i){this.s01=e,this.s00=t,this.s11=r,this.s10=i}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=this.s00+this.s10|0,t=this.s10^this.s00,r=this.s11^this.s01,i=this.s00,n=this.s01;return this.s00=i<<24^n>>>8^t^t<<16,this.s01=n<<24^i>>>8^r^(r<<16|t>>>16),this.s10=r<<5^t>>>27,this.s11=t<<5^r>>>27,e},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var e=0,t=0,r=0,i=0,n=[0xd8f554a5,0xdf900294,0x4b3201fc,0x170865df],a=0;4!==a;++a)for(var s=1;s;s<<=1)n[a]&s&&(e^=this.s01,t^=this.s00,r^=this.s11,i^=this.s10),this.unsafeNext();this.s01=e,this.s00=t,this.s11=r,this.s10=i},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e}(),th=Object.assign(function(e){return new td(-1,~e,0|e,0)},{fromState:function(e){if(4!==e.length)throw Error("The state must have been produced by a xoroshiro128plus RandomGenerator");return new td(e[0],e[1],e[2],e[3])}});function tm(e,t){if(e.sign!==t.sign)return tg(e,{sign:-t.sign,data:t.data});for(var r=[],i=0,n=e.data,a=t.data,s=n.length-1,o=a.length-1;s>=0||o>=0;--s,--o){var l=(s>=0?n[s]:0)+(o>=0?a[o]:0)+i;r.push(l>>>0),i=~~(l/0x100000000)}return 0!==i&&r.push(i),{sign:e.sign,data:r.reverse()}}function tg(e,t){if(e.sign!==t.sign)return tm(e,{sign:-t.sign,data:t.data});var r=e.data,i=t.data;if(function(e,t){for(var r=Math.max(e.length,t.length),i=0;i<r;++i){var n=i+e.length-r,a=i+t.length-r,s=n>=0?e[n]:0,o=a>=0?t[a]:0;if(s<o)return!0;if(s>o)break}return!1}(r,i)){var n=tg(t,e);return n.sign=-n.sign,n}for(var a=[],s=0,o=r.length-1,l=i.length-1;o>=0||l>=0;--o,--l){var u=(o>=0?r[o]:0)-(l>=0?i[l]:0)-s;a.push(u>>>0),s=+(u<0)}return{sign:e.sign,data:a.reverse()}}function ty(e){for(var t=e.data,r=0;r!==t.length&&0===t[r];++r);return r===t.length?(e.sign=1,e.data=[0]):t.splice(0,r),e}function tb(e,t){if(t<0){var r=-t;e.sign=-1,e.data[0]=~~(r/0x100000000),e.data[1]=r>>>0}else e.sign=1,e.data[0]=~~(t/0x100000000),e.data[1]=t>>>0;return e}function tS(e,t){for(var r=e>2?~~(0x100000000/e)*e:0x100000000,i=t.unsafeNext()+0x80000000;i>=r;)i=t.unsafeNext()+0x80000000;return i%e}function tv(e,t,r){for(var i=t.length;;){for(var n=0;n!==i;++n){var a=tS(0===n?t[0]+1:0x100000000,r);e[n]=a}for(var n=0;n!==i;++n){var s=e[n],o=t[n];if(s<o)return e;if(s>o)break}}}function tE(e,t,r){var i=ty(function(e){e.sign=1;for(var t=e.data,r=t.length-1;r>=0;--r)if(0xffffffff!==t[r])return t[r]+=1,e;else t[r]=0;return t.unshift(1),e}(tg(t,e)));return ty(tm({sign:1,data:tv(i.data.slice(0),i.data,r)},e))}function tw(e,t,r){if(null!=r){var i=r.clone();return[tE(e,t,i),i]}return function(r){var i=r.clone();return[tE(e,t,i),i]}}var t_="u">typeof BigInt?BigInt:void 0;function tk(e,t,r){for(var i=t-e+t_(1),n=t_(-0x80000000),a=t_(0x100000000),s=a,o=1;s<i;)s*=a,++o;for(var l=s-s%i;;){for(var u=t_(0),c=0;c!==o;++c)u=a*u+(t_(r.unsafeNext())-n);if(u<l)return u%i+e}}function tx(e,t,r){if(null!=r){var i=r.clone();return[tk(e,t,i),i]}return function(r){var i=r.clone();return[tk(e,t,i),i]}}var tC=Number.MAX_SAFE_INTEGER,tI={sign:1,data:[0,0]},tT={sign:1,data:[0,0]},tR={sign:1,data:[0,0]},tO=[0,0];function tF(e,t,r){var i,n=t-e;return n<=0xffffffff?tS(n+1,r)+e:(0xffffffff===(i=n<=tC?tb(tR,n):function(e,t,r){var i=t.data[1],n=t.data[0],a=t.sign,s=r.data[1],o=r.data[0],l=r.sign;if(e.sign=1,1===a&&-1===l){var u=i+s;return e.data[0]=n+o+ +(u>0xffffffff)>>>0,e.data[1]=u>>>0,e}var c=i,p=n,f=s,d=o;-1===a&&(c=s,p=o,f=i,d=n);var h=0,m=c-f;return m<0&&(h=1,m>>>=0),e.data[0]=p-d-h,e.data[1]=m,e}(tR,tb(tI,t),tb(tT,e))).data[1]?(i.data[0]+=1,i.data[1]=0):i.data[1]+=1,tv(tO,i.data,r),0x100000000*tO[0]+tO[1]+e)}function tM(e,t,r){if(null!=r){var i=r.clone();return[tF(e,t,i),i]}return function(r){var i=r.clone();return[tF(e,t,i),i]}}var tA="module",tN="6.1.0",tP="a413dd2b721516be2ef29adffb515c5ae67bfbad";e.s(["__commitHash",()=>tP,"__type",()=>tA,"__version",()=>tN],182258),e.i(182258),e.s(["__commitHash",()=>tP,"__type",()=>tA,"__version",()=>tN,"congruential32",()=>ts,"generateN",()=>e9,"mersenne",0,tc,"skipN",()=>tt,"uniformArrayIntDistribution",()=>tw,"uniformBigIntDistribution",()=>tx,"uniformIntDistribution",()=>tM,"unsafeGenerateN",()=>e7,"unsafeSkipN",()=>te,"unsafeUniformArrayIntDistribution",()=>tE,"unsafeUniformBigIntDistribution",()=>tk,"unsafeUniformIntDistribution",()=>tF,"xoroshiro128plus",()=>th,"xorshift128plus",()=>tf],998425);var tD=e.i(998425);(a=l||(l={}))[a.None=0]="None",a[a.Verbose=1]="Verbose",a[a.VeryVerbose=2]="VeryVerbose";let tL=Date.now,tU=Math.min,tz=Math.random;class tj{constructor(e){const t=e||{};this.seed=tj.readSeed(t),this.randomType=tj.readRandomType(t),this.numRuns=tj.readNumRuns(t),this.verbose=tj.readVerbose(t),this.maxSkipsPerRun=tj.readOrDefault(t,"maxSkipsPerRun",100),this.timeout=tj.safeTimeout(tj.readOrDefault(t,"timeout",null)),this.skipAllAfterTimeLimit=tj.safeTimeout(tj.readOrDefault(t,"skipAllAfterTimeLimit",null)),this.interruptAfterTimeLimit=tj.safeTimeout(tj.readOrDefault(t,"interruptAfterTimeLimit",null)),this.markInterruptAsFailure=tj.readBoolean(t,"markInterruptAsFailure"),this.skipEqualValues=tj.readBoolean(t,"skipEqualValues"),this.ignoreEqualValues=tj.readBoolean(t,"ignoreEqualValues"),this.logger=tj.readOrDefault(t,"logger",e=>{console.log(e)}),this.path=tj.readOrDefault(t,"path",""),this.unbiased=tj.readBoolean(t,"unbiased"),this.examples=tj.readOrDefault(t,"examples",[]),this.endOnFailure=tj.readBoolean(t,"endOnFailure"),this.reporter=tj.readOrDefault(t,"reporter",null),this.asyncReporter=tj.readOrDefault(t,"asyncReporter",null),this.errorWithCause=tj.readBoolean(t,"errorWithCause")}toParameters(){let e=e=>null!==e?e:void 0;return{seed:this.seed,randomType:this.randomType,numRuns:this.numRuns,maxSkipsPerRun:this.maxSkipsPerRun,timeout:e(this.timeout),skipAllAfterTimeLimit:e(this.skipAllAfterTimeLimit),interruptAfterTimeLimit:e(this.interruptAfterTimeLimit),markInterruptAsFailure:this.markInterruptAsFailure,skipEqualValues:this.skipEqualValues,ignoreEqualValues:this.ignoreEqualValues,path:this.path,logger:this.logger,unbiased:this.unbiased,verbose:this.verbose,examples:this.examples,endOnFailure:this.endOnFailure,reporter:e(this.reporter),asyncReporter:e(this.asyncReporter),errorWithCause:this.errorWithCause}}static read(e){return new tj(e)}}tj.createQualifiedRandomGenerator=e=>t=>{let r=e(t);return void 0===r.unsafeJump&&(r.unsafeJump=()=>te(r,42)),r},tj.readSeed=e=>{if(null==e.seed)return tL()^0x100000000*tz();let t=0|e.seed;if(e.seed===t)return t;let r=e.seed-t;return t^0x100000000*r},tj.readRandomType=e=>{if(null==e.randomType)return tD.xorshift128plus;if("string"==typeof e.randomType)switch(e.randomType){case"mersenne":return tj.createQualifiedRandomGenerator(tD.mersenne);case"congruential":case"congruential32":return tj.createQualifiedRandomGenerator(tD.congruential32);case"xorshift128plus":return tD.xorshift128plus;case"xoroshiro128plus":return tD.xoroshiro128plus;default:throw Error(`Invalid random specified: '${e.randomType}'`)}let t=e.randomType(0);if("min"in t&&-0x80000000!==t.min)throw Error(`Invalid random number generator: min must equal -0x80000000, got ${String(t.min)}`);if("max"in t&&0x7fffffff!==t.max)throw Error(`Invalid random number generator: max must equal 0x7fffffff, got ${String(t.max)}`);return"unsafeJump"in t?e.randomType:tj.createQualifiedRandomGenerator(e.randomType)},tj.readNumRuns=e=>null!=e.numRuns?e.numRuns:null!=e.num_runs?e.num_runs:100,tj.readVerbose=e=>null==e.verbose?l.None:"boolean"==typeof e.verbose?!0===e.verbose?l.Verbose:l.None:e.verbose<=l.None?l.None:e.verbose>=l.VeryVerbose?l.VeryVerbose:0|e.verbose,tj.readBoolean=(e,t)=>!0===e[t],tj.readOrDefault=(e,t,r)=>{let i=e[t];return null!=i?i:r},tj.safeTimeout=e=>null===e?null:tU(e,0x7fffffff);let tW=Array.from,tq="u">typeof Buffer?Buffer.isBuffer:void 0,t$=JSON.stringify,tB=Number.isNaN,tH=Object.keys,tV=Object.getOwnPropertySymbols,tJ=Object.getOwnPropertyDescriptor,tG=Object.getPrototypeOf,tK=-1/0,tZ=1/0,tQ=Symbol.for("fast-check/toStringMethod"),tY=Symbol.for("fast-check/asyncToStringMethod"),tX=/^Symbol\((.*)\)$/;function t0(e){switch(e){case 0:return 1/e===tK?"-0":"0";case tK:return"Number.NEGATIVE_INFINITY";case tZ:return"Number.POSITIVE_INFINITY";default:return e==e?eL(e):"Number.NaN"}}function t1(e){return function e(t,r,i){var n,a;let s=[...r,t];if("object"==typeof t&&-1!==function(e,...t){return function(e){try{return e.indexOf}catch(e){return}}(e)===ej?e.indexOf(...t):eN(ej,e,t)}(r,t))return"[cyclic]";if(null!==t&&("object"==typeof t||"function"==typeof t)&&tY in t&&"function"==typeof t[tY]){let e=i(t);if("fulfilled"===e.state)return e.value}if(null!==t&&("object"==typeof t||"function"==typeof t)&&tQ in t&&"function"==typeof t[tQ])try{return t[tQ]()}catch(e){}switch(eN(e0,t,[])){case"[object Array]":{if(t.length>=50&&function(e){let t=-1;for(let r in e){let e=Number(r);if(e!==t+1)return!0;t=e}return t+1!==e.length}(t)){let r=[];for(let n in t)tB(Number(n))||function(e,...t){(function(e){try{return e.push}catch(e){return}})(e)===eB?e.push(...t):eN(eB,e,t)}(r,`${n}:${e(t[n],s,i)}`);return 0!==r.length?`Object.assign(Array(${t.length}),{${eH(r,",")}})`:`Array(${t.length})`}let r=eH(eV(t,t=>e(t,s,i)),",");return 0===t.length||t.length-1 in t?`[${r}]`:`[${r},]`}case"[object BigInt]":return`${t}n`;case"[object Boolean]":{let e=!0==t?"true":"false";return"boolean"==typeof t?e:`new Boolean(${e})`}case"[object Date]":return tB(function(e){try{return e.getTime}catch(e){return}}(t)===eJ?t.getTime():eN(eJ,t,[]))?"new Date(NaN)":`new Date(${t$(function(e){try{return e.toISOString}catch(e){return}}(t)===eG?t.toISOString():eN(eG,t,[]))})`;case"[object Map]":return`new Map(${e(Array.from(t),s,i)})`;case"[object Null]":return"null";case"[object Number]":return"number"==typeof t?t0(t):`new Number(${t0(Number(t))})`;case"[object Object]":{try{let e=t.toString;if("function"==typeof e&&e!==Object.prototype.toString)return t.toString()}catch(e){return"[object Object]"}let r=r=>`${"__proto__"===r?'["__proto__"]':"symbol"==typeof r?`[${e(r,s,i)}]`:t$(r)}:${e(t[r],s,i)}`,o="{"+eH([...eV(tH(t),r),...eV((n=tV(t),a=e=>{let r=tJ(t,e);return r&&r.enumerable},function(e){try{return e.filter}catch(e){return}}(n)===e$?n.filter(a):eN(e$,n,[a])),r)],",")+"}";if(null===tG(t))return"{}"===o?"Object.create(null)":`Object.assign(Object.create(null),${o})`;return o}case"[object Set]":return`new Set(${e(Array.from(t),s,i)})`;case"[object String]":return"string"==typeof t?t$(t):`new String(${t$(t)})`;case"[object Symbol]":{if(void 0!==ez.keyFor(t))return`Symbol.for(${t$(ez.keyFor(t))})`;let e=function(e){if(void 0!==e.description)return e.description;let t=tX.exec(eL(e));return t&&t[1].length?t[1]:null}(t);if(null===e)return"Symbol()";return t===(e.startsWith("Symbol.")&&ez[e.substring(7)])?e:`Symbol(${t$(e)})`}case"[object Promise]":{let r=i(t);switch(r.state){case"fulfilled":return`Promise.resolve(${e(r.value,s,i)})`;case"rejected":return`Promise.reject(${e(r.value,s,i)})`;case"pending":return"new Promise(() => {/*pending*/})";default:return"new Promise(() => {/*unknown*/})"}}case"[object Error]":if(t instanceof Error)return`new Error(${e(t.message,s,i)})`;break;case"[object Undefined]":return"undefined";case"[object Int8Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Int16Array]":case"[object Uint16Array]":case"[object Int32Array]":case"[object Uint32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object BigInt64Array]":case"[object BigUint64Array]":{if("function"==typeof tq&&tq(t))return`Buffer.from(${e(tW(t.values()),s,i)})`;let r=tG(t),n=r&&r.constructor&&r.constructor.name;if("string"==typeof n){let r=t.values();return`${n}.from(${e(tW(r),s,i)})`}}}try{return t.toString()}catch(e){return eN(e0,t,[])}}(e,[],()=>({state:"unknown",value:void 0}))}(s=u||(u={}))[s.Success=0]="Success",s[s.Skipped=-1]="Skipped",s[s.Failure=1]="Failure";class t2{constructor(e,t){this.verbosity=e,this.interruptedAsFailure=t,this.isSuccess=()=>null==this.pathToFailure,this.firstFailure=()=>this.pathToFailure?+eQ(this.pathToFailure,":")[0]:-1,this.numShrinks=()=>this.pathToFailure?eQ(this.pathToFailure,":").length-1:0,this.rootExecutionTrees=[],this.currentLevelExecutionTrees=this.rootExecutionTrees,this.failure=null,this.numSkips=0,this.numSuccesses=0,this.interrupted=!1}appendExecutionTree(e,t){let r={status:e,value:t,children:[]};return this.currentLevelExecutionTrees.push(r),r}fail(e,t,r){if(this.verbosity>=l.Verbose){let t=this.appendExecutionTree(u.Failure,e);this.currentLevelExecutionTrees=t.children}null==this.pathToFailure?this.pathToFailure=`${t}`:this.pathToFailure+=`:${t}`,this.value=e,this.failure=r}skip(e){this.verbosity>=l.VeryVerbose&&this.appendExecutionTree(u.Skipped,e),null==this.pathToFailure&&++this.numSkips}success(e){this.verbosity>=l.VeryVerbose&&this.appendExecutionTree(u.Success,e),null==this.pathToFailure&&++this.numSuccesses}interrupt(){this.interrupted=!0}extractFailures(){if(this.isSuccess())return[];let e=[],t=this.rootExecutionTrees;for(;t.length>0&&t[t.length-1].status===u.Failure;){let r=t[t.length-1];e.push(r.value),t=r.children}return e}toRunDetails(e,t,r,i){if(!this.isSuccess())return{failed:!0,interrupted:this.interrupted,numRuns:this.firstFailure()+1-this.numSkips,numSkips:this.numSkips,numShrinks:this.numShrinks(),seed:e,counterexample:this.value,counterexamplePath:t2.mergePaths(t,this.pathToFailure),error:this.failure.errorMessage,errorInstance:this.failure.error,failures:this.extractFailures(),executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:i.toParameters()};let n=this.interruptedAsFailure||0===this.numSuccesses;return{failed:this.numSkips>r||this.interrupted&&n,interrupted:this.interrupted,numRuns:this.numSuccesses,numSkips:this.numSkips,numShrinks:0,seed:e,counterexample:null,counterexamplePath:null,error:null,errorInstance:null,failures:[],executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:i.toParameters()}}}t2.mergePaths=(e,t)=>{if(0===e.length)return t;let r=e.split(":"),i=t.split(":"),n=+r[r.length-1]+ +i[0];return[...r.slice(0,r.length-1),`${n}`,...i.slice(1)].join(":")};class t6{constructor(e){this.internalRng=e.clone()}clone(){return new t6(this.internalRng)}next(e){return tF(0,(1<<e)-1,this.internalRng)}nextBoolean(){return 1==tF(0,1,this.internalRng)}nextInt(e,t){return tF(null==e?t6.MIN_INT:e,null==t?t6.MAX_INT:t,this.internalRng)}nextBigInt(e,t){return tk(e,t,this.internalRng)}nextArrayInt(e,t){return tE(e,t,this.internalRng)}nextDouble(){let e=this.next(26),t=this.next(27);return(e*t6.DBL_FACTOR+t)*t6.DBL_DIVISOR}getState(){if("getState"in this.internalRng&&"function"==typeof this.internalRng.getState)return this.internalRng.getState()}}t6.MIN_INT=-0x80000000,t6.MAX_INT=0x7fffffff,t6.DBL_FACTOR=0x8000000,t6.DBL_DIVISOR=11102230246251565e-32;let t3=Math.floor,t4=Math.log;function t5(e){return t3(t4(e)/t4(2))}let t8=Math.ceil,t7=Math.floor;function t9(e,t,r){let i=e-t;return new ev(i>0?function*(){let n=r?void 0:t,a=r?i:t7(i/2);for(let r=a;r>0;r=t7(r/2)){let a=r===i?t:e-r;yield new ek(a,n),n=a}}():function*(){let n=r?void 0:t,a=r?i:t8(i/2);for(let r=a;r<0;r=t8(r/2)){let a=r===i?t:e-r;yield new ek(a,n),n=a}}())}let re=Math.sign,rt=Number.isInteger,rr=Object.is;class ri extends eC{constructor(e,t){super(),this.min=e,this.max=t}generate(e,t){let r=this.computeGenerateRange(e,t);return new ek(e.nextInt(r.min,r.max),void 0)}canShrinkWithoutContext(e){return"number"==typeof e&&rt(e)&&!rr(e,-0)&&this.min<=e&&e<=this.max}shrink(e,t){return ri.isValidContext(e,t)?this.isLastChanceTry(e,t)?ev.of(new ek(t,void 0)):t9(e,t,!1):t9(e,this.defaultTarget(),!0)}defaultTarget(){return this.min<=0&&this.max>=0?0:this.min<0?this.max:this.min}computeGenerateRange(e,t){if(void 0===t||1!==e.nextInt(1,t))return{min:this.min,max:this.max};let r=function(e,t,r){if(e===t)return[{min:e,max:t}];if(e<0&&t>0){let i=r(-e),n=r(t);return[{min:-i,max:n},{min:t-n,max:t},{min:e,max:e+i}]}let i=r(t-e),n={min:e,max:e+i},a={min:t-i,max:t};return e<0?[a,n]:[n,a]}(this.min,this.max,t5);if(1===r.length)return r[0];let i=e.nextInt(-2*(r.length-1),r.length-2);return i<0?r[0]:r[i+1]}isLastChanceTry(e,t){return e>0?e===t+1&&e>this.min:e<0&&e===t-1&&e<this.max}static isValidContext(e,t){if(void 0===t)return!1;if("number"!=typeof t)throw Error("Invalid context type passed to IntegerArbitrary (#1)");if(0!==t&&re(e)!==re(t))throw Error("Invalid context value passed to IntegerArbitrary (#2)");return!0}}let rn=Number.isInteger,ra=String.fromCodePoint;function rs(e,t,r,i){return(function(e={}){let t={min:void 0!==e.min?e.min:-0x80000000,max:void 0!==e.max?e.max:0x7fffffff};if(t.min>t.max)throw Error("fc.integer maximum value should be equal or greater than the minimum one");if(!rn(t.min))throw Error("fc.integer minimum value should be an integer");if(!rn(t.max))throw Error("fc.integer maximum value should be an integer");return new ri(t.min,t.max)})({min:e,max:t}).map(e=>ra(r(e)),e=>i(function(e){if("string"!=typeof e)throw Error("Cannot unmap non-string");if(0===e.length||e.length>2)throw Error("Cannot unmap string with more or less than one character");let t=eY(e,0);if(1===e.length)return t;let r=eY(e,1);if(t<55296||t>56319||r<56320||r>57343)throw Error("Cannot unmap invalid surrogate pairs");return e.codePointAt(0)}(e)))}function ro(e){return e}class rl{constructor(){this.receivedLogs=[]}log(e){this.receivedLogs.push(e)}size(){return this.receivedLogs.length}toString(){return JSON.stringify({logs:this.receivedLogs})}[eE](){return new rl}}rs(0,1112063,function(e){if(e<55296)return e<95?e+32:e<=126?e-95:e;return e+2048},function(e){if(e<55296)return e>=32&&e<=126?e-32:e>=0&&e<=31?e+95:e;return e<=57343?-1:e-2048}).map(function(e){let t=eU(e);return e!==t?t:`%${function(e,...t){return function(e){try{return e.toString}catch(e){return}}(e)===eX?e.toString(...t):eN(eX,e,t)}(eY(e,0),16)}`},function(e){if("string"!=typeof e)throw Error("Unsupported");return decodeURIComponent(e)}),new WeakMap,Object.create(null),Symbol("adapted-value");let ru=new Float64Array(1);new Uint32Array(ru.buffer,ru.byteOffset);let rc=new Float32Array(1);new Uint32Array(rc.buffer,rc.byteOffset),eP.isArray,Symbol("no-key");let rp={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F",16:"G",17:"H",18:"J",19:"K",20:"M",21:"N",22:"P",23:"Q",24:"R",25:"S",26:"T",27:"V",28:"W",29:"X",30:"Y",31:"Z"};function rf(e,t){let r="";for(;e.length+r.length<t;)r+="0";return r+e}function rd(e){let t="";for(let i=e;0!==i;){var r;let e=i>>5;t=((r=i-(e<<5))<10?eL(r):rp[r])+t,i=e}return t}function rh(e){return function(t){return rf(rd(~~(t/0x40000000)),e-6)+rf(rd(0x3fffffff&t),6)}}rh(10),rh(8);class rm{constructor(e,t){this.commands=e,this.metadataForReplay=t}[Symbol.iterator](){return this.commands[Symbol.iterator]()}[eE](){return new rm(this.commands.map(e=>e.clone()),this.metadataForReplay)}toString(){let e=this.commands.filter(e=>e.hasRan).map(e=>e.toString()).join(","),t=this.metadataForReplay();return 0!==t.length?`${e} /*${t}*/`:e}}let rg=e=>e();class ry{constructor(e,t){this.act=e,this.taskSelector=t,this.lastTaskId=0,this.sourceTaskSelector=t.clone(),this.scheduledTasks=[],this.triggeredTasks=[],this.scheduledWatchers=[]}static buildLog(e){return`[task\${${e.taskId}}] ${0!==e.label.length?`${e.schedulingType}::${e.label}`:e.schedulingType} ${e.status}${void 0!==e.outputValue?` with value ${e.outputValue.replace(/([$`\\])/g,"\\$1").replace(/\r/g,"\\r")}`:""}`}log(e,t,r,i,n,a){this.triggeredTasks.push({status:n,schedulingType:e,taskId:t,label:r,metadata:i,outputValue:void 0!==a?t1(a):void 0})}scheduleInternal(e,t,r,i,n,a){let s=null,o=++this.lastTaskId,l=new Promise((n,l)=>{s=()=>{(a?r.then(()=>a()):r).then(r=>(this.log(e,o,t,i,"resolved",r),n(r)),r=>(this.log(e,o,t,i,"rejected",r),l(r)))}});return this.scheduledTasks.push({original:r,scheduled:l,trigger:s,schedulingType:e,taskId:o,label:t,metadata:i,customAct:n}),0!==this.scheduledWatchers.length&&this.scheduledWatchers[0](),l}schedule(e,t,r,i){return this.scheduleInternal("promise",t||"",e,r,i||rg)}scheduleFunction(e,t){return(...r)=>this.scheduleInternal("function",`${e.name}(${r.map(t1).join(",")})`,e(...r),void 0,t||rg)}scheduleSequence(e,t){let r={done:!1,faulty:!1},i={then:e=>e()},n=()=>{},a=new Promise(e=>n=e);return e.reduce((e,a)=>{let[s,o,l]="function"==typeof a?[a,a.name,void 0]:[a.builder,a.label,a.metadata];return e.then(()=>{let e=this.scheduleInternal("sequence",o,i,l,t||rg,()=>s());return e.catch(()=>{r.faulty=!0,n()}),e})},i).then(()=>{r.done=!0,n()},()=>{}),Object.assign(r,{task:Promise.resolve(a).then(()=>({done:r.done,faulty:r.faulty}))})}count(){return this.scheduledTasks.length}internalWaitOne(){if(0===this.scheduledTasks.length)throw Error("No task scheduled");let e=this.taskSelector.nextTaskIndex(this.scheduledTasks),[t]=this.scheduledTasks.splice(e,1);return t.customAct(async()=>{t.trigger();try{await t.scheduled}catch(e){}})}async waitOne(e){let t=e||rg;await this.act(()=>t(async()=>await this.internalWaitOne()))}async waitAll(e){for(;this.scheduledTasks.length>0;)await this.waitOne(e)}async waitFor(e,t){let r=!1,i=null,n=async()=>{for(;!r&&this.scheduledTasks.length>0;)await this.waitOne(t);i=null},a=()=>{null===i&&(i=Promise.resolve().then(n))},s=()=>{let e=this.scheduledWatchers.indexOf(a);-1!==e&&this.scheduledWatchers.splice(e,1),0===e&&0!==this.scheduledWatchers.length&&this.scheduledWatchers[0]()},o=e.then(e=>(r=!0,null===i)?(s(),e):i.then(()=>(s(),e)),e=>{if(r=!0,null===i)throw s(),e;return i.then(()=>{throw s(),e})});return this.scheduledTasks.length>0&&0===this.scheduledWatchers.length&&a(),this.scheduledWatchers.push(a),o}report(){return[...this.triggeredTasks,...this.scheduledTasks.map(e=>({status:"pending",schedulingType:e.schedulingType,taskId:e.taskId,label:e.label,metadata:e.metadata}))]}toString(){return"schedulerFor()`\n"+this.report().map(ry.buildLog).map(e=>`-> ${e}`).join("\n")+"`"}[eE](){return new ry(this.act,this.sourceTaskSelector)}}(o=c||(c={}))[o.Full=0]="Full",o[o.Character=1]="Character",[..."abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_"],[..."0123456789"],[..." 	\r\n\v\f"],[..."\r\n",..."\x1e\x15"],rs(32,126,ro,ro),e.s(["__commitHash",()=>"a4a600eaa08c833707067a877db144289a724b91","__type",()=>"module","__version",()=>"3.23.2"],631345),e.i(631345);var rb=e.i(500577),rS=e.i(402409);e.i(214250),e.i(838927);var rv=e.i(129627);let rE=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return rE(e,t.from)}},rw=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),r_=e=>{let t,r=!1;return()=>(r||(t=e(),r=!0),t)},rk=e=>{try{return e.toISOString()}catch{return String(e)}},rx=(e,t=!0)=>{if(Array.isArray(e))return`[${e.map(e=>rx(e,t)).join(",")}]`;if(v.isDate(e))return rk(e);if(v.hasProperty(e,"toString")&&v.isFunction(e.toString)&&e.toString!==Object.prototype.toString)return e.toString();if(v.isString(e))return JSON.stringify(e);if(v.isNumber(e)||null==e||v.isBoolean(e)||v.isSymbol(e))return String(e);if(v.isBigInt(e))return String(e)+"n";if(v.isIterable(e))return`${e.constructor.name}(${rx(Array.from(e),t)})`;try{t&&JSON.stringify(e);let r=`{${rw(e).map(t=>`${v.isString(t)?JSON.stringify(t):String(t)}:${rx(e[t],!1)}`).join(",")}}`,i=e.constructor.name;return e.constructor!==Object.prototype.constructor?`${i}(${r})`:r}catch{return"<circular structure>"}},rC=e=>"string"==typeof e?JSON.stringify(e):String(e),rI=e=>`[${rC(e)}]`,rT=e=>Array.isArray(e)?e.map(rI).join(""):rI(e),rR=(e,t,r,i)=>{let n=e;return r&&p.isNonEmptyReadonlyArray(r)&&(n+=`
at path: ${rT(r)}`),void 0!==t&&(n+=`
details: ${t}`),i&&(n+=`
schema (${i._tag}): ${i}`),n},rO=(e,t,r)=>rR("Unsupported schema or overlapping types",`cannot extend ${e} with ${t}`,r),rF=e=>rR("Unsupported schema",void 0,void 0,e),rM=e=>rR("Duplicate index signature",`${e} index signature`),rA=rR("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),rN=rR("Invalid element","A required element cannot follow an optional element. ts(1257)"),rP=e=>rR("Duplicate property signature transformation",`Duplicate key ${rx(e)}`),rD=e=>rR("Duplicate property signature",`Duplicate key ${rx(e)}`),rL=Symbol.for("effect/SchemaId/DateFromSelf"),rU=Symbol.for("effect/SchemaId/GreaterThan"),rz=Symbol.for("effect/SchemaId/GreaterThanOrEqualTo"),rj=Symbol.for("effect/SchemaId/LessThan"),rW=Symbol.for("effect/SchemaId/LessThanOrEqualTo"),rq=Symbol.for("effect/SchemaId/Int"),r$=Symbol.for("effect/SchemaId/NonNaN"),rB=Symbol.for("effect/SchemaId/Finite"),rH=Symbol.for("effect/SchemaId/JsonNumber"),rV=Symbol.for("effect/SchemaId/Between"),rJ=Symbol.for("effect/SchemaId/GreaterThanOrEqualToBigint"),rG=Symbol.for("effect/SchemaId/BetweenBigint"),rK=Symbol.for("effect/SchemaId/MinLength"),rZ=Symbol.for("effect/SchemaId/Length"),rQ=Symbol.for("effect/SchemaId/ItemsCount");e.i(807816);var rY=e.i(931499),rX=Z,r0=e.i(803327),r1=e.i(930559);let r2=Symbol.for("effect/annotation/Brand"),r6=Symbol.for("effect/annotation/SchemaId"),r3=Symbol.for("effect/annotation/Message"),r4=Symbol.for("effect/annotation/MissingMessage"),r5=Symbol.for("effect/annotation/Identifier"),r8=Symbol.for("effect/annotation/Title"),r7=Symbol.for("effect/annotation/AutoTitle"),r9=Symbol.for("effect/annotation/Description"),ie=Symbol.for("effect/annotation/Examples"),it=Symbol.for("effect/annotation/Default"),ir=Symbol.for("effect/annotation/JSONSchema"),ii=Symbol.for("effect/annotation/Arbitrary"),ia=Symbol.for("effect/annotation/Pretty"),is=Symbol.for("effect/annotation/Equivalence"),io=Symbol.for("effect/annotation/Documentation"),il=Symbol.for("effect/annotation/Concurrency"),iu=Symbol.for("effect/annotation/Batching"),ic=Symbol.for("effect/annotation/ParseIssueTitle"),ip=Symbol.for("effect/annotation/ParseOptions"),id=Symbol.for("effect/annotation/DecodingFallback"),ih=Symbol.for("effect/annotation/Surrogate"),im=Symbol.for("effect/annotation/StableFilter"),ig=(0,h.dual)(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?y.some(e.annotations[t]):y.none()),iy=ig(r2),ib=ig(r3),iS=ig(r4),iv=ig(r8),iE=ig(r7),iw=ig(r5),i_=ig(r9),ik=ig(il),ix=ig(iu),iC=ig(ic),iI=ig(ip),iT=ig(id),iR=ig(ih),iO=ig(im),iF=e=>y.exists(iO(e),e=>!0===e),iM=Symbol.for("effect/annotation/JSONIdentifier"),iA=ig(iM),iN=Symbol.for("effect/schema/ParseJson");class iP{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(e,t,r,i={}){this.typeParameters=e,this.decodeUnknown=t,this.encodeUnknown=r,this.annotations=i}toString(){return y.getOrElse(nG(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(e=>e.toJSON()),annotations:nz(this.annotations)}}}let iD=e=>t=>t._tag===e;class iL{literal;annotations;_tag="Literal";constructor(e,t={}){this.literal=e,this.annotations=t}toString(){return y.getOrElse(nG(this),()=>rx(this.literal))}toJSON(){return{_tag:this._tag,literal:v.isBigInt(this.literal)?String(this.literal):this.literal,annotations:nz(this.annotations)}}}let iU=iD("Literal"),iz=new iL(null);class ij{symbol;annotations;_tag="UniqueSymbol";constructor(e,t={}){this.symbol=e,this.annotations=t}toString(){return y.getOrElse(nG(this),()=>rx(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:nz(this.annotations)}}}let iW=iD("UniqueSymbol"),iq=new class{annotations;_tag="UndefinedKeyword";constructor(e={}){this.annotations=e}toString(){return nV(this)}toJSON(){return{_tag:this._tag,annotations:nz(this.annotations)}}}({[r8]:"undefined"}),i$=new class{annotations;_tag="NeverKeyword";constructor(e={}){this.annotations=e}toString(){return nV(this)}toJSON(){return{_tag:this._tag,annotations:nz(this.annotations)}}}({[r8]:"never"}),iB=iD("NeverKeyword"),iH=new class{annotations;_tag="UnknownKeyword";constructor(e={}){this.annotations=e}toString(){return nV(this)}toJSON(){return{_tag:this._tag,annotations:nz(this.annotations)}}}({[r8]:"unknown"}),iV=new class{annotations;_tag="AnyKeyword";constructor(e={}){this.annotations=e}toString(){return nV(this)}toJSON(){return{_tag:this._tag,annotations:nz(this.annotations)}}}({[r8]:"any"}),iJ=new class{annotations;_tag="StringKeyword";constructor(e={}){this.annotations=e}toString(){return nV(this)}toJSON(){return{_tag:this._tag,annotations:nz(this.annotations)}}}({[r8]:"string",[r9]:"a string"}),iG=iD("StringKeyword"),iK=new class{annotations;_tag="NumberKeyword";constructor(e={}){this.annotations=e}toString(){return nV(this)}toJSON(){return{_tag:this._tag,annotations:nz(this.annotations)}}}({[r8]:"number",[r9]:"a number"}),iZ=iD("NumberKeyword"),iQ=new class{annotations;_tag="BooleanKeyword";constructor(e={}){this.annotations=e}toString(){return nV(this)}toJSON(){return{_tag:this._tag,annotations:nz(this.annotations)}}}({[r8]:"boolean",[r9]:"a boolean"}),iY=iD("BooleanKeyword"),iX=new class{annotations;_tag="BigIntKeyword";constructor(e={}){this.annotations=e}toString(){return nV(this)}toJSON(){return{_tag:this._tag,annotations:nz(this.annotations)}}}({[r8]:"bigint",[r9]:"a bigint"}),i0=new class{annotations;_tag="SymbolKeyword";constructor(e={}){this.annotations=e}toString(){return nV(this)}toJSON(){return{_tag:this._tag,annotations:nz(this.annotations)}}}({[r8]:"symbol",[r9]:"a symbol"}),i1=iD("SymbolKeyword"),i2=iD("Enums"),i6=iD("TemplateLiteral");class i3{type;annotations;constructor(e,t={}){this.type=e,this.annotations=t}toJSON(){return{type:this.type.toJSON(),annotations:nz(this.annotations)}}toString(){return String(this.type)}}class i4 extends i3{isOptional;constructor(e,t,r={}){super(e,r),this.isOptional=t}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:nz(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}let i5=e=>e.map(e=>e.type);class i8{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(e,t,r,i={}){this.elements=e,this.rest=t,this.isReadonly=r,this.annotations=i;let n=!1,a=!1;for(const t of e)if(t.isOptional)n=!0;else if(n){a=!0;break}if(a||n&&t.length>1)throw Error(rN)}toString(){return y.getOrElse(nG(this),()=>i7(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(e=>e.toJSON()),rest:this.rest.map(e=>e.toJSON()),isReadonly:this.isReadonly,annotations:nz(this.annotations)}}}let i7=e=>{let t=e.elements.map(String).join(", ");return p.matchLeft(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(r,i)=>{let n=String(r),a=n.includes(" | ")?`(${n})`:n;if(i.length>0){let r=i.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${a}[], ${r}]`:`readonly [...${a}[], ${r}]`}return e.elements.length>0?`readonly [${t}, ...${a}[]]`:`ReadonlyArray<${n}>`}})};class i9 extends i4{name;isReadonly;constructor(e,t,r,i,n){super(t,r,n),this.name=e,this.isReadonly=i}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:nz(this.annotations)}}}let ne=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return ne(e.from)}return!1};class nt{type;isReadonly;parameter;constructor(e,t,r){if(this.type=t,this.isReadonly=r,ne(e))this.parameter=e;else throw Error(rA)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class nr{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(e,t,r={}){this.annotations=r;const i={};for(let t=0;t<e.length;t++){const r=e[t].name;if(Object.prototype.hasOwnProperty.call(i,r))throw Error(rD(r));i[r]=null}const n={string:!1,symbol:!1};for(let e=0;e<t.length;e++){const r=nj(t[e].parameter);if(iG(r)){if(n.string)throw Error(rM("string"));n.string=!0}else if(i1(r)){if(n.symbol)throw Error(rM("symbol"));n.symbol=!0}}this.propertySignatures=e,this.indexSignatures=t}toString(){return y.getOrElse(nG(this),()=>nn(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(e=>e.toJSON()),indexSignatures:this.indexSignatures.map(e=>e.toJSON()),annotations:nz(this.annotations)}}}let ni=e=>e.map(String).join("; "),nn=e=>{if(e.propertySignatures.length>0){let t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${ni(e.indexSignatures)} }`:`{ ${t} }`}return e.indexSignatures.length>0?`{ ${ni(e.indexSignatures)} }`:"{}"},na=iD("TypeLiteral"),ns=p.sort(b.mapInput(rY.Order,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),no={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},nl=e=>p.flatMap(e,e=>np(e)?nl(e.types):[e]);class nu{types;annotations;static make=(e,t)=>nc(e)?new nu(e,t):1===e.length?e[0]:i$;static unify=(e,t)=>nu.make((e=>{let t=ns(e),r=[],i={},n=[];for(let e of t)switch(e._tag){case"NeverKeyword":break;case"AnyKeyword":return[iV];case"UnknownKeyword":return[iH];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":i[e._tag]||(i[e._tag]=e,r.push(e));break;case"Literal":{let t=typeof e.literal;switch(t){case"string":case"number":case"bigint":case"boolean":i[no[t]]||n.includes(e.literal)||(n.push(e.literal),r.push(e));break;case"object":n.includes(e.literal)||(n.push(e.literal),r.push(e))}break}case"UniqueSymbol":i.SymbolKeyword||n.includes(e.symbol)||(n.push(e.symbol),r.push(e));break;case"TupleType":i.ObjectKeyword||r.push(e);break;case"TypeLiteral":0===e.propertySignatures.length&&0===e.indexSignatures.length?i["{}"]||(i["{}"]=e,r.push(e)):i.ObjectKeyword||r.push(e);break;default:r.push(e)}return r})(nl(e)),t);_tag="Union";constructor(e,t={}){this.types=e,this.annotations=t}toString(){return y.getOrElse(nG(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(e=>e.toJSON()),annotations:nz(this.annotations)}}}let nc=e=>e.length>1,np=iD("Union"),nf=(0,rS.globalValue)(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class nd{f;annotations;_tag="Suspend";constructor(e,t={}){this.f=e,this.annotations=t,this.f=r_(e)}toString(){return nG(this).pipe(y.orElse(()=>y.flatMap(y.liftThrowable(this.f)(),e=>nG(e))),y.getOrElse(()=>"<suspended schema>"))}toJSON(){let e=this.f(),t=nf.get(e);return t||(nf.set(e,{_tag:this._tag}),t={_tag:this._tag,ast:e.toJSON(),annotations:nz(this.annotations)},nf.set(e,t)),t}}class nh{from;filter;annotations;_tag="Refinement";constructor(e,t,r={}){this.from=e,this.filter=t,this.annotations=r}toString(){return iw(this).pipe(y.getOrElse(()=>y.match(nJ(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:e=>nm(this.from)?String(this.from)+" & "+e:e})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:nz(this.annotations)}}}let nm=iD("Refinement"),ng={};class ny{from;to;transformation;annotations;_tag="Transformation";constructor(e,t,r,i={}){this.from=e,this.to=t,this.transformation=r,this.annotations=i}toString(){return y.getOrElse(nG(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:nz(this.annotations)}}}let nb=iD("Transformation");class nS{decode;encode;_tag="FinalTransformation";constructor(e,t){this.decode=e,this.encode=t}}let nv=new class{_tag="ComposeTransformation"};class nE{from;to;decode;encode;constructor(e,t,r,i){this.from=e,this.to=t,this.decode=r,this.encode=i}}class nw{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(e){this.propertySignatureTransformations=e;const t={},r={};for(const i of e){const e=i.from;if(t[e])throw Error(rP(e));t[e]=!0;const n=i.to;if(r[n])throw Error(rP(n));r[n]=!0}}}let n_=(e,t)=>{let r=Object.getOwnPropertyDescriptors(e),i={...e.annotations,...t},n=iR(e);return y.isSome(n)&&(i[ih]=n_(n.value,t)),r.annotations.value=i,Object.create(Object.getPrototypeOf(e),r)},nk=(e,t)=>{switch(e._tag){case"Literal":return r1.escape(String(e.literal));case"StringKeyword":return"[\\s\\S]*?";case"NumberKeyword":return"[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?";case"TemplateLiteral":return nC(e,t,!1);case"Union":return e.types.map(e=>nk(e,t)).join("|")}},nx=(e,t,r,i)=>{if(np(e)){if(r&&!i)return`(?:${t})`}else if(!r||!i)return t;return`(${t})`},nC=(e,t,r)=>{let i="";if(""!==e.head){let n=r1.escape(e.head);i+=t&&r?`(${n})`:n}for(let n of e.spans){let e=nk(n.type,t);if(i+=nx(n.type,e,t,r),""!==n.literal){let e=r1.escape(n.literal);i+=t&&r?`(${e})`:e}}return i},nI=e=>RegExp(`^${nC(e,!1,!0)}$`),nT=(e,t)=>{let r=p.findFirst(e.propertySignatures,e=>e.name===t);if(y.isSome(r))return r.value;if(v.isString(t)){let r;for(let i of e.indexSignatures){let e=nj(i.parameter);switch(e._tag){case"TemplateLiteral":if(nI(e).test(t))return new i9(t,i.type,!1,!0);break;case"StringKeyword":void 0===r&&(r=new i9(t,i.type,!1,!0))}}if(r)return r}else if(v.isSymbol(t)){for(let r of e.indexSignatures)if(i1(nj(r.parameter)))return new i9(t,r.type,!1,!0)}},nR=(e,t)=>{let r=iR(e);if(y.isSome(r))return nR(r.value,t);switch(e._tag){case"TypeLiteral":{let r=nT(e,t);if(r)return r;break}case"Union":return new i9(t,nu.make(e.types.map(e=>nR(e,t).type)),!1,!0);case"Suspend":return nR(e.f(),t);case"Refinement":return nR(e.from,t)}throw Error(rF(e))},nO=(e,t)=>{let r=[],i=[],n=e=>{switch(e._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":i.push(new nt(e,t,!0));break;case"Literal":if(v.isString(e.literal)||v.isNumber(e.literal))r.push(new i9(e.literal,t,!1,!0));else{let t;throw Error((t=e.literal,rR("Unsupported literal",`literal value: ${rx(t)}`)))}break;case"Enums":for(let[i,n]of e.enums)r.push(new i9(n,t,!1,!0));break;case"UniqueSymbol":r.push(new i9(e.symbol,t,!1,!0));break;case"Union":e.types.forEach(n);break;default:throw Error(rR("Unsupported key schema",void 0,void 0,e))}};return n(e),{propertySignatures:r,indexSignatures:i}},nF=e=>t=>{let r;for(let i of e)Object.prototype.hasOwnProperty.call(t.annotations,i)&&(void 0===r&&(r={}),r[i]=t.annotations[i]);return r},nM=nF([ie,it,ir,ii,ia,is]),nA=e=>{switch(e._tag){case"Declaration":{let t=nP(e.typeParameters,nA);return t===e.typeParameters?e:new iP(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{let t=nP(e.elements,e=>{let t=nA(e.type);return t===e.type?e:new i4(t,e.isOptional)}),r=i5(e.rest),i=nP(r,nA);return t===e.elements&&i===r?e:new i8(t,i.map(e=>new i3(e)),e.isReadonly,e.annotations)}case"TypeLiteral":{let t=nP(e.propertySignatures,e=>{let t=nA(e.type);return t===e.type?e:new i9(e.name,t,e.isOptional,e.isReadonly)}),r=nP(e.indexSignatures,e=>{let t=nA(e.type);return t===e.type?e:new nt(e.parameter,t,e.isReadonly)});return t===e.propertySignatures&&r===e.indexSignatures?e:new nr(t,r,e.annotations)}case"Union":{let t=nP(e.types,nA);return t===e.types?e:nu.make(t,e.annotations)}case"Suspend":return new nd(()=>nA(e.f()),e.annotations);case"Refinement":{let t=nA(e.from);return t===e.from?e:new nh(t,e.filter,e.annotations)}case"Transformation":{let t=nM(e);return nA(void 0!==t?n_(e.to,t):e.to)}}return e},nN=e=>y.match(y.orElse(iA(e),()=>iw(e)),{onNone:()=>void 0,onSome:e=>({[iM]:e})});function nP(e,t){let r=!1,i=p.allocate(e.length);for(let n=0;n<e.length;n++){let a=e[n],s=t(a);s!==a&&(r=!0),i[n]=s}return r?i:e}let nD=e=>{switch(e._tag){case"Transformation":return e.from;case"Refinement":return nD(e.from);case"Suspend":return nD(e.f())}},nL=(e,t)=>{switch(e._tag){case"Declaration":{let r=nP(e.typeParameters,e=>nL(e,t));return r===e.typeParameters?e:new iP(r,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{let r=nP(e.elements,e=>{let r=nL(e.type,t);return r===e.type?e:new i4(r,e.isOptional)}),i=i5(e.rest),n=nP(i,e=>nL(e,t));return r===e.elements&&n===i?e:new i8(r,n.map(e=>new i3(e)),e.isReadonly,nN(e))}case"TypeLiteral":{let r=nP(e.propertySignatures,e=>{let r=nL(e.type,t);return r===e.type?e:new i9(e.name,r,e.isOptional,e.isReadonly)}),i=nP(e.indexSignatures,e=>{let r=nL(e.type,t);return r===e.type?e:new nt(e.parameter,r,e.isReadonly)});return r===e.propertySignatures&&i===e.indexSignatures?e:new nr(r,i,nN(e))}case"Union":{let r=nP(e.types,e=>nL(e,t));return r===e.types?e:nu.make(r,nN(e))}case"Suspend":return new nd(()=>nL(e.f(),t),nN(e));case"Refinement":{let r=nL(e.from,t);if(t){if(r===e.from)return e;if(void 0===nD(e.from)&&iF(e))return new nh(r,e.filter,e.annotations)}let i=nN(e);return i?n_(r,i):r}case"Transformation":{let r=nN(e);return nL(r?n_(e.from,r):e.from,t)}}return e},nU=e=>nL(e,!1),nz=e=>{let t={};for(let r of Object.getOwnPropertySymbols(e))t[String(r)]=e[r];return t},nj=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return nj(e.from)}},nW=(e,t)=>{switch(e._tag){case"Literal":return iU(t)&&t.literal===e.literal;case"UniqueSymbol":return iW(t)&&t.symbol===e.symbol;case"UndefinedKeyword":case"VoidKeyword":case"NeverKeyword":case"UnknownKeyword":case"AnyKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":case"ObjectKeyword":return t._tag===e._tag;case"TemplateLiteral":return i6(t)&&t.head===e.head&&nq(t.spans,e.spans);case"Enums":return i2(t)&&n$(t.enums,e.enums);case"Union":return np(t)&&nB(e.types,t.types);case"Refinement":case"TupleType":case"TypeLiteral":case"Suspend":case"Transformation":case"Declaration":return e===t}},nq=p.getEquivalence((e,t)=>e.literal===t.literal&&nW(e.type,t.type)),n$=p.getEquivalence((e,t)=>t[0]===e[0]&&t[1]===e[1]),nB=p.getEquivalence(nW),nH=(e,t)=>new ny(e,t,nv),nV=e=>y.getOrElse(nG(e),()=>e._tag),nJ=e=>iv(e).pipe(y.orElse(()=>i_(e)),y.orElse(()=>iE(e)),y.map(t=>t+y.match(iy(e),{onNone:()=>"",onSome:e=>e.map(e=>` & Brand<${rx(e)}>`).join("")}))),nG=e=>y.orElse(iw(e),()=>nJ(e));class nK{path;actual;issue;_tag="Pointer";constructor(e,t,r){this.path=e,this.actual=t,this.issue=r}}class nZ{actual;message;_tag="Unexpected";constructor(e,t){this.actual=e,this.message=t}}class nQ{ast;message;_tag="Missing";actual=void 0;constructor(e,t){this.ast=e,this.message=t}}class nY{ast;actual;issues;output;_tag="Composite";constructor(e,t,r,i){this.ast=e,this.actual=t,this.issues=r,this.output=i}}class nX{ast;actual;kind;issue;_tag="Refinement";constructor(e,t,r,i){this.ast=e,this.actual=t,this.kind=r,this.issue=i}}class n0{ast;actual;kind;issue;_tag="Transformation";constructor(e,t,r,i){this.ast=e,this.actual=t,this.kind=r,this.issue=i}}class n1{ast;actual;message;_tag="Type";constructor(e,t,r){this.ast=e,this.actual=t,this.message=r}}class n2{ast;actual;message;_tag="Forbidden";constructor(e,t,r){this.ast=e,this.actual=t,this.message=r}}let n6=Symbol.for("effect/Schema/ParseErrorTypeId");class n3 extends(0,rX.TaggedError)("ParseError"){[n6]=n6;get message(){return this.toString()}toString(){return aR.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[g.NodeInspectSymbol](){return this.toJSON()}}let n4=e=>new n3({issue:e}),n5=ef.right,n8=ef.left,n7=ef.try,n9=ef.fromOption,ae=ef.isEither,at=(0,h.dual)(2,(e,t)=>ae(e)?ef.match(e,{onLeft:ef.left,onRight:t}):Y.flatMap(e,t)),ar=(0,h.dual)(2,(e,t)=>ae(e)?ef.map(e,t):Y.map(e,t)),ai=(0,h.dual)(2,(e,t)=>ae(e)?ef.mapLeft(e,t):Y.mapError(e,t)),an=(0,h.dual)(2,(e,t)=>ae(e)?ef.mapBoth(e,{onLeft:t.onFailure,onRight:t.onSuccess}):Y.mapBoth(e,t)),aa=(0,h.dual)(2,(e,t)=>ae(e)?ef.match(e,{onLeft:t,onRight:ef.right}):Y.catchAll(e,t)),as=(e,t)=>void 0===t||v.isNumber(t)?e:void 0===e?t:{...e,...t},ao=(e,t,r)=>{let i=ag(e,t);return(e,t)=>i(e,as(r,t))},al=(e,t,r)=>{let i=ag(e,t);return(e,t)=>i(e,{...as(r,t),isEffectAllowed:!0})},au=(e,t)=>ao(e.ast,!0,t),ac=(e,t)=>al(e.ast,!0,t),ap=(e,t)=>al(e.ast,!1,t),af=(e,t)=>{let r;return r=ao(nA(e.ast),!0,t),(e,t)=>ef.getOrThrowWith(r(e,t),n4)},ad=(e,t)=>{let r=ag(nA(e.ast),!0);return(e,i)=>ef.isRight(r(e,{exact:!0,...as(t,i)}))},ah=(0,rS.globalValue)(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),am=(0,rS.globalValue)(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),ag=(e,t)=>{let r=t?ah:am,i=r.get(e);if(i)return i;let n=aS(e,t),a=iI(e),s=y.isSome(a)?(e,t)=>n(e,as(t,a.value)):n,o=iT(e),l=t&&y.isSome(o)?(t,r)=>ak(aa(s(t,r),o.value),e,t,r):s;return r.set(e,l),l},ay=e=>y.getOrUndefined(ik(e)),ab=e=>y.getOrUndefined(ix(e)),aS=(e,t)=>{switch(e._tag){case"Refinement":if(t){let t=ag(e.from,!0);return(r,i)=>{i=i??ng;let n=i?.errors==="all";return ak(at(aa(t(r,i),t=>{let a=new nX(e,r,"From",t);return n&&iF(e)&&aP(t)?y.match(e.filter(r,i,e),{onNone:()=>ef.left(a),onSome:t=>ef.left(new nY(e,r,[a,new nX(e,r,"Predicate",t)]))}):ef.left(a)}),t=>y.match(e.filter(t,i,e),{onNone:()=>ef.right(t),onSome:t=>ef.left(new nX(e,r,"Predicate",t))})),e,r,i)}}{let t=ag(nA(e),!0),r=ag(a_(e.from),!1);return(i,n)=>ak(at(t(i,n),e=>r(e,n)),e,i,n)}case"Transformation":{let r=aI(e.transformation,t),i=t?ag(e.from,!0):ag(e.to,!1),n=t?ag(e.to,!0):ag(e.from,!1);return(a,s)=>ak(at(ai(i(a,s),r=>new n0(e,a,t?"Encoded":"Type",r)),i=>at(ai(r(i,s??ng,e,a),t=>new n0(e,a,"Transformation",t)),r=>ai(n(r,s),r=>new n0(e,a,t?"Type":"Encoded",r)))),e,a,s)}case"Declaration":{let r=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(t,i)=>ak(r(t,i??ng,e),e,t,i)}case"Literal":return av(e,t=>t===e.literal);case"UniqueSymbol":return av(e,t=>t===e.symbol);case"UndefinedKeyword":return av(e,v.isUndefined);case"NeverKeyword":return av(e,v.isNever);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return ef.right;case"StringKeyword":return av(e,v.isString);case"NumberKeyword":return av(e,v.isNumber);case"BooleanKeyword":return av(e,v.isBoolean);case"BigIntKeyword":return av(e,v.isBigInt);case"SymbolKeyword":return av(e,v.isSymbol);case"ObjectKeyword":return av(e,v.isObject);case"Enums":return av(e,t=>e.enums.some(([e,r])=>r===t));case"TemplateLiteral":{let t=nI(e);return av(e,e=>v.isString(e)&&t.test(e))}case"TupleType":{let r=e.elements.map(e=>ag(e.type,t)),i=e.rest.map(e=>ag(e.type,t)),n=e.elements.filter(e=>!e.isOptional);e.rest.length>0&&(n=n.concat(e.rest.slice(1)));let a=n.length,s=e.elements.length>0?e.elements.map((e,t)=>t).join(" | "):"never",o=ay(e),l=ab(e);return(t,u)=>{let c;if(!p.isArray(t))return ef.left(new n1(e,t));let f=u?.errors==="all",d=[],h=0,m=[],g=t.length;for(let r=g;r<=a-1;r++){let i=new nK(r,t,new nQ(n[r-g]));if(!f)return ef.left(new nY(e,t,i,m));d.push([h++,i])}if(0===e.rest.length)for(let r=e.elements.length;r<=g-1;r++){let i=new nK(r,t,new nZ(t[r],`is unexpected, expected: ${s}`));if(!f)return ef.left(new nY(e,t,i,m));d.push([h++,i])}let y=0;for(;y<r.length;y++)if(g<y+1){if(e.elements[y].isOptional)continue}else{let i=(0,r[y])(t[y],u);if(ae(i)){if(ef.isLeft(i)){let r=new nK(y,t,i.left);if(!f)return ef.left(new nY(e,t,r,aC(m)));d.push([h++,r]);continue}m.push([h++,i.right])}else{let r=h++,n=y;c||(c=[]),c.push(({es:a,output:s})=>Y.flatMap(Y.either(i),i=>{if(ef.isLeft(i)){let o=new nK(n,t,i.left);return f?(a.push([r,o]),Y.void):ef.left(new nY(e,t,o,aC(s)))}return s.push([r,i.right]),Y.void}))}}if(p.isNonEmptyReadonlyArray(i)){let[r,...n]=i;for(;y<g-n.length;y++){let i=r(t[y],u);if(ae(i))if(ef.isLeft(i)){let r=new nK(y,t,i.left);if(!f)return ef.left(new nY(e,t,r,aC(m)));d.push([h++,r]);continue}else m.push([h++,i.right]);else{let r=h++,n=y;c||(c=[]),c.push(({es:a,output:s})=>Y.flatMap(Y.either(i),i=>{if(!ef.isLeft(i))return s.push([r,i.right]),Y.void;{let o=new nK(n,t,i.left);return f?(a.push([r,o]),Y.void):ef.left(new nY(e,t,o,aC(s)))}}))}}for(let r=0;r<n.length;r++)if(!(g<(y+=r)+1)){let i=n[r](t[y],u);if(ae(i)){if(ef.isLeft(i)){let r=new nK(y,t,i.left);if(!f)return ef.left(new nY(e,t,r,aC(m)));d.push([h++,r]);continue}m.push([h++,i.right])}else{let r=h++,n=y;c||(c=[]),c.push(({es:a,output:s})=>Y.flatMap(Y.either(i),i=>{if(ef.isLeft(i)){let o=new nK(n,t,i.left);return f?(a.push([r,o]),Y.void):ef.left(new nY(e,t,o,aC(s)))}return s.push([r,i.right]),Y.void}))}}}let b=({es:r,output:i})=>p.isNonEmptyArray(r)?ef.left(new nY(e,t,aC(r),aC(i))):ef.right(aC(i));if(c&&c.length>0){let e=c;return Y.suspend(()=>{let t={es:p.copy(d),output:p.copy(m)};return Y.flatMap(Y.forEach(e,e=>e(t),{concurrency:o,batching:l,discard:!0}),()=>b(t))})}return b({output:m,es:d})}}case"TypeLiteral":{if(0===e.propertySignatures.length&&0===e.indexSignatures.length)return av(e,v.isNotNullable);let r=[],i={},n=[];for(let a of e.propertySignatures)r.push([ag(a.type,t),a]),i[a.name]=null,n.push(a.name);let a=e.indexSignatures.map(e=>[ag(e.parameter,t),ag(e.type,t),e.parameter]),s=nu.make(e.indexSignatures.map(e=>e.parameter).concat(n.map(e=>v.isSymbol(e)?new ij(e):new iL(e)))),o=ag(s,t),l=ay(e),u=ab(e);return(t,c)=>{let f,d;if(!v.isRecord(t))return ef.left(new n1(e,t));let h=c?.errors==="all",m=[],g=0,y=c?.onExcessProperty==="error",b=c?.onExcessProperty==="preserve",S={};if(y||b)for(let r of f=rw(t)){let i=o(r,c);if(ae(i)&&ef.isLeft(i))if(y){let i=new nK(r,t,new nZ(t[r],`is unexpected, expected: ${String(s)}`));if(!h)return ef.left(new nY(e,t,i,S));m.push([g++,i]);continue}else S[r]=t[r]}let E=c?.exact===!0;for(let i=0;i<r.length;i++){let n=r[i][1],a=n.name,s=Object.prototype.hasOwnProperty.call(t,a);if(!s){if(n.isOptional)continue;else if(E){let r=new nK(a,t,new nQ(n));if(!h)return ef.left(new nY(e,t,r,S));m.push([g++,r]);continue}}let o=(0,r[i][0])(t[a],c);if(ae(o)){if(ef.isLeft(o)){let r=new nK(a,t,s?o.left:new nQ(n));if(!h)return ef.left(new nY(e,t,r,S));m.push([g++,r]);continue}S[a]=o.right}else{let r=g++;d||(d=[]),d.push(({es:i,output:l})=>Y.flatMap(Y.either(o),o=>{if(ef.isLeft(o)){let u=new nK(a,t,s?o.left:new nQ(n));return h?(i.push([r,u]),Y.void):ef.left(new nY(e,t,u,l))}return l[a]=o.right,Y.void}))}}for(let r=0;r<a.length;r++){let n=a[r],s=n[0],o=n[1];for(let r of rE(t,n[2])){let n=s(r,c);if(ae(n)&&ef.isRight(n)){let n=o(t[r],c);if(ae(n))if(ef.isLeft(n)){let i=new nK(r,t,n.left);if(!h)return ef.left(new nY(e,t,i,S));m.push([g++,i]);continue}else Object.prototype.hasOwnProperty.call(i,r)||(S[r]=n.right);else{let a=g++,s=r;d||(d=[]),d.push(({es:o,output:l})=>Y.flatMap(Y.either(n),n=>{if(!ef.isLeft(n))return Object.prototype.hasOwnProperty.call(i,r)||(l[r]=n.right),Y.void;{let r=new nK(s,t,n.left);return h?(o.push([a,r]),Y.void):ef.left(new nY(e,t,r,l))}}))}}}}let w=({es:r,output:i})=>{if(p.isNonEmptyArray(r))return ef.left(new nY(e,t,aC(r),i));if(c?.propertyOrder==="original"){let e=f||rw(t);for(let t of n)-1===e.indexOf(t)&&e.push(t);let r={};for(let t of e)Object.prototype.hasOwnProperty.call(i,t)&&(r[t]=i[t]);return ef.right(r)}return ef.right(i)};if(d&&d.length>0){let e=d;return Y.suspend(()=>{let t={es:p.copy(m),output:Object.assign({},S)};return Y.flatMap(Y.forEach(e,e=>e(t),{concurrency:l,batching:u,discard:!0}),()=>w(t))})}return w({es:m,output:S})}}case"Union":{let r=aw(e.types,t),i=rw(r.keys),n=i.length,a=e.types.length,s=new Map;for(let r=0;r<a;r++)s.set(e.types[r],ag(e.types[r],t));let o=ay(e)??1,l=ab(e);return(t,u)=>{let c,f=[],d=0,h=[];if(n>0)if(v.isRecordOrArray(t))for(let e=0;e<n;e++){let n=i[e],s=r.keys[n].buckets;if(Object.prototype.hasOwnProperty.call(t,n)){let e=String(t[n]);if(Object.prototype.hasOwnProperty.call(s,e))h=h.concat(s[e]);else{let{candidates:e,literals:i}=r.keys[n],s=nu.make(i),o=e.length===a?new nr([new i9(n,s,!1,!0)],[]):nu.make(e);f.push([d++,new nY(o,t,new nK(n,t,new n1(s,t[n])))])}}else{let{candidates:e,literals:i}=r.keys[n],s=new i9(n,nu.make(i),!1,!0),o=e.length===a?new nr([s],[]):nu.make(e);f.push([d++,new nY(o,t,new nK(n,t,new nQ(s)))])}}else{let i=r.candidates.length===a?e:nu.make(r.candidates);f.push([d++,new n1(i,t)])}r.otherwise.length>0&&(h=h.concat(r.otherwise));for(let e=0;e<h.length;e++){let r=h[e],i=s.get(r)(t,u);if(ae(i)&&(!c||0===c.length))if(ef.isRight(i))return i;else f.push([d++,i.left]);else{let e=d++;c||(c=[]),c.push(t=>Y.suspend(()=>"finalResult"in t?Y.void:Y.flatMap(Y.either(i),r=>(ef.isRight(r)?t.finalResult=r:t.es.push([e,r.left]),Y.void))))}}let m=r=>p.isNonEmptyArray(r)?1===r.length&&"Type"===r[0][1]._tag?ef.left(r[0][1]):ef.left(new nY(e,t,aC(r))):ef.left(new n1(e,t));if(c&&c.length>0){let e=c;return Y.suspend(()=>{let t={es:p.copy(f)};return Y.flatMap(Y.forEach(e,e=>e(t),{concurrency:o,batching:l,discard:!0}),()=>"finalResult"in t?t.finalResult:m(t.es))})}return m(f)}}case"Suspend":{let r=r_(()=>ag(n_(e.f(),e.annotations),t));return(e,t)=>r()(e,t)}}},av=(e,t)=>r=>t(r)?ef.right(r):ef.left(new n1(e,r)),aE=(e,t)=>{switch(e._tag){case"Declaration":{let r=iR(e);if(y.isSome(r))return aE(r.value,t);break}case"TypeLiteral":{let r=[];for(let i=0;i<e.propertySignatures.length;i++){let n=e.propertySignatures[i],a=t?nU(n.type):nA(n.type);iU(a)&&!n.isOptional&&r.push([n.name,a])}return r}case"TupleType":{let r=[];for(let i=0;i<e.elements.length;i++){let n=e.elements[i],a=t?nU(n.type):nA(n.type);iU(a)&&!n.isOptional&&r.push([i,a])}return r}case"Refinement":return aE(e.from,t);case"Suspend":return aE(e.f(),t);case"Transformation":return aE(t?e.from:e.to,t)}return[]},aw=(e,t)=>{let r={},i=[],n=[];for(let a=0;a<e.length;a++){let s=e[a],o=aE(s,t);if(o.length>0){n.push(s);for(let e=0;e<o.length;e++){let[t,i]=o[e],n=String(i.literal);r[t]=r[t]||{buckets:{},literals:[],candidates:[]};let a=r[t].buckets;if(Object.prototype.hasOwnProperty.call(a,n)){if(e<o.length-1)continue;a[n].push(s),r[t].literals.push(i),r[t].candidates.push(s)}else{a[n]=[s],r[t].literals.push(i),r[t].candidates.push(s);break}}}else i.push(s)}return{keys:r,otherwise:i,candidates:n}},a_=e=>nm(e)?a_(e.from):e,ak=(e,t,r,i)=>{if(i?.isEffectAllowed===!0||ae(e))return e;let n=new r0.SyncScheduler,a=Y.runFork(e,{scheduler:n});n.flush();let s=a.unsafePoll();if(s){if(eg.isSuccess(s))return ef.right(s.value);let e=s.cause;return J.isFailType(e)?ef.left(e.error):ef.left(new n2(t,r,J.pretty(e)))}return ef.left(new n2(t,r,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},ax=([e],[t])=>e>t?1:e<t?-1:0;function aC(e){return e.sort(ax).map(e=>e[1])}let aI=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return ef.right;case"TypeLiteralTransformation":return r=>{let i=ef.right(r);for(let r of e.propertySignatureTransformations){let[e,n]=t?[r.from,r.to]:[r.to,r.from],a=t?r.decode:r.encode;i=ar(i,t=>{let r=a(Object.prototype.hasOwnProperty.call(t,e)?y.some(t[e]):y.none());return delete t[e],y.isSome(r)&&(t[n]=r.value),t})}return i}}},aT=(e,t=[])=>({value:e,forest:t}),aR={formatIssue:e=>ar(a$(e),aO),formatIssueSync:e=>{let t=aR.formatIssue(e);return ae(t)?ef.getOrThrow(t):Y.runSync(t)},formatError:e=>aR.formatIssue(e.issue),formatErrorSync:e=>aR.formatIssueSync(e.issue)},aO=e=>e.value+aF("\n",e.forest),aF=(e,t)=>{let r,i="",n=t.length;for(let a=0;a<n;a++){r=t[a];let s=a===n-1;i+=e+(s?"└":"├")+"─ "+r.value,i+=aF(e+(n>1&&!s?"│  ":"   "),r.forest)}return i},aM=e=>"ast"in e?y.some(e.ast):y.none(),aA=ef.right(void 0),aN=e=>t=>t._tag===e,aP=aN("Composite"),aD=aN("Refinement"),aL=aN("Transformation"),aU=e=>at(aM(e).pipe(y.flatMap(ib),y.match({onNone:()=>aA,onSome:t=>{let r=t(e);return v.isString(r)?ef.right({message:r,override:!1}):Y.isEffect(r)?Y.map(r,e=>({message:e,override:!1})):v.isString(r.message)?ef.right({message:r.message,override:r.override}):Y.map(r.message,e=>({message:e,override:r.override}))}})),t=>void 0!==t?!t.override&&(aP(e)||aD(e)&&"From"===e.kind||aL(e)&&"Transformation"!==e.kind)?aL(e)||aD(e)?aU(e.issue):aA:ef.right(t.message):aA),az=e=>aM(e).pipe(y.flatMap(iC),y.flatMapNullable(t=>t(e)),y.getOrUndefined),aj=e=>ar(aU(e),t=>t??az(e)??function(e){var t;if(void 0!==e.message)return e.message;let r=nm(e.ast)?i_(t=e.ast).pipe(y.orElse(()=>iv(t)),y.orElse(()=>iE(t)),y.orElse(()=>iw(t)),y.getOrElse(()=>`{ ${t.from} | filter }`)):String(e.ast);return`Expected ${r}, actual ${rx(e.actual)}`}(e)),aW=e=>az(e)??String(e.ast),aq=e=>{let t=iS(e.ast);if(y.isSome(t)){let e=t.value();return v.isString(e)?ef.right(e):e}return ef.right(e.message??"is missing")},a$=e=>{switch(e._tag){case"Type":return ar(aj(e),aT);case"Forbidden":return ef.right(aT(aW(e),[aT(e.message??"is forbidden")]));case"Unexpected":return ef.right(aT(e.message??"is unexpected"));case"Missing":return ar(aq(e),aT);case"Transformation":return at(aU(e),t=>void 0!==t?ef.right(aT(t)):ar(a$(e.issue),t=>aT(aW(e),[aT((e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}})(e.kind),[t])])));case"Refinement":return at(aU(e),t=>void 0!==t?ef.right(aT(t)):ar(a$(e.issue),t=>aT(aW(e),[aT((e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}})(e.kind),[t])])));case"Pointer":return ar(a$(e.issue),t=>aT(rT(e.path),[t]));case"Composite":return at(aU(e),t=>{if(void 0!==t)return ef.right(aT(t));let r=aW(e);return Array.isArray(e.issues)?ar(Y.forEach(e.issues,a$),e=>aT(r,e)):ar(a$(e.issues),e=>aT(r,[e]))})}},aB=(e,t,r)=>({_tag:e,path:t,message:r}),aH={formatIssue:e=>aV(e,void 0,[]),formatIssueSync:e=>{let t=aH.formatIssue(e);return ae(t)?ef.getOrThrow(t):Y.runSync(t)},formatError:e=>aH.formatIssue(e.issue),formatErrorSync:e=>aH.formatIssueSync(e.issue)},aV=(e,t,r)=>{let i=e._tag;switch(i){case"Type":return ar(aj(e),e=>[aB(t??i,r,e)]);case"Forbidden":return ef.right([aB(i,r,e.message??"is forbidden")]);case"Unexpected":return ef.right([aB(i,r,e.message??"is unexpected")]);case"Missing":return ar(aq(e),e=>[aB(i,r,e)]);case"Pointer":return aV(e.issue,void 0,r.concat(e.path));case"Composite":return at(aU(e),t=>void 0!==t?ef.right([aB(i,r,t)]):Array.isArray(e.issues)?ar(Y.forEach(e.issues,e=>aV(e,void 0,r)),p.flatten):aV(e.issues,void 0,r));case"Refinement":return at(aU(e),t=>void 0!==t?ef.right([aB(i,r,t)]):aV(e.issue,"Predicate"===e.kind?i:void 0,r));case"Transformation":return at(aU(e),t=>void 0!==t?ef.right([aB(i,r,t)]):aV(e.issue,"Transformation"===e.kind?i:void 0,r))}};e.s(["ArrayFormatter",0,aH,"Composite",()=>nY,"Pointer",()=>nK,"TreeFormatter",0,aR,"Type",()=>n1,"decodeUnknown",0,ac,"decodeUnknownEither",0,au,"encodeUnknown",0,ap,"encodeUnknownEither",0,(e,t)=>ao(e.ast,!1,t),"fail",0,n8,"flatMap",0,at,"fromOption",0,n9,"getSearchTree",0,aw,"is",0,ad,"isParseError",0,e=>v.hasProperty(e,n6),"map",0,ar,"mapBoth",0,an,"mapError",0,ai,"parseError",0,n4,"succeed",0,n5,"try",()=>n7,"validate",0,(e,t)=>al(nA(e.ast),!0,t),"validateEither",0,(e,t)=>ao(nA(e.ast),!0,t),"validateSync",0,af],862396);var aJ=v,aG=e.i(392353);e.i(237270),e.i(628555),e.i(923928);let aK=(0,h.dual)(e=>v.isObject(e[0]),(e,...t)=>{let r={};for(let i of t)i in e&&(r[i]=e[i]);return r}),aZ=(0,h.dual)(e=>v.isObject(e[0]),(e,...t)=>{let r={...e};for(let e of t)delete r[e];return r});d.struct,b.struct;let aQ=Symbol.for("effect/Schema");function aY(e){return class{[aQ]=aX;static ast=e;static annotations(e){return aY(a2(this.ast,e))}static pipe(){return(0,S.pipeArguments)(this,arguments)}static toString(){return String(e)}static Type;static Encoded;static Context;static [aQ]=aX}}let aX={_A:e=>e,_I:e=>e,_R:e=>e},a0={schemaId:r6,message:r3,missingMessage:r4,identifier:r5,title:r8,description:r9,examples:ie,default:it,documentation:io,jsonSchema:ir,arbitrary:ii,pretty:ia,equivalence:is,concurrency:il,batching:iu,parseIssueTitle:ic,parseOptions:ip,decodingFallback:id},a1=e=>{if(!e)return{};let t={...e};for(let r in a0)r in e&&(t[a0[r]]=e[r],delete t[r]);return t},a2=(e,t)=>n_(e,a1(t)),a6=e=>aY(nA(e.ast)),a3=(e,t)=>{let r=ac(e,t);return(e,t)=>ai(r(e,t),n4)},a4=e=>aJ.hasProperty(e,aQ)&&aJ.isObject(e[aQ]);function a5(...e){return p.isNonEmptyReadonlyArray(e)?function e(t,r=function(e){let t;return nc(e)?nu.make((t=e=>new iL(e),e.map(t))):new iL(e[0])}(t)){return class extends aY(r){static annotations(t){return e(this.literals,a2(this.ast,t))}static literals=[...t]}}(e):si}function a8(e,t){return class extends aY(t){static annotations(e){return a8(this.typeParameters,a2(this.ast,e))}static typeParameters=[...e]}}let a7=function(){let e;if(Array.isArray(arguments[0])){let e=arguments[0],t=arguments[1],r=arguments[2];return a8(e,new iP(e.map(e=>e.ast),(...e)=>t.decode(...e.map(aY)),(...e)=>t.encode(...e.map(aY)),a1(r)))}let t=arguments[0],r=arguments[1];return a8([],new iP([],e=()=>(e,r,i)=>t(e)?n5(e):n8(new n1(i,e)),e,a1(r)))},a9=Symbol.for("effect/SchemaId/InstanceOf"),se=(e,t)=>a7(t=>t instanceof e,{title:e.name,description:`an instance of ${e.name}`,pretty:()=>String,schemaId:a9,[a9]:{constructor:e},...t});class st extends aY(iq){}class sr extends aY(iz){}class si extends aY(i$){}class sn extends aY(iH){}class sa extends aY(iX){}class ss extends aY(i0){}class so extends aY(iJ){}class sl extends aY(iK){}class su extends aY(iQ){}function sc(...e){return nc(e)?function e(t,r=(e=>nu.make(e.map(e=>e.ast)))(t)){return class extends aY(r){static annotations(t){return e(this.members,a2(this.ast,t))}static members=[...t]}}(e):p.isNonEmptyReadonlyArray(e)?e[0]:si}let sp=e=>sc(e,sr),sf=e=>new sd(new i4(e.ast,!1),e);class sd{ast;from;[aQ];_Token;constructor(e,t){this.ast=e,this.from=t}annotations(e){return new sd(new i4(this.ast.type,this.ast.isOptional,{...this.ast.annotations,...a1(e)}),this.from)}toString(){return`${this.ast.type}${this.ast.isOptional?"?":""}`}}function sh(e,t,r=((e,t)=>new i8(e.map(e=>a4(e)?new i4(e.ast,!1):e.ast),t.map(e=>a4(e)?new i3(e.ast):e.ast),!0))(e,t)){return class extends aY(r){static annotations(e){return sh(this.elements,this.rest,a2(this.ast,e))}static elements=[...e];static rest=[...t]}}function sm(...e){return Array.isArray(e[0])?sh(e[0],e.slice(1)):sh(e,[])}let sg=e=>(function e(t,r){return class extends sh([],[t],r){static annotations(t){return e(this.value,a2(this.ast,t))}static value=t}})(e),sy=e=>e?'"?:"':'":"';class sb extends i4{isReadonly;defaultValue;_tag="PropertySignatureDeclaration";constructor(e,t,r,i,n){super(e,t,i),this.isReadonly=r,this.defaultValue=n}toString(){let e=sy(this.isOptional),t=String(this.type);return`PropertySignature<${e}, ${t}, never, ${e}, ${t}>`}}class sS extends i4{isReadonly;fromKey;constructor(e,t,r,i,n){super(e,t,i),this.isReadonly=r,this.fromKey=n}}class sv extends i4{isReadonly;defaultValue;constructor(e,t,r,i,n){super(e,t,i),this.isReadonly=r,this.defaultValue=n}}class sE{from;to;decode;encode;_tag="PropertySignatureTransformation";constructor(e,t,r,i){this.from=e,this.to=t,this.decode=r,this.encode=i}toString(){var e;return`PropertySignature<${sy(this.to.isOptional)}, ${this.to.type}, ${void 0===(e=this.from.fromKey)?"never":aJ.isString(e)?JSON.stringify(e):String(e)}, ${sy(this.from.isOptional)}, ${this.from.type}>`}}let sw=(e,t)=>{switch(e._tag){case"PropertySignatureDeclaration":return new sb(e.type,e.isOptional,e.isReadonly,{...e.annotations,...t},e.defaultValue);case"PropertySignatureTransformation":return new sE(e.from,new sv(e.to.type,e.to.isOptional,e.to.isReadonly,{...e.to.annotations,...t},e.to.defaultValue),e.decode,e.encode)}},s_=Symbol.for("effect/PropertySignature"),sk=e=>aJ.hasProperty(e,s_);class sx{ast;[aQ];[s_]=null;_TypeToken;_Key;_EncodedToken;_HasDefault;constructor(e){this.ast=e}pipe(){return(0,S.pipeArguments)(this,arguments)}annotations(e){return new sx(sw(this.ast,a1(e)))}toString(){return String(this.ast)}}let sC=e=>new sx(e);class sI extends sx{from;constructor(e,t){super(e),this.from=t}annotations(e){return new sI(sw(this.ast,a1(e)),this.from)}}let sT=e=>new sI(new sb(e.ast,!1,!0,{},void 0),e),sR=(0,h.dual)(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":return sC(new sb(r.type,r.isOptional,r.isReadonly,r.annotations,t));case"PropertySignatureTransformation":return sC(new sE(r.from,new sv(r.to.type,r.to.isOptional,r.to.isReadonly,r.to.annotations,t),r.decode,r.encode))}}),sO=(e,t)=>y.match(e,{onNone:()=>y.some(t()),onSome:e=>y.some(void 0===e?t():e)}),sF=e=>((e,t,r)=>{switch(e._tag){case"UndefinedKeyword":return i$;case"Union":{let r=[],i=!1;for(let n of e.types){let e=t(n);e?(i=!0,iB(e)||r.push(e)):r.push(n)}if(i)return nu.make(r);break}case"Suspend":return t(e.f());case"Transformation":return r(e)}})(e,sF,e=>{let t=sF(e.to);if(t)return new ny(e.from,t,e.transformation)}),sM=((e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":{let e=nA(r.type);return sC(new sE(new sS(r.type,r.isOptional,r.isReadonly,r.annotations),new sv(sF(e)??e,!1,!0,{},r.defaultValue),e=>sO(e,t),h.identity))}case"PropertySignatureTransformation":{let e=r.to.type;return sC(new sE(r.from,new sv(sF(e)??e,!1,r.to.isReadonly,r.to.annotations,r.to.defaultValue),e=>sO(r.decode(e),t),r.encode))}}},(e,t,r)=>sC(new sE(new sS(e.ast,!0,!0,{},void 0),new sv(t.ast,!1,!0,{},void 0),e=>y.some(r.decode(e)),y.flatMap(r.encode)))),sA=(e,t,r)=>sC(new sE(new sS(e.ast,!0,!0,{},void 0),new sv(t.ast,!0,!0,{},void 0),r.decode,r.encode)),sN=(0,h.dual)(e=>a4(e[0]),(e,t)=>new sI(((e,t)=>{let r=t?.exact,i=t?.default,n=t?.nullable,a=t?.as=="Option",s=t?.onNoneEncoding?y.orElse(t.onNoneEncoding):h.identity;if(r)if(i)if(n)return sR(sM(sp(e),a6(e),{decode:y.match({onNone:i,onSome:e=>null===e?i():e}),encode:y.some}),i).ast;else return sR(sM(e,a6(e),{decode:y.match({onNone:i,onSome:h.identity}),encode:y.some}),i).ast;else if(a)if(n)return sM(sp(e),oD(a6(e)),{decode:y.filter(aJ.isNotNull),encode:s}).ast;else return sM(e,oD(a6(e)),{decode:h.identity,encode:h.identity}).ast;else if(n)return sA(sp(e),a6(e),{decode:y.filter(aJ.isNotNull),encode:h.identity}).ast;else return new sb(e.ast,!0,!0,{},void 0);if(i)if(n)return sR(sM(sc(e,sr,st),a6(e),{decode:y.match({onNone:i,onSome:e=>null==e?i():e}),encode:y.some}),i).ast;else return sR(sM(sc(e,st),a6(e),{decode:y.match({onNone:i,onSome:e=>void 0===e?i():e}),encode:y.some}),i).ast;if(a)if(n)return sM(sc(e,sr,st),oD(a6(e)),{decode:y.filter(e=>null!=e),encode:s}).ast;else return sM(sc(e,st),oD(a6(e)),{decode:y.filter(aJ.isNotUndefined),encode:s}).ast;if(n)return sA(sc(e,sr,st),sc(a6(e),st),{decode:y.filter(aJ.isNotNull),encode:h.identity}).ast;return new sb(sc(e,st).ast,!0,!0,{},void 0)})(e,t),e)),sP=nF([r4]),sD=(e,t)=>{for(let r of rw(e)){let i=e[r];if(void 0===t[r]&&sk(i)){let e=i.ast,n="PropertySignatureDeclaration"===e._tag?e.defaultValue:e.to.defaultValue;void 0!==n&&(t[r]=n())}}return t};function sL(e,t,r=((e,t)=>{let r=rw(e),i=[];if(r.length>0){let n=[],a=[],s=[];for(let t=0;t<r.length;t++){let o=r[t],l=e[o];if(sk(l)){let e=l.ast;switch(e._tag){case"PropertySignatureDeclaration":{let t=e.type,r=e.isOptional,s=e.annotations;n.push(new i9(o,t,r,!0,sP(e))),a.push(new i9(o,nA(t),r,!0,s)),i.push(new i9(o,t,r,!0,s));break}case"PropertySignatureTransformation":{let t=e.from.fromKey??o;n.push(new i9(t,e.from.type,e.from.isOptional,!0,e.from.annotations)),a.push(new i9(o,e.to.type,e.to.isOptional,!0,e.to.annotations)),s.push(new nE(t,o,e.decode,e.encode))}}}else n.push(new i9(o,l.ast,!1,!0)),a.push(new i9(o,nA(l.ast),!1,!0)),i.push(new i9(o,l.ast,!1,!0))}if(p.isNonEmptyReadonlyArray(s)){let e=[],r=[];for(let i of t){let{indexSignatures:t,propertySignatures:s}=nO(i.key.ast,i.value.ast);s.forEach(e=>{n.push(e),a.push(new i9(e.name,nA(e.type),e.isOptional,e.isReadonly,e.annotations))}),t.forEach(t=>{e.push(t),r.push(new nt(t.parameter,nA(t.type),t.isReadonly))})}return new ny(new nr(n,e,{[r7]:"Struct (Encoded side)"}),new nr(a,r,{[r7]:"Struct (Type side)"}),new nw(s))}}let n=[];for(let e of t){let{indexSignatures:t,propertySignatures:r}=nO(e.key.ast,e.value.ast);r.forEach(e=>i.push(e)),t.forEach(e=>n.push(e))}return new nr(i,n)})(e,t)){return class extends aY(r){static annotations(e){return sL(this.fields,this.records,a2(this.ast,e))}static fields={...e};static records=[...t];static make=(t,r)=>{let i=sD(e,{...t});return oB(r)?i:af(this)(i)};static pick(...t){return sU(aK(e,...t))}static omit(...t){return sU(aZ(e,...t))}}}function sU(e,...t){return sL(e,t)}let sz=(e,t)=>sU({_tag:a5(e).pipe(sT,sR(()=>e)),...t}),sj=(e,t,r)=>{if(na(e)&&na(t)){let i=[...e.propertySignatures];for(let e of t.propertySignatures){let t=e.name,n=i.findIndex(e=>e.name===t);if(-1===n)i.push(e);else{let{isOptional:a,type:s}=i[n];i[n]=new i9(t,s$(s,e.type,r.concat(t)),a,!0)}}return new nr(i,e.indexSignatures.concat(t.indexSignatures))}throw Error(rO(e,t,r))},sW=(t=[r5],e=>{let r={...e.annotations};for(let e of t)delete r[e];return r}),sq=(e,t)=>t.map(t=>new nh(t,e.filter,sW(e))),s$=(e,t,r)=>nu.make(sH([e],[t],r)),sB=e=>np(e)?e.types:[e],sH=(e,t,r)=>p.flatMap(e,e=>p.flatMap(t,t=>{switch(t._tag){case"Literal":if(aJ.isString(t.literal)&&iG(e)||aJ.isNumber(t.literal)&&iZ(e)||aJ.isBoolean(t.literal)&&iY(e))return[t];break;case"StringKeyword":if(t===iJ){if(iG(e)||iU(e)&&aJ.isString(e.literal))return[e];else if(nm(e))return sq(e,sH(sB(e.from),[t],r))}else if(e===iJ)return[t];break;case"NumberKeyword":if(t===iK){if(iZ(e)||iU(e)&&aJ.isNumber(e.literal))return[e];else if(nm(e))return sq(e,sH(sB(e.from),[t],r))}else if(e===iK)return[t];break;case"BooleanKeyword":if(t===iQ){if(iY(e)||iU(e)&&aJ.isBoolean(e.literal))return[e];else if(nm(e))return sq(e,sH(sB(e.from),[t],r))}else if(e===iQ)return[t];break;case"Union":return sH(sB(e),t.types,r);case"Suspend":return[new nd(()=>s$(e,t.f(),r))];case"Refinement":return sq(t,sH(sB(e),sB(t.from),r));case"TypeLiteral":switch(e._tag){case"Union":return sH(e.types,[t],r);case"Suspend":return[new nd(()=>s$(e.f(),t,r))];case"Refinement":return sq(e,sH(sB(e.from),[t],r));case"TypeLiteral":return[sj(e,t,r)];case"Transformation":{let i=e.transformation,n=sj(e.from,t,r),a=sj(e.to,nA(t),r);switch(i._tag){case"TypeLiteralTransformation":return[new ny(n,a,new nw(i.propertySignatureTransformations))];case"ComposeTransformation":return[new ny(n,a,nv)];case"FinalTransformation":return[new ny(n,a,new nS((e,t,r,n)=>ar(i.decode(e,t,r,n),t=>({...e,...t})),(e,t,r,n)=>ar(i.encode(e,t,r,n),t=>({...e,...t}))))]}}}break;case"Transformation":if(!nb(e))return sH([t],[e],r);if("TypeLiteralTransformation"===t.transformation._tag&&"TypeLiteralTransformation"===e.transformation._tag)return[new ny(sj(e.from,t.from,r),sj(e.to,t.to,r),new nw(t.transformation.propertySignatureTransformations.concat(e.transformation.propertySignatureTransformations)))]}throw Error(rO(e,t,r))})),sV=(0,h.dual)(2,(e,t)=>aY(s$(e.ast,t.ast,[]))),sJ=(0,h.dual)(e=>a4(e[1]),(e,t)=>sY(e,t,nH(e.ast,t.ast))),sG=e=>aY(new nd(()=>e().ast)),sK=Symbol.for("effect/SchemaId/Refine"),sZ=(e,t,r)=>{if(aJ.isBoolean(e))return e?y.none():y.some(new n1(t,r));if(aJ.isString(e))return y.some(new n1(t,r,e));if(void 0!==e){if("_tag"in e)return y.some(e);let i=new n1(t,r,e.message);return y.some(p.isNonEmptyReadonlyArray(e.path)?new nK(e.path,r,i):i)}return y.none()};function sQ(e,t){return r=>{function i(t,r,i){var n=e(t,r,i),a=i,s=t;if(!Array.isArray(n))return sZ(n,a,s);if(p.isNonEmptyReadonlyArray(n)){let e=p.filterMap(n,e=>sZ(e,a,s));if(p.isNonEmptyReadonlyArray(e))return y.some(1===e.length?e[0]:new nY(a,s,e))}return y.none()}let n=new nh(r.ast,i,a1(t));return function e(t,r,i){return class extends aY(i){static annotations(t){return e(this.from,this.filter,a2(this.ast,t))}static [sK]=t;static from=t;static filter=r;static make=(e,t)=>oB(t)?e:af(this)(e)}}(r,i,n)}}function sY(e,t,r){return class extends aY(r){static annotations(e){return sY(this.from,this.to,a2(this.ast,e))}static from=e;static to=t}}let sX=(0,h.dual)(e=>a4(e[0])&&a4(e[1]),(e,t,r)=>sY(e,t,new ny(e.ast,t.ast,new nS(r.decode,r.encode)))),s0=(0,h.dual)(e=>a4(e[0])&&a4(e[1]),(e,t,r)=>sX(e,t,{strict:!0,decode:(e,t,i,n)=>n5(r.decode(e,n)),encode:(e,t,i,n)=>n5(r.encode(e,n))})),s1=Symbol.for("effect/SchemaId/Trimmed"),s2=e=>t=>t.pipe(sQ(e=>e===e.trim(),{schemaId:s1,title:"trimmed",description:"a string with no leading or trailing whitespace",jsonSchema:{pattern:"^\\S[\\s\\S]*\\S$|^\\S$|^$"},...e})),s6=Symbol.for("effect/SchemaId/Pattern"),s3=Symbol.for("effect/SchemaId/StartsWith"),s4=Symbol.for("effect/SchemaId/Lowercased"),s5=e=>t=>t.pipe(sQ(e=>e===e.toLowerCase(),{schemaId:s4,title:"lowercased",description:"a lowercase string",jsonSchema:{pattern:"^[^A-Z]*$"},...e})),s8=Symbol.for("effect/SchemaId/Uppercased"),s7=e=>t=>t.pipe(sQ(e=>e===e.toUpperCase(),{schemaId:s8,title:"uppercased",description:"an uppercase string",jsonSchema:{pattern:"^[^a-z]*$"},...e})),s9=Symbol.for("effect/SchemaId/Capitalized"),oe=e=>t=>t.pipe(sQ(e=>e[0]?.toUpperCase()===e[0],{schemaId:s9,title:"capitalized",description:"a capitalized string",jsonSchema:{pattern:"^[^a-z]?.*$"},...e})),ot=Symbol.for("effect/SchemaId/Uncapitalized"),or=e=>t=>t.pipe(sQ(e=>e[0]?.toLowerCase()===e[0],{schemaId:ot,title:"uncapitalized",description:"a uncapitalized string",jsonSchema:{pattern:"^[^A-Z]?.*$"},...e})),oi=e=>{let t;return t={title:"nonEmptyString",description:"a non empty string",...e},e=>e.pipe(sQ(e=>e.length>=1,{schemaId:rK,title:"minLength(1)",description:"a string at least 1 character(s) long",jsonSchema:{minLength:1},...t}))};class on extends so.pipe(s2({identifier:"Trimmed"})){}let oa=e=>e instanceof Error?e.message:String(e),os=(e,t)=>a4(e)?sJ(os(t),e):sX(so.annotations({description:"a string to be decoded into JSON"}),sn,{strict:!0,decode:(t,r,i)=>n7({try:()=>JSON.parse(t,e?.reviver),catch:e=>new n1(i,t,oa(e))}),encode:(t,r,i)=>n7({try:()=>JSON.stringify(t,e?.replacer,e?.space),catch:e=>new n1(i,t,oa(e))})}).annotations({title:"parseJson",schemaId:iN});/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.source,URL;let oo=e=>t=>t.pipe(sQ(e=>Number.isSafeInteger(e),{schemaId:rq,title:"int",description:"an integer",jsonSchema:{type:"integer"},...e})),ol=(e,t,r)=>i=>i.pipe(sQ(r=>r>=e&&r<=t,{schemaId:rV,title:`between(${e}, ${t})`,description:`a number between ${e} and ${t}`,jsonSchema:{minimum:e,maximum:t},...r})),ou=e=>{let t;return t={title:"nonNegative",...e},e=>e.pipe(sQ(e=>e>=0,{schemaId:rz,title:"greaterThanOrEqualTo(0)",description:"a non-negative number",jsonSchema:{minimum:0},...t}))};class oc extends sl.pipe(oo({identifier:"Int"})){}class op extends sl.pipe(ou({identifier:"NonNegative"})){}class of extends sX(so.annotations({description:"a string to be decoded into a bigint"}),sa,{strict:!0,decode:(e,t,r)=>n9(V(e),()=>new n1(r,e,`Unable to decode ${JSON.stringify(e)} into a bigint`)),encode:e=>n5(String(e))}).annotations({identifier:"BigInt"}){}r={title:"nonNegativeBigInt",identifier:"NonNegativeBigintFromSelf"},e=>e.pipe(sQ(e=>e>=0n,{schemaId:rJ,[rJ]:{min:0n},title:`greaterThanOrEqualToBigInt(${0n})`,description:0n===0n?"a non-negative bigint":`a bigint greater than or equal to ${0n}n`,...r}));let od=e=>t=>e(t).map(aG.make),oh=(e,t,r,i)=>an(e,{onFailure:e=>new nY(r,i,e),onSuccess:t}),om=e=>(t,r,i)=>aG.isRedacted(t)?oh(e(aG.value(t),r),aG.make,i,t):n8(new n1(i,t));function og(e){return s0(e,a7([a6(e)],{decode:e=>om(ac(e)),encode:e=>om(ap(e))},{description:"Redacted(<redacted>)",pretty:()=>()=>"Redacted(<redacted>)",arbitrary:od,equivalence:aG.getEquivalence}),{strict:!0,decode:e=>aG.make(e),encode:e=>aG.value(e)})}ep.isDuration;let oy=op.pipe(oo()).annotations({identifier:"NonNegativeInt"}),ob=sz("Millis",{millis:oy}),oS=sz("Nanos",{nanos:of}),ov=sz("Infinity",{}),oE=sm(sf(oy).annotations({title:"seconds"}),sf(oy).annotations({title:"nanos"})).annotations({identifier:"FiniteHRTime"});class ow extends a7(aJ.isUint8Array,{identifier:"Uint8ArrayFromSelf",pretty:()=>e=>`new Uint8Array(${JSON.stringify(Array.from(e))})`,arbitrary:()=>e=>e.uint8Array(),equivalence:()=>p.getEquivalence(eh.equals)}){}let o_=(i=ed.decodeBase64,n=ed.encodeBase64,sX(so.annotations({description:"a string to be decoded into a Uint8Array"}),ow,{strict:!0,decode:(e,t,r)=>ef.mapLeft(i(e),t=>new n1(r,e,t.message)),encode:e=>n5(n(e))}).annotations({identifier:"Uint8ArrayFromBase64"}));ed.decodeBase64Url,ed.encodeBase64Url,ed.decodeHex,ed.encodeHex,ed.decodeBase64String,ed.encodeBase64,ed.decodeBase64UrlString,ed.encodeBase64Url,ed.decodeHexString,ed.encodeHex;let ok=Symbol.for("effect/SchemaId/ValidDate"),ox=rL;class oC extends a7(aJ.isDate,{identifier:"DateFromSelf",schemaId:ox,[ox]:{noInvalidDate:!1},description:"a potentially invalid Date instance",pretty:()=>e=>`new Date(${JSON.stringify(e)})`,arbitrary:()=>e=>e.date({noInvalidDate:!1}),equivalence:()=>em.Date}){}e=>ee(e)&&ei(e);let oI=()=>e=>e.integer({min:-432e5,max:504e5}).map(ec);class oT extends a7(et,{identifier:"TimeZoneOffsetFromSelf",description:"a TimeZone.Offset instance",pretty:()=>e=>e.toString(),arbitrary:oI}){}let oR=()=>e=>e.constantFrom(...Intl.supportedValuesOf("timeZone")).map(eu);class oO extends a7(er,{identifier:"TimeZoneNamedFromSelf",description:"a TimeZone.Named instance",pretty:()=>e=>e.toString(),arbitrary:oR}){}let oF=e=>e.oneof(oI()(e),oR()(e));e=>ee(e)&&en(e);let oM=e=>"None"===e._tag?y.none():y.some(e.value),oA=(e,t)=>r=>r.oneof(t,r.record({_tag:r.constant("None")}),r.record({_tag:r.constant("Some"),value:e(r)})).map(oM),oN=e=>y.match({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),oP=e=>(t,r,i)=>y.isOption(t)?y.isNone(t)?n5(y.none()):oh(e(t.value,r),y.some,i,t):n8(new n1(i,t)),oD=e=>a7([e],{decode:e=>oP(ac(e)),encode:e=>oP(ap(e))},{description:`Option<${String(e.ast)}>`,pretty:oN,arbitrary:oA,equivalence:y.getEquivalence}),oL=()=>e=>`BigDecimal(${z(O(e))})`,oU=()=>e=>e.tuple(e.bigInt(),e.integer({min:0,max:18})).map(([e,t])=>k(e,t)),oz=e=>rw(e).every(t=>{let r;return a4(r=e[t])||sk(r)}),oj=e=>"fields"in e?e.fields:oj(e[sK]),oW=e=>oz(e)?sU(e):a4(e)?e:sU(oj(e)),oq=e=>oz(e)?e:oj(e),o$=(e,t)=>{let r={...e};for(let i of rw(t)){if(i in e)throw Error(rD(i));r[i]=t[i]}return r};function oB(e){return aJ.isBoolean(e)?e:e?.disableValidation??!1}let oH=(0,rS.globalValue)("effect/Schema/astCache",()=>new WeakMap),oV=({Base:e,annotations:t,disableToString:r,fields:i,identifier:n,kind:a,schema:s})=>{let o=Symbol.for(`effect/Schema/${a}/${n}`),[l,u,c]=void 0===t?[]:Array.isArray(t)?t:[t],p=a6(s),f=p.annotations({identifier:n,...l}),d=p.annotations({[r7]:`${n} (Type side)`,...l}),m=s.annotations({[r7]:`${n} (Constructor)`,...l}),g=s.annotations({[r7]:`${n} (Encoded side)`,...c}),y=s.annotations({[iM]:n,...c,...l,...u}),b=class extends e{constructor(e={},t=!1){e={...e},"Class"!==a&&delete e._tag,e=sD(i,e),oB(t)||(e=af(m)(e)),super(e,!0)}static [aQ]=aX;static get ast(){let e=oH.get(this);return e||(e=s0(g,a7([s],{decode:()=>(e,t,r)=>e instanceof this||aJ.hasProperty(e,o)&&ad(d)(e)?n5(e):n8(new n1(r,e)),encode:()=>(e,t)=>e instanceof this?n5(e):ar(ap(d)(e,t),e=>new this(e,!0))},{identifier:n,pretty:e=>t=>`${n}(${e(t)})`,arbitrary:e=>t=>e(t).map(e=>new this(e)),equivalence:h.identity,[ih]:f.ast,...l}),{strict:!0,decode:e=>new this(e,!0),encode:h.identity}).annotations({[ih]:y.ast,...u}).ast,oH.set(this,e)),e}static pipe(){return(0,S.pipeArguments)(this,arguments)}static annotations(e){return aY(this.ast).annotations(e)}static toString(){return`(${String(g)} <-> ${n})`}static make(...e){return new this(...e)}static fields={...i};static identifier=n;static extend(e){return(t,r)=>{let n=oq(t),o=oW(t),l=o$(i,n);return oV({kind:a,identifier:e,schema:sV(s,o),fields:l,Base:this,annotations:r})}}static transformOrFail(e){return(t,r,n)=>{let o=o$(i,t);return oV({kind:a,identifier:e,schema:sX(s,a6(sU(o)),r),fields:o,Base:this,annotations:n})}}static transformOrFailFrom(e){return(t,r,n)=>{let o=o$(i,t);return oV({kind:a,identifier:e,schema:sX(aY(nU(s.ast)),sU(o),r),fields:o,Base:this,annotations:n})}}get[o](){return o}};return!0!==r&&Object.defineProperty(b.prototype,"toString",{value(){return`${n}({ ${rw(i).map(e=>`${rC(e)}: ${rx(this[e])}`).join(", ")} })`},configurable:!0,writable:!0}),b},oJ=sc(sU({_tag:a5("None")}).annotations({identifier:"FiberIdNoneEncoded"}),sU({_tag:a5("Runtime"),id:oc,startTimeMillis:oc}).annotations({identifier:"FiberIdRuntimeEncoded"}),sU({_tag:a5("Composite"),left:sG(()=>oJ),right:sG(()=>oJ)}).annotations({identifier:"FiberIdCompositeEncoded"})).annotations({identifier:"FiberIdEncoded"}),oG=e=>e.letrec(t=>({None:e.record({_tag:e.constant("None")}),Runtime:e.record({_tag:e.constant("Runtime"),id:e.integer(),startTimeMillis:e.integer()}),Composite:e.record({_tag:e.constant("Composite"),left:t("FiberId"),right:t("FiberId")}),FiberId:e.oneof(t("None"),t("Runtime"),t("Composite"))})).FiberId.map(oZ),oK=e=>{switch(e._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${e.id}, ${e.startTimeMillis})`;case"Composite":return`FiberId.composite(${oK(e.right)}, ${oK(e.left)})`}};rb.isFiberId;let oZ=e=>{switch(e._tag){case"None":return rb.none;case"Runtime":return rb.runtime(e.id,e.startTimeMillis);case"Composite":return rb.composite(oZ(e.left),oZ(e.right))}},oQ=sU({_tag:a5("Empty")}),oY=sU({_tag:a5("Interrupt"),fiberId:oJ});class oX extends s0(sn,sn,{strict:!0,decode:e=>{if(aJ.isObject(e)&&"message"in e&&"string"==typeof e.message){let t=Error(e.message,{cause:e});return"name"in e&&"string"==typeof e.name&&(t.name=e.name),t.stack="stack"in e&&"string"==typeof e.stack?e.stack:"",t}return String(e)},encode:e=>e instanceof Error?{name:e.name,message:e.message}:rv.prettyErrorMessage(e)}).annotations({identifier:"Defect"}){}let o0=Symbol.for("effect/Schema/Serializable/symbolResult"),o1=(0,rS.globalValue)("effect/Schema/Serializable/exitSchemaCache",()=>new WeakMap),o2=sz("symbol",{key:so}).annotations({description:"an object to be decoded into a globally shared symbol"}),o6=sX(o2,ss,{strict:!0,decode:e=>n5(Symbol.for(e.key)),encode:(e,t,r)=>{var i,n;let a;return ar((i=e,n=r,void 0===(a=Symbol.keyFor(i))?n8(new n1(n,i,`Unable to encode a unique symbol ${String(i)} into a string`)):n5(a)),e=>o2.make({key:e}))}});e.s(["Array",()=>sg,"Boolean",()=>su,"Class",0,e=>(t,r)=>oV({kind:"Class",identifier:e,schema:oW(t),fields:oq(t),Base:Z.Class,annotations:r}),"Config",0,(e,t)=>{let r=au(t);return G.string(e).pipe(G.mapOrFail(e=>r(e).pipe(ef.mapLeft(e=>K.InvalidData([],aR.formatIssueSync(e))))))},"Defect",()=>oX,"Literal",()=>a5,"NonEmptyArray",0,e=>(function e(t,r){return class extends sh([t],[t],r){static annotations(t){return e(this.value,a2(this.ast,t))}static value=t}})(e),"NullOr",0,sp,"Number",()=>sl,"Record",0,e=>(function e(t,r,i){return class extends sL({},[{key:t,value:r}],i){static annotations(i){return e(t,r,a2(this.ast,i))}static key=t;static value=r}})(e.key,e.value),"Redacted",()=>og,"String",()=>so,"Struct",()=>sU,"TaggedError",0,e=>(t,r,i)=>{class n extends Z.Error{}n.prototype.name=t;let a=oq(r),s=oW(r),o={_tag:sR(sT(a5(t)),()=>t)},l=o$(o,a),u="message"in l;class c extends oV({kind:"TaggedError",identifier:e??t,schema:sV(s,sU(o)),fields:l,Base:n,annotations:i,disableToString:!0}){static _tag=t}return u||Object.defineProperty(c.prototype,"message",{get(){return`{ ${rw(a).map(e=>`${rC(e)}: ${rx(this[e])}`).join(", ")} }`},enumerable:!1,configurable:!0}),c},"Tuple",()=>sm,"Uint8ArrayFromBase64",0,o_,"Uint8ArrayFromSelf",()=>ow,"Union",()=>sc,"Unknown",()=>sn,"compose",0,sJ,"declare",0,a7,"decodeUnknown",0,a3,"decodeUnknownPromise",0,(e,t)=>{let r=a3(e,t);return(e,t)=>Y.runPromise(r(e,t))},"encode",0,(e,t)=>{let r=ap(e,t);return(e,t)=>ai(r(e,t),n4)},"isSchema",0,a4,"itemsCount",0,(e,t)=>r=>{let i=Math.floor(e);if(i<0)throw Error(rR("Invalid Argument",`Expected an integer greater than or equal to 0, actual ${e}`));return r.pipe(sQ(e=>e.length===i,{schemaId:rQ,title:`itemsCount(${i})`,description:`an array of exactly ${i} item(s)`,jsonSchema:{minItems:i,maxItems:i},[im]:!0,...t}))},"optional",0,e=>new sI(new sb(e.ast===iq||e.ast===i$?iq:sc(e,st).ast,!0,!0,{},void 0),e),"optionalWith",0,sN,"parseJson",0,os,"startsWith",0,(e,t)=>r=>{let i=JSON.stringify(e);return r.pipe(sQ(t=>t.startsWith(e),{schemaId:s3,[s3]:{startsWith:e},title:`startsWith(${i})`,description:`a string starting with ${i}`,jsonSchema:{pattern:`^${e}`},...t}))},"transform",0,s0],411237)},658079,e=>e.a(async(t,r)=>{try{var i=e.i(244795),n=e.i(411237),a=t([i]);[i]=a.then?(await a)():a,n.Literal(...i.ValidContentDispositions),n.Literal(...i.ValidACLs);let d=n.Literal("upload"),h=n.Literal("callback","error"),m=n.transform(n.Uint8ArrayFromSelf,n.String,{decode:e=>new TextDecoder().decode(e),encode:e=>new TextEncoder().encode(e)}),g=n.Struct({apiKey:n.Redacted(n.String.pipe(n.startsWith("sk_"))),appId:n.String,regions:n.NonEmptyArray(n.String),ingestHost:n.String.pipe(n.optionalWith({default:()=>"ingest.uploadthing.com"}))}),y=n.Uint8ArrayFromBase64.pipe(n.compose(m),n.compose(n.parseJson(g)));var s=class extends n.Class("FileUploadData")({name:n.String,size:n.Number,type:n.String,lastModified:n.Number.pipe(n.optional)}){},o=class extends s.extend("FileUploadDataWithCustomId")({customId:n.NullOr(n.String)}){},l=class extends o.extend("UploadedFileData")({key:n.String,url:n.String,appUrl:n.String,ufsUrl:n.String,fileHash:n.String}){},u=class extends n.Class("MetadataFetchStreamPart")({payload:n.String,signature:n.String,hook:h}){},c=class extends n.Class("MetadataFetchResponse")({ok:n.Boolean}){},p=class extends n.Class("CallbackResultResponse")({ok:n.Boolean}){},f=class extends n.Class("UploadActionPayload")({files:n.Array(s),input:n.Unknown}){};e.s(["ActionType",()=>d,"CallbackResultResponse",()=>p,"MetadataFetchResponse",()=>c,"MetadataFetchStreamPart",()=>u,"UploadActionPayload",()=>f,"UploadThingHook",()=>h,"UploadThingToken",()=>y,"UploadedFileData",()=>l]),r()}catch(e){r(e)}},!1),847279,e=>{"use strict";var t=e.i(741840);let r=t.unsafeFork;t.unsafeRunSyncExit,t.unsafeRunSync,t.unsafeRunCallback,t.unsafeRunPromise;let i=t.unsafeRunPromiseExit,n=t.defaultRuntime;t.defaultRuntimeFlags;let a=t.make,s=t.FiberFailureCauseId;t.isAsyncFiberException,t.isFiberFailure,t.fiberFailure,t.updateRuntimeFlags,t.enableRuntimeFlag,t.disableRuntimeFlag,t.updateContext,t.provideService,t.updateFiberRefs,t.setFiberRef,t.deleteFiberRef,e.s(["FiberFailureCauseId",0,s,"defaultRuntime",0,n,"make",0,a,"runFork",0,r,"runPromiseExit",0,i])},169228,e=>{"use strict";var t=e.i(580611),r=e.i(276406),i=e.i(162098),n=e.i(803327);t.FiberRefTypeId,r.fiberRefMake,r.fiberRefMakeWith,r.fiberRefMakeContext,r.fiberRefMakeRuntimeFlags;let a=t.fiberRefUnsafeMake;t.fiberRefUnsafeMakeHashSet,t.fiberRefUnsafeMakeContext,r.fiberRefUnsafeMakeSupervisor,t.fiberRefUnsafeMakePatch;let s=t.fiberRefGet;t.fiberRefGetAndSet,t.fiberRefGetAndUpdate,t.fiberRefGetAndUpdateSome;let o=t.fiberRefGetWith,l=t.fiberRefSet;t.fiberRefDelete,t.fiberRefReset,t.fiberRefModify,t.fiberRefModifySome;let u=t.fiberRefUpdate;t.fiberRefUpdateSome,t.fiberRefUpdateAndGet,t.fiberRefUpdateSomeAndGet,t.currentConcurrency,t.currentRequestBatching,i.currentCache,i.currentCacheEnabled;let c=t.currentContext,p=t.currentSchedulingPriority;t.currentMaxOpsBeforeYield,t.currentUnhandledErrorLogLevel,t.currentVersionMismatchErrorLogLevel,t.currentLogAnnotations,r.currentLoggers,t.currentLogLevel,r.currentMinimumLogLevel,t.currentLogSpan,r.currentRuntimeFlags;let f=n.currentScheduler;r.currentSupervisor,t.currentMetricLabels;let d=t.currentTracerEnabled,h=t.currentTracerTimingEnabled;t.currentTracerSpanAnnotations,t.currentTracerSpanLinks,t.currentInterruptedCause,e.s(["currentContext",0,c,"currentScheduler",0,f,"currentSchedulingPriority",0,p,"currentTracerEnabled",0,d,"currentTracerTimingEnabled",0,h,"get",0,s,"getWith",0,o,"set",0,l,"unsafeMake",0,a,"update",0,u])},724880,604234,174073,565005,56786,954277,65463,e=>{"use strict";var t=e.i(710284),r=e.i(526886),i=e.i(385510),n=e.i(405614),a=e.i(680465),s=e.i(368171),o=e.i(842862),l=e.i(65632),u=e.i(787039),c=e.i(100808),p=e.i(435146),f=a,d=e.i(659809),h=e.i(727606),m=e.i(580611),g=e.i(276406);let y=Symbol.for("effect/QueueEnqueue"),b=Symbol.for("effect/QueueDequeue"),S=Symbol.for("effect/QueueStrategy"),v=Symbol.for("effect/BackingQueue"),E={_A:e=>e},w={_A:e=>e},_={_In:e=>e},k={_Out:e=>e};class x extends f.Class{queue;takers;shutdownHook;shutdownFlag;strategy;[y]=_;[b]=k;constructor(e,t,r,i,n){super(),this.queue=e,this.takers=t,this.shutdownHook=r,this.shutdownFlag=i,this.strategy=n}pipe(){return(0,u.pipeArguments)(this,arguments)}commit(){return this.take}capacity(){return this.queue.capacity()}get size(){return m.suspend(()=>m.catchAll(this.unsafeSize(),()=>m.interrupt))}unsafeSize(){return h.get(this.shutdownFlag)?l.none():l.some(this.queue.length()-d.length(this.takers)+this.strategy.surplusSize())}get isEmpty(){return m.map(this.size,e=>e<=0)}get isFull(){return m.map(this.size,e=>e>=this.capacity())}get shutdown(){return m.uninterruptible(m.withFiberRuntime(e=>((0,o.pipe)(this.shutdownFlag,h.set(!0)),(0,o.pipe)(g.forEachConcurrentDiscard(q(this.takers),t=>m.deferredInterruptWith(t,e.id()),!1,!1),m.zipRight(this.strategy.shutdown),m.whenEffect(m.deferredSucceed(this.shutdownHook,void 0)),m.asVoid))))}get isShutdown(){return m.sync(()=>h.get(this.shutdownFlag))}get awaitShutdown(){return m.deferredAwait(this.shutdownHook)}isActive(){return!h.get(this.shutdownFlag)}unsafeOffer(e){let t;if(h.get(this.shutdownFlag))return!1;if(0===this.queue.length()){let r=(0,o.pipe)(this.takers,d.poll(d.EmptyMutableQueue));r!==d.EmptyMutableQueue?(j(r,e),t=!0):t=!1}else t=!1;if(t)return!0;let r=this.queue.offer(e);return H(this.strategy,this.queue,this.takers),r}offer(e){return m.suspend(()=>{let t;if(h.get(this.shutdownFlag))return m.interrupt;if(0===this.queue.length()){let r=(0,o.pipe)(this.takers,d.poll(d.EmptyMutableQueue));r!==d.EmptyMutableQueue?(j(r,e),t=!0):t=!1}else t=!1;if(t)return m.succeed(!0);let r=this.queue.offer(e);return H(this.strategy,this.queue,this.takers),r?m.succeed(!0):this.strategy.handleSurplus([e],this.queue,this.takers,this.shutdownFlag)})}offerAll(e){return m.suspend(()=>{if(h.get(this.shutdownFlag))return m.interrupt;let t=p.fromIterable(e),i=0===this.queue.length()?p.fromIterable($(this.takers,t.length)):p.empty,[n,a]=(0,o.pipe)(t,p.splitAt(i.length));for(let e=0;e<i.length;e++)j(i[e],n[e]);if(0===a.length)return m.succeed(!0);let s=this.queue.offerAll(a);return H(this.strategy,this.queue,this.takers),r.isEmpty(s)?m.succeed(!0):this.strategy.handleSurplus(s,this.queue,this.takers,this.shutdownFlag)})}get take(){return m.withFiberRuntime(e=>{if(h.get(this.shutdownFlag))return m.interrupt;let t=this.queue.poll(d.EmptyMutableQueue);if(t!==d.EmptyMutableQueue)return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),m.succeed(t);{let t=m.deferredUnsafeMake(e.id());return(0,o.pipe)(m.suspend(()=>((0,o.pipe)(this.takers,d.offer(t)),H(this.strategy,this.queue,this.takers),h.get(this.shutdownFlag)?m.interrupt:m.deferredAwait(t))),m.onInterrupt(()=>m.sync(()=>B(this.takers,t))))}})}get takeAll(){return m.suspend(()=>h.get(this.shutdownFlag)?m.interrupt:m.sync(()=>{let e=this.queue.pollUpTo(1/0);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),r.fromIterable(e)}))}takeUpTo(e){return m.suspend(()=>h.get(this.shutdownFlag)?m.interrupt:m.sync(()=>{let t=this.queue.pollUpTo(e);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),r.fromIterable(t)}))}takeBetween(e,t){return m.suspend(()=>C(this,e,t,r.empty()))}}let C=(e,t,i,n)=>i<t?m.succeed(n):(0,o.pipe)(A(e,i),m.flatMap(a=>{let s=t-a.length;return 1===s?(0,o.pipe)(M(e),m.map(e=>(0,o.pipe)(n,r.appendAll(a),r.append(e)))):s>1?(0,o.pipe)(M(e),m.flatMap(t=>C(e,s-1,i-a.length-1,(0,o.pipe)(n,r.appendAll(a),r.append(t))))):m.succeed((0,o.pipe)(n,r.appendAll(a)))})),I=(e,t)=>(0,o.pipe)(m.deferredMake(),m.map(r=>{let i;return i=d.unbounded(),new x(e,i,r,h.make(!1),t)}));class T{mutable;[v]=w;constructor(e){this.mutable=e}poll(e){return d.poll(this.mutable,e)}pollUpTo(e){return d.pollUpTo(this.mutable,e)}offerAll(e){return d.offerAll(this.mutable,e)}offer(e){return d.offer(this.mutable,e)}capacity(){return d.capacity(this.mutable)}length(){return d.length(this.mutable)}}let R=e=>new T(e),O=(0,o.dual)(2,(e,t)=>e.offer(t)),F=(0,o.dual)(2,(e,t)=>e.offerAll(t)),M=e=>e.take,A=(0,o.dual)(2,(e,t)=>e.takeUpTo(t)),N=(0,o.dual)(3,(e,t,r)=>e.takeBetween(t,r)),P=(0,o.dual)(2,(e,t)=>e.takeBetween(t,t)),D=()=>new U;class L{[S]=E;putters=d.unbounded();surplusSize(){return d.length(this.putters)}onCompleteTakersWithEmptyQueue(e){for(;!d.isEmpty(this.putters)&&!d.isEmpty(e);){let t=d.poll(e,void 0),r=d.poll(this.putters,void 0);r[2]&&j(r[1],!0),j(t,r[0])}}get shutdown(){return(0,o.pipe)(m.fiberId,m.flatMap(e=>(0,o.pipe)(m.sync(()=>q(this.putters)),m.flatMap(t=>g.forEachConcurrentDiscard(t,([t,r,i])=>i?(0,o.pipe)(m.deferredInterruptWith(r,e),m.asVoid):m.void,!1,!1)))))}handleSurplus(e,t,r,i){return m.withFiberRuntime(n=>{let a=m.deferredUnsafeMake(n.id());return(0,o.pipe)(m.suspend(()=>(this.unsafeOffer(e,a),this.unsafeOnQueueEmptySpace(t,r),H(this,t,r),h.get(i)?m.interrupt:m.deferredAwait(a))),m.onInterrupt(()=>m.sync(()=>this.unsafeRemove(a))))})}unsafeOnQueueEmptySpace(e,t){let i=!0;for(;i&&(e.capacity()===1/0||e.length()<e.capacity());){let n=(0,o.pipe)(this.putters,d.poll(d.EmptyMutableQueue));if(n===d.EmptyMutableQueue)i=!1;else{let i=e.offer(n[0]);i&&n[2]?j(n[1],!0):i||W(this.putters,(0,o.pipe)(q(this.putters),r.prepend(n))),H(this,e,t)}}}unsafeOffer(e,t){let r=p.fromIterable(e);for(let e=0;e<r.length;e++){let i=r[e];e===r.length-1?(0,o.pipe)(this.putters,d.offer([i,t,!0])):(0,o.pipe)(this.putters,d.offer([i,t,!1]))}}unsafeRemove(e){W(this.putters,(0,o.pipe)(q(this.putters),r.filter(([,t])=>t!==e)))}}class U{[S]=E;surplusSize(){return 0}get shutdown(){return m.void}onCompleteTakersWithEmptyQueue(){}handleSurplus(e,t,r,i){return m.succeed(!1)}unsafeOnQueueEmptySpace(e,t){}}class z{[S]=E;surplusSize(){return 0}get shutdown(){return m.void}onCompleteTakersWithEmptyQueue(){}handleSurplus(e,t,r,i){return m.sync(()=>(this.unsafeOffer(t,e),H(this,t,r),!0))}unsafeOnQueueEmptySpace(e,t){}unsafeOffer(e,t){let r,i=t[Symbol.iterator](),n=!0;for(;!(r=i.next()).done&&n;){if(0===e.capacity())return;e.poll(d.EmptyMutableQueue),n=e.offer(r.value)}}}let j=(e,t)=>m.deferredUnsafeDone(e,m.succeed(t)),W=(e,t)=>(0,o.pipe)(e,d.offerAll(t)),q=e=>(0,o.pipe)(e,d.pollUpTo(1/0)),$=(e,t)=>(0,o.pipe)(e,d.pollUpTo(t)),B=(e,t)=>{W(e,(0,o.pipe)(q(e),r.filter(e=>t!==e)))},H=(e,t,i)=>{let n=!0;for(;n&&0!==t.length();){let a=(0,o.pipe)(i,d.poll(d.EmptyMutableQueue));if(a!==d.EmptyMutableQueue){let s=t.poll(d.EmptyMutableQueue);s!==d.EmptyMutableQueue?(j(a,s),e.unsafeOnQueueEmptySpace(t,i)):W(i,(0,o.pipe)(q(i),r.prepend(a))),n=!0}else n=!1}n&&0===t.length()&&!d.isEmpty(i)&&e.onCompleteTakersWithEmptyQueue(i)},V=e=>(0,o.pipe)(m.sync(()=>d.bounded(e)),m.flatMap(e=>I(R(e),new L))),J=e=>(0,o.pipe)(m.sync(()=>d.bounded(e)),m.flatMap(e=>I(R(e),D()))),G=e=>(0,o.pipe)(m.sync(()=>d.bounded(e)),m.flatMap(e=>I(R(e),new z))),K=()=>(0,o.pipe)(m.sync(()=>d.unbounded()),m.flatMap(e=>I(R(e),D()))),Z=e=>e.shutdown;var Q=e.i(374536),Y=e.i(625552),X=e.i(777865),ee=e.i(964665),et=e.i(945831),er=e.i(165039),ei=e.i(169228),en=e.i(347064),ea=a,es=e.i(931499),eo=e.i(213979);let el=Symbol.for("effect/PubSub/AbsentValue"),eu=(e,t)=>r=>{r.has(e)||r.set(e,new Set),r.get(e).add(t)},ec=(e,t)=>r=>{if(!r.has(e))return;let i=r.get(e);i.delete(t),0===i.size&&r.delete(e)},ep=e=>{let t="number"==typeof e?{capacity:e}:e;ex(t.capacity);let r=t.replay&&t.replay>0?new eU(Math.ceil(t.replay)):void 0;return 1===t.capacity?new eg(r):(0,es.nextPow2)(t.capacity)===t.capacity?new eh(t.capacity,r):new ef(t.capacity,r)};class ef{capacity;replayBuffer;array;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(e,t){this.capacity=e,this.replayBuffer=t,this.array=Array.from({length:e}),this.subscribers=Array.from({length:e})}replayWindow(){return this.replayBuffer?new ez(this.replayBuffer):ej}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(e){if(this.isFull())return!1;if(0!==this.subscriberCount){let t=this.publisherIndex%this.capacity;this.array[t]=e,this.subscribers[t]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),r.empty();let t=r.fromIterable(e),i=t.length,n=this.publisherIndex-this.subscribersIndex,a=Math.min(i,this.capacity-n);if(0===a)return t;let s=0,o=this.publisherIndex+a;for(;this.publisherIndex!==o;){let e=r.unsafeGet(t,s++),i=this.publisherIndex%this.capacity;this.array[i]=e,this.subscribers[i]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(e)}return r.drop(t,s)}slide(){if(this.subscribersIndex!==this.publisherIndex){let e=this.subscribersIndex%this.capacity;this.array[e]=el,this.subscribers[e]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new ed(this,this.publisherIndex,!1)}}class ed{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let e=this.subscriberIndex%this.self.capacity,t=this.self.array[e];return this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=el,this.self.subscribersIndex+=1),this.subscriberIndex+=1,t}return e}pollUpTo(e){if(this.unsubscribed)return r.empty();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let t=Math.min(e,this.self.publisherIndex-this.subscriberIndex);if(t<=0)return r.empty();let i=[],n=this.subscriberIndex+t;for(;this.subscriberIndex!==n;){let e=this.subscriberIndex%this.self.capacity,t=this.self.array[e];this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=el,this.self.subscribersIndex+=1),i.push(t),this.subscriberIndex+=1}return r.fromIterable(i)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let e=this.subscriberIndex%this.self.capacity;this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=el,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class eh{capacity;replayBuffer;array;mask;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(e,t){this.capacity=e,this.replayBuffer=t,this.array=Array.from({length:e}),this.mask=e-1,this.subscribers=Array.from({length:e})}replayWindow(){return this.replayBuffer?new ez(this.replayBuffer):ej}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(e){if(this.isFull())return!1;if(0!==this.subscriberCount){let t=this.publisherIndex&this.mask;this.array[t]=e,this.subscribers[t]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),r.empty();let t=r.fromIterable(e),i=t.length,n=this.publisherIndex-this.subscribersIndex,a=Math.min(i,this.capacity-n);if(0===a)return t;let s=0,o=this.publisherIndex+a;for(;this.publisherIndex!==o;){let e=r.unsafeGet(t,s++),i=this.publisherIndex&this.mask;this.array[i]=e,this.subscribers[i]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(e)}return r.drop(t,s)}slide(){if(this.subscribersIndex!==this.publisherIndex){let e=this.subscribersIndex&this.mask;this.array[e]=el,this.subscribers[e]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new em(this,this.publisherIndex,!1)}}class em{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let e=this.subscriberIndex&this.self.mask,t=this.self.array[e];return this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=el,this.self.subscribersIndex+=1),this.subscriberIndex+=1,t}return e}pollUpTo(e){if(this.unsubscribed)return r.empty();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let t=Math.min(e,this.self.publisherIndex-this.subscriberIndex);if(t<=0)return r.empty();let i=[],n=this.subscriberIndex+t;for(;this.subscriberIndex!==n;){let e=this.subscriberIndex&this.self.mask,t=this.self.array[e];this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=el,this.self.subscribersIndex+=1),i.push(t),this.subscriberIndex+=1}return r.fromIterable(i)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let e=this.subscriberIndex&this.self.mask;this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=el,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class eg{replayBuffer;publisherIndex=0;subscriberCount=0;subscribers=0;value=el;capacity=1;constructor(e){this.replayBuffer=e}replayWindow(){return this.replayBuffer?new ez(this.replayBuffer):ej}pipe(){return(0,u.pipeArguments)(this,arguments)}isEmpty(){return 0===this.subscribers}isFull(){return!this.isEmpty()}size(){return+!this.isEmpty()}publish(e){return!this.isFull()&&(0!==this.subscriberCount&&(this.value=e,this.subscribers=this.subscriberCount,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(e),!0)}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),r.empty();let t=r.fromIterable(e);return r.isEmpty(t)?t:this.publish(r.unsafeHead(t))?r.drop(t,1):t}slide(){this.isFull()&&(this.subscribers=0,this.value=el),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new ey(this,this.publisherIndex,!1)}}class ey{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||0===this.self.subscribers||this.subscriberIndex===this.self.publisherIndex}size(){return+!this.isEmpty()}poll(e){if(this.isEmpty())return e;let t=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=el),this.subscriberIndex+=1,t}pollUpTo(e){if(this.isEmpty()||e<1)return r.empty();let t=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=el),this.subscriberIndex+=1,r.of(t)}unsubscribe(){this.unsubscribed||(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex!==this.self.publisherIndex&&(this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=el)))}}class eb{replayBuffer;publisherHead={value:el,subscribers:0,next:null};publisherTail=this.publisherHead;publisherIndex=0;subscribersIndex=0;capacity=Number.MAX_SAFE_INTEGER;constructor(e){this.replayBuffer=e}replayWindow(){return this.replayBuffer?new ez(this.replayBuffer):ej}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(e){let t=this.publisherTail.subscribers;return 0!==t&&(this.publisherTail.next={value:e,subscribers:t,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0!==this.publisherTail.subscribers)for(let t of e)this.publish(t);else this.replayBuffer&&this.replayBuffer.offerAll(e);return r.empty()}slide(){this.publisherHead!==this.publisherTail&&(this.publisherHead=this.publisherHead.next,this.publisherHead.value=el,this.subscribersIndex+=1),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new eS(this,this.publisherTail,this.publisherIndex,!1)}}class eS{self;subscriberHead;subscriberIndex;unsubscribed;constructor(e,t,r,i){this.self=e,this.subscriberHead=t,this.subscriberIndex=r,this.unsubscribed=i}isEmpty(){if(this.unsubscribed)return!0;let e=!0,t=!0;for(;t;)this.subscriberHead===this.self.publisherTail?t=!1:this.subscriberHead.next.value!==el?(e=!1,t=!1):(this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1);return e}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;let t=!0,r=e;for(;t;)if(this.subscriberHead===this.self.publisherTail)t=!1;else{let e=this.subscriberHead.next.value;e!==el&&(r=e,this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=el,this.self.subscribersIndex+=1),t=!1),this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return r}pollUpTo(e){let t=[],i=0;for(;i!==e;){let r=this.poll(el);r===el?i=e:(t.push(r),i+=1)}return r.fromIterable(t)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;this.subscriberHead!==this.self.publisherTail;)this.subscriberHead.next.value!==el&&(this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=el,this.self.subscribersIndex+=1)),this.subscriberHead=this.subscriberHead.next}}class ev extends ea.Class{pubsub;subscribers;subscription;pollers;shutdownHook;shutdownFlag;strategy;replayWindow;[b]=k;constructor(e,t,r,i,n,a,s,o){super(),this.pubsub=e,this.subscribers=t,this.subscription=r,this.pollers=i,this.shutdownHook=n,this.shutdownFlag=a,this.strategy=s,this.replayWindow=o}commit(){return this.take}pipe(){return(0,u.pipeArguments)(this,arguments)}capacity(){return this.pubsub.capacity}isActive(){return!h.get(this.shutdownFlag)}get size(){return m.suspend(()=>h.get(this.shutdownFlag)?m.interrupt:m.succeed(this.subscription.size()+this.replayWindow.remaining))}unsafeSize(){return h.get(this.shutdownFlag)?l.none():l.some(this.subscription.size()+this.replayWindow.remaining)}get isFull(){return m.suspend(()=>h.get(this.shutdownFlag)?m.interrupt:m.succeed(this.subscription.size()===this.capacity()))}get isEmpty(){return m.map(this.size,e=>0===e)}get shutdown(){return m.uninterruptible(m.withFiberRuntime(e=>(h.set(this.shutdownFlag,!0),(0,o.pipe)(g.forEachParUnbounded(eT(this.pollers),t=>m.deferredInterruptWith(t,e.id()),!1),m.zipRight(m.sync(()=>{this.subscribers.delete(this.subscription),this.subscription.unsubscribe(),this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers)})),m.whenEffect(m.deferredSucceed(this.shutdownHook,void 0)),m.asVoid))))}get isShutdown(){return m.sync(()=>h.get(this.shutdownFlag))}get awaitShutdown(){return m.deferredAwait(this.shutdownHook)}get take(){return m.withFiberRuntime(e=>{if(h.get(this.shutdownFlag))return m.interrupt;if(this.replayWindow.remaining>0){let e=this.replayWindow.take();return m.succeed(e)}let t=d.isEmpty(this.pollers)?this.subscription.poll(d.EmptyMutableQueue):d.EmptyMutableQueue;if(t!==d.EmptyMutableQueue)return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),m.succeed(t);{let t=m.deferredUnsafeMake(e.id());return(0,o.pipe)(m.suspend(()=>((0,o.pipe)(this.pollers,d.offer(t)),(0,o.pipe)(this.subscribers,eu(this.subscription,this.pollers)),this.strategy.unsafeCompletePollers(this.pubsub,this.subscribers,this.subscription,this.pollers),h.get(this.shutdownFlag)?m.interrupt:m.deferredAwait(t))),m.onInterrupt(()=>m.sync(()=>eM(this.pollers,t))))}})}get takeAll(){return m.suspend(()=>{if(h.get(this.shutdownFlag))return m.interrupt;let e=d.isEmpty(this.pollers)?eR(this.subscription):r.empty();return(this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),this.replayWindow.remaining>0)?m.succeed(r.appendAll(this.replayWindow.takeAll(),e)):m.succeed(e)})}takeUpTo(e){return m.suspend(()=>{let t;if(h.get(this.shutdownFlag))return m.interrupt;if(this.replayWindow.remaining>=e){let t=this.replayWindow.takeN(e);return m.succeed(t)}this.replayWindow.remaining>0&&(t=this.replayWindow.takeAll(),e-=t.length);let i=d.isEmpty(this.pollers)?eO(this.subscription,e):r.empty();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),t?m.succeed(r.appendAll(t,i)):m.succeed(i)})}takeBetween(e,t){return m.suspend(()=>eE(this,e,t,r.empty()))}}let eE=(e,t,i,n)=>i<t?m.succeed(n):(0,o.pipe)(e.takeUpTo(i),m.flatMap(a=>{let s=t-a.length;return 1===s?(0,o.pipe)(e.take,m.map(e=>(0,o.pipe)(n,r.appendAll(a),r.append(e)))):s>1?(0,o.pipe)(e.take,m.flatMap(t=>eE(e,s-1,i-a.length-1,(0,o.pipe)(n,r.appendAll(a),r.append(t))))):m.succeed((0,o.pipe)(n,r.appendAll(a)))}));class ew{pubsub;subscribers;scope;shutdownHook;shutdownFlag;strategy;[y]=_;[b]=k;constructor(e,t,r,i,n,a){this.pubsub=e,this.subscribers=t,this.scope=r,this.shutdownHook=i,this.shutdownFlag=n,this.strategy=a}capacity(){return this.pubsub.capacity}get size(){return m.suspend(()=>h.get(this.shutdownFlag)?m.interrupt:m.sync(()=>this.pubsub.size()))}unsafeSize(){return h.get(this.shutdownFlag)?l.none():l.some(this.pubsub.size())}get isFull(){return m.map(this.size,e=>e===this.capacity())}get isEmpty(){return m.map(this.size,e=>0===e)}get awaitShutdown(){return m.deferredAwait(this.shutdownHook)}get isShutdown(){return m.sync(()=>h.get(this.shutdownFlag))}get shutdown(){return m.uninterruptible(m.withFiberRuntime(e=>((0,o.pipe)(this.shutdownFlag,h.set(!0)),(0,o.pipe)(this.scope.close(m.exitInterrupt(e.id())),m.zipRight(this.strategy.shutdown),m.whenEffect(m.deferredSucceed(this.shutdownHook,void 0)),m.asVoid))))}publish(e){return m.suspend(()=>h.get(this.shutdownFlag)?m.interrupt:this.pubsub.publish(e)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),m.succeed(!0)):this.strategy.handleSurplus(this.pubsub,this.subscribers,r.of(e),this.shutdownFlag))}isActive(){return!h.get(this.shutdownFlag)}unsafeOffer(e){return!h.get(this.shutdownFlag)&&!!this.pubsub.publish(e)&&(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),!0)}publishAll(e){return m.suspend(()=>{if(h.get(this.shutdownFlag))return m.interrupt;let t=eF(this.pubsub,e);return(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),r.isEmpty(t))?m.succeed(!0):this.strategy.handleSurplus(this.pubsub,this.subscribers,t,this.shutdownFlag)})}get subscribe(){let e,t,r,i=m.tap(g.all([this.scope.fork(eo.sequential),(e=this.pubsub,t=this.subscribers,r=this.strategy,m.map(m.deferredMake(),i=>{let n,a,s,o,l,u;return n=e,a=t,s=e.subscribe(),o=d.unbounded(),l=i,u=h.make(!1),new ev(n,a,s,o,l,u,r,n.replayWindow())}))]),e=>e[0].addFinalizer(()=>e[1].shutdown));return m.map(g.acquireRelease(i,(e,t)=>e[0].close(t)),e=>e[1])}offer(e){return this.publish(e)}offerAll(e){return this.publishAll(e)}pipe(){return(0,u.pipeArguments)(this,arguments)}}let e_=(e,t)=>m.flatMap(g.scopeMake(),r=>m.map(m.deferredMake(),i=>ek(e,new Map,r,i,h.make(!1),t))),ek=(e,t,r,i,n,a)=>new ew(e,t,r,i,n,a),ex=e=>{if(e<=0)throw new m.InvalidPubSubCapacityException(`Cannot construct PubSub with capacity of ${e}`)},eC=(e,t)=>{m.deferredUnsafeDone(e,m.succeed(t))},eI=(e,t)=>(0,o.pipe)(e,d.offerAll(t)),eT=e=>(0,o.pipe)(e,d.pollUpTo(1/0)),eR=e=>e.pollUpTo(1/0),eO=(e,t)=>e.pollUpTo(t),eF=(e,t)=>e.publishAll(t),eM=(e,t)=>{eI(e,(0,o.pipe)(eT(e),r.filter(e=>e!==t)))};class eA{publishers=d.unbounded();get shutdown(){return m.flatMap(m.fiberId,e=>m.flatMap(m.sync(()=>eT(this.publishers)),t=>g.forEachConcurrentDiscard(t,([t,r,i])=>i?(0,o.pipe)(m.deferredInterruptWith(r,e),m.asVoid):m.void,!1,!1)))}handleSurplus(e,t,r,i){return m.withFiberRuntime(n=>{let a=m.deferredUnsafeMake(n.id());return(0,o.pipe)(m.suspend(()=>(this.unsafeOffer(r,a),this.unsafeOnPubSubEmptySpace(e,t),this.unsafeCompleteSubscribers(e,t),h.get(i)?m.interrupt:m.deferredAwait(a))),m.onInterrupt(()=>m.sync(()=>this.unsafeRemove(a))))})}unsafeOnPubSubEmptySpace(e,t){let i=!0;for(;i&&!e.isFull();){let n=(0,o.pipe)(this.publishers,d.poll(d.EmptyMutableQueue));if(n===d.EmptyMutableQueue)i=!1;else{let i=e.publish(n[0]);i&&n[2]?eC(n[1],!0):i||eI(this.publishers,(0,o.pipe)(eT(this.publishers),r.prepend(n))),this.unsafeCompleteSubscribers(e,t)}}}unsafeCompletePollers(e,t,r,i){return eD(this,e,t,r,i)}unsafeCompleteSubscribers(e,t){return eL(this,e,t)}unsafeOffer(e,t){let r=e[Symbol.iterator](),i=r.next();if(!i.done)for(;;){let e=i.value;if((i=r.next()).done){(0,o.pipe)(this.publishers,d.offer([e,t,!0]));break}(0,o.pipe)(this.publishers,d.offer([e,t,!1]))}}unsafeRemove(e){eI(this.publishers,(0,o.pipe)(eT(this.publishers),r.filter(([t,r])=>r!==e)))}}class eN{get shutdown(){return m.void}handleSurplus(e,t,r,i){return m.succeed(!1)}unsafeOnPubSubEmptySpace(e,t){}unsafeCompletePollers(e,t,r,i){return eD(this,e,t,r,i)}unsafeCompleteSubscribers(e,t){return eL(this,e,t)}}class eP{get shutdown(){return m.void}handleSurplus(e,t,r,i){return m.sync(()=>(this.unsafeSlidingPublish(e,r),this.unsafeCompleteSubscribers(e,t),!0))}unsafeOnPubSubEmptySpace(e,t){}unsafeCompletePollers(e,t,r,i){return eD(this,e,t,r,i)}unsafeCompleteSubscribers(e,t){return eL(this,e,t)}unsafeSlidingPublish(e,t){let r=t[Symbol.iterator](),i=r.next();if(!i.done&&e.capacity>0){let t=i.value,n=!0;for(;n;){e.slide();let a=e.publish(t);a&&(i=r.next())&&!i.done?t=i.value:a&&(n=!1)}}}}let eD=(e,t,i,n,a)=>{let s=!0;for(;s&&!n.isEmpty();){let l=(0,o.pipe)(a,d.poll(d.EmptyMutableQueue));if(l===d.EmptyMutableQueue)(0,o.pipe)(i,ec(n,a)),d.isEmpty(a)?s=!1:(0,o.pipe)(i,eu(n,a));else{let s=n.poll(d.EmptyMutableQueue);s===d.EmptyMutableQueue?eI(a,(0,o.pipe)(eT(a),r.prepend(l))):(eC(l,s),e.unsafeOnPubSubEmptySpace(t,i))}}},eL=(e,t,r)=>{for(let[i,n]of r)for(let a of n)e.unsafeCompletePollers(t,r,i,a)};class eU{capacity;constructor(e){this.capacity=e}head={value:el,next:null};tail=this.head;size=0;index=0;slide(){this.index++}offer(e){this.tail.value=e,this.tail.next={value:el,next:null},this.tail=this.tail.next,this.size===this.capacity?this.head=this.head.next:this.size+=1}offerAll(e){for(let t of e)this.offer(t)}}class ez{buffer;head;index;remaining;constructor(e){this.buffer=e,this.index=e.index,this.remaining=e.size,this.head=e.head}fastForward(){for(;this.index<this.buffer.index;)this.head=this.head.next,this.index++}take(){if(0===this.remaining)return;this.index<this.buffer.index&&this.fastForward(),this.remaining--;let e=this.head.value;return this.head=this.head.next,e}takeN(e){if(0===this.remaining)return r.empty();this.index<this.buffer.index&&this.fastForward();let t=Math.min(e,this.remaining),i=Array(t);for(let e=0;e<t;e++){let t=this.head.value;this.head=this.head.next,i[e]=t}return this.remaining-=t,r.unsafeFromArray(i)}takeAll(){return this.takeN(this.remaining)}}let ej={remaining:0,take:()=>void 0,takeN:()=>r.empty(),takeAll:()=>r.empty()},eW=e=>m.suspend(()=>e_(ep(e),new eA)),eq=e=>e.subscribe;var e$=e.i(568819),eB=e.i(500577),eH=e.i(838927);let eV="Continue",eJ=Symbol.for("effect/ChannelChildExecutorDecision"),eG={[eJ]:eJ},eK=e=>{let t=Object.create(eG);return t._tag=eV,t},eZ="ContinuationK",eQ=Symbol.for("effect/ChannelContinuation"),eY={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutDone:e=>e,_OutErr2:e=>e,_OutElem:e=>e,_OutDone2:e=>e};class eX{onSuccess;onHalt;_tag=eZ;[eQ]=eY;constructor(e,t){this.onSuccess=e,this.onHalt=t}onExit(e){return s.isFailure(e)?this.onHalt(e.cause):this.onSuccess(e.value)}}class e0{finalizer;_tag="ContinuationFinalizer";[eQ]=eY;constructor(e){this.finalizer=e}}let e1="PullAfterNext",e2={[Symbol.for("effect/ChannelUpstreamPullStrategy")]:{_A:e=>e}},e6=e=>{let t=Object.create(e2);return t._tag=e1,t.emitSeparator=e,t},e3="BracketOut",e4="Bridge",e5="ConcatAll",e8="Emit",e7="Ensuring",e9="Fail",te="Fold",tt="FromEffect",tr="PipeTo",ti="Provide",tn="Read",ta="Succeed",ts="SucceedNow",to="Suspend",tl=Symbol.for("effect/Channel"),tu={[tl]:{_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},pipe(){return(0,u.pipeArguments)(this,arguments)}},tc=e=>(0,c.hasProperty)(e,tl)||n.isEffect(e),tp=(0,o.dual)(2,(e,t)=>{let r=Object.create(tu);return r._tag=e3,r.acquire=()=>e,r.finalizer=t,r}),tf=(0,o.dual)(2,(e,t)=>{let r=Object.create(tu);return r._tag=te,r.channel=e,r.k=new eX(tA,t),r}),td=e=>tP(()=>{let t=[];return tx(tT(e,th(t)),e=>tD(()=>[r.fromIterable(t),e]))}),th=e=>tF({onInput:t=>tx(tD(()=>{e.push(t)}),()=>th(e)),onFailure:tE,onDone:tN}),tm=e=>tg(e,o.constVoid,o.constVoid),tg=(e,t,r)=>{let i=Object.create(tu);return i._tag=e5,i.combineInners=t,i.combineAll=r,i.onPull=()=>e6(l.none()),i.onEmit=()=>eK,i.value=()=>e,i.k=o.identity,i},ty=(0,o.dual)(4,(e,t,r,i)=>{let n=Object.create(tu);return n._tag=e5,n.combineInners=r,n.combineAll=i,n.onPull=()=>e6(l.none()),n.onEmit=()=>eK,n.value=()=>e,n.k=t,n}),tb=(0,o.dual)(6,(e,t,r,i,n,a)=>{let s=Object.create(tu);return s._tag=e5,s.combineInners=r,s.combineAll=i,s.onPull=n,s.onEmit=a,s.value=()=>e,s.k=t,s}),tS=(0,o.dual)(2,(e,t)=>{let r=Object.create(tu);return r._tag=e4,r.input=t,r.channel=e,r}),tv=(0,o.dual)(2,(e,t)=>{let r=Object.create(tu);return r._tag=e7,r.channel=e,r.finalizer=t,r}),tE=e=>t_(t.fail(e)),tw=e=>tk(()=>t.fail(e())),t_=e=>tk(()=>e),tk=e=>{let t=Object.create(tu);return t._tag=e9,t.error=e,t},tx=(0,o.dual)(2,(e,t)=>{let r=Object.create(tu);return r._tag=te,r.channel=e,r.k=new eX(t,t_),r}),tC=(0,o.dual)(2,(e,t)=>{let r=Object.create(tu);return r._tag=te,r.channel=e,r.k=new eX(t.onSuccess,t.onFailure),r}),tI=e=>{let t=Object.create(tu);return t._tag=tt,t.effect=()=>e,t},tT=(0,o.dual)(2,(e,t)=>{let r=Object.create(tu);return r._tag=tr,r.left=()=>e,r.right=()=>t,r}),tR=(0,o.dual)(2,(e,t)=>{let r=Object.create(tu);return r._tag=ti,r.context=()=>t,r.inner=e,r}),tO=e=>{let t=Object.create(tu);return t._tag=tn,t.more=tA,t.done=new eX(()=>tE(e),()=>tE(e)),t},tF=e=>tM({onInput:e.onInput,onFailure:r=>ee.match(t.failureOrCause(r),{onLeft:e.onFailure,onRight:t_}),onDone:e.onDone}),tM=e=>{let t=Object.create(tu);return t._tag=tn,t.more=e.onInput,t.done=new eX(e.onDone,e.onFailure),t},tA=e=>tD(()=>e),tN=e=>{let t=Object.create(tu);return t._tag=ts,t.terminal=e,t},tP=e=>{let t=Object.create(tu);return t._tag=to,t.channel=e,t},tD=e=>{let t=Object.create(tu);return t._tag=ta,t.evaluate=e,t},tL=tN(void 0),tU=e=>{let t=Object.create(tu);return t._tag=e8,t.out=e,t};e.s(["ChannelTypeId",0,tl,"acquireReleaseOut",0,tp,"catchAllCause",0,tf,"collectElements",0,td,"concatAll",0,tm,"concatAllWith",0,tg,"concatMapWith",0,ty,"concatMapWithCustom",0,tb,"embedInput",0,tS,"ensuringWith",0,tv,"fail",0,tE,"failCause",0,t_,"failCauseSync",0,tk,"failSync",0,tw,"flatMap",0,tx,"foldCauseChannel",0,tC,"fromEffect",0,tI,"isChannel",0,tc,"pipeTo",0,tT,"provideContext",0,tR,"readOrFail",0,tO,"readWith",0,tF,"readWithCause",0,tM,"succeed",0,tA,"succeedNow",0,tN,"suspend",0,tP,"sync",0,tD,"void",()=>tL,"write",0,tU],604234);let tz="Done",tj="Emit",tW="FromEffect",tq="Read",t$={[Symbol.for("effect/ChannelState")]:{_E:e=>e,_R:e=>e}},tB=()=>{let e=Object.create(t$);return e._tag=tz,e},tH=()=>{let e=Object.create(t$);return e._tag=tj,e},tV=e=>{let t=Object.create(t$);return t._tag=tW,t.effect=e,t},tJ=(e,t,r,i)=>{let n=Object.create(t$);return n._tag=tq,n.upstream=e,n.onEffect=t,n.onEmit=r,n.onDone=i,n},tG=e=>e._tag===tW,tK=e=>tG(e)?n.ignore(e.effect):void 0,tZ="PullFromChild",tQ="PullFromUpstream",tY="DrainChildExecutors",tX="Emit";class t0{childExecutor;parentSubexecutor;onEmit;_tag=tZ;constructor(e,t,r){this.childExecutor=e,this.parentSubexecutor=t,this.onEmit=r}close(e){let t=this.childExecutor.close(e),r=this.parentSubexecutor.close(e);return void 0!==t&&void 0!==r?n.zipWith(n.exit(t),n.exit(r),(e,t)=>(0,o.pipe)(e,s.zipRight(t))):void 0!==t?t:void 0!==r?r:void 0}enqueuePullFromChild(e){return this}}class t1{upstreamExecutor;createChild;lastDone;activeChildExecutors;combineChildResults;combineWithChildResult;onPull;onEmit;_tag=tQ;constructor(e,t,r,i,n,a,s,o){this.upstreamExecutor=e,this.createChild=t,this.lastDone=r,this.activeChildExecutors=i,this.combineChildResults=n,this.combineWithChildResult=a,this.onPull=s,this.onEmit=o}close(e){let t=this.upstreamExecutor.close(e);return[...this.activeChildExecutors.map(t=>void 0!==t?t.childExecutor.close(e):void 0),t].reduce((e,t)=>void 0!==e&&void 0!==t?n.zipWith(e,n.exit(t),(e,t)=>s.zipRight(e,t)):void 0!==e?e:void 0!==t?n.exit(t):void 0,void 0)}enqueuePullFromChild(e){return new t1(this.upstreamExecutor,this.createChild,this.lastDone,[...this.activeChildExecutors,e],this.combineChildResults,this.combineWithChildResult,this.onPull,this.onEmit)}}class t2{upstreamExecutor;lastDone;activeChildExecutors;upstreamDone;combineChildResults;combineWithChildResult;onPull;_tag=tY;constructor(e,t,r,i,n,a,s){this.upstreamExecutor=e,this.lastDone=t,this.activeChildExecutors=r,this.upstreamDone=i,this.combineChildResults=n,this.combineWithChildResult=a,this.onPull=s}close(e){let t=this.upstreamExecutor.close(e);return[...this.activeChildExecutors.map(t=>void 0!==t?t.childExecutor.close(e):void 0),t].reduce((e,t)=>void 0!==e&&void 0!==t?n.zipWith(e,n.exit(t),(e,t)=>s.zipRight(e,t)):void 0!==e?e:void 0!==t?n.exit(t):void 0,void 0)}enqueuePullFromChild(e){return new t2(this.upstreamExecutor,this.lastDone,[...this.activeChildExecutors,e],this.upstreamDone,this.combineChildResults,this.combineWithChildResult,this.onPull)}}class t6{value;next;_tag=tX;constructor(e,t){this.value=e,this.next=t}close(e){return this.next.close(e)}enqueuePullFromChild(e){return this}}let t3={[Symbol.for("effect/ChannelUpstreamPullRequest")]:{_A:e=>e}},t4=e=>{let t=Object.create(t3);return t._tag="Pulled",t.value=e,t};class t5{_activeSubexecutor=void 0;_cancelled=void 0;_closeLastSubstream=void 0;_currentChannel;_done=void 0;_doneStack=[];_emitted=void 0;_executeCloseLastSubstream;_input=void 0;_inProgressFinalizer=void 0;_providedEnv;constructor(e,t,r){this._currentChannel=e,this._executeCloseLastSubstream=r,this._providedEnv=t}run(){let e;for(;void 0===e;)if(void 0!==this._cancelled)e=this.processCancellation();else if(void 0!==this._activeSubexecutor)e=this.runSubexecutor();else try{if(void 0===this._currentChannel)e=tB();else switch(n.isEffect(this._currentChannel)&&(this._currentChannel=tI(this._currentChannel)),this._currentChannel._tag){case e3:e=this.runBracketOut(this._currentChannel);break;case e4:{let t=this._currentChannel.input;if(this._currentChannel=this._currentChannel.channel,void 0!==this._input){let r=this._input;this._input=void 0;let i=()=>n.flatMap(t.awaitRead(),()=>n.suspend(()=>{let e=r.run();switch(e._tag){case tz:return s.match(r.getDone(),{onFailure:e=>t.error(e),onSuccess:e=>t.done(e)});case tj:return n.flatMap(t.emit(r.getEmit()),()=>i());case tW:return n.matchCauseEffect(e.effect,{onFailure:e=>t.error(e),onSuccess:()=>i()});case tq:return t9(e,()=>i(),e=>t.error(e))}}));e=tV(n.flatMap(n.forkDaemon(n.interruptible(i())),e=>n.sync(()=>this.addFinalizer(t=>n.flatMap(er.interrupt(e),()=>n.suspend(()=>{let e=this.restorePipe(t,r);return void 0!==e?e:n.void}))))))}break}case e5:{let e=new t5(this._currentChannel.value(),this._providedEnv,e=>n.sync(()=>{let t=void 0===this._closeLastSubstream?n.void:this._closeLastSubstream;this._closeLastSubstream=(0,o.pipe)(t,n.zipRight(e))}));e._input=this._input;let t=this._currentChannel;this._activeSubexecutor=new t1(e,e=>t.k(e),void 0,[],(e,r)=>t.combineInners(e,r),(e,r)=>t.combineAll(e,r),e=>t.onPull(e),e=>t.onEmit(e)),this._closeLastSubstream=void 0,this._currentChannel=void 0;break}case e8:this._emitted=this._currentChannel.out,this._currentChannel=void 0!==this._activeSubexecutor?void 0:tL,e=tH();break;case e7:this.runEnsuring(this._currentChannel);break;case e9:e=this.doneHalt(this._currentChannel.error());break;case te:this._doneStack.push(this._currentChannel.k),this._currentChannel=this._currentChannel.channel;break;case tt:{let t=void 0===this._providedEnv?this._currentChannel.effect():(0,o.pipe)(this._currentChannel.effect(),n.provide(this._providedEnv));e=tV(n.matchCauseEffect(t,{onFailure:e=>{let t=this.doneHalt(e);return void 0!==t&&tG(t)?t.effect:n.void},onSuccess:e=>{let t=this.doneSucceed(e);return void 0!==t&&tG(t)?t.effect:n.void}}));break}case tr:{let e=this._input,t=new t5(this._currentChannel.left(),this._providedEnv,e=>this._executeCloseLastSubstream(e));t._input=e,this._input=t,this.addFinalizer(t=>{let r=this.restorePipe(t,e);return void 0!==r?r:n.void}),this._currentChannel=this._currentChannel.right();break}case ti:{let e=this._providedEnv;this._providedEnv=this._currentChannel.context(),this._currentChannel=this._currentChannel.inner,this.addFinalizer(()=>n.sync(()=>{this._providedEnv=e}));break}case tn:{let t=this._currentChannel;e=tJ(this._input,o.identity,e=>{try{this._currentChannel=t.more(e)}catch(e){this._currentChannel=t.done.onExit(s.die(e))}},e=>{let r=e=>t.done.onExit(e);this._currentChannel=r(e)});break}case ta:e=this.doneSucceed(this._currentChannel.evaluate());break;case ts:e=this.doneSucceed(this._currentChannel.terminal);break;case to:this._currentChannel=this._currentChannel.channel()}}catch(e){this._currentChannel=t_(t.die(e))}return e}getDone(){return this._done}getEmit(){return this._emitted}cancelWith(e){this._cancelled=e}clearInProgressFinalizer(){this._inProgressFinalizer=void 0}storeInProgressFinalizer(e){this._inProgressFinalizer=e}popAllFinalizers(e){let t=[],r=this._doneStack.pop();for(;r;)"ContinuationFinalizer"===r._tag&&t.push(r.finalizer),r=this._doneStack.pop();let i=0===t.length?n.void:t7(t,e);return this.storeInProgressFinalizer(i),i}popNextFinalizers(){let e=[];for(;0!==this._doneStack.length;){let t=this._doneStack[this._doneStack.length-1];if(t._tag===eZ)break;e.push(t),this._doneStack.pop()}return e}restorePipe(e,t){let r=this._input;return(this._input=t,void 0!==r)?r.close(e):n.void}close(e){let t,r,i=this._inProgressFinalizer;void 0!==i&&(t=(0,o.pipe)(i,n.ensuring(n.sync(()=>this.clearInProgressFinalizer()))));let a=this.popAllFinalizers(e);void 0!==a&&(r=(0,o.pipe)(a,n.ensuring(n.sync(()=>this.clearInProgressFinalizer()))));let l=void 0===this._activeSubexecutor?void 0:this._activeSubexecutor.close(e);if(void 0!==l||void 0!==t||void 0!==r)return(0,o.pipe)(n.exit(t8(l)),n.zip(n.exit(t8(t))),n.zip(n.exit(t8(r))),n.map(([[e,t],r])=>(0,o.pipe)(e,s.zipRight(t),s.zipRight(r))),n.uninterruptible,n.flatMap(e=>n.suspend(()=>e)))}doneSucceed(e){if(0===this._doneStack.length)return this._done=s.succeed(e),this._currentChannel=void 0,tB();let t=this._doneStack[this._doneStack.length-1];if(t._tag===eZ){this._doneStack.pop(),this._currentChannel=t.onSuccess(e);return}let r=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=r.reverse(),this._done=s.succeed(e),this._currentChannel=void 0,tB();let i=t7(r.map(e=>e.finalizer),s.succeed(e));return this.storeInProgressFinalizer(i),tV((0,o.pipe)(i,n.ensuring(n.sync(()=>this.clearInProgressFinalizer())),n.uninterruptible,n.flatMap(()=>n.sync(()=>this.doneSucceed(e)))))}doneHalt(e){if(0===this._doneStack.length)return this._done=s.failCause(e),this._currentChannel=void 0,tB();let r=this._doneStack[this._doneStack.length-1];if(r._tag===eZ){this._doneStack.pop();try{this._currentChannel=r.onHalt(e)}catch(e){this._currentChannel=t_(t.die(e))}return}let i=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=i.reverse(),this._done=s.failCause(e),this._currentChannel=void 0,tB();let a=t7(i.map(e=>e.finalizer),s.failCause(e));return this.storeInProgressFinalizer(a),tV((0,o.pipe)(a,n.ensuring(n.sync(()=>this.clearInProgressFinalizer())),n.uninterruptible,n.flatMap(()=>n.sync(()=>this.doneHalt(e)))))}processCancellation(){return this._currentChannel=void 0,this._done=this._cancelled,this._cancelled=void 0,tB()}runBracketOut(e){return tV(n.uninterruptible(n.matchCauseEffect(this.provide(e.acquire()),{onFailure:e=>n.sync(()=>{this._currentChannel=t_(e)}),onSuccess:t=>n.sync(()=>{this.addFinalizer(r=>this.provide(e.finalizer(t,r))),this._currentChannel=tU(t)})})))}provide(e){return void 0===this._providedEnv?e:(0,o.pipe)(e,n.provide(this._providedEnv))}runEnsuring(e){this.addFinalizer(e.finalizer),this._currentChannel=e.channel}addFinalizer(e){this._doneStack.push(new e0(e))}runSubexecutor(){let e=this._activeSubexecutor;switch(e._tag){case tZ:return this.pullFromChild(e.childExecutor,e.parentSubexecutor,e.onEmit,e);case tQ:return this.pullFromUpstream(e);case tY:return this.drainChildExecutors(e);case tX:return this._emitted=e.value,this._activeSubexecutor=e.next,tH()}}replaceSubexecutor(e){this._currentChannel=void 0,this._activeSubexecutor=e}finishWithExit(e){let t=s.match(e,{onFailure:e=>this.doneHalt(e),onSuccess:e=>this.doneSucceed(e)});return this._activeSubexecutor=void 0,void 0===t?n.void:tG(t)?t.effect:n.void}finishSubexecutorWithCloseEffect(e,...t){this.addFinalizer(()=>(0,o.pipe)(t,n.forEach(t=>(0,o.pipe)(n.sync(()=>t(e)),n.flatMap(e=>void 0!==e?e:n.void)),{discard:!0})));let r=(0,o.pipe)(e,s.match({onFailure:e=>this.doneHalt(e),onSuccess:e=>this.doneSucceed(e)}));return this._activeSubexecutor=void 0,r}applyUpstreamPullStrategy(e,t,r){switch(r._tag){case e1:{let i=!e||t.some(e=>void 0!==e);return[r.emitSeparator,i?[void 0,...t]:t]}case"PullAfterAllEnqueued":{let i=!e||t.some(e=>void 0!==e);return[r.emitSeparator,i?[...t,void 0]:t]}}}pullFromChild(e,t,r,i){return tJ(e,o.identity,n=>{let a=r(n);switch(a._tag){case eV:break;case"Close":this.finishWithDoneValue(e,t,a.value);break;case"Yield":{let e=t.enqueuePullFromChild(i);this.replaceSubexecutor(e)}}this._activeSubexecutor=new t6(n,this._activeSubexecutor)},s.match({onFailure:r=>{let i=this.handleSubexecutorFailure(e,t,r);return void 0===i?void 0:tK(i)},onSuccess:r=>{this.finishWithDoneValue(e,t,r)}}))}finishWithDoneValue(e,t,r){switch(t._tag){case tQ:{let i=new t1(t.upstreamExecutor,t.createChild,void 0!==t.lastDone?t.combineChildResults(t.lastDone,r):r,t.activeChildExecutors,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit);this._closeLastSubstream=e.close(s.succeed(r)),this.replaceSubexecutor(i);break}case tY:{let i=new t2(t.upstreamExecutor,void 0!==t.lastDone?t.combineChildResults(t.lastDone,r):r,t.activeChildExecutors,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull);this._closeLastSubstream=e.close(s.succeed(r)),this.replaceSubexecutor(i)}}}handleSubexecutorFailure(e,t,r){return this.finishSubexecutorWithCloseEffect(s.failCause(r),e=>t.close(e),t=>e.close(t))}pullFromUpstream(e){if(0===e.activeChildExecutors.length)return this.performPullFromUpstream(e);let t=e.activeChildExecutors[0],r=new t1(e.upstreamExecutor,e.createChild,e.lastDone,e.activeChildExecutors.slice(1),e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit);if(void 0===t)return this.performPullFromUpstream(r);this.replaceSubexecutor(new t0(t.childExecutor,r,t.onEmit))}performPullFromUpstream(e){return tJ(e.upstreamExecutor,e=>{let t=void 0===this._closeLastSubstream?n.void:this._closeLastSubstream;return this._closeLastSubstream=void 0,(0,o.pipe)(this._executeCloseLastSubstream(t),n.zipRight(e))},t=>{if(void 0!==this._closeLastSubstream){let r=this._closeLastSubstream;return this._closeLastSubstream=void 0,(0,o.pipe)(this._executeCloseLastSubstream(r),n.map(()=>{let r=new t5(e.createChild(t),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;let[i,n]=this.applyUpstreamPullStrategy(!1,e.activeChildExecutors,e.onPull(t4(t)));this._activeSubexecutor=new t0(r,new t1(e.upstreamExecutor,e.createChild,e.lastDone,n,e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit),e.onEmit),l.isSome(i)&&(this._activeSubexecutor=new t6(i.value,this._activeSubexecutor))}))}let r=new t5(e.createChild(t),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;let[i,a]=this.applyUpstreamPullStrategy(!1,e.activeChildExecutors,e.onPull(t4(t)));this._activeSubexecutor=new t0(r,new t1(e.upstreamExecutor,e.createChild,e.lastDone,a,e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit),e.onEmit),l.isSome(i)&&(this._activeSubexecutor=new t6(i.value,this._activeSubexecutor))},t=>{if(e.activeChildExecutors.some(e=>void 0!==e)){let t=new t2(e.upstreamExecutor,e.lastDone,[void 0,...e.activeChildExecutors],e.upstreamExecutor.getDone(),e.combineChildResults,e.combineWithChildResult,e.onPull);if(void 0!==this._closeLastSubstream){let e=this._closeLastSubstream;return this._closeLastSubstream=void 0,(0,o.pipe)(this._executeCloseLastSubstream(e),n.map(()=>this.replaceSubexecutor(t)))}return void this.replaceSubexecutor(t)}let r=this._closeLastSubstream,i=this.finishSubexecutorWithCloseEffect((0,o.pipe)(t,s.map(t=>e.combineWithChildResult(e.lastDone,t))),()=>r,t=>e.upstreamExecutor.close(t));return void 0===i?void 0:tK(i)})}drainChildExecutors(e){if(0===e.activeChildExecutors.length){let t=this._closeLastSubstream;return void 0!==t&&this.addFinalizer(()=>n.succeed(t)),this.finishSubexecutorWithCloseEffect(e.upstreamDone,()=>t,t=>e.upstreamExecutor.close(t))}let t=e.activeChildExecutors[0],r=e.activeChildExecutors.slice(1);if(void 0===t){var i;let t,[n,a]=this.applyUpstreamPullStrategy(!0,r,e.onPull((i=r.reduce((e,t)=>void 0!==t?e+1:e,0),(t=Object.create(t3))._tag="NoUpstream",t.activeDownstreamCount=i,t)));return(this.replaceSubexecutor(new t2(e.upstreamExecutor,e.lastDone,a,e.upstreamDone,e.combineChildResults,e.combineWithChildResult,e.onPull)),l.isSome(n))?(this._emitted=n.value,tH()):void 0}let a=new t2(e.upstreamExecutor,e.lastDone,r,e.upstreamDone,e.combineChildResults,e.combineWithChildResult,e.onPull);this.replaceSubexecutor(new t0(t.childExecutor,a,t.onEmit))}}let t8=e=>void 0!==e?e:n.void,t7=(e,t)=>(0,o.pipe)(n.forEach(e,e=>n.exit(e(t))),n.map(e=>(0,o.pipe)(s.all(e),l.getOrElse(()=>s.void))),n.flatMap(e=>n.suspend(()=>e))),t9=(e,t,r)=>{let i=[e],a=()=>{let e=i.pop();if(void 0===e||void 0===e.upstream)return n.dieMessage("Unexpected end of input for channel execution");let l=e.upstream.run();switch(l._tag){case tj:{let s=e.onEmit(e.upstream.getEmit());if(0===i.length){if(void 0===s)return n.suspend(t);return(0,o.pipe)(s,n.matchCauseEffect({onFailure:r,onSuccess:t}))}if(void 0===s)return n.suspend(()=>a());return(0,o.pipe)(s,n.matchCauseEffect({onFailure:r,onSuccess:()=>a()}))}case tz:{let s=e.onDone(e.upstream.getDone());if(0===i.length){if(void 0===s)return n.suspend(t);return(0,o.pipe)(s,n.matchCauseEffect({onFailure:r,onSuccess:t}))}if(void 0===s)return n.suspend(()=>a());return(0,o.pipe)(s,n.matchCauseEffect({onFailure:r,onSuccess:()=>a()}))}case tW:return i.push(e),(0,o.pipe)(e.onEffect(l.effect),n.catchAllCause(t=>n.suspend(()=>{let r=e.onDone(s.failCause(t));return void 0===r?n.void:r})),n.matchCauseEffect({onFailure:r,onSuccess:()=>a()}));case tq:return i.push(e),i.push(l),n.suspend(()=>a())}};return a()},re=(0,o.dual)(2,(e,r)=>n.uninterruptibleMask(a=>n.all([Y.fork(r,e$.sequential),i.make(),i.make()]).pipe(n.flatMap(([l,u,c])=>a(n.acquireUseRelease(n.sync(()=>new t5(e,void 0,o.identity)),e=>n.suspend(()=>rt(e.run(),e).pipe(n.intoDeferred(u),n.zipRight(i.await(u)),n.zipLeft(i.await(c)))),(e,t)=>{let r=e.close(t);return void 0===r?n.void:n.tapErrorCause(r,e=>Y.addFinalizer(l,n.failCause(e)))})).pipe(n.forkIn(r),n.flatMap(e=>r.addFinalizer(r=>{let a=s.isFailure(r)?t.interruptors(r.cause):void 0;return i.isDone(u).pipe(n.flatMap(t=>t?i.succeed(c,void 0).pipe(n.zipRight(er.await(e)),n.zipRight(er.inheritAll(e))):i.succeed(c,void 0).pipe(n.zipRight(a&&eH.size(a)>0?er.interruptAs(e,eB.combineAll(a)):er.interrupt(e)),n.zipRight(er.inheritAll(e)))))}).pipe(n.zipRight(a(i.await(u)))))))))),rt=(e,t)=>{switch(e._tag){case tW:return(0,o.pipe)(e.effect,n.flatMap(()=>rt(t.run(),t)));case tj:return rt(t.run(),t);case tz:return n.suspend(()=>t.getDone());case tq:return t9(e,()=>rt(t.run(),t),n.failCause)}};e.s(["ChannelExecutor",()=>t5,"readUpstream",0,t9,"runIn",0,re],174073);let rr="Done",ri={[Symbol.for("effect/ChannelMergeDecision")]:{_R:e=>e,_E0:e=>e,_Z0:e=>e,_E:e=>e,_Z:e=>e}},rn=e=>{let t=Object.create(ri);return t._tag=rr,t.effect=e,t},ra=e=>{let t=Object.create(ri);return t._tag="Await",t.f=e,t},rs="BothRunning",ro="LeftDone",rl="RightDone",ru=Symbol.for("effect/ChannelMergeState"),rc={[ru]:ru},rp=(e,t)=>{let r=Object.create(rc);return r._tag=rs,r.left=e,r.right=t,r},rf=e=>{let t=Object.create(rc);return t._tag=ro,t.f=e,t},rd=e=>{let t=Object.create(rc);return t._tag=rl,t.f=e,t},rh="BackPressure",rm="BufferSliding",rg=Symbol.for("effect/ChannelMergeStrategy"),ry={[rg]:rg},rb=e=>{let t=Object.create(ry);return t._tag=rh,t},rS=(0,o.dual)(2,(e,{onBackPressure:t,onBufferSliding:r})=>{switch(e._tag){case rh:return t();case rm:return r()}}),rv="Empty",rE="Emit",rw="Error",r_="Done",rk=e=>({_tag:rv,notifyProducer:e}),rx=e=>({_tag:rE,notifyConsumers:e});class rC{ref;constructor(e){this.ref=e}awaitRead(){return n.flatten(Q.modify(this.ref,e=>e._tag===rv?[i.await(e.notifyProducer),e]:[n.void,e]))}get close(){return n.fiberIdWith(e=>this.error(t.interrupt(e)))}done(e){return n.flatten(Q.modify(this.ref,t=>{switch(t._tag){case rv:return[i.await(t.notifyProducer),t];case rE:return[n.forEach(t.notifyConsumers,t=>i.succeed(t,ee.left(e)),{discard:!0}),{_tag:r_,done:e}];case rw:case r_:return[n.interrupt,t]}}))}emit(e){return n.flatMap(i.make(),t=>n.flatten(Q.modify(this.ref,r=>{switch(r._tag){case rv:return[i.await(r.notifyProducer),r];case rE:{let n=r.notifyConsumers[0],a=r.notifyConsumers.slice(1);if(void 0!==n)return[i.succeed(n,ee.right(e)),0===a.length?rk(t):rx(a)];throw Error("Bug: Channel.SingleProducerAsyncInput.emit - Queue was empty! please report an issue at https://github.com/Effect-TS/effect/issues")}case rw:case r_:return[n.interrupt,r]}})))}error(e){return n.flatten(Q.modify(this.ref,t=>{switch(t._tag){case rv:return[i.await(t.notifyProducer),t];case rE:return[n.forEach(t.notifyConsumers,t=>i.failCause(t,e),{discard:!0}),{_tag:rw,cause:e}];case rw:case r_:return[n.interrupt,t]}}))}get take(){return this.takeWith(e=>s.failCause(t.map(e,ee.left)),e=>s.succeed(e),e=>s.fail(ee.right(e)))}takeWith(e,t,r){return n.flatMap(i.make(),a=>n.flatten(Q.modify(this.ref,s=>{switch(s._tag){case rv:return[n.zipRight(i.succeed(s.notifyProducer,void 0),n.matchCause(i.await(a),{onFailure:e,onSuccess:ee.match({onLeft:r,onRight:t})})),rx([a])];case rE:return[n.matchCause(i.await(a),{onFailure:e,onSuccess:ee.match({onLeft:r,onRight:t})}),rx([...s.notifyConsumers,a])];case rw:return[n.succeed(e(s.cause)),s];case r_:return[n.succeed(r(s.done)),s]}})))}}let rI=()=>(0,o.pipe)(i.make(),n.flatMap(e=>Q.make(rk(e))),n.map(e=>new rC(e)));var rT=e.i(395649),rR=e.i(601009);let rO=(e,t,r)=>tx(tI(Q.make(()=>n.void)),i=>(0,o.pipe)(tI(n.uninterruptible(n.tap(e,e=>Q.set(i,t=>r(e,t))))),tx(t),tv(e=>n.flatMap(Q.get(i),t=>t(e))))),rF=(0,o.dual)(2,(e,t)=>r6(e,()=>t)),rM=e=>tP(()=>{let t=(e,r,i)=>iO(Q.modify(i,n=>r(n)?[tF({onInput:n=>tx(tU(n),()=>t(e,r,i)),onFailure:e=>tE(e),onDone:e=>tN(e)}),n]:[tx(tU(n),()=>t(e,r,i)),e]));return t(e.empty,e.isEmpty,e.ref)}),rA=e=>rM({empty:r.empty(),isEmpty:r.isEmpty,ref:e}),rN=(0,o.dual)(2,(e,r)=>tf(e,e=>ee.match(t.failureOrCause(e),{onLeft:r,onRight:t_}))),rP=(0,o.dual)(2,(e,t)=>ty(e,t,()=>void 0,()=>void 0)),rD=(0,o.dual)(2,(e,t)=>{let r=tF({onInput:e=>l.match(t(e),{onNone:()=>r,onSome:e=>tx(tU(e),()=>r)}),onFailure:tE,onDone:tN});return tT(e,r)}),rL=(0,o.dual)(2,(e,t)=>{let r=tF({onInput:e=>tx(tU(e),()=>r),onFailure:tE,onDone:e=>tN(t(e))});return tT(r,e)}),rU=(0,o.dual)(2,(e,t)=>{let r=tF({onInput:e=>tx(tU(e),()=>r),onFailure:tE,onDone:e=>tI(t(e))});return tT(r,e)}),rz=(0,o.dual)(2,(e,t)=>{let r=tF({onInput:e=>tx(tU(e),()=>r),onFailure:e=>tE(t(e)),onDone:tN});return tT(r,e)}),rj=(0,o.dual)(2,(e,t)=>{let r=tF({onInput:e=>tx(tU(e),()=>r),onFailure:e=>tI(t(e)),onDone:tN});return tT(r,e)}),rW=(0,o.dual)(2,(e,t)=>{let r=tF({onInput:e=>tx(tU(t(e)),()=>r),onFailure:tE,onDone:tN});return tT(r,e)}),rq=(0,o.dual)(2,(e,t)=>{let r=tF({onInput:e=>tx(tx(tI(t(e)),tU),()=>r),onFailure:tE,onDone:tN});return tT(r,e)}),r$=e=>tP(()=>{let t=[];return(0,o.pipe)(tT(e,rB(t)),tx(e=>tA([r.unsafeFromArray(t),e])))}),rB=e=>tF({onInput:t=>tx(tD(()=>{e.push(t)}),()=>rB(e)),onFailure:tE,onDone:tA}),rH=e=>{let t=tM({onInput:()=>t,onFailure:t_,onDone:tA});return tT(e,t)},rV=(0,o.dual)(2,(e,t)=>tv(e,()=>t)),rJ=()=>tI(n.context()),rG=e=>tx(rJ(),e),rK=e=>tx(e,o.identity),rZ=(0,o.dual)(2,(e,r)=>tC(e,{onFailure:e=>{let i=t.failureOrCause(e);switch(i._tag){case"Left":return r.onFailure(i.left);case"Right":return t_(i.right)}},onSuccess:r.onSuccess})),rQ=e=>iO(e.takeWith(t_,t=>tx(tU(t),()=>rQ(e)),tA)),rY=e=>tP(()=>rX(e)),rX=e=>(0,o.pipe)(tI(M(e)),tx(ee.match({onLeft:s.match({onFailure:t_,onSuccess:tN}),onRight:t=>tx(tU(t),()=>rX(e))}))),r0=()=>tF({onInput:e=>tx(tU(e),()=>r0()),onFailure:tE,onDone:tN}),r1=(0,o.dual)(2,(e,t)=>is(e,{other:tI(t),onSelfDone:e=>rn(n.suspend(()=>e)),onOtherDone:e=>rn(n.suspend(()=>e))})),r2=(0,o.dual)(2,(e,t)=>r1(e,i.await(t))),r6=(0,o.dual)(2,(e,t)=>tx(e,e=>tD(()=>t(e)))),r3=(0,o.dual)(2,(e,t)=>tx(e,e=>tI(t(e)))),r4=(0,o.dual)(2,(e,r)=>r5(e,t.map(r))),r5=(0,o.dual)(2,(e,t)=>tf(e,e=>t_(t(e)))),r8=(0,o.dual)(2,(e,t)=>{let r=tF({onInput:e=>tx(tU(t(e)),()=>r),onFailure:tE,onDone:tN});return tT(e,r)}),r7=(0,o.dual)(2,(e,t)=>{let r=tM({onInput:e=>(0,o.pipe)(tI(t(e)),tx(tU),tx(()=>r)),onFailure:t_,onDone:tN});return tT(e,r)}),r9=(0,o.dual)(3,(e,t,r)=>iM(a=>n.gen(function*(){let s=yield*rI(),l=rQ(s),u=yield*V(r);yield*Y.addFinalizer(a,Z(u));let c=yield*i.make(),p=r===1/0?e=>o.identity:(yield*n.makeSemaphore(r)).withPermits,f=yield*l.pipe(tT(e),iC(a));yield*f.pipe(n.matchCauseEffect({onFailure:e=>O(u,n.failCause(e)),onSuccess:ee.match({onLeft:e=>n.zipRight(n.interruptible(p(r)(n.void)),n.asVoid(O(u,n.succeed(ee.left(e))))),onRight:e=>n.gen(function*(){let r=yield*i.make(),s=yield*i.make();yield*O(u,n.map(i.await(r),ee.right)),yield*i.succeed(s,void 0).pipe(n.zipRight(n.uninterruptibleMask(r=>n.exit(r(i.await(c))).pipe(n.raceFirst(n.exit(r(t(e)))),n.flatMap(o.identity))).pipe(n.tapErrorCause(e=>i.failCause(c,e)),n.intoDeferred(r))),p(1),n.forkIn(a)),yield*i.await(s)})})}),n.forever,n.interruptible,n.forkIn(a));let d=iO(n.matchCause(n.flatten(M(u)),{onFailure:t_,onSuccess:ee.match({onLeft:tN,onRight:e=>tx(tU(e),()=>d)})}));return tS(d,s)}))),ie=e=>t=>it(e)(t,o.constVoid),it=({bufferSize:e=16,concurrency:r,mergeStrategy:a=rb()})=>(s,u)=>iM(c=>n.gen(function*(){let p="unbounded"===r?Number.MAX_SAFE_INTEGER:r,f=yield*rI(),d=rQ(f),h=yield*V(e);yield*Y.addFinalizer(c,Z(h));let m=yield*K();yield*Y.addFinalizer(c,Z(m));let g=yield*Q.make(l.none()),y=yield*i.make(),b=(yield*n.makeSemaphore(p)).withPermits,S=yield*iC(tT(d,s),c);function v(e){return e.pipe(n.flatMap(ee.match({onLeft:e=>n.succeed(l.some(e)),onRight:e=>n.as(O(h,n.succeed(ee.right(e))),l.none())})),n.repeat({until:e=>l.isSome(e)}),n.flatMap(e=>Q.update(g,l.match({onNone:()=>l.some(e.value),onSome:t=>l.some(u(t,e.value))}))),n.catchAllCause(e=>t.isInterrupted(e)?n.failCause(e):O(h,n.failCause(e)).pipe(n.zipRight(i.succeed(y,void 0)),n.asVoid)))}yield*S.pipe(n.matchCauseEffect({onFailure:e=>O(h,n.failCause(e)).pipe(n.zipRight(n.succeed(!1))),onSuccess:ee.match({onLeft:e=>n.raceWith(n.interruptible(i.await(y)),n.interruptible(b(p)(n.void)),{onSelfDone:(e,t)=>n.as(er.interrupt(t),!1),onOtherDone:(t,r)=>n.zipRight(er.interrupt(r),Q.get(g).pipe(n.flatMap(l.match({onNone:()=>O(h,n.succeed(ee.left(e))),onSome:t=>O(h,n.succeed(ee.left(u(t,e))))})),n.as(!1)))}),onRight:e=>rS(a,{onBackPressure:()=>n.gen(function*(){let t=yield*i.make(),r=n.scopedWith(t=>iC(tT(d,e),t).pipe(n.flatMap(e=>n.race(n.exit(v(e)),n.exit(n.interruptible(i.await(y))))),n.flatMap(o.identity)));return yield*i.succeed(t,void 0).pipe(n.zipRight(r),b(1),n.forkIn(c)),yield*i.await(t),!(yield*i.isDone(y))}),onBufferSliding:()=>n.gen(function*(){let t=yield*i.make(),r=yield*i.make(),a=yield*m.size;yield*M(m).pipe(n.flatMap(e=>i.succeed(e,void 0)),n.when(()=>a>=p)),yield*O(m,t);let s=n.scopedWith(r=>iC(tT(d,e),r).pipe(n.flatMap(e=>n.exit(v(e)).pipe(n.race(n.exit(n.interruptible(i.await(y)))),n.race(n.exit(n.interruptible(i.await(t)))))),n.flatMap(o.identity)));return yield*i.succeed(r,void 0).pipe(n.zipRight(s),b(1),n.forkIn(c)),yield*i.await(r),!(yield*i.isDone(y))})})})}),n.repeat({while:e=>e}),n.forkIn(c));let E=(0,o.pipe)(M(h),n.flatten,n.matchCause({onFailure:t_,onSuccess:ee.match({onLeft:tN,onRight:e=>tx(tU(e),()=>E)})}),iO);return tS(E,f)})),ir=(0,o.dual)(3,(e,t,r)=>ie(r)(r8(e,t))),ii=(0,o.dual)(2,(e,t)=>ie({concurrency:t})(r8(e,o.identity))),ia=(0,o.dual)(3,(e,t,r)=>it({concurrency:t})(r8(e,o.identity),r)),is=(0,o.dual)(2,(e,t)=>iM(function(r){return n.gen(function*(){let i=yield*rI(),a=rQ(i),o=yield*iC(tT(a,e),r),l=yield*iC(tT(a,t.other),r);function u(e,t,i){return(a,o,l)=>{function u(e){return e._tag===rr?n.succeed(tI(n.zipRight(er.interrupt(t),e.effect))):n.map(er.await(t),s.match({onFailure:t=>tI(e.f(s.failCause(t))),onSuccess:ee.match({onLeft:t=>tI(e.f(s.succeed(t))),onRight:t=>ij(tU(t),c(l(e.f)))})}))}return s.match(e,{onFailure:e=>u(a(s.failCause(e))),onSuccess:ee.match({onLeft:e=>u(a(s.succeed(e))),onRight:e=>n.succeed(tx(tU(e),()=>tx(tI(n.forkIn(n.interruptible(i),r)),e=>c(o(e,t)))))})})}}function c(e){switch(e._tag){case rs:{let r=n.interruptible(er.join(e.left)),i=n.interruptible(er.join(e.right));return iO(n.raceWith(r,i,{onSelfDone:(r,i)=>n.zipRight(er.interrupt(i),u(r,e.right,o)(t.onSelfDone,rp,e=>rf(e))),onOtherDone:(r,i)=>n.zipRight(er.interrupt(i),u(r,e.left,l)(t.onOtherDone,(e,t)=>rp(t,e),e=>rd(e)))}))}case ro:return iO(n.map(n.exit(l),s.match({onFailure:t=>tI(e.f(s.failCause(t))),onSuccess:ee.match({onLeft:t=>tI(e.f(s.succeed(t))),onRight:t=>tx(tU(t),()=>c(rf(e.f)))})})));case rl:return iO(n.map(n.exit(o),s.match({onFailure:t=>tI(e.f(s.failCause(t))),onSuccess:ee.match({onLeft:t=>tI(e.f(s.succeed(t))),onRight:t=>tx(tU(t),()=>c(rd(e.f)))})})))}}return tI(n.withFiberRuntime(e=>{let t=n.withFiberRuntime(t=>(t.transferChildren(e.scope()),n.void)),i=n.interruptible(o).pipe(n.ensuring(t),n.forkIn(r)),a=n.interruptible(l).pipe(n.ensuring(t),n.forkIn(r));return n.zipWith(i,a,(e,t)=>rp(e,t))})).pipe(tx(c),tS(i))})})),io=tI(n.never),il=(0,o.dual)(2,(e,t)=>iu(e,t)),iu=(0,o.dual)(2,(e,r)=>rN(e,e=>tk(()=>t.die(r(e))))),ic=(0,o.dual)(2,(e,t)=>rN(e,t)),ip=(0,o.dual)(2,(e,r)=>tP(()=>{let i,n=tF({onInput:e=>tx(tU(e),()=>n),onFailure:e=>(i=iq(e),t_(t.die(i))),onDone:tN}),a=tM({onInput:e=>(0,o.pipe)(tU(e),tx(()=>a)),onFailure:e=>t.isDieType(e)&&i$(e.defect)&&et.equals(e.defect,i)?tE(e.defect.error):t_(e),onDone:tN});return tT(tT(tT(e,n),r),a)})),id=(0,o.dual)(3,(e,t,r)=>tx(rJ(),i=>tR(e,X.add(i,t,r)))),ih=(0,o.dual)(2,(e,t)=>iM(r=>n.map(en.buildWithScope(t,r),t=>tR(e,t)))),im=(0,o.dual)(2,(e,t)=>rG(r=>tR(e,t(r)))),ig=(0,o.dual)(2,(e,t)=>ih(e,en.merge(en.context(),t))),iy=e=>tx(e,()=>iy(e)),ib=e=>n.scopedWith(t=>re(e,t)),iS=e=>ib(rH(e)),iv=e=>n.scopeWith(t=>re(e,t)),iE=e=>iO(n.uninterruptibleMask(t=>n.map(Y.make(),r=>tp(n.tapErrorCause(t(Y.extend(e,r)),e=>Y.close(r,s.failCause(e))),(e,t)=>Y.close(r,t))))),iw=e=>iF(n.map(n.scope,t=>tx(tI(e(t)),tU))),i_=()=>tP(()=>{let e="",t=!1,i=tM({onInput:n=>{let a,s=(a=[],r.map(n,r=>{if(0!==r.length){let i=0,n=r.indexOf("\r"),s=r.indexOf("\n");for(t&&(0===s?(a.push(e),e="",i=1,s=r.indexOf("\n",i)):e+="\r",t=!1);-1!==n||-1!==s;)-1===n||-1!==s&&s<n?(0===e.length?a.push(r.substring(i,s)):(a.push(e+r.substring(i,s)),e=""),i=s+1,s=r.indexOf("\n",i)):r.length===n+1?(t=!0,n=-1):s===n+1?(0===e.length?a.push(r.substring(i,n)):(e+=r.substring(i,n),a.push(e),e=""),i=n+2,n=r.indexOf("\r",i),s=r.indexOf("\n",i)):n=r.indexOf("\r",n+1);t?e+=r.substring(i,r.length-1):e+=r.substring(i,r.length)}}),r.unsafeFromArray(a));return r.isEmpty(s)?i:tx(tU(s),()=>i)},onFailure:t=>0===e.length?t_(t):tx(tU(r.of(e)),()=>t_(t)),onDone:t=>0===e.length?tA(t):tx(tU(r.of(e)),()=>tA(t))});return i}),ik=e=>iT(e),ix=e=>n.flatMap(n.scope,t=>iC(e,t)),iC=(0,o.dual)(2,(e,t)=>n.zip(n.sync(()=>new t5(e,void 0,o.identity)),n.runtime()).pipe(n.tap(([e,r])=>Y.addFinalizerExit(t,t=>{let i=e.close(t);return void 0!==i?n.provide(i,r):n.void})),n.uninterruptible,n.map(([e])=>n.suspend(()=>iI(e.run(),e))))),iI=(e,t)=>{switch(e._tag){case tz:return s.match(t.getDone(),{onFailure:n.failCause,onSuccess:e=>n.succeed(ee.left(e))});case tj:return n.succeed(ee.right(t.getEmit()));case tW:return(0,o.pipe)(e.effect,n.flatMap(()=>iI(t.run(),t)));case tq:return t9(e,()=>iI(t.run(),t),e=>n.failCause(e))}},iT=e=>tP(()=>iR(e)),iR=e=>tM({onInput:t=>tx(tI(O(e,ee.right(t))),()=>iR(e)),onFailure:t=>tI(O(e,ee.left(s.failCause(t)))),onDone:t=>tI(O(e,ee.left(s.succeed(t))))}),iO=e=>rK(tI(e)),iF=e=>tg(iE(e),(e,t)=>e,(e,t)=>e),iM=e=>tg(iw(e),(e,t)=>e,(e,t)=>e),iA=(0,o.dual)(3,(e,t,r)=>im(e,e=>X.merge(e,X.make(t,r(X.unsafeGet(e,t)))))),iN=function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=rR.addSpanStackTrace(e?arguments[2]:arguments[1]),i=n.all([n.makeSpan(t,r),n.context(),n.clock,ei.get(ei.currentTracerTimingEnabled)]);if(e){let e=arguments[0];return rO(i,([t,r])=>tR(e,X.add(r,rR.spanTag,t)),([e,,t,r],i)=>rT.endSpan(e,i,t,r))}return e=>rO(i,([t,r])=>tR(e,X.add(r,rR.spanTag,t)),([e,,t,r],i)=>rT.endSpan(e,i,t,r))},iP=(...e)=>iD(r.fromIterable(e)),iD=e=>iL(0,e.length,e),iL=(e,t,i)=>e===t?tL:(0,o.pipe)(tU((0,o.pipe)(i,r.unsafeGet(e))),tx(()=>iL(e+1,t,i))),iU=(0,o.dual)(e=>tc(e[1]),(e,t,r)=>r?.concurrent?is(e,{other:t,onSelfDone:e=>ra(t=>n.suspend(()=>s.zip(e,t))),onOtherDone:e=>ra(t=>n.suspend(()=>s.zip(t,e)))}):tx(e,e=>r6(t,t=>[e,t]))),iz=(0,o.dual)(e=>tc(e[1]),(e,t,r)=>r?.concurrent?r6(iU(e,t,{concurrent:!0}),e=>e[0]):tx(e,e=>rF(t,e))),ij=(0,o.dual)(e=>tc(e[1]),(e,t,r)=>r?.concurrent?r6(iU(e,t,{concurrent:!0}),e=>e[1]):tx(e,()=>t)),iW=Symbol.for("effect/Channel/ChannelException"),iq=e=>({_tag:"ChannelException",[iW]:iW,error:e}),i$=e=>(0,c.hasProperty)(e,iW);e.s(["ChannelException",0,iq,"ChannelExceptionTypeId",0,iW,"acquireUseRelease",0,rO,"as",0,rF,"asVoid",0,e=>r6(e,o.constVoid),"buffer",0,rM,"bufferChunk",0,rA,"catchAll",0,rN,"collect",0,rD,"concatMap",0,rP,"concatOut",0,e=>tm(e),"context",0,rJ,"contextWith",0,e=>r6(rJ(),e),"contextWithChannel",0,rG,"contextWithEffect",0,e=>r3(rJ(),e),"doneCollect",0,r$,"drain",0,rH,"emitCollect",0,e=>tx(r$(e),tU),"ensuring",0,rV,"flatten",0,rK,"foldChannel",0,rZ,"fromEither",0,e=>tP(()=>ee.match(e,{onLeft:tE,onRight:tA})),"fromInput",0,rQ,"fromOption",0,e=>tP(()=>l.match(e,{onNone:()=>tE(l.none()),onSome:tA})),"fromPubSub",0,e=>iF(n.map(eq(e),rY)),"fromPubSubScoped",0,e=>n.map(eq(e),rY),"fromQueue",0,rY,"identityChannel",0,r0,"interruptWhen",0,r1,"interruptWhenDeferred",0,r2,"isChannelException",0,i$,"map",0,r6,"mapEffect",0,r3,"mapError",0,r4,"mapErrorCause",0,r5,"mapInput",0,rL,"mapInputContext",0,im,"mapInputEffect",0,rU,"mapInputError",0,rz,"mapInputErrorEffect",0,rj,"mapInputIn",0,rW,"mapInputInEffect",0,rq,"mapOut",0,r8,"mapOutEffect",0,r7,"mapOutEffectPar",0,r9,"mergeAll",0,ie,"mergeAllUnbounded",0,e=>it({concurrency:"unbounded"})(e,o.constVoid),"mergeAllUnboundedWith",0,(e,t)=>it({concurrency:"unbounded"})(e,t),"mergeAllWith",0,it,"mergeMap",0,ir,"mergeOut",0,ii,"mergeOutWith",0,ia,"mergeWith",0,is,"never",0,io,"orDie",0,il,"orDieWith",0,iu,"orElse",0,ic,"pipeToOrFail",0,ip,"provideLayer",0,ih,"provideService",0,id,"provideSomeLayer",0,ig,"read",0,()=>tO(l.none()),"repeated",0,iy,"run",0,ib,"runCollect",0,e=>ib(td(e)),"runDrain",0,iS,"runScoped",0,iv,"scoped",0,iE,"scopedWith",0,iw,"splitLines",0,i_,"toPubSub",0,ik,"toPull",0,ix,"toPullIn",0,iC,"toQueue",0,iT,"unwrap",0,iO,"unwrapScoped",0,iF,"unwrapScopedWith",0,iM,"updateService",0,iA,"withSpan",0,iN,"writeAll",0,iP,"writeChunk",0,iD,"zip",0,iU,"zipLeft",0,iz,"zipRight",0,ij],565005);var iB=e.i(64176),iH=e.i(649488),iV=e.i(900386),iJ=a,iG=e.i(423616),iK=e.i(405889);let iZ=Symbol.for("effect/RcRef"),iQ={_tag:"Empty"},iY={_tag:"Closed"},iX={_A:o.identity,_E:o.identity};class i0 extends iJ.Class{acquire;context;scope;idleTimeToLive;[iZ]=iX;[iG.TypeId]=iG.TypeId;state=iQ;semaphore=iK.unsafeMakeSemaphore(1);constructor(e,t,r,i){super(),this.acquire=e,this.context=t,this.scope=r,this.idleTimeToLive=i,this.get=i1(this)}get;commit(){return this.get}}let i1=e=>m.uninterruptibleMask(t=>m.suspend(()=>{switch(e.state._tag){case"Closed":return m.interrupt;case"Acquired":return e.state.refCount++,e.state.fiber?m.as(m.interruptFiber(e.state.fiber),e.state):m.succeed(e.state);case"Empty":return g.scopeMake().pipe(rT.bindTo("scope"),rT.bind("value",({scope:r})=>t(m.fiberRefLocally(e.acquire,m.currentContext,X.add(e.context,g.scopeTag,r)))),m.map(({scope:t,value:r})=>{let i={_tag:"Acquired",value:r,scope:t,fiber:void 0,refCount:1};return e.state=i,i}))}})).pipe(e.semaphore.withPermits(1),rT.bindTo("state"),rT.bind("scope",()=>g.scopeTag),m.tap(({scope:t,state:r})=>t.addFinalizer(()=>m.suspend(()=>(r.refCount--,r.refCount>0)?m.void:void 0===e.idleTimeToLive?(e.state=iQ,m.scopeClose(r.scope,m.exitVoid)):rT.sleep(e.idleTimeToLive).pipe(m.interruptible,m.zipRight(m.suspend(()=>"Acquired"===e.state._tag&&0===e.state.refCount?(e.state=iQ,m.scopeClose(r.scope,m.exitVoid)):m.void)),g.ensuring(m.sync(()=>{r.fiber=void 0})),iK.forkIn(e.scope),m.tap(e=>{r.fiber=e}),e.semaphore.withPermits(1))))),m.map(({state:e})=>e.value));var i2=e.i(847279),i6=e.i(943597);let i3=i6.ScheduleTypeId;i6.ScheduleDriverTypeId,i6.makeWithState,i6.isSchedule,i6.addDelay,i6.addDelayEffect,i6.andThen,i6.andThenEither,i6.as,i6.asVoid,i6.bothInOut,i6.check,i6.checkEffect,i6.collectAllInputs,i6.collectAllOutputs,i6.collectUntil,i6.collectUntilEffect,i6.collectWhile,i6.collectWhileEffect,i6.compose,i6.mapInput,i6.mapInputEffect,i6.mapInputContext,i6.count,i6.cron,i6.secondOfMinute,i6.minuteOfHour,i6.hourOfDay,i6.dayOfMonth,i6.dayOfWeek,i6.delayed,i6.delayedEffect,i6.delayedSchedule,i6.delays,i6.mapBoth,i6.mapBothEffect;let i4=i6.driver;i6.duration,i6.either,i6.eitherWith,i6.elapsed,i6.ensuring,i6.exponential,i6.fibonacci,i6.fixed;let i5=i6.forever;i6.fromDelay,i6.fromDelays,i6.fromFunction,i6.identity,i6.passthrough,i6.intersect,i6.intersectWith,i6.jittered,i6.jitteredWith,i6.linear,i6.map,i6.mapEffect,i6.modifyDelay,i6.modifyDelayEffect,i6.onDecision,i6.once,i6.provideContext,i6.provideService,i6.recurUntil,i6.recurUntilEffect,i6.recurUntilOption,i6.recurUpTo,i6.recurWhile,i6.recurWhileEffect,i6.recurs,i6.reduce,i6.reduceEffect,i6.forever,i6.repetitions,i6.resetAfter,i6.resetWhen,i6.run;let i8=i6.spaced;i6.stop,i6.succeed,i6.sync,i6.tapInput,i6.tapOutput,i6.unfold,i6.union,i6.unionWith,i6.untilInput,i6.untilInputEffect,i6.untilOutput,i6.untilOutputEffect,i6.upTo,i6.whileInput,i6.whileInputEffect,i6.whileOutput,i6.whileOutputEffect,i6.windowed,i6.zipLeft,i6.zipRight,i6.zipWith;let i7=i6.CurrentIterationMetadata;e.s(["CurrentIterationMetadata",0,i7,"ScheduleTypeId",0,i3,"driver",0,i4,"forever",0,i5,"spaced",0,i8],56786);let i9={_tag:"Left"},ne={_tag:"Right"},nt={_tag:"Both"},nr={_tag:"Either"};var ni=e.i(408043),nn=e.i(686434),na=e.i(874995),ns=e.i(25560),no=e.i(167804),nl=e.i(214250);let nu=Symbol.for("effect/Sink"),nc={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e};class np{channel;[nu]=nc;constructor(e){this.channel=e}pipe(){return(0,u.pipeArguments)(this,arguments)}}let nf=e=>(0,c.hasProperty)(e,nu),nd=e=>new np(tP(()=>aM(e()))),nh=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,am(()=>t))),nm=()=>new np(ng(r.empty())),ng=e=>tM({onInput:t=>ng((0,o.pipe)(e,r.appendAll(t))),onFailure:t_,onDone:()=>tA(e)}),ny=e=>nd(()=>al(nb(e,r.empty()))),nb=(e,t)=>tM({onInput:i=>{let[n,a]=r.splitAt(i,e);return n.length<e?nb(e-n.length,r.appendAll(t,n)):r.isEmpty(a)?tA(r.appendAll(t,n)):tx(tU(a),()=>tA(r.appendAll(t,n)))},onFailure:t_,onDone:()=>tA(t)}),nS=(e,t)=>tF({onInput:i=>{let[n,a]=(0,o.pipe)(r.toReadonlyArray(i),p.span(e));return 0===a.length?nS(e,(0,o.pipe)(t,r.appendAll(r.unsafeFromArray(n)))):(0,o.pipe)(tU(r.unsafeFromArray(a)),ij(tA((0,o.pipe)(t,r.appendAll(r.unsafeFromArray(n))))))},onFailure:tE,onDone:()=>tA(t)}),nv=(e,t)=>tF({onInput:i=>(0,o.pipe)(tI((0,o.pipe)(i,n.takeWhile(e),n.map(r.unsafeFromArray))),tx(n=>{let a=(0,o.pipe)(i,r.drop(n.length));return r.isEmpty(a)?nv(e,(0,o.pipe)(t,r.appendAll(n))):(0,o.pipe)(tU(a),ij(tA((0,o.pipe)(t,r.appendAll(n)))))})),onFailure:tE,onDone:()=>tA(t)}),nE=(0,o.dual)(2,(e,t)=>{let i=(0,o.pipe)(Q.make(r.empty()),n.zip(Q.make(!1)));return new np((0,o.pipe)(tI(i),tx(([r,i])=>{let n=tF({onInput:e=>(0,o.pipe)(tU(e),tx(()=>n)),onFailure:tE,onDone:e=>(0,o.pipe)(tI(Q.set(i,!0)),rF(e))});return(0,o.pipe)(n,tT(rA(r)),tT(nw(e,r,i,t.initial,t.while,t.body)))})))}),nw=(e,t,i,n,a,s)=>(0,o.pipe)(aM(e),r$,rZ({onFailure:tE,onSuccess:([l,u])=>a(u)?(0,o.pipe)(tI(Q.set(t,r.flatten(l))),tx(()=>(0,o.pipe)(tI(Q.get(i)),tx(c=>{let p=s(n,u);return c?(0,o.pipe)(tU(r.flatten(l)),rF(p)):nw(e,t,i,p,a,s)})))):(0,o.pipe)(tU(r.flatten(l)),rF(n))})),n_=e=>new np((0,o.pipe)(td(aM(e)),r6(([e,t])=>[t,r.flatten(e)]))),nk=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,nC(r.map(t)))),nx=(0,o.dual)(2,(e,t)=>nI(e,e=>n.map(n.forEach(e,e=>t(e)),r.unsafeFromArray))),nC=(0,o.dual)(2,(e,t)=>{let r=tF({onInput:e=>(0,o.pipe)(tU(t(e)),tx(()=>r)),onFailure:tE,onDone:tA});return new np((0,o.pipe)(r,tT(aM(e))))}),nI=(0,o.dual)(2,(e,t)=>{let r=tF({onInput:e=>(0,o.pipe)(tI(t(e)),tx(tU),tx(()=>r)),onFailure:tE,onDone:tA});return new np((0,o.pipe)(r,ip(aM(e))))}),nT=(0,o.dual)(2,(e,t)=>am(nk(e,t.onInput),t.onDone)),nR=(0,o.dual)(2,(e,t)=>ag(nx(e,t.onInput),t.onDone)),nO=(0,o.dual)(2,(e,t)=>am(nC(e,t.onInput),t.onDone)),nF=(0,o.dual)(2,(e,t)=>ag(nI(e,t.onInput),t.onDone)),nM=new np(rH(r0())),nA=e=>nd(()=>new np(nN(e))),nN=e=>tF({onInput:t=>{let i=(0,o.pipe)(t,r.drop(e)),n=Math.max(e-t.length,0);return r.isEmpty(t)||n>0?nN(n):(0,o.pipe)(tU(i),ij(r0()))},onFailure:tE,onDone:()=>tL}),nP=e=>tF({onInput:t=>(0,o.pipe)(t,n.dropUntil(e),n.map(t=>0===t.length?nP(e):(0,o.pipe)(tU(r.unsafeFromArray(t)),ij(r0()))),iO),onFailure:tE,onDone:()=>tL}),nD=e=>new np(nL(e)),nL=e=>tF({onInput:t=>{let i=(0,o.pipe)(t,r.dropWhile(e));return r.isEmpty(i)?nL(e):(0,o.pipe)(tU(i),ij(r0()))},onFailure:tE,onDone:tN}),nU=e=>tF({onInput:t=>(0,o.pipe)(t,n.dropWhile(e),n.map(t=>0===t.length?nU(e):(0,o.pipe)(tU(r.unsafeFromArray(t)),ij(r0()))),iO),onFailure:tE,onDone:()=>tL}),nz=(0,o.dual)(2,(e,t)=>new np((0,o.pipe)(e,aM,rV(t)))),nj=(0,o.dual)(2,(e,t)=>new np((0,o.pipe)(e,aM,tv(t)))),nW=()=>au(n.context()),nq=e=>new np(tE(e)),n$=e=>new np(t_(e)),nB=e=>new np(tk(e)),nH=(0,o.dual)(2,(e,t)=>nI(e,e=>n.map(n.filter(e,t),r.unsafeFromArray))),nV=(0,o.dual)(2,(e,t)=>new np((0,o.pipe)(tI((0,o.pipe)(Q.make(r.empty()),n.zip(Q.make(!1)))),tx(([i,n])=>{let a=tF({onInput:e=>(0,o.pipe)(tU(e),tx(()=>a)),onFailure:tE,onDone:e=>(0,o.pipe)(tI(Q.set(n,!0)),rF(e))}),s=rZ(td(aM(e)),{onFailure:tE,onSuccess:([e,a])=>(0,o.pipe)(tI(t(a)),tx(t=>(0,o.pipe)(tI(Q.set(i,r.flatten(e))),ij((0,o.pipe)(tI(Q.get(n)),tx(i=>t?(0,o.pipe)(tU(r.flatten(e)),rF(l.some(a))):i?(0,o.pipe)(tU(r.flatten(e)),rF(l.none())):s))))))});return(0,o.pipe)(a,tT(rA(i)),tT(s))})))),nJ=(e,t,r)=>nd(()=>new np(nG(e,t,r))),nG=(e,t,i)=>t(e)?tF({onInput:n=>{let[a,s]=nK(e,n,t,i,0,n.length);return r.isNonEmpty(s)?(0,o.pipe)(tU(s),rF(a)):nG(a,t,i)},onFailure:tE,onDone:()=>tN(e)}):tN(e),nK=(e,t,i,n,a,s)=>{if(a===s)return[e,r.empty()];let l=n(e,(0,o.pipe)(t,r.unsafeGet(a)));return i(l)?nK(l,t,i,n,a+1,s):[l,(0,o.pipe)(t,r.drop(a+1))]},nZ=(0,o.dual)(2,(e,t)=>new np((0,o.pipe)(aM(e),td,rZ({onFailure:e=>aM(t.onFailure(e)),onSuccess:([e,i])=>tP(()=>{let n={ref:(0,o.pipe)(e,r.filter(r.isNonEmpty))},a=(0,o.pipe)(tD(()=>{let e=n.ref;return n.ref=r.empty(),e}),tx(e=>iD(e))),s=r0();return tx(td((0,o.pipe)(a,ij(s),tT(aM(t.onSuccess(i))))),([e,t])=>(0,o.pipe)(tA(n.ref),tx(iD),ij(iD(e)),rF(t)))})})))),nQ=(e,t,r)=>nd(()=>new np(nY(e,t,r))),nY=(e,t,r)=>t(e)?tF({onInput:i=>nY(r(e,i),t,r),onFailure:tE,onDone:()=>tN(e)}):tN(e),nX=(e,t,r)=>nd(()=>new np(n0(e,t,r))),n0=(e,t,r)=>t(e)?tF({onInput:i=>(0,o.pipe)(tI(r(e,i)),tx(e=>n0(e,t,r))),onFailure:tE,onDone:()=>tN(e)}):tN(e),n1=(e,t,r)=>nd(()=>new np(n2(e,t,r))),n2=(e,t,r)=>t(e)?tF({onInput:i=>(0,o.pipe)(tI(n6(e,i,t,r)),tx(([e,i])=>(0,o.pipe)(i,l.match({onNone:()=>n2(e,t,r),onSome:t=>(0,o.pipe)(tU(t),rF(e))})))),onFailure:tE,onDone:()=>tN(e)}):tN(e),n6=(e,t,r,i)=>n3(e,t,0,t.length,r,i),n3=(e,t,i,a,s,u)=>i===a?n.succeed([e,l.none()]):(0,o.pipe)(u(e,(0,o.pipe)(t,r.unsafeGet(i))),n.flatMap(e=>s(e)?n3(e,t,i+1,a,s,u):n.succeed([e,l.some((0,o.pipe)(t,r.drop(i+1)))]))),n4=(e,t)=>nQ(e,o.constTrue,t),n5=e=>n8({...e,decompose:r.of}),n8=e=>nd(()=>new np(n7(e.initial,0,!1,e.maxCost,e.cost,e.decompose,e.body))),n7=(e,t,i,n,a,s,l)=>tF({onInput:u=>{let[c,p,f,d]=n9(u,e,t,i,n,a,s,l);return r.isNonEmpty(d)?(0,o.pipe)(tU(d),ij(tN(c))):t>n?tN(c):n7(c,p,f,n,a,s,l)},onFailure:tE,onDone:()=>tN(e)}),n9=(e,t,i,n,a,s,o,l)=>{for(let u=0;u<e.length;u++){let c=r.unsafeGet(e,u),p=i;if((i+=s(t,c))<=a){t=l(t,c),n=!0;continue}let f=o(c);if(f.length<=1&&!n)return[l(t,c),i,!0,r.drop(e,u+1)];if(f.length<=1&&n)return[t,p,n,r.drop(e,u)];e=r.appendAll(f,r.drop(e,u+1)),i=p,u=-1}return[t,i,n,r.empty()]},ae=e=>nd(()=>new np(at(e.initial,e.maxCost,e.cost,e.decompose,e.body,0,!1))),at=(e,t,i,n,a,s,l)=>tF({onInput:u=>(0,o.pipe)(tI(ar(e,t,i,n,a,u,l,s,0)),tx(([e,l,u,c])=>r.isNonEmpty(c)?(0,o.pipe)(tU(c),ij(tN(e))):s>t?tN(e):at(e,t,i,n,a,l,u))),onFailure:tE,onDone:()=>tN(e)}),ar=(e,t,i,a,s,l,u,c,p)=>{if(p===l.length)return n.succeed([e,c,u,r.empty()]);let f=(0,o.pipe)(l,r.unsafeGet(p));return(0,o.pipe)(i(e,f),n.map(e=>c+e),n.flatMap(d=>d<=t?(0,o.pipe)(s(e,f),n.flatMap(e=>ar(e,t,i,a,s,l,!0,d,p+1))):(0,o.pipe)(a(f),n.flatMap(h=>h.length<=1&&!u?(0,o.pipe)(s(e,f),n.map(e=>[e,d,!0,(0,o.pipe)(l,r.drop(p+1))])):h.length<=1&&u?n.succeed([e,c,u,(0,o.pipe)(l,r.drop(p))]):ar(e,t,i,a,s,(0,o.pipe)(h,r.appendAll((0,o.pipe)(l,r.drop(p+1)))),u,c,0)))))},ai=(0,o.dual)(2,(e,t)=>nZ(e,{onFailure:nq,onSuccess:t})),an=e=>{let t=tM({onInput:r=>(0,o.pipe)(tI(n.forEach(r,t=>e(t),{discard:!0})),tx(()=>t)),onFailure:t_,onDone:()=>tL});return new np(t)},aa=e=>{let t=tM({onInput:r=>(0,o.pipe)(tI(e(r)),tx(()=>t)),onFailure:t_,onDone:()=>tL});return new np(t)},as=e=>{let t=tM({onInput:r=>ao(e,r,0,r.length,t),onFailure:t_,onDone:()=>tL});return new np(t)},ao=(e,t,i,n,a)=>i===n?a:(0,o.pipe)(tI(e((0,o.pipe)(t,r.unsafeGet(i)))),tx(s=>s?ao(e,t,i+1,n,a):tU((0,o.pipe)(t,r.drop(i)))),rN(e=>(0,o.pipe)(tU((0,o.pipe)(t,r.drop(i))),ij(tE(e))))),al=e=>new np(e),au=e=>new np(tI(e)),ac=e=>tF({onInput:t=>rZ(tI(e(l.some(t))),{onFailure:([e,t])=>ee.match(e,{onLeft:e=>(0,o.pipe)(tU(t),ij(tE(e))),onRight:e=>(0,o.pipe)(tU(t),ij(tN(e)))}),onSuccess:()=>ac(e)}),onFailure:tE,onDone:()=>rZ(tI(e(l.none())),{onFailure:([e,t])=>ee.match(e,{onLeft:e=>(0,o.pipe)(tU(t),ij(tE(e))),onRight:e=>(0,o.pipe)(tU(t),ij(tN(e)))}),onSuccess:()=>tI(n.dieMessage("BUG: Sink.fromPush - please report an issue at https://github.com/Effect-TS/effect/issues"))})}),ap=(e,t)=>t?.shutdown?aA(n.map(n.acquireRelease(n.succeed(e),Z),ap)):aa(t=>F(e,t)),af=()=>nJ(l.none(),l.isNone,(e,t)=>l.match(e,{onNone:()=>l.some(t),onSome:()=>e})),ad=e=>new np(rH(aM(e))),ah=()=>n4(l.none(),(e,t)=>l.orElse(r.last(t),()=>e)),am=(0,o.dual)(2,(e,t)=>new np((0,o.pipe)(aM(e),r6(t)))),ag=(0,o.dual)(2,(e,t)=>new np((0,o.pipe)(aM(e),r3(t)))),ay=(0,o.dual)(2,(e,t)=>new np((0,o.pipe)(aM(e),r4(t)))),ab=(0,o.dual)(2,(e,t)=>new np((0,o.pipe)(aM(e),r8(r.map(t))))),aS=au(n.never),av=(0,o.dual)(2,(e,t)=>new np((0,o.pipe)(aM(e),ic(()=>aM(t()))))),aE=(0,o.dual)(2,(e,t)=>new np((0,o.pipe)(aM(e),tR(t)))),aw=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,a_(t),am(ee.merge))),a_=(0,o.dual)(e=>nf(e[1]),(e,t,r)=>ak(e,{other:t,onSelfDone:e=>rn(n.map(e,ee.left)),onOtherDone:e=>rn(n.map(e,ee.right)),capacity:r?.capacity??16})),ak=(0,o.dual)(2,(e,t)=>aN(function(r){return n.gen(function*(){let i=yield*eW(t?.capacity??16),n=yield*Y.extend(eq(i),r),a=yield*Y.extend(eq(i),r),s=ik(i),l=rY(n).pipe(tT(aM(e)),iz(tI(Z(n))),is({other:rY(a).pipe(tT(aM(t.other)),iz(tI(Z(a)))),onSelfDone:t.onSelfDone,onOtherDone:t.onOtherDone}));return new np(is(s,{other:l,onSelfDone:()=>ra(o.identity),onOtherDone:e=>rn(e)}))})})),ax=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,aC(t,o.identity))),aC=(0,o.dual)(3,(e,r,i)=>new np((0,o.pipe)(e,aM,rN(e=>l.match(r(e),{onNone:()=>tk(()=>t.die(i(e))),onSome:tE}))))),aI=(0,o.dual)(2,(e,t)=>new np((0,o.pipe)(tI(Q.make(r.empty())),tx(i=>(0,o.pipe)(aT(!1,i,t),ip(aM(e)),td,tx(([e,t])=>(0,o.pipe)(tI(Q.get(i)),tx(i=>(0,o.pipe)(tU((0,o.pipe)(i,r.appendAll(r.flatten(e)))),ij(tA(t))))))))))),aT=(e,t,i)=>tM({onInput:n=>{if(r.isEmpty(n))return aT(e,t,i);if(e){let e=aR(n,i);if(-1===e)return ij(tU(n),aT(!0,t,i));let[a,s]=r.splitAt(n,e);return ij(tU(a),tI(Q.set(t,s)))}let a=aR(n,i,1);if(-1===a)return ij(tU(n),aT(!0,t,i));let[s,l]=(0,o.pipe)(n,r.splitAt(Math.max(a,1)));return ij(tU(s),tI(Q.set(t,l)))},onFailure:t_,onDone:tA}),aR=(e,t,r=0)=>{let i,n=e[Symbol.iterator](),a=0,s=-1;for(;s<0&&(i=n.next())&&!i.done;){let e=i.value;a>=r&&t(e)&&(s=a),a+=1}return s},aO=n4(0,(e,t)=>e+r.reduce(t,0,(e,t)=>e+t)),aF=(0,o.dual)(3,(e,t,r)=>new np((0,o.pipe)(tI(t),tx(i=>(0,o.pipe)(e,aM,tx(e=>(0,o.pipe)(tI(t),r6(t=>[e,r(i,t)])))))))),aM=e=>n.isEffect(e)?aM(au(e)):e.channel,aA=e=>new np(iF(e.pipe(n.map(e=>aM(e))))),aN=e=>new np(iM(t=>e(t).pipe(n.map(e=>aM(e))))),aP=e=>(0,o.pipe)(e,aF(iB.currentTimeMillis,(e,t)=>iH.millis(t-e))),aD=(0,o.dual)(e=>nf(e[1]),(e,t,r)=>az(e,t,(e,t)=>[e,t],r)),aL=(0,o.dual)(e=>nf(e[1]),(e,t,r)=>az(e,t,(e,t)=>e,r)),aU=(0,o.dual)(e=>nf(e[1]),(e,t,r)=>az(e,t,(e,t)=>t,r)),az=(0,o.dual)(e=>nf(e[1]),(e,t,r,i)=>i?.concurrent?ak(e,{other:t,onSelfDone:s.match({onFailure:e=>rn(n.failCause(e)),onSuccess:e=>ra(s.match({onFailure:n.failCause,onSuccess:t=>n.succeed(r(e,t))}))}),onOtherDone:s.match({onFailure:e=>rn(n.failCause(e)),onSuccess:e=>ra(s.match({onFailure:n.failCause,onSuccess:t=>n.succeed(r(t,e))}))})}):ai(e,e=>am(t,t=>r(e,t)))),aj=n4(0,(e,t)=>e+t.length),aW=nd(()=>{let e=[];return(0,o.pipe)(n4(void 0,(t,i)=>r.map(i,t=>{e.push(String(t))})),am(()=>e.join("")))}),aq=(0,o.pipe)(aP(nM),am(e=>e[1]));e.s(["SinkTypeId",0,nu,"as",0,nh,"channelToSink",0,e=>new np(e),"collectAll",0,nm,"collectAllFrom",0,e=>nE(e,{initial:r.empty(),while:o.constTrue,body:(e,t)=>(0,o.pipe)(e,r.append(t))}),"collectAllN",0,ny,"collectAllToMap",0,(e,t)=>n4(nl.empty(),(i,n)=>(0,o.pipe)(n,r.reduce(i,(r,i)=>{let n=e(i),a=(0,o.pipe)(r,nl.has(n))?t((0,o.pipe)(r,nl.unsafeGet(n)),i):i;return(0,o.pipe)(r,nl.set(n,a))}))),"collectAllToMapN",0,(e,t,r)=>n5({initial:nl.empty(),maxCost:e,cost:(e,r)=>+!(0,o.pipe)(e,nl.has(t(r))),body:(e,i)=>{let n=t(i),a=(0,o.pipe)(e,nl.has(n))?r((0,o.pipe)(e,nl.unsafeGet(n)),i):i;return(0,o.pipe)(e,nl.set(n,a))}}),"collectAllToSet",0,()=>n4(eH.empty(),(e,t)=>(0,o.pipe)(t,r.reduce(e,(e,t)=>(0,o.pipe)(e,eH.add(t))))),"collectAllToSetN",0,e=>n5({initial:eH.empty(),maxCost:e,cost:(e,t)=>+!eH.has(e,t),body:(e,t)=>eH.add(e,t)}),"collectAllUntil",0,e=>(0,o.pipe)(nJ([r.empty(),!0],e=>e[1],([t,i],n)=>[(0,o.pipe)(t,r.append(n)),!e(n)]),am(e=>e[0])),"collectAllUntilEffect",0,e=>(0,o.pipe)(n1([r.empty(),!0],e=>e[1],([t,i],a)=>(0,o.pipe)(e(a),n.map(e=>[(0,o.pipe)(t,r.append(a)),!e]))),am(e=>e[0])),"collectAllWhile",0,e=>al(nS(e,r.empty())),"collectAllWhileEffect",0,e=>al(nv(e,r.empty())),"collectAllWhileWith",0,nE,"collectLeftover",0,n_,"context",0,nW,"contextWith",0,e=>(0,o.pipe)(nW(),am(e)),"contextWithEffect",0,e=>(0,o.pipe)(nW(),ag(e)),"contextWithSink",0,e=>new np(iO(n.contextWith(t=>aM(e(t))))),"count",0,aj,"die",0,e=>n$(t.die(e)),"dieMessage",0,e=>n$(t.die(new t.RuntimeException(e))),"dieSync",0,e=>nB(()=>t.die(e())),"dimap",0,nT,"dimapChunks",0,nO,"dimapChunksEffect",0,nF,"dimapEffect",0,nR,"drain",0,nM,"drop",0,nA,"dropUntil",0,e=>new np((0,o.pipe)(aM(nD(t=>!e(t))),ip(aM(nA(1))))),"dropUntilEffect",0,e=>nd(()=>new np(nP(e))),"dropWhile",0,nD,"dropWhileEffect",0,e=>nd(()=>new np(nU(e))),"ensuring",0,nz,"ensuringWith",0,nj,"every",0,e=>nJ(!0,o.identity,(t,r)=>t&&e(r)),"fail",0,nq,"failCause",0,n$,"failCauseSync",0,nB,"failSync",0,e=>new np(tw(e)),"filterInput",0,e=>t=>(0,o.pipe)(t,nC(r.filter(e))),"filterInputEffect",0,nH,"findEffect",0,nV,"flatMap",0,ai,"fold",0,nJ,"foldChunks",0,nQ,"foldChunksEffect",0,nX,"foldEffect",0,n1,"foldLeft",0,(e,t)=>ad(nJ(e,o.constTrue,t)),"foldLeftChunks",0,n4,"foldLeftChunksEffect",0,(e,t)=>ad(nX(e,o.constTrue,t)),"foldLeftEffect",0,(e,t)=>n1(e,o.constTrue,t),"foldSink",0,nZ,"foldUntil",0,(e,t,r)=>(0,o.pipe)(nJ([e,0],e=>e[1]<t,([e,t],i)=>[r(e,i),t+1]),am(e=>e[0])),"foldUntilEffect",0,(e,t,r)=>(0,o.pipe)(n1([e,0],e=>e[1]<t,([e,t],i)=>(0,o.pipe)(r(e,i),n.map(e=>[e,t+1]))),am(e=>e[0])),"foldWeighted",0,n5,"foldWeightedDecompose",0,n8,"foldWeightedDecomposeEffect",0,ae,"foldWeightedEffect",0,e=>ae({...e,decompose:e=>n.succeed(r.of(e))}),"forEach",0,an,"forEachChunk",0,aa,"forEachChunkWhile",0,e=>{let t=tF({onInput:r=>(0,o.pipe)(tI(e(r)),tx(e=>e?t:tL)),onFailure:tE,onDone:()=>tL});return new np(t)},"forEachWhile",0,as,"fromChannel",0,al,"fromEffect",0,au,"fromPubSub",0,(e,t)=>ap(e,t),"fromPush",0,e=>new np(iF((0,o.pipe)(e,n.map(ac)))),"fromQueue",0,ap,"head",0,af,"ignoreLeftover",0,ad,"last",0,ah,"leftover",0,e=>new np(tP(()=>tU(e))),"map",0,am,"mapEffect",0,ag,"mapError",0,ay,"mapInput",0,nk,"mapInputChunks",0,nC,"mapInputChunksEffect",0,nI,"mapInputEffect",0,nx,"mapLeftover",0,ab,"mkString",0,aW,"never",0,aS,"orElse",0,av,"provideContext",0,aE,"race",0,aw,"raceBoth",0,a_,"raceWith",0,ak,"refineOrDie",0,ax,"refineOrDieWith",0,aC,"some",0,e=>nJ(!1,e=>!e,(t,r)=>t||e(r)),"splitWhere",0,aI,"succeed",0,e=>new np(tA(e)),"sum",0,aO,"summarized",0,aF,"suspend",0,nd,"sync",0,e=>new np(tD(e)),"take",0,e=>(0,o.pipe)(nQ(r.empty(),t=>t.length<e,(e,t)=>(0,o.pipe)(e,r.appendAll(t))),ai(t=>{let[i,n]=(0,o.pipe)(t,r.splitAt(e));return new np((0,o.pipe)(tU(n),ij(tN(i))))})),"timed",0,aq,"toChannel",0,aM,"unwrap",0,e=>new np(iO((0,o.pipe)(e,n.map(e=>aM(e))))),"unwrapScoped",0,aA,"unwrapScopedWith",0,aN,"withDuration",0,aP,"zip",0,aD,"zipLeft",0,aL,"zipRight",0,aU,"zipWith",0,az],954277);class a${value;constructor(e){this.value=e}}let aB=(e,t)=>({ref:e,isNew:t,isChanged:!1,expected:e.versioned,newValue:e.versioned.value}),aH=(e,t)=>{e.isChanged=!0,e.newValue=t},aV=e=>{e.ref.versioned=new a$(e.newValue)},aJ=e=>({ref:e.ref,isNew:e.isNew,isChanged:e.isChanged,expected:e.expected,newValue:e.newValue}),aG=e=>e.ref.versioned!==e.expected,aK=e=>e.isChanged,aZ="Invalid",aQ="ReadWrite",aY=e=>{for(let t of e)aV(t[1])},aX=e=>{let t="ReadOnly";for(let[,r]of e)if((t=aG(r)?aZ:aK(r)?aQ:t)===aZ)break;return t},a0="WithSTMRuntime",a1="OnFailure",a2="OnRetry",a6="OnSuccess",a3="Provide",a4="Sync",a5="Succeed",a8="Retry",a7="Fail",a9="Interrupt",se="Fail",st="Interrupt",sr="Succeed",si="Retry",sn="Done",sa="Suspend",ss="Done",so="Interrupted",sl="Running",su="effect/STM/State",sc=Symbol.for(su),sp=e=>(0,c.hasProperty)(e,sc),sf=e=>({[sc]:sc,_tag:ss,exit:e,[ni.symbol](){return(0,o.pipe)(ni.hash(su),ni.combine(ni.hash(ss)),ni.combine(ni.hash(e)),ni.cached(this))},[et.symbol]:t=>sp(t)&&t._tag===ss&&et.equals(e,t.exit)}),sd=(0,o.pipe)(ni.hash(su),ni.combine(ni.hash(so)),ni.combine(ni.hash("interrupted"))),sh={[sc]:sc,_tag:so,[ni.symbol]:()=>sd,[et.symbol]:e=>sp(e)&&e._tag===so},sm=(0,o.pipe)(ni.hash(su),ni.combine(ni.hash(sl)),ni.combine(ni.hash("running"))),sg={[sc]:sc,_tag:sl,[ni.symbol]:()=>sm,[et.symbol]:e=>sp(e)&&e._tag===sl},sy=e=>{switch(e._tag){case se:return sf(s.fail(e.error));case"Die":return sf(s.die(e.defect));case st:return sf(s.interrupt(e.fiberId));case sr:return sf(s.succeed(e.value));case si:throw Error("BUG: STM.STMState.fromTExit - please report an issue at https://github.com/Effect-TS/effect/issues")}},sb="effect/TExit",sS=Symbol.for(sb),sv={_A:e=>e,_E:e=>e},sE=e=>(0,c.hasProperty)(e,sS),sw=e=>({[sS]:sv,_tag:se,error:e,[ni.symbol](){return(0,o.pipe)(ni.hash(sb),ni.combine(ni.hash(se)),ni.combine(ni.hash(e)),ni.cached(this))},[et.symbol]:t=>sE(t)&&t._tag===se&&et.equals(e,t.error)}),s_=e=>({[sS]:sv,_tag:"Die",defect:e,[ni.symbol](){return(0,o.pipe)(ni.hash(sb),ni.combine(ni.hash("Die")),ni.combine(ni.hash(e)),ni.cached(this))},[et.symbol]:t=>sE(t)&&"Die"===t._tag&&et.equals(e,t.defect)}),sk=e=>({[sS]:sv,_tag:st,fiberId:e,[ni.symbol](){return(0,o.pipe)(ni.hash(sb),ni.combine(ni.hash(st)),ni.combine(ni.hash(e)),ni.cached(this))},[et.symbol]:t=>sE(t)&&t._tag===st&&et.equals(e,t.fiberId)}),sx=e=>({[sS]:sv,_tag:sr,value:e,[ni.symbol](){return(0,o.pipe)(ni.hash(sb),ni.combine(ni.hash(sr)),ni.combine(ni.hash(e)),ni.cached(this))},[et.symbol]:t=>sE(t)&&t._tag===sr&&et.equals(e,t.value)}),sC=(0,o.pipe)(ni.hash(sb),ni.combine(ni.hash(si)),ni.combine(ni.hash("retry"))),sI={[sS]:sv,_tag:si,[ni.symbol]:()=>sC,[et.symbol]:e=>sE(e)&&e._tag===si},sT=e=>({_tag:sa,journal:e}),sR={ref:0},sO=Symbol.for("effect/STM"),sF={_R:e=>e,_E:e=>e,_A:e=>e};class sM{effect_instruction_i0;_op=ns.OP_COMMIT;effect_instruction_i1=void 0;effect_instruction_i2=void 0;[n.EffectTypeId];[na.StreamTypeId];[nu];[tl];get[sO](){return sF}constructor(e){this.effect_instruction_i0=e,this[n.EffectTypeId]=na.effectVariance,this[na.StreamTypeId]=sF,this[nu]=sF,this[tl]=sF}[et.symbol](e){return this===e}[ni.symbol](){return ni.cached(this,ni.random(this))}[Symbol.iterator](){return new no.SingleShotGen(new nn.YieldWrap(this))}commit(){return sA(this,o.constVoid,o.constVoid)}pipe(){return(0,u.pipeArguments)(this,arguments)}}let sA=(e,t,r)=>(0,m.withFiberRuntime)(i=>{let a=i.id(),s=i.getFiberRef(ei.currentContext),l=i.getFiberRef(ei.currentScheduler),u=i.getFiberRef(ei.currentSchedulingPriority),c=sN(a,e,s,l,u);switch(c._tag){case sn:return t(c.exit),c.exit;case sa:{let i,c=(i=sR.ref+1,sR.ref=i,i),p={value:sg},f=n.async(t=>sP(a,e,c,p,s,l,u,t));return n.uninterruptibleMask(e=>(0,o.pipe)(e(f),n.catchAllCause(e=>{let i=p.value;return i._tag===sl&&(p.value=sh),(i=p.value)._tag===ss?(t(i.exit),i.exit):(r(),n.failCause(e))})))}}}),sN=(e,r,i,n,a)=>{let o=new Map,l=new sU(r,o,e,i).run(),u=aX(o);if(u===aQ&&l._tag===sr)aY(o);else if(u===aZ)throw Error("BUG: STM.TryCommit.tryCommitSync - please report an issue at https://github.com/Effect-TS/effect/issues");switch(l._tag){case sr:return sD(s.succeed(l.value),o,n,a);case se:{let e=t.fail(l.error);return sD(s.failCause(e),o,n,a)}case"Die":{let e=t.die(l.defect);return sD(s.failCause(e),o,n,a)}case st:{let r=t.interrupt(e);return sD(s.failCause(r),o,n,a)}case si:return sT(o)}},sP=(e,r,i,n,a,o,l,u)=>{if(n.value._tag===sl){let c=((e,r,i,n,a,o)=>{let l=new Map,u=new sU(r,l,e,n).run(),c=aX(l);if(c===aQ)aY(l);else if(c===aZ)throw Error("BUG: STM.TryCommit.tryCommit - please report an issue at https://github.com/Effect-TS/effect/issues");switch(u._tag){case sr:return i.value=sy(u),sD(s.succeed(u.value),l,a,o);case se:{i.value=sy(u);let e=t.fail(u.error);return sD(s.failCause(e),l,a,o)}case"Die":{i.value=sy(u);let e=t.die(u.defect);return sD(s.failCause(e),l,a,o)}case st:{i.value=sy(u);let r=t.interrupt(e);return sD(s.failCause(r),l,a,o)}case si:return sT(l)}})(e,r,n,a,o,l);switch(c._tag){case sn:sL(c.exit,u);break;case sa:((e,t,r)=>{for(let[,i]of t)i.ref.todos.has(e)||i.ref.todos.set(e,r)})(i,c.journal,()=>sP(e,r,i,n,a,o,l,u))}}},sD=(e,t,r,i)=>{let n=(e=>{let t=new Map;for(let[,r]of e){for(let e of r.ref.todos)t.set(e[0],e[1]);r.ref.todos=new Map}return t})(t);return n.size>0&&r.scheduleTask(()=>(e=>{for(let[t,r]of Array.from(e.entries()).sort((e,t)=>e[0]-t[0]))r()})(n),i),{_tag:sn,exit:e}},sL=(e,t)=>{t(e)};class sU{self;journal;fiberId;contStack=[];env;constructor(e,t,r,i){this.self=e,this.journal=t,this.fiberId=r,this.env=i}getEnv(){return this.env}pushStack(e){this.contStack.push(e)}popStack(){return this.contStack.pop()}nextSuccess(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==a6;)e=this.popStack();return e}nextFailure(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==a1;)e=this.popStack();return e}nextRetry(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==a2;)e=this.popStack();return e}run(){let e,r=this.self;for(;void 0===e&&void 0!==r;)try{let i=r;if(i)switch(i._op){case"Tag":r=s$((e,t,r)=>X.unsafeGet(r,i));break;case"Left":r=sH(i.left);break;case"None":r=sH(new t.NoSuchElementException);break;case"Right":r=s0(i.right);break;case"Some":r=s0(i.value);break;case"Commit":switch(i.effect_instruction_i0){case"Die":e=s_((0,nn.internalCall)(()=>i.effect_instruction_i1()));break;case a7:{let t=this.nextFailure();void 0===t?e=sw((0,nn.internalCall)(()=>i.effect_instruction_i1())):r=(0,nn.internalCall)(()=>t.effect_instruction_i2((0,nn.internalCall)(()=>i.effect_instruction_i1())));break}case a8:{let t=this.nextRetry();void 0===t?e=sI:r=(0,nn.internalCall)(()=>t.effect_instruction_i2());break}case a9:e=sk(this.fiberId);break;case a0:r=(0,nn.internalCall)(()=>i.effect_instruction_i1(this));break;case a6:case a1:case a2:this.pushStack(i),r=i.effect_instruction_i1;break;case a3:{let e=this.env;this.env=(0,nn.internalCall)(()=>i.effect_instruction_i2(e)),r=(0,o.pipe)(i.effect_instruction_i1,sB(s1(()=>this.env=e)));break}case a5:{let t=i.effect_instruction_i1,n=this.nextSuccess();void 0===n?e=sx(t):r=(0,nn.internalCall)(()=>n.effect_instruction_i2(t));break}case a4:{let t=(0,nn.internalCall)(()=>i.effect_instruction_i1()),n=this.nextSuccess();void 0===n?e=sx(t):r=(0,nn.internalCall)(()=>n.effect_instruction_i2(t))}}}}catch(e){r=sW(e)}return e}}let sz=(0,o.dual)(2,(e,t)=>{let r=new sM(a1);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),sj=(0,o.dual)(2,(e,t)=>{let r=new sM(a3);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),sW=e=>sq(()=>e),sq=e=>{let t=new sM("Die");return t.effect_instruction_i1=e,t},s$=e=>sK(t=>s0(e(t.journal,t.fiberId,t.getEnv()))),sB=(0,o.dual)(2,(e,t)=>sG(e,{onFailure:e=>s2(t,sH(e)),onSuccess:e=>s2(t,s0(e))})),sH=e=>sV(()=>e),sV=e=>{let t=new sM(a7);return t.effect_instruction_i1=e,t},sJ=(0,o.dual)(2,(e,t)=>{let r=new sM(a6);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),sG=(0,o.dual)(2,(e,{onFailure:t,onSuccess:r})=>(0,o.pipe)(e,sQ(ee.right),sz(e=>(0,o.pipe)(t(e),sQ(ee.left))),sJ(e=>{switch(e._tag){case"Left":return s0(e.left);case"Right":return r(e.right)}}))),sK=e=>{let t=new sM(a0);return t.effect_instruction_i1=e,t},sZ=e=>{let t=new sM(a9);return t.effect_instruction_i1=e,t},sQ=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,sJ(e=>s1(()=>t(e))))),sY=(0,o.dual)(2,(e,t)=>{let r=new sM(a2);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),sX=new sM(a8),s0=e=>{let t=new sM(a5);return t.effect_instruction_i1=e,t},s1=e=>{let t=new sM(a4);return t.effect_instruction_i1=e,t},s2=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,sJ(()=>t))),s6=(0,o.dual)(3,(e,t,r)=>(0,o.pipe)(e,sJ(e=>(0,o.pipe)(t,sQ(t=>r(e,t)))))),s3=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,sQ(()=>t))),s4=((e,t)=>sG(e,{onFailure:sH,onSuccess:e=>{let r=t(e);return l.isSome(r)?r.value:sX}}),(0,o.dual)(2,(e,{onFailure:t,onSuccess:r})=>sG(e,{onFailure:e=>s0(t(e)),onSuccess:e=>s0(r(e))}))),s5=(0,o.dual)(e=>c.isIterable(e[0]),(e,t,r)=>r?.discard?(0,o.pipe)(s1(()=>e[Symbol.iterator]()),sJ(e=>{let r=s7(()=>{let i=e.next();return i.done?oe:(0,o.pipe)(t(i.value),sJ(()=>r))});return r})):s7(()=>p.fromIterable(e).reduce((e,r)=>s6(e,t(r),(e,t)=>(e.push(t),e)),s0([])))),s8=((e,t)=>sG(e,{onFailure:e=>sH(t(e)),onSuccess:s0}),(0,o.dual)(2,(e,t)=>sj(e,e=>t))),s7=((e,t,r)=>{let i;return i=i=>sJ(r,r=>s8(e,X.add(i,t,r))),sJ(s$((e,t,r)=>r),i)},e=>sJ(s1(e),o.identity)),s9=(0,o.dual)(2,(e,t)=>sJ(e,e=>s3(t(e),e))),oe=s0(void 0),ot=Symbol.for("effect/TRef"),or={_A:e=>e};class oi{[ot]=or;todos;versioned;constructor(e){this.versioned=new a$(e),this.todos=new Map}modify(e){return s$(t=>{let r=os(this,t),[i,n]=e(r.newValue);return aH(r,n),i})}pipe(){return(0,u.pipeArguments)(this,arguments)}}let on=e=>e.modify(e=>[e,e]),oa=(0,o.dual)(2,(e,t)=>e.modify(()=>[void 0,t])),os=(e,t)=>{if(t.has(e))return t.get(e);let r=aB(e,!1);return t.set(e,r),r},oo=(0,o.dual)(2,(e,t)=>os(e,t).newValue),ol=(0,o.dual)(3,(e,t,r)=>{aH(os(e,r),t)}),ou=Symbol.for("effect/TQueue/TDequeue"),oc={_Out:e=>e},op=((e,t,i)=>s7(()=>{let n=(t,i,a)=>i<t?s0(a):(0,o.pipe)(e.takeUpTo(i),sJ(s=>{let l=t-s.length;return 1===l?(0,o.pipe)(e.take,sQ(e=>(0,o.pipe)(a,r.appendAll(r.unsafeFromArray(s)),r.append(e)))):l>1?(0,o.pipe)(e.take,sJ(e=>n(l-1,i-s.length-1,(0,o.pipe)(a,r.appendAll(r.unsafeFromArray(s)),r.append(e))))):s0((0,o.pipe)(a,r.appendAll(r.unsafeFromArray(s))))}));return sQ(n(t,i,r.empty()),e=>Array.from(e))}),Symbol.for("effect/TPubSub")),of=Symbol.for("effect/TPubSub/AbsentValue"),od=(e,t,r)=>({head:e,subscribers:t,tail:r});class oh{pubsubSize;publisherHead;requestedCapacity;subscriberHead;subscriberCount;subscribers;[op]=op;[ou]=oc;constructor(e,t,r,i,n,a){this.pubsubSize=e,this.publisherHead=t,this.requestedCapacity=r,this.subscriberHead=i,this.subscriberCount=n,this.subscribers=a}isShutdown=s$(e=>void 0===oo(this.subscriberHead,e));awaitShutdown=sJ(this.isShutdown,e=>e?oe:sX);capacity(){return this.requestedCapacity}size=sK(e=>{let t=oo(this.subscriberHead,e.journal);if(void 0===t)return sZ(e.fiberId);let r=!0,i=0;for(;r;){let n=oo(t,e.journal);void 0===n?r=!1:(n.head!==of&&(i+=1)>=Number.MAX_SAFE_INTEGER&&(r=!1),t=n.tail)}return s0(i)});isEmpty=sQ(this.size,e=>0===e);isFull=sQ(this.size,e=>e===this.capacity());peek=sK(e=>{let t=oo(this.subscriberHead,e.journal);if(void 0===t)return sZ(e.fiberId);let r=of,i=!0;for(;i;){let n=oo(t,e.journal);if(void 0===n)return sX;let a=n.head,s=n.tail;a!==of?(r=a,i=!1):t=s}return s0(r)});peekOption=sK(e=>{let t=oo(this.subscriberHead,e.journal);if(void 0===t)return sZ(e.fiberId);let r=l.none(),i=!0;for(;i;){let n=oo(t,e.journal);if(void 0===n)r=l.none(),i=!1;else{let e=n.head,a=n.tail;e!==of?(r=l.some(e),i=!1):t=a}}return s0(r)});shutdown=s$(e=>{let t=oo(this.subscriberHead,e);if(void 0!==t){ol(this.subscriberHead,void 0,e);let r=!0;for(;r;){let i=oo(t,e);if(void 0===i)r=!1;else{let r=i.head,n=i.tail;if(r!==of){let a=i.subscribers;if(1===a){let r=oo(this.pubsubSize,e);ol(t,od(of,0,n),e),ol(this.publisherHead,n,e),ol(this.pubsubSize,r-1,e)}else ol(t,od(r,a-1,n),e)}t=n}}let i=oo(this.subscriberCount,e);ol(this.subscriberCount,i-1,e),ol(this.subscribers,eH.remove(oo(this.subscribers,e),this.subscriberHead),e)}});take=sK(e=>{let t=oo(this.subscriberHead,e.journal);if(void 0===t)return sZ(e.fiberId);let r=of,i=!0;for(;i;){let n=oo(t,e.journal);if(void 0===n)return sX;let a=n.head,s=n.tail;if(a!==of){let o=n.subscribers;if(1===o){let r=oo(this.pubsubSize,e.journal);ol(t,od(of,0,s),e.journal),ol(this.publisherHead,s,e.journal),ol(this.pubsubSize,r-1,e.journal)}else ol(t,od(a,o-1,s),e.journal);ol(this.subscriberHead,s,e.journal),r=a,i=!1}else t=s}return s0(r)});takeAll=this.takeUpTo(1/0);takeUpTo(e){return sK(t=>{let r=oo(this.subscriberHead,t.journal);if(void 0===r)return sZ(t.fiberId);let i=[],n=0;for(;n!==e;){let a=oo(r,t.journal);if(void 0===a)n=e;else{let e=a.head,s=a.tail;if(e!==of){let o=a.subscribers;if(1===o){let e=oo(this.pubsubSize,t.journal);ol(r,od(of,0,s),t.journal),ol(this.publisherHead,s,t.journal),ol(this.pubsubSize,e-1,t.journal)}else ol(r,od(e,o-1,s),t.journal);i.push(e),n+=1}r=s}}return ol(this.subscriberHead,r,t.journal),s0(i)})}}var om=e.i(434596),og=e.i(717222);class oy{capacity;array;size=0;current=0;constructor(e){this.capacity=e,this.array=Array.from({length:e},o.constUndefined)}head(){return l.fromNullable(this.array[this.current])}lastOrNull(){if(0===this.size)return;let e=0===this.current?this.array.length-1:this.current-1;return this.array[e]??void 0}put(e){this.array[this.current]=e,this.increment()}dropLast(){this.size>0&&(this.decrement(),this.array[this.current]=void 0)}toChunk(){let e=this.current-this.size,t=e<0?[...this.array.slice(this.capacity+e,this.capacity),...this.array.slice(0,this.current)]:this.array.slice(e,this.current);return r.fromIterable(t)}increment(){this.size<this.capacity&&(this.size+=1),this.current=(this.current+1)%this.capacity}decrement(){this.size-=1,this.current>0?this.current-=1:this.current=this.capacity-1}}let ob="NotStarted",oS="Previous",ov="Current",oE={_tag:ob},ow=e=>Object.assign(e,{chunk(e){return this(n.succeed(e))},die(e){return this(n.die(e))},dieMessage(e){return this(n.dieMessage(e))},done(e){return this(n.suspend(()=>s.mapBoth(e,{onFailure:l.some,onSuccess:r.of})))},end(){return this(n.fail(l.none()))},fail(e){return this(n.fail(l.some(e)))},fromEffect(e){return this(n.mapBoth(e,{onFailure:l.some,onSuccess:r.of}))},fromEffectChunk(e){return this((0,o.pipe)(e,n.mapError(l.some)))},halt(e){return this(n.failCause((0,o.pipe)(e,t.map(l.some))))},single(e){return this(n.succeed(r.of(e)))}}),o_=Symbol.for("effect/Stream/Handoff"),ok="Empty",ox="Full",oC=e=>({_tag:ok,notifyConsumer:e}),oI=(e,t)=>r=>{switch(r._tag){case ok:return e(r.notifyConsumer);case ox:return t(r.value,r.notifyProducer)}},oT={_A:e=>e},oR=()=>(0,o.pipe)(i.make(),n.flatMap(e=>Q.make(oC(e))),n.map(e=>({[o_]:oT,ref:e}))),oO=(0,o.dual)(2,(e,t)=>n.flatMap(i.make(),r=>n.flatten(Q.modify(e.ref,a=>(0,o.pipe)(a,oI(e=>[n.zipRight(i.succeed(e,void 0),i.await(r)),{_tag:ox,value:t,notifyProducer:r}],(r,s)=>[n.flatMap(i.await(s),()=>(0,o.pipe)(e,oO(t))),a])))))),oF=e=>n.flatMap(i.make(),t=>n.flatten(Q.modify(e.ref,r=>(0,o.pipe)(r,oI(t=>[n.flatMap(i.await(t),()=>oF(e)),r],(e,r)=>[n.as(i.succeed(r,void 0),e),oC(t)]))))),oM="Emit",oA="Halt",oN=e=>({_tag:oM,elements:e}),oP=e=>({_tag:oA,cause:e}),oD=e=>({_tag:"End",reason:e}),oL=Symbol.for("effect/Take"),oU={_A:e=>e,_E:e=>e};class oz{exit;[oL]=oU;constructor(e){this.exit=e}pipe(){return(0,u.pipeArguments)(this,arguments)}}let oj=e=>new oz(s.succeed(e)),oW=e=>n.suspend(()=>e.exit),oq=new oz(s.fail(l.none())),o$=e=>new oz(s.failCause((0,o.pipe)(e,t.map(l.some)))),oB=e=>n.matchCause(e,{onFailure:e=>l.match(t.flipCauseOption(e),{onNone:()=>oq,onSome:o$}),onSuccess:oj}),oH=(0,o.dual)(2,(e,{onEnd:r,onFailure:i,onSuccess:n})=>s.match(e.exit,{onFailure:e=>l.match(t.flipCauseOption(e),{onNone:r,onSome:i}),onSuccess:n})),oV=e=>new oz(s.succeed(r.of(e))),oJ=()=>n.fail(l.none()),oG=e=>n.mapError(n.failCause(e),l.some),oK="ScheduleEnd",oZ="UpstreamEnd",oQ={_tag:oK},oY={_tag:oZ},oX="DrainLeft",o0="DrainRight",o1="PullBoth",o2="PullLeft",o6="PullRight",o3={_tag:oX},o4={_tag:o0},o5={_tag:o1},o8=e=>({_tag:o2,rightChunk:e}),o7=e=>({_tag:o6,leftChunk:e}),o9="PullBoth",le="PullLet",lt="PullRight",lr={_tag:o9},li=e=>({_tag:le,rightChunk:e}),ln=e=>({_tag:lt,leftChunk:e}),la=Symbol.for("effect/Stream"),ls={_R:e=>e,_E:e=>e,_A:e=>e};class lo{channel;[la]=ls;constructor(e){this.channel=e}pipe(){return(0,u.pipeArguments)(this,arguments)}}let ll=e=>(0,c.hasProperty)(e,la)||n.isEffect(e),lu=4096,lc=e=>{let t=e=>tF({onInput:i=>{let n=r.appendAll(e,i);return tx(tU(n),()=>t(n))},onFailure:tE,onDone:()=>tL});return new lo(tT(uT(e),t(r.empty())))},lp=(e,t)=>pC(n.acquireRelease(e,t)),lf=(0,o.dual)(2,(e,t)=>ld(e,t,i5)),ld=(0,o.dual)(3,(e,t,r)=>uf(lh(e,t,r),e=>ee.match(e,{onLeft:l.none,onRight:l.some}))),lh=(0,o.dual)(3,(e,i,a)=>uF(n.all([oR(),Q.make(oQ),Q.make(r.empty()),i4(a),Q.make(!1),Q.make(!1)])).pipe(ub(([a,s,u,c,p,f])=>{let d=tM({onInput:e=>tx(tI((0,o.pipe)(a,oO(oN(e)),n.when(()=>r.isNonEmpty(e)))),()=>d),onFailure:e=>tI(oO(a,oP(e))),onDone:()=>tI(oO(a,oD(oY)))}),h=(0,o.pipe)(Q.getAndSet(u,r.empty()),n.flatMap(e=>r.isNonEmpty(e)?(0,o.pipe)(Q.set(p,!0),n.zipRight(n.succeed((0,o.pipe)(tU(e),tx(()=>h))))):(0,o.pipe)(oF(a),n.map(e=>{switch(e._tag){case oM:return(0,o.pipe)(tI(Q.set(p,!0)),ij(tU(e.elements)),ij(tI(Q.get(f))),tx(e=>e?tL:h));case oA:return t_(e.cause);case"End":if(e.reason._tag===oK)return(0,o.pipe)(Q.get(p),n.map(e=>e?tI((0,o.pipe)(Q.set(s,oQ),n.zipRight(Q.set(f,!0)))):(0,o.pipe)(tI((0,o.pipe)(Q.set(s,oQ),n.zipRight(Q.set(f,!0)))),tx(()=>h))),iO);return(0,o.pipe)(Q.set(s,e.reason),n.zipRight(Q.set(f,!0)),tI)}}))),iO),m=(e,d,g)=>{let y=(0,o.pipe)(Q.set(p,!1),n.zipRight(Q.set(f,!1)),n.zipRight((0,o.pipe)(h,ip(aM(i)),td,ib,n.forkIn(g)))),b=(e,t,i)=>(0,o.pipe)(Q.set(u,r.flatten(e)),n.zipRight(n.map(Q.get(s),e=>{switch(e._tag){case oK:let a;return(0,o.pipe)(n.all([Q.get(p),y,(0,o.pipe)((a=l.some(t),c.next(a)),n.forkIn(g))]),n.map(([e,n,a])=>{let s=(0,o.pipe)(i,l.match({onNone:()=>r.of(ee.right(t)),onSome:e=>r.make(ee.right(t),ee.left(e))}));return e?(0,o.pipe)(tU(s),tx(()=>m(n,a,g))):m(n,a,g)}),iO);case oZ:return(0,o.pipe)(Q.get(p),n.map(e=>e?tU(r.of(ee.right(t))):tL),iO)}})),iO);return iO(n.raceWith(er.join(e),er.join(d),{onSelfDone:(e,t)=>(0,o.pipe)(er.interrupt(d),n.zipRight((0,o.pipe)(n.suspend(()=>e),n.map(([e,t])=>b(e,t,l.none()))))),onOtherDone:(r,i)=>n.matchCauseEffect(n.suspend(()=>r),{onFailure:r=>ee.match(t.failureOrCause(r),{onLeft:()=>(0,o.pipe)(a,oO(oD(oQ)),n.forkDaemon,n.zipRight((0,o.pipe)(er.join(e),n.map(([e,t])=>b(e,t,l.none()))))),onRight:t=>(0,o.pipe)(a,oO(oP(t)),n.forkDaemon,n.zipRight((0,o.pipe)(er.join(e),n.map(([e,t])=>b(e,t,l.none())))))}),onSuccess:t=>(0,o.pipe)(a,oO(oD(oQ)),n.forkDaemon,n.zipRight((0,o.pipe)(er.join(e),n.map(([e,r])=>b(e,r,l.some(t))))))})}))};return fl(t=>tT(uT(e),d).pipe(ib,n.forkIn(t),n.zipRight(ip(h,aM(i)).pipe(td,ib,n.forkIn(t),n.flatMap(e=>{let r;return(r=l.none(),c.next(r)).pipe(n.forkIn(t),n.map(r=>new lo(m(e,r,t))))})))))}))),lm=(0,o.dual)(2,(e,t)=>u2(e,()=>t)),lg=e=>{if("unbounded"===e)return K();if("number"==typeof e||void 0===e)return V(e??16);switch(e.strategy){case"dropping":return J(e.bufferSize??16);case"sliding":return G(e.bufferSize??16);default:return V(e.bufferSize??16)}},ly=(e,t)=>n.acquireRelease(t?.bufferSize==="unbounded"||t?.bufferSize===void 0&&t?.strategy===void 0?K():t?.strategy==="sliding"?G(t.bufferSize??16):J(t?.bufferSize??16),Z).pipe(n.tap(t=>ei.getWith(ei.currentScheduler,i=>e(((e,t)=>{let i=!1,n=[],a=!1;function o(e){if(i)return!1;if(e.length<=5e4)n.push.apply(n,e);else for(let t=0;t<e.length;t++)n.push(e[0]);return a||(a=!0,t.scheduleTask(l,0)),!0}function l(){a=!1,n.length>0&&(e.unsafeOffer(n),n=[])}function u(t){i||(i=!0,"Success"===t._tag&&n.push(t.value),l(),e.unsafeOffer("Success"===t._tag?s.void:t))}return{single:e=>!i&&(n.push(e),a||(a=!0,t.scheduleTask(l,0)),!0),array:o,chunk:e=>o(r.toReadonlyArray(e)),done:u,end(){i||(i=!0,l(),e.unsafeOffer(s.void))},halt:e=>u(s.failCause(e)),fail:e=>u(s.fail(e)),die:e=>u(s.die(e)),dieMessage:e=>u(s.die(Error(e)))}})(t,i)))),n.map(e=>{let t=tx(M(e),e=>s.isExit(e)?s.isSuccess(e)?tL:t_(e.cause):ij(tU(r.unsafeFromArray(e)),t));return t}),iF,uI),lb=(0,o.dual)(3,(e,t,i)=>pD(()=>{let n=e=>tF({onInput:i=>{if(e.length+i.length>=t){let[n,s]=(0,o.pipe)(i,r.splitAt(t-e.length));return a((0,o.pipe)(e,r.appendAll(n)),s)}return n((0,o.pipe)(e,r.appendAll(i)))},onFailure:tE,onDone:()=>a(e,r.empty())}),a=(e,t)=>tT(ij(tU(t),r0()),uT(i(e)));return new lo((0,o.pipe)(uT(e),ip(n(r.empty()))))})),lS=(0,o.dual)(3,(e,t,r)=>(0,o.pipe)(e,lw(t,r),n.map(e=>e.map(e=>ux(uL(e,{shutdown:!0})))))),lv=(0,o.dual)(2,(e,t)=>n.map(p2(e,t),e=>ux(uA(e)))),lE=(0,o.dual)(2,(e,t)=>{let r;return n.map((r={acquire:lv(e,t),idleTimeToLive:t.idleTimeToLive},m.withFiberRuntime(e=>{let t=e.getFiberRef(m.currentContext),i=X.get(t,g.scopeTag),n=new i0(r.acquire,t,i,r.idleTimeToLive?iH.decode(r.idleTimeToLive):void 0);return m.as(i.addFinalizer(()=>n.semaphore.withPermits(1)(m.suspend(()=>{let e="Acquired"===n.state._tag?m.scopeClose(n.state.scope,m.exitVoid):m.void;return n.state=iY,e}))),n)})),e=>fo(i1(e)))}),lw=(0,o.dual)(3,(e,t,r)=>n.flatMap(p1(r),r=>(0,o.pipe)(n.all(Array.from({length:t},()=>eq(r))),n.tap(()=>n.forkScoped(pm(e,r)))))),l_=(0,o.dual)(2,(e,t)=>n.map(p2(e,t),eq)),lk=(0,o.dual)(2,(e,i)=>{if("unbounded"===i.capacity)return lO(e);if("dropping"===i.strategy)return lT(e,i.capacity);if("sliding"===i.strategy)return lR(e,i.capacity);let a=p4(e,i);return new lo(iF(n.map(a,e=>{let i=(0,o.pipe)(tI(M(e)),tx(s.match({onFailure:e=>(0,o.pipe)(t.flipCauseOption(e),l.match({onNone:()=>tL,onSome:t_})),onSuccess:e=>tx(tU(r.of(e)),()=>i)})));return i})))}),lx=(0,o.dual)(2,(e,t)=>{if("dropping"===t.strategy)return lC(e,t.capacity);if("sliding"===t.strategy)return lI(e,t.capacity);let r=p3(e,t);return new lo(iF(n.map(r,e=>{let t=(0,o.pipe)(tI(M(e)),tx(oH({onEnd:()=>tL,onFailure:t_,onSuccess:e=>(0,o.pipe)(tU(e),tx(()=>t))})));return t})))}),lC=(0,o.dual)(2,(e,t)=>new lo(lF(n.acquireRelease(J(t),e=>Z(e)),uT(e)))),lI=(0,o.dual)(2,(e,t)=>new lo(lF(n.acquireRelease(G(t),e=>Z(e)),uT(e)))),lT=(0,o.dual)(2,(e,t)=>new lo(lF(n.acquireRelease(J(t),e=>Z(e)),uT(cV(1)(e))))),lR=(0,o.dual)(2,(e,t)=>new lo(lF(n.acquireRelease(G(t),e=>Z(e)),uT((0,o.pipe)(e,cV(1)))))),lO=e=>{let t=p3(e,{strategy:"unbounded"});return new lo(iF(n.map(t,e=>{let t=(0,o.pipe)(tI(M(e)),tx(oH({onEnd:()=>tL,onFailure:t_,onSuccess:e=>tx(tU(e),()=>t)})));return t})))},lF=(e,t)=>{let r=(e,t)=>{let a=r=>(0,o.pipe)(Q.get(t),n.tap(i.await),n.zipRight(i.make()),n.flatMap(a=>(0,o.pipe)(O(e,[r,a]),n.zipRight(Q.set(t,a)),n.zipRight(i.await(a)))),n.asVoid,tI);return tM({onInput:a=>(0,o.pipe)(i.make(),n.flatMap(r=>(0,o.pipe)(O(e,[oj(a),r]),n.flatMap(e=>(0,o.pipe)(Q.set(t,r),n.when(()=>e))))),n.asVoid,tI,tx(()=>r(e,t))),onFailure:e=>a(o$(e)),onDone:()=>a(oq)})};return iF((0,o.pipe)(e,n.flatMap(e=>(0,o.pipe)(i.make(),n.tap(e=>i.succeed(e,void 0)),n.flatMap(a=>{let s;return(0,o.pipe)(Q.make(a),n.flatMap(i=>(0,o.pipe)(t,tT(r(e,i)),iv,n.forkScoped)),n.as(s=(0,o.pipe)(tI(M(e)),tx(([e,t])=>ij(tI(i.succeed(t,void 0)),oH(e,{onEnd:()=>tL,onFailure:t_,onSuccess:e=>(0,o.pipe)(tU(e),tx(()=>s))}))))))})))))},lM=(0,o.dual)(2,(e,r)=>lA(e,e=>ee.match(t.failureOrCause(e),{onLeft:r,onRight:uu}))),lA=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),tf(e=>uT(t(e)))))),lN=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,lM(e=>(0,o.pipe)(t(e),l.getOrElse(()=>uo(e)))))),lP=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,lA(e=>(0,o.pipe)(t(e),l.getOrElse(()=>uu(e)))))),lD=(0,o.dual)(3,(e,t,r)=>lM(e,e=>"_tag"in e&&e._tag===t?r(e):uo(e))),lL=(0,o.dual)(2,(e,t)=>lM(e,e=>{let r=Object.keys(t);return"_tag"in e&&r.includes(e._tag)?t[e._tag](e):uo(e)})),lU=(0,o.dual)(2,(e,t)=>{let i=e=>tM({onInput:n=>{let[a,s]=r.reduce(n,[e,r.empty()],([e,i],n)=>l.isSome(e)&&t(e.value,n)?[l.some(n),i]:[l.some(n),(0,o.pipe)(i,r.append(n))]);return tx(tU(s),()=>i(a))},onFailure:t_,onDone:()=>tL});return new lo((0,o.pipe)(uT(e),tT(i(l.none()))))}),lz=(0,o.dual)(2,(e,t)=>{let i=e=>tM({onInput:a=>(0,o.pipe)(a,n.reduce([e,r.empty()],([e,i],a)=>l.isSome(e)?(0,o.pipe)(t(e.value,a),n.map(e=>e?[l.some(a),i]:[l.some(a),(0,o.pipe)(i,r.append(a))])):n.succeed([l.some(a),(0,o.pipe)(i,r.append(a))])),tI,tx(([e,t])=>(0,o.pipe)(tU(t),tx(()=>i(e))))),onFailure:t_,onDone:()=>tL});return new lo((0,o.pipe)(uT(e),tT(i(l.none()))))}),lj=e=>(0,o.pipe)(e,u5(r.of)),lW=(0,o.dual)(2,(e,t)=>uw(t(lj(e)))),lq=e=>n.catchAll(n.asSome(e),e=>"None"===e._tag?n.succeedNone:n.fail(e.value)),l$=(0,o.dual)(4,(e,r,i,a)=>{function u(e,r){return tI(oF(r)).pipe(ij(tM({onInput:t=>tx(tI(oO(e,s.succeed(t))),()=>u(e,r)),onFailure:r=>tI(oO(e,s.failCause((0,o.pipe)(r,t.map(l.some))))),onDone:()=>tx(tI(oO(e,s.fail(l.none()))),()=>u(e,r))})))}return new lo(iM(t=>n.all([oR(),oR(),oR(),oR()]).pipe(n.tap(([r,i,a])=>uT(e).pipe(rP(iD),tT(u(r,a)),re(t),n.forkIn(t))),n.tap(([,e,i,a])=>uT(r).pipe(rP(iD),tT(u(e,a)),re(t),n.forkIn(t))),n.map(([e,t,r,s])=>{let l=oO(r,void 0).pipe(n.zipRight(oF(e).pipe(n.flatMap(o.identity)))),u=oO(s,void 0).pipe(n.zipRight(oF(t).pipe(n.flatMap(o.identity))));return uT(fn(i,e=>n.flatMap(a(e,l,u),lq)))}))))}),lB=(0,o.dual)(4,(e,t,r,i)=>{let a=(e,t)=>ij(tI(oF(t)),tM({onInput:r=>tx(tI((0,o.pipe)(e,oO(oj(r)))),()=>a(e,t)),onFailure:t=>tI(oO(e,o$(t))),onDone:()=>tI(oO(e,oq))}));return new lo(iM(s=>n.all([oR(),oR(),oR(),oR()]).pipe(n.tap(([t,r,i])=>tT(uT(e),a(t,i)).pipe(re(s),n.forkIn(s))),n.tap(([e,r,i,o])=>tT(uT(t),a(r,o)).pipe(re(s),n.forkIn(s))),n.map(([e,t,a,s])=>{let o=oO(a,void 0).pipe(n.zipRight(oF(e).pipe(n.flatMap(oW)))),l=oO(s,void 0).pipe(n.zipRight(oF(t).pipe(n.flatMap(oW))));return uT(fi(r,e=>n.flatMap(i(e,o,l),lq)))}))))}),lH=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),ij(uT(t))))),lV=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,lK(t,(e,t)=>[e,t]))),lJ=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,lK(t,(e,t)=>e))),lG=(0,o.dual)(2,(e,t)=>ub(e,()=>t)),lK=(0,o.dual)(3,(e,t,r)=>(0,o.pipe)(e,ub(e=>(0,o.pipe)(t,u2(t=>r(e,t)))))),lZ=(0,o.dual)(2,(e,t)=>fl(i=>n.gen(function*(){let a=yield*oR();function o(e){return iB.sleep(t).pipe(n.as(e),n.forkIn(i),n.map(e=>c({_tag:oS,fiber:e})))}let u=tM({onInput:e=>l.match(r.last(e),{onNone:()=>u,onSome:e=>tI(oO(a,oN(r.of(e)))).pipe(tx(()=>u))}),onFailure:e=>tI(oO(a,oP(e))),onDone:()=>tI(oO(a,oD(oY)))});function c(e){switch(e._tag){case ob:return iO(oF(a).pipe(n.map(e=>{switch(e._tag){case oM:return iO(o(e.elements));case oA:return t_(e.cause);case"End":return tL}})));case oS:return iO(oF(a).pipe(n.forkIn(i),n.flatMap(t=>n.raceWith(er.join(e.fiber),er.join(t),{onSelfDone:(e,r)=>s.match(e,{onFailure:e=>er.interrupt(r).pipe(n.as(t_(e))),onSuccess:e=>er.interrupt(r).pipe(n.zipRight(n.succeed(tU(e).pipe(tx(()=>c({_tag:ov,fiber:t}))))))}),onOtherDone:(e,t)=>s.match(e,{onFailure:e=>er.interrupt(t).pipe(n.as(t_(e))),onSuccess:e=>{switch(e._tag){case oM:return er.interrupt(t).pipe(n.zipRight(o(e.elements)));case oA:return er.interrupt(t).pipe(n.as(t_(e.cause)));case"End":return er.join(t).pipe(n.map(e=>tU(e).pipe(ij(tL))))}}})}))));case ov:return iO(er.join(e.fiber).pipe(n.map(e=>{switch(e._tag){case oM:return iO(o(e.elements));case oA:return t_(e.cause);case"End":return tL}})))}}return pI(t=>tT(uT(e),u).pipe(re(t),n.forkIn(t))).pipe(lG(new lo(c(oE))))}))),lQ=e=>uF(n.die(e)),lY=(0,o.dual)(2,(e,t)=>(0,o.pipe)(i.make(),n.flatMap(a=>(0,o.pipe)(e,l1({maximumLag:t.maximumLag,decide:e=>n.flatMap(i.await(a),t=>t(e))}),n.flatMap(e=>(0,o.pipe)(n.all(r.map(r.range(0,t.size-1),t=>n.map(e,([e,r])=>[[e,t],r]))),n.map(r.unsafeFromArray),n.flatMap(e=>{let[s,l]=r.reduceRight(e,[new Map,r.empty()],([e,t],[i,n])=>[e.set(i[0],i[1]),(0,o.pipe)(t,r.prepend(n))]);return(0,o.pipe)(i.succeed(a,e=>n.map(t.decide(e),e=>t=>e(s.get(t)))),n.as(Array.from(l)))}))))))),lX={ref:0},l0=()=>{let e=lX.ref;return lX.ref=e+1,e},l1=(0,o.dual)(2,(e,t)=>l2(e,t.maximumLag,t.decide,()=>n.void)),l2=(0,o.dual)(4,(e,i,a,u)=>(0,o.pipe)(n.acquireRelease(Q.make(new Map),(e,t)=>(0,o.pipe)(Q.get(e),n.flatMap(e=>(0,o.pipe)(e.values(),n.forEach(Z))))),n.flatMap(c=>n.gen(function*(){let p=yield*n.makeSemaphore(1),f=yield*Q.make((0,o.pipe)(V(i),n.flatMap(e=>{let t=l0();return(0,o.pipe)(Q.update(c,r=>r.set(t,e)),n.as([t,e]))}))),d=e=>p.withPermits(1)((0,o.pipe)(Q.set(f,(0,o.pipe)(V(1),n.tap(t=>O(t,e)),n.flatMap(e=>{let t=l0();return(0,o.pipe)(Q.update(c,r=>r.set(t,e)),n.as(om.make(t,e)))}))),n.zipRight((0,o.pipe)(Q.get(c),n.flatMap(i=>(0,o.pipe)(r.fromIterable(i.values()),n.forEach(r=>(0,o.pipe)(O(r,e),n.catchSomeCause(e=>t.isInterrupted(e)?l.some(n.void):l.none()))))))),n.zipRight(u(e)),n.asVoid));return yield*(0,o.pipe)(e,pp(e=>(0,o.pipe)(a(e),n.flatMap(i=>(0,o.pipe)(Q.get(c),n.flatMap(a=>(0,o.pipe)(a.entries(),n.reduce(r.empty(),(a,[l,u])=>i(l)?(0,o.pipe)(O(u,s.succeed(e)),n.matchCauseEffect({onFailure:e=>t.isInterrupted(e)?n.succeed((0,o.pipe)(a,r.prepend(l))):n.failCause(e),onSuccess:()=>n.succeed(a)})):n.succeed(a)),n.flatMap(e=>r.isNonEmpty(e)?Q.update(c,t=>{for(let r of e)t.delete(r);return t}):n.void))))),n.asVoid)),n.matchCauseEffect({onFailure:e=>d(s.failCause((0,o.pipe)(e,t.map(l.some)))),onSuccess:()=>d(s.fail(l.none()))}),n.forkScoped),p.withPermits(1)(n.flatten(Q.get(f)))})))),l6=e=>new lo(rH(uT(e))),l3=(0,o.dual)(2,(e,t)=>uF(i.make()).pipe(ub(r=>pI(e=>uT(t).pipe(rH,re(e),n.catchAllCause(e=>i.failCause(r,e)),n.forkIn(e))).pipe(lG(u0(e,r)))))),l4=(0,o.dual)(2,(e,t)=>{let i=e=>tF({onInput:t=>{let n=(0,o.pipe)(t,r.drop(e)),a=Math.max(0,e-t.length);return r.isEmpty(t)||a>0?i(a):(0,o.pipe)(tU(n),ij(r0()))},onFailure:tE,onDone:()=>tL});return new lo((0,o.pipe)(uT(e),ip(i(t))))}),l5=(0,o.dual)(2,(e,t)=>t<=0?uJ():pD(()=>{let i=new oy(t),n=tF({onInput:e=>{let t=(0,o.pipe)(e,r.filterMap(e=>{let t=i.head();return i.put(e),t}));return(0,o.pipe)(tU(t),tx(()=>n))},onFailure:tE,onDone:()=>tL});return new lo((0,o.pipe)(uT(e),ip(n)))})),l8=(0,o.dual)(2,(e,t)=>l4(l9(e,e=>!t(e)),1)),l7=(0,o.dual)(2,(e,t)=>{let i=tF({onInput:e=>(0,o.pipe)(n.dropUntil(e,t),n.map(r.unsafeFromArray),n.map(e=>r.isEmpty(e)?tP(()=>i):(0,o.pipe)(tU(e),ij(r0()))),iO),onFailure:tE,onDone:()=>tL});return new lo((0,o.pipe)(uT(e),ip(i)))}),l9=(0,o.dual)(2,(e,t)=>{let i=tF({onInput:e=>{let n=r.dropWhile(e,t);return r.isEmpty(n)?tP(()=>i):ij(tU(n),r0())},onFailure:tE,onDone:tN});return new lo(ip(uT(e),i))}),ue=(0,o.dual)(2,(e,t)=>{let i=tF({onInput:e=>(0,o.pipe)(n.dropWhile(e,t),n.map(r.unsafeFromArray),n.map(e=>r.isEmpty(e)?tP(()=>i):ij(tU(e),r0())),iO),onFailure:tE,onDone:()=>tL});return new lo(ip(uT(e),i))}),ut=new lo(tL),ur=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),rV(t)))),ui=(0,o.dual)(2,(e,t)=>new lo(tv(uT(e),t))),un=()=>uF(n.context()),ua=e=>(0,o.pipe)(un(),ub(e)),us=e=>l6(uF(e)),uo=e=>uM(n.fail(l.some(e))),ul=e=>uM(n.failSync(()=>l.some(e()))),uu=e=>uF(n.failCause(e)),uc=(0,o.dual)(2,(e,t)=>u5(e,r.filter(t))),up=(0,o.dual)(2,(e,t)=>{let i=e=>{let a=e.next();return a.done?tM({onInput:e=>i(e[Symbol.iterator]()),onFailure:t_,onDone:tA}):(0,o.pipe)(t(a.value),n.map(t=>t?(0,o.pipe)(tU(r.of(a.value)),tx(()=>i(e))):i(e)),iO)};return new lo(tP(()=>(0,o.pipe)(uT(e),tT(i(r.empty()[Symbol.iterator]())))))}),uf=(0,o.dual)(2,(e,t)=>u5(e,r.filterMap(t))),ud=(0,o.dual)(2,(e,t)=>pD(()=>{let i=e=>{let a=e.next();return a.done?tM({onInput:e=>i(e[Symbol.iterator]()),onFailure:t_,onDone:tA}):(0,o.pipe)(t(a.value),l.match({onNone:()=>n.sync(()=>i(e)),onSome:n.map(t=>tx(tU(r.of(t)),()=>i(e)))}),iO)};return new lo((0,o.pipe)(uT(e),tT(i(r.empty()[Symbol.iterator]()))))})),uh=(0,o.dual)(2,(e,t)=>{let i=tF({onInput:e=>{let n=r.filterMapWhile(e,t);return n.length===e.length?(0,o.pipe)(tU(n),tx(()=>i)):tU(n)},onFailure:tE,onDone:tA});return new lo((0,o.pipe)(uT(e),ip(i)))}),um=(0,o.dual)(2,(e,t)=>pD(()=>{let i=e=>{let a=e.next();return a.done?tM({onInput:e=>i(e[Symbol.iterator]()),onFailure:t_,onDone:tA}):iO(l.match(t(a.value),{onNone:()=>n.succeed(tL),onSome:n.map(t=>tx(tU(r.of(t)),()=>i(e)))}))};return new lo((0,o.pipe)(uT(e),ip(i(r.empty()[Symbol.iterator]()))))})),ug=(0,o.dual)(2,(e,t)=>{let i=tF({onInput:e=>l.match(r.findFirst(e,t),{onNone:()=>i,onSome:e=>tU(r.of(e))}),onFailure:tE,onDone:()=>tL});return new lo((0,o.pipe)(uT(e),tT(i)))}),uy=(0,o.dual)(2,(e,t)=>{let i=tF({onInput:e=>(0,o.pipe)(n.findFirst(e,t),n.map(l.match({onNone:()=>i,onSome:e=>tU(r.of(e))})),iO),onFailure:tE,onDone:()=>tL});return new lo((0,o.pipe)(uT(e),tT(i)))}),ub=(0,o.dual)(e=>ll(e[0]),(e,t,i)=>{let n=i?.bufferSize??16;return i?.switch?uS(i?.concurrency,()=>uv(e,1,n,t),r=>uv(e,r,n,t)):uS(i?.concurrency,()=>new lo(rP(uT(e),e=>(0,o.pipe)(e,r.map(e=>uT(t(e))),r.reduce(tL,(e,t)=>(0,o.pipe)(e,ij(t)))))),r=>new lo((0,o.pipe)(uT(e),rP(iD),ir(e=>uT(t(e)),i))))}),uS=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r(Number.MAX_SAFE_INTEGER);default:return e>1?r(e):t()}},uv=(0,o.dual)(4,(e,t,r,i)=>{let n;return new lo((0,o.pipe)(uT(e),rP(iD),ir(e=>uT(i(e)),{concurrency:t,mergeStrategy:((n=Object.create(ry))._tag=rm,n),bufferSize:r})))}),uE=(0,o.dual)(e=>ll(e[0]),(e,t)=>ub(e,o.identity,t)),uw=e=>{let t=tM({onInput:e=>tx(iD(e),()=>t),onFailure:t_,onDone:()=>tL});return new lo((0,o.pipe)(uT(e),tT(t)))},u_=(0,o.dual)(e=>ll(e[0]),(e,t)=>t?.unordered?ub(e,e=>uF(e),{concurrency:t.concurrency}):uS(t?.concurrency,()=>cr(e,o.identity),t=>new lo((0,o.pipe)(uT(e),rP(iD),r9(o.identity,t),r8(r.of))))),uk=e=>{let i=tM({onInput:e=>((e,i)=>{let[n,a]=(0,o.pipe)(e,r.splitWhere(e=>!s.isSuccess(e))),u=(0,o.pipe)(r.head(a),l.match({onNone:()=>i,onSome:s.match({onFailure:e=>l.match(t.flipCauseOption(e),{onNone:()=>tL,onSome:t_}),onSuccess:()=>tL})}));return(0,o.pipe)(tU((0,o.pipe)(n,r.filterMap(e=>s.isSuccess(e)?l.some(e.value):l.none()))),tx(()=>u))})(e,i),onFailure:e=>t_(e),onDone:()=>tL});return new lo((0,o.pipe)(uT(e),tT(i)))},ux=e=>uw(uk((0,o.pipe)(e,u2(e=>e.exit)))),uC=e=>new lo(iy(uT(e))),uI=e=>new lo(e),uT=e=>{if("channel"in e)return e.channel;if(n.isEffect(e))return uT(uF(e));throw TypeError("Expected a Stream.")},uR=e=>new lo(r.isEmpty(e)?tL:tU(e)),uO=(e,r)=>(0,o.pipe)(M(e),n.catchAllCause(r=>(0,o.pipe)(e.isShutdown,n.flatMap(e=>e&&t.isInterrupted(r)?oJ():oG(r)))),cY,r?.shutdown?ur(Z(e)):o.identity),uF=e=>(0,o.pipe)(e,n.mapError(l.some),uM),uM=e=>new lo(iO(n.match(e,{onFailure:l.match({onNone:()=>tL,onSome:tE}),onSuccess:e=>tU(r.of(e))}))),uA=(e,t)=>{let r=t?.maxChunkSize??lu;if(t?.scoped){let i=n.map(eq(e),e=>uL(e,{maxChunkSize:r,shutdown:!0}));return t.shutdown?n.map(i,ur(e.shutdown)):i}let i=ub(pC(eq(e)),e=>uL(e,{maxChunkSize:r}));return t?.shutdown?ur(i,e.shutdown):i},uN=e=>pD(()=>r.isChunk(e)?uR(e):uP(e[Symbol.iterator]())),uP=(e,t=lu)=>(0,o.pipe)(n.sync(()=>{let i=[],a=e=>(0,o.pipe)(n.sync(()=>{let n=e.next();if(1===t)return n.done?tL:(0,o.pipe)(tU(r.of(n.value)),tx(()=>a(e)));i=[];let s=0;for(;!1===n.done&&(i.push(n.value),!((s+=1)>=t));)n=e.next();return s>0?(0,o.pipe)(tU(r.unsafeFromArray(i)),tx(()=>a(e))):tL}),iO);return new lo(a(e))}),fs),uD=e=>(0,o.pipe)(e,n.map(cY),fo),uL=(e,r)=>(0,o.pipe)(N(e,1,r?.maxChunkSize??lu),n.catchAllCause(r=>(0,o.pipe)(e.isShutdown,n.flatMap(e=>e&&t.isInterrupted(r)?oJ():oG(r)))),cY,r?.shutdown?ur(Z(e)):o.identity),uU=e=>(0,o.pipe)(e.take,n.map(r.of),n.catchAllCause(r=>(0,o.pipe)(e.isShutdown,n.flatMap(e=>e&&t.isInterrupted(r)?oJ():oG(r)))),cY),uz=(...e)=>{let t=1===e.length?e[0].evaluate:e[0],r=1===e.length?e[0].onError:e[1],i=1===e.length&&!0===e[0].releaseLockOnEnd;return fo(n.map(n.acquireRelease(n.sync(()=>t().getReader()),e=>i?n.sync(()=>e.releaseLock()):n.promise(()=>e.cancel())),e=>cX(n.flatMap(n.tryPromise({try:()=>e.read(),catch:e=>l.some(r(e))}),({done:e,value:t})=>e?n.fail(l.none()):n.succeed(t)))))},uj=Symbol.for("effect/Stream/EOF"),uW=(0,o.dual)(2,(e,t)=>{let i=e=>tM({onInput:n=>{let[a,s]=((e,i)=>{let n;if(r.isEmpty(i))return[e,r.empty()];let a=[],s=0,o=0,u=r.empty();switch(e._tag){case"Some":{let l=e.value;n=l[0];let c=!0;for(;c&&o<i.length;){let e=t(r.unsafeGet(i,o));if(!et.equals(n,e)){let t=l[1],u=r.unsafeFromArray(Array.from(i).slice(s,o)),p=r.appendAll(t,u);a.push([n,p]),n=e,s=o,c=!1}o+=1}c&&(u=l[1]);break}case"None":n=t(r.unsafeGet(i,o)),o+=1}for(;o<i.length;){let e=t(r.unsafeGet(i,o));et.equals(n,e)||(a.push([n,r.unsafeFromArray(Array.from(i).slice(s,o))]),n=e,s=o),o+=1}let c=r.appendAll(u,r.unsafeFromArray(Array.from(i).slice(s,o))),p=r.unsafeFromArray(a);return[l.some([n,c]),p]})(e,n);return r.isEmpty(s)?i(a):tx(tU(s),()=>i(a))},onFailure:t=>l.match(e,{onNone:()=>t_(t),onSome:e=>tx(tU(r.of(e)),()=>t_(t))}),onDone:t=>l.match(e,{onNone:()=>tN(t),onSome:e=>tx(tU(r.of(e)),()=>tN(t))})});return new lo(ip(uT(e),i(l.none())))}),uq=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,cV(t),lj)),u$=(0,o.dual)(3,(e,t,r)=>ld(e,ny(t),i8(r))),uB=(0,o.dual)(2,(e,t)=>{let r=e=>(0,o.pipe)(er.poll(e),n.map(l.match({onNone:()=>tF({onInput:t=>tx(tU(t),()=>r(e)),onFailure:tE,onDone:()=>tL}),onSome:s.match({onFailure:t_,onSuccess:()=>tL})})),iO);return new lo(iM(i=>t.pipe(n.forkIn(i),n.map(t=>uT(e).pipe(tT(r(t)))))))}),uH=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,uB(iB.sleep(t)))),uV=(0,o.dual)(2,(e,t)=>{let r=(0,o.pipe)(i.poll(t),n.map(l.match({onNone:()=>tF({onInput:e=>(0,o.pipe)(tU(e),tx(()=>r)),onFailure:tE,onDone:()=>tL}),onSome:e=>iO(n.match(e,{onFailure:tE,onSuccess:()=>tL}))})),iO);return new lo((0,o.pipe)(uT(e),tT(r)))}),uJ=()=>new lo(r0()),uG=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,uK(t,uC(u1(!0,!1))))),uK=(0,o.dual)(3,(e,t,r)=>{let i=e=>tM({onInput:t=>tx(tI(oO(e,oV(t))),()=>i(e)),onFailure:t=>tI(oO(e,o$(t))),onDone:()=>tI(oO(e,oq))});return new lo(iM(a=>(0,o.pipe)(oR(),n.zip(oR()),n.tap(([t])=>uT(e).pipe(rP(iD),tT(i(t)),re(a),n.forkIn(a))),n.tap(([e,r])=>uT(t).pipe(rP(iD),tT(i(r)),re(a),n.forkIn(a))),n.map(([e,t])=>{let i=(r,n)=>tM({onInput:a=>a&&!r?(0,o.pipe)(tI(oF(e)),tx(oH({onEnd:()=>n?tL:i(!0,n),onFailure:t_,onSuccess:e=>(0,o.pipe)(tU(e),tx(()=>i(r,n)))}))):a||n?i(r,n):(0,o.pipe)(tI(oF(t)),tx(oH({onEnd:()=>r?tL:i(r,!0),onFailure:t_,onSuccess:e=>(0,o.pipe)(tU(e),tx(()=>i(r,n)))}))),onFailure:t_,onDone:()=>tL});return(0,o.pipe)(uT(r),rP(iD),tT(i(!1,!1)))}))))}),uZ=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),ip(tP(()=>{let e=i=>tM({onInput:n=>{let a=[],s=i;for(let e of n)s?s=!1:a.push(t),a.push(e);return(0,o.pipe)(tU(r.unsafeFromArray(a)),tx(()=>e(s)))},onFailure:t_,onDone:()=>tL});return e(!0)}))))),uQ=(0,o.dual)(2,(e,{end:t,middle:r,start:i})=>(0,o.pipe)(u1(i),lH((0,o.pipe)(e,uZ(r))),lH(u1(t)))),uY=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,uX(iB.sleep(t)))),uX=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),r1(t)))),u0=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),r2(t)))),u1=(...e)=>uN(e),u2=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),r8(r.map(t))))),u6=(0,o.dual)(3,(e,t,i)=>{let n=e=>tF({onInput:t=>{let[a,s]=r.mapAccum(t,e,i);return tx(tU(s),()=>n(a))},onFailure:tE,onDone:()=>tL});return new lo((0,o.pipe)(uT(e),tT(n(t))))}),u3=(0,o.dual)(3,(e,t,i)=>pD(()=>{let a=e=>tF({onInput:t=>(0,o.pipe)(n.suspend(()=>{let s=[];return(0,o.pipe)(t,n.reduce(e,(e,t)=>(0,o.pipe)(i(e,t),n.flatMap(([e,t])=>(0,o.pipe)(n.sync(()=>{s.push(t)}),n.as(e))))),n.match({onFailure:e=>0!==s.length?ij(tU(r.unsafeFromArray(s)),tE(e)):tE(e),onSuccess:e=>tx(tU(r.unsafeFromArray(s)),()=>a(e))}))}),iO),onFailure:tE,onDone:()=>tL});return new lo((0,o.pipe)(uT(e),ip(a(t))))})),u4=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,cn(t.onFailure),u2(t.onSuccess))),u5=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),r8(t)))),u8=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),r7(t)))),u7=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,u9(e=>r.fromIterable(t(e))))),u9=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,u5(r.flatMap(t)))),ce=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,cr(t),u9(o.identity))),ct=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,cr(e=>(0,o.pipe)(t(e),n.map(r.fromIterable))),u9(o.identity))),cr=(0,o.dual)(2,(e,t)=>{let i=e=>{let a=e.next();if(a.done)return tM({onInput:e=>i(e[Symbol.iterator]()),onFailure:t_,onDone:tA});{let s=a.value;return iO(n.map(t(s),t=>tx(tU(r.of(t)),()=>i(e))))}};return new lo((0,o.pipe)(uT(e),tT(tP(()=>i(r.empty()[Symbol.iterator]())))))}),ci=(0,o.dual)(3,(e,t,i)=>new lo((0,o.pipe)(uT(e),rP(iD),r9(i,t),r8(r.of)))),cn=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),r4(t)))),ca=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),r5(t)))),cs=(0,o.dual)(e=>ll(e[1]),(e,t,r)=>cf(e,t,{onSelf:o.identity,onOther:o.identity,haltStrategy:r?.haltStrategy})),co=(0,o.dual)(e=>Symbol.iterator in e[0],(e,t)=>uE(uN(e),t)),cl=(0,o.dual)(2,(e,t)=>co(Object.keys(e).map(t=>e[t].pipe(u2(e=>({_tag:t,value:e})))),t)),cu=(0,o.dual)(2,(e,t)=>cf(e,t,{onSelf:ee.left,onOther:ee.right})),cc=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,cs(l6(t)))),cp=(0,o.dual)(2,(e,t)=>(0,o.pipe)(l6(e),cs(t))),cf=(0,o.dual)(3,(e,t,r)=>{let i=r.haltStrategy?(e=>{switch(e){case"left":return i9;case"right":return ne;case"both":return nt;case"either":return nr;default:return e}})(r.haltStrategy):nt,a=e=>t=>e||!s.isSuccess(t)?rn(n.suspend(()=>t)):ra(e=>n.suspend(()=>e));return new lo(is(uT(u2(e,r.onSelf)),{other:uT(u2(t,r.onOther)),onSelfDone:a("Either"===i._tag||"Left"===i._tag),onOtherDone:a("Either"===i._tag||"Right"===i._tag)}))}),cd=uF(n.never),ch=(0,o.dual)(2,(e,t)=>lH(e,l6(uF(t)))),cm=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,lA(e=>uF((0,o.pipe)(t(e),n.zipRight(n.failCause(e))))))),cg=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),tv(e=>s.isSuccess(e)?t():n.void)))),cy=(0,o.dual)(2,(e,t)=>fs(n.as(t,e))),cb=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),iu(t)))),cS=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),ic(()=>uT(t()))))),cv=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,u2(ee.left),cS(()=>(0,o.pipe)(t(),u2(ee.right))))),cE=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,cS(()=>ul(t)))),cw=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,c_(()=>r.of(t())))),c_=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,ck(()=>new lo(tU(t()))))),ck=(0,o.dual)(2,(e,t)=>{let i=tF({onInput:e=>r.isEmpty(e)?tP(()=>i):(0,o.pipe)(tU(e),ij(r0())),onFailure:tE,onDone:()=>tP(()=>uT(t()))});return new lo((0,o.pipe)(uT(e),tT(i)))}),cx=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,cS(()=>pP(t)))),cC=(e,t)=>{let r=e=>{let i=t(e);return l.match(i[1],{onNone:()=>ij(tU(i[0]),tL),onSome:e=>tx(tU(i[0]),()=>r(e))})};return new lo(tP(()=>r(e)))},cI=(e,t)=>{let r=e=>iO(n.map(t(e),([e,t])=>l.match(t,{onNone:()=>ij(tU(e),tL),onSome:t=>tx(tU(e),()=>r(t))})));return new lo(tP(()=>r(e)))},cT=(e,t)=>cI(e,e=>(0,o.pipe)(t(e),n.map(([e,t])=>[r.of(e),t]))),cR=(0,o.dual)(2,(e,t)=>{let r="Emit",a="Halt";return(0,o.pipe)(i.make(),n.flatMap(s=>(0,o.pipe)(oR(),n.map(l=>{let u=nZ(n_(t),{onFailure:e=>aU(au(i.fail(s,e)),nq(e)),onSuccess:([e,t])=>{let n=tM({onInput:e=>tx(tI(oO(l,{_tag:r,elements:e})),()=>n),onFailure:e=>ij(tI(oO(l,{_tag:a,cause:e})),t_(e)),onDone:e=>ij(tI(oO(l,{_tag:"End"})),tL)});return al((0,o.pipe)(tI(i.succeed(s,e)),ij(tI((0,o.pipe)(l,oO({_tag:r,elements:t})))),ij(n)))}}),c=(0,o.pipe)(oF(l),n.map(e=>{switch(e._tag){case r:return(0,o.pipe)(tU(e.elements),tx(()=>c));case a:return t_(e.cause);case"End":return tL}}),iO);return(0,o.pipe)(e,pH(e=>i.failCause(s,e)),c7(u),n.forkScoped,n.zipRight(i.await(s)),n.map(e=>[e,new lo(c)]))}))),n.flatten)}),cO=(0,o.dual)(e=>"function"==typeof e[1],(e,t,r)=>cF(e,e=>n.succeed(t(e)?ee.right(e):ee.left(e)),r)),cF=(0,o.dual)(e=>"function"==typeof e[1],(e,t,r)=>(0,o.pipe)(cr(e,t),lY({size:2,maximumLag:r?.bufferSize??16,decide:ee.match({onLeft:()=>n.succeed(e=>0===e),onRight:()=>n.succeed(e=>1===e)})}),n.flatMap(([e,t])=>n.succeed([uf(uk(uL(e,{shutdown:!0})),e=>ee.match(e,{onLeft:l.some,onRight:l.none})),uf(uk(uL(t,{shutdown:!0})),e=>ee.match(e,{onLeft:l.none,onRight:l.some}))])))),cM=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),ip(aM(t))))),cA=(0,o.dual)(2,(e,t)=>new lo(tT(uT(e),t))),cN=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),ip(t)))),cP=(0,o.dual)(2,(e,t)=>new lo(ij(tU(t),uT(e)))),cD=(0,o.dual)(2,(e,t)=>new lo((0,o.pipe)(uT(e),tR(t)))),cL=(0,o.dual)(2,(e,t)=>cq(e,X.merge(t))),cU=(0,o.dual)(2,(e,t)=>new lo(iM(r=>en.buildWithScope(t,r).pipe(n.map(t=>(0,o.pipe)(uT(e),tR(t))))))),cz=(0,o.dual)(3,(e,t,r)=>cj(e,t,n.succeed(r))),cj=(0,o.dual)(3,(e,t,r)=>cW(e,t,uF(r))),cW=(0,o.dual)(3,(e,t,r)=>ua(i=>ub(r,r=>(0,o.pipe)(e,cD(X.add(i,t,r)))))),cq=(0,o.dual)(2,(e,t)=>ua(r=>(0,o.pipe)(e,cD(t(r))))),c$=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,cU((0,o.pipe)(en.context(),en.merge(t))))),cB=(0,o.dual)(2,(e,t)=>cH(e,t)),cH=(...e)=>i.make().pipe(n.map(t=>{let r=null;return co(e.map((e,a)=>e.pipe(pW(()=>null===r?(r=a,i.unsafeDone(t,s.void),!0):r===a),uX(i.await(t).pipe(n.flatMap(()=>r===a?n.never:n.void))))),{concurrency:e.length})}),fs),cV=(0,o.dual)(2,(e,t)=>pD(()=>{let r=Math.max(t,1),i=cJ(new cG(r),r);return new lo((0,o.pipe)(uT(e),tT(i)))})),cJ=(e,t)=>tM({onInput:i=>{if(i.length===t&&e.isEmpty())return tx(tU(i),()=>cJ(e,t));if(i.length>0){let n,a=[],s=0;for(;s<i.length;){for(;s<i.length&&void 0===n;)n=e.write((0,o.pipe)(i,r.unsafeGet(s))),s+=1;void 0!==n&&(a.push(n),n=void 0)}return tx(iP(...a),()=>cJ(e,t))}return tP(()=>cJ(e,t))},onFailure:t=>ij(e.emitIfNotEmpty(),t_(t)),onDone:()=>e.emitIfNotEmpty()});class cG{n;builder=[];pos=0;constructor(e){this.n=e}isEmpty(){return 0===this.pos}write(e){if(this.builder.push(e),this.pos+=1,this.pos===this.n){let e=r.unsafeFromArray(this.builder);return this.builder=[],this.pos=0,e}}emitIfNotEmpty(){return 0!==this.pos?tU(r.unsafeFromArray(this.builder)):tL}}let cK=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,cZ(t,o.identity))),cZ=(0,o.dual)(3,(e,r,i)=>new lo(rN(uT(e),e=>l.match(r(e),{onNone:()=>t_(t.die(i(e))),onSome:tE})))),cQ=(0,o.dual)(2,(e,t)=>uf(c0(e,t),e=>ee.match(e,{onLeft:l.none,onRight:l.some}))),cY=e=>fi(e,e=>(0,o.pipe)(n.map(e,t=>l.some([t,e])),n.catchAll(l.match({onNone:()=>n.succeed(l.none()),onSome:n.fail})))),cX=e=>cY((0,o.pipe)(e,n.map(r.of))),c0=(0,o.dual)(2,(e,t)=>c6(e,t,{onElement:e=>ee.right(e),onSchedule:ee.left})),c1=(0,o.dual)(2,(e,t)=>uf(c2(e,t,{onElement:e=>l.some(e),onSchedule:l.none}),o.identity)),c2=(0,o.dual)(3,(e,t,i)=>{let a=(0,o.pipe)(i4(t),n.map(e=>{let t=e=>l.match(r.head(e),{onNone:()=>s,onSome:t=>ij(tU(r.of(i.onElement(t))),a((0,o.pipe)(e,r.drop(1)),t))}),a=(s,l)=>{let u=(0,o.pipe)(e.next(l),n.as((0,o.pipe)(tU(r.of(i.onElement(l))),tx(()=>a(s,l))))),c=(0,o.pipe)(e.last,n.orDie,n.flatMap(a=>(0,o.pipe)(e.reset,n.map(()=>(0,o.pipe)(tU(r.of(i.onSchedule(a))),ij(t(s)))))));return(0,o.pipe)(u,n.orElse(()=>c),iO)},s=tF({onInput:t,onFailure:tE,onDone:()=>tL});return s}),iO);return new lo((0,o.pipe)(uT(e),tT(a)))}),c6=(0,o.dual)(3,(e,t,i)=>(0,o.pipe)(i4(t),n.map(t=>{let a=cj(i7,Q.get(t.iterationMeta)),s=(0,o.pipe)(e,a,u2(i.onElement),uT),l=iO(n.match(t.next(void 0),{onFailure:()=>tL,onSuccess:e=>tx(s,()=>ij(tU(r.of(i.onSchedule(e))),l))}));return new lo(ij(s,l))}),fs)),c3=(e,t)=>ub(uF(n.zip(e,i4(t))),([t,r])=>{let i=n.provideServiceEffect(i7,Q.get(r.iterationMeta));return lH(pN(t),fn(t,t=>n.matchEffect(r.next(t),{onFailure:n.succeed,onSuccess:()=>n.map(i(e),e=>l.some([e,e]))})))}),c4=(0,o.dual)(2,(e,t)=>i4(t).pipe(n.map(t=>{let r=uT(cj(i7,Q.get(t.iterationMeta))(e)).pipe(r7(e=>n.as(t.reset,e)),rN(e=>t.next(e).pipe(n.match({onFailure:()=>tE(e),onSuccess:()=>r}),iO)));return r}),iO,uI)),c5=(0,o.dual)(e=>ll(e[0]),(e,t,r)=>pD(()=>{let i=r?.preventFallbackOnPartialStream??!1,n=0,a=l.none(),s=pD(()=>{let r=t.steps[n++];if(!r)return uo(l.getOrThrow(a));let o=X.isContext(r.provide)?cL(e,r.provide):c$(e,r.provide),u=!1;if(l.isSome(a)){let e=a.value,t=!1,i=o;o=c8(c4(o=pD(()=>t?i:(t=!0,uo(e))),iV.scheduleFromStep(r,!1)))}else{let e=iV.scheduleFromStep(r,!0);o=e?c8(c4(o,e)):o}return lM(i?u5(o,e=>(u=!0,e)):o,e=>i&&u?uo(e):(a=l.some(e),s))});return s})),c8=e=>lA(e,e=>uu(i6.scheduleDefectRefailCause(e))),c7=(0,o.dual)(2,(e,t)=>uT(e).pipe(ip(aM(t)),iS)),c9=e=>c7(e,nM),pe=(0,o.dual)(3,(e,t,r)=>pn(e,t,o.constTrue,r)),pt=(0,o.dual)(3,(e,t,r)=>pa(e,t,o.constTrue,r)),pr=(0,o.dual)(3,(e,t,r)=>(0,o.pipe)(e,ps(t,o.constTrue,r))),pi=(0,o.dual)(3,(e,t,r)=>(0,o.pipe)(e,po(t,o.constTrue,r))),pn=(0,o.dual)(4,(e,t,r,i)=>c7(e,nJ(t,r,i))),pa=(0,o.dual)(4,(e,t,r,i)=>c7(e,n1(t,r,i))),ps=(0,o.dual)(4,(e,t,r,i)=>(0,o.pipe)(e,pS(nJ(t,r,i)))),po=(0,o.dual)(4,(e,t,r,i)=>(0,o.pipe)(e,pS(n1(t,r,i)))),pl=(0,o.dual)(2,(e,t)=>c7(e,an(t))),pu=(0,o.dual)(2,(e,t)=>c7(e,aa(t))),pc=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,pS(aa(t)))),pp=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,pS(an(t)))),pf=(0,o.dual)(2,(e,t)=>c7(e,as(t))),pd=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,pS(as(t)))),ph=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,pg(t))),pm=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,pb(t))),pg=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,pb(t),n.scoped)),py=(0,o.dual)(2,(e,i)=>{let a=tM({onInput:e=>tx(tI(F(i,r.map(e,s.succeed))),()=>a),onFailure:e=>tI(O(i,s.failCause(t.map(e,l.some)))),onDone:()=>tI(O(i,s.fail(l.none())))});return(0,o.pipe)(tT(uT(e),a),rH,iv,n.asVoid)}),pb=(0,o.dual)(2,(e,t)=>{let r=tM({onInput:e=>tx(tU(oj(e)),()=>r),onFailure:e=>tU(o$(e)),onDone:()=>tU(oq)});return(0,o.pipe)(tT(uT(e),r),r7(e=>O(t,e)),rH,iv,n.asVoid)}),pS=(0,o.dual)(2,(e,t)=>(0,o.pipe)(uT(e),ip(aM(t)),rH,iv)),pv=(0,o.dual)(3,(e,t,r)=>(0,o.pipe)(e,px(t,(e,t)=>n.succeed(r(e,t))))),pE=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,pw((e,r)=>n.succeed(t(e,r))))),pw=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,u3(l.none(),(e,r)=>{switch(e._tag){case"None":return n.succeed([l.some(r),r]);case"Some":return(0,o.pipe)(t(e.value,r),n.map(e=>[l.some(e),e]))}}))),p_=(0,o.dual)(2,(e,t)=>uf(pk(e,t,{onElement:l.some,onSchedule:l.none}),o.identity)),pk=(0,o.dual)(3,(e,t,i)=>{let a=(e,t)=>{let s=t.next();return s.done?tM({onInput:t=>a(e,t[Symbol.iterator]()),onFailure:t_,onDone:tN}):iO(n.matchEffect(e.next(s.value),{onFailure:()=>(0,o.pipe)(e.last,n.orDie,n.map(n=>(0,o.pipe)(tU(r.make(i.onElement(s.value),i.onSchedule(n))),tx(()=>a(e,t)))),n.zipLeft(e.reset)),onSuccess:()=>n.succeed((0,o.pipe)(tU(r.of(i.onElement(s.value))),tx(()=>a(e,t))))}))};return new lo((0,o.pipe)(tI(i4(t)),tx(t=>(0,o.pipe)(uT(e),tT(a(t,r.empty()[Symbol.iterator]()))))))}),px=(0,o.dual)(3,(e,t,i)=>new lo((0,o.pipe)(tU(r.of(t)),tx(()=>uT((0,o.pipe)(e,u3(t,(e,t)=>(0,o.pipe)(i(e,t),n.map(e=>[e,e]))))))))),pC=e=>new lo(rV(iE((0,o.pipe)(e,n.map(r.of))),n.void)),pI=e=>new lo(iw(t=>e(t).pipe(n.map(r.of)))),pT=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,u2(l.getOrElse(t)))),pR=(0,o.dual)(2,(e,t)=>cr(e,l.match({onNone:()=>n.failSync(t),onSome:n.succeed}))),pO=(0,o.dual)(2,(e,t)=>pF(e,t,1)),pF=(0,o.dual)(3,(e,i,n)=>i<=0||n<=0?lQ(new t.IllegalArgumentException("Invalid bounds - `chunkSize` and `stepSize` must be greater than zero")):new lo(tP(()=>{let t=new oy(i),a=(e,a)=>{if(e<i){let e=t.toChunk(),i=r.isEmpty(e)?r.empty():r.of(e);return(0,o.pipe)(tU(i),tx(()=>a))}let s=e-(e-i)%n;if(s===e)return a;let l=(0,o.pipe)(t.toChunk(),r.takeRight(e-(s-i+n))),u=r.isEmpty(l)?r.empty():r.of(l);return(0,o.pipe)(tU(u),tx(()=>a))},s=e=>tM({onInput:a=>tx(tU(r.filterMap(a,(r,a)=>{t.put(r);let s=e+a+1;return s<i||(s-i)%n>0?l.none():l.some(t.toChunk())})),()=>s(e+a.length)),onFailure:t=>a(e,t_(t)),onDone:()=>a(e,tL)});return(0,o.pipe)(uT(e),tT(s(0)))}))),pM=(0,o.dual)(2,(e,t)=>{let i=(e,a)=>{let[s,l]=(0,o.pipe)(e,r.appendAll(a),r.splitWhere(t));return r.isEmpty(s)||r.isEmpty(l)?n((0,o.pipe)(s,r.appendAll((0,o.pipe)(l,r.drop(1))))):(0,o.pipe)(tU(r.of(s)),tx(()=>i(r.empty(),(0,o.pipe)(l,r.drop(1)))))},n=e=>tF({onInput:t=>i(e,t),onFailure:tE,onDone:()=>r.isEmpty(e)?tL:l.isNone((0,o.pipe)(e,r.findFirst(t)))?ij(tU(r.of(e)),tL):ij(i(r.empty(),e),tL)});return new lo((0,o.pipe)(uT(e),tT(n(r.empty()))))}),pA=(0,o.dual)(2,(e,t)=>{let i=(e,n)=>tM({onInput:a=>{let s,[u,c]=(0,o.pipe)(a,r.reduce([(0,o.pipe)(e,l.getOrElse(()=>r.empty())),n],([e,i],n)=>{let a=(0,o.pipe)(e,r.append(n));return i<t.length&&et.equals(n,(0,o.pipe)(t,r.unsafeGet(i)))?i+1===t.length?(void 0===s&&(s=[]),s.push((0,o.pipe)(a,r.take(a.length-t.length))),[r.empty(),0]):[a,i+1]:[a,+!!et.equals(n,(0,o.pipe)(t,r.unsafeGet(0)))]}));return tx(tU(void 0===s?r.empty():r.unsafeFromArray(s)),()=>i(r.isNonEmpty(u)?l.some(u):l.none(),c))},onFailure:t=>l.match(e,{onNone:()=>t_(t),onSome:e=>ij(tU(r.of(e)),t_(t))}),onDone:t=>l.match(e,{onNone:()=>tA(t),onSome:e=>ij(tU(r.of(e)),tA(t))})});return new lo((0,o.pipe)(uT(e),tT(i(l.none(),0))))}),pN=e=>uR(r.of(e)),pP=e=>pD(()=>uR(r.of(e()))),pD=e=>new lo(tP(()=>uT(e()))),pL=(0,o.dual)(2,(e,i)=>{if(!Number.isInteger(i))return lQ(new t.IllegalArgumentException(`${i} must be an integer`));let n=e=>tF({onInput:t=>{let i=(0,o.pipe)(t,r.take(Math.min(e,1/0))),a=Math.max(0,e-i.length);return a>0?(0,o.pipe)(tU(i),tx(()=>n(a))):tU(i)},onFailure:tE,onDone:tA});return new lo((0,o.pipe)(uT(e),ip(0<i?n(i):tL)))}),pU=(0,o.dual)(2,(e,t)=>t<=0?ut:new lo((0,o.pipe)(n.succeed(new oy(t)),n.map(t=>{let r=tF({onInput:e=>{for(let r of e)t.put(r);return r},onFailure:tE,onDone:()=>(0,o.pipe)(tU(t.toChunk()),ij(tL))});return(0,o.pipe)(uT(e),tT(r))}),iO))),pz=(0,o.dual)(2,(e,t)=>{let i=tF({onInput:e=>{let n=(0,o.pipe)(e,r.takeWhile(e=>!t(e))),a=(0,o.pipe)(e,r.drop(n.length),r.take(1));return r.isEmpty(a)?(0,o.pipe)(tU(n),tx(()=>i)):tU((0,o.pipe)(n,r.appendAll(a)))},onFailure:tE,onDone:tA});return new lo((0,o.pipe)(uT(e),ip(i)))}),pj=(0,o.dual)(2,(e,t)=>{let i=e=>{let a=e.next();return a.done?tM({onInput:e=>i(e[Symbol.iterator]()),onFailure:t_,onDone:tA}):(0,o.pipe)(t(a.value),n.map(t=>t?tU(r.of(a.value)):(0,o.pipe)(tU(r.of(a.value)),tx(()=>i(e)))),iO)};return new lo((0,o.pipe)(uT(e),tT(i(r.empty()[Symbol.iterator]()))))}),pW=(0,o.dual)(2,(e,t)=>{let i=tF({onInput:e=>{let n=(0,o.pipe)(e,r.takeWhile(t));return n.length===e.length?(0,o.pipe)(tU(n),tx(()=>i)):tU(n)},onFailure:tE,onDone:tA});return new lo((0,o.pipe)(uT(e),ip(i)))}),pq=(0,o.dual)(2,(e,t)=>cr(e,e=>n.as(t(e),e))),p$=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,pB(t.onFailure),pq(t.onSuccess))),pB=(0,o.dual)(2,(e,t)=>lM(e,e=>uF(n.zipRight(t(e),n.fail(e))))),pH=(0,o.dual)(2,(e,t)=>{let r=tM({onInput:e=>tx(tU(e),()=>r),onFailure:e=>tI(n.zipRight(t(e),n.failCause(e))),onDone:tN});return new lo((0,o.pipe)(uT(e),tT(r)))}),pV=(0,o.dual)(2,(e,t)=>(0,o.pipe)(uF(n.all([V(1),i.make()])),ub(([r,a])=>{let s=ux(uL(r,{maxChunkSize:1})),l=tM({onInput:e=>(0,o.pipe)(tI(O(r,oj(e))),tC({onFailure:()=>tx(tU(e),()=>r0()),onSuccess:()=>tx(tU(e),()=>l)})),onFailure:e=>(0,o.pipe)(tI(O(r,o$(e))),tC({onFailure:()=>t_(e),onSuccess:()=>t_(e)})),onDone:()=>(0,o.pipe)(tI(O(r,oq)),tC({onFailure:()=>tL,onSuccess:()=>tL}))});return(0,o.pipe)(new lo((0,o.pipe)(tT(uT(e),l),rV(n.zipRight(n.forkDaemon(O(r,oq)),i.await(a))))),cs(us((0,o.pipe)(c7(s,t),n.ensuring(n.zipRight(Z(r),i.succeed(a,void 0)))))))}))),pJ=(0,o.dual)(2,(e,t)=>pG(e,{...t,cost:e=>n.succeed(t.cost(e))})),pG=(0,o.dual)(2,(e,t)=>"enforce"===t.strategy?pK(e,t.cost,t.units,t.duration,t.burst??0):pZ(e,t.cost,t.units,t.duration,t.burst??0)),pK=(e,t,r,i,a)=>{let s=(e,l)=>tM({onInput:u=>(0,o.pipe)(t(u),n.zip(iB.currentTimeMillis),n.map(([t,n])=>{let c=e+(n-l)/iH.toMillis(i)*r,p=r+a<0?1/0:r+a,f=c<0?p:Math.min(c,p);return t<=f?(0,o.pipe)(tU(u),tx(()=>s(f-t,n))):s(e,l)}),iO),onFailure:t_,onDone:()=>tL}),l=(0,o.pipe)(iB.currentTimeMillis,n.map(e=>s(r,e)),iO);return new lo((0,o.pipe)(uT(e),ip(l)))},pZ=(e,t,r,i,a)=>{let s=(e,l)=>tM({onInput:u=>(0,o.pipe)(t(u),n.zip(iB.currentTimeMillis),n.map(([t,n])=>{let c=e+(n-l)/iH.toMillis(i)*r,p=r+a<0?1/0:r+a,f=(c<0?p:Math.min(c,p))-t,d=f>=0?0:-f/r,h=iH.millis(Math.max(0,d*iH.toMillis(i)));return iH.greaterThan(h,iH.zero)?(0,o.pipe)(tI(iB.sleep(h)),ij(tU(u)),tx(()=>s(f,n))):tx(tU(u),()=>s(f,n))}),iO),onFailure:t_,onDone:()=>tL}),l=(0,o.pipe)(iB.currentTimeMillis,n.map(e=>s(r,e)),iO);return new lo((0,o.pipe)(uT(e),ip(l)))},pQ=(0,o.dual)(2,(e,t)=>(0,o.pipe)(p6(e),n.map(n.timeoutFail({onTimeout:()=>l.none(),duration:t})),uD)),pY=(0,o.dual)(3,(e,t,r)=>(0,o.pipe)(e,p0(r,ul(t)))),pX=(0,o.dual)(3,(e,r,i)=>(0,o.pipe)(p6(e),n.map(n.timeoutFailCause({onTimeout:()=>t.map(r(),l.some),duration:i})),uD)),p0=(0,o.dual)(3,(e,r,i)=>{let n=new t.RuntimeException("Stream Timeout");return(0,o.pipe)(e,pX(()=>t.die(n),r),lP(e=>t.isDieType(e)&&t.isRuntimeException(e.defect)&&void 0!==e.defect.message&&"Stream Timeout"===e.defect.message?l.some(i):l.none()))}),p1=e=>{if("number"==typeof e)return eW(e);if("unbounded"===e.capacity){let t;return t={replay:e.replay},m.suspend(()=>{let e;return e_((e=t,new eb(e?.replay?new eU(e.replay):void 0)),new eN)})}switch(e.strategy){case"dropping":return m.suspend(()=>e_(ep(e),new eN));case"sliding":return m.suspend(()=>e_(ep(e),new eP));default:return eW(e)}},p2=(0,o.dual)(2,(e,t)=>(0,o.pipe)(n.acquireRelease(p1(t),e=>e.shutdown),n.tap(t=>(0,o.pipe)(e,pm(t),n.forkScoped)))),p6=e=>n.map(ix(uT(e)),e=>(0,o.pipe)(e,n.mapError(l.some),n.flatMap(ee.match({onLeft:()=>n.fail(l.none()),onRight:n.succeed})))),p3=(0,o.dual)(e=>ll(e[0]),(e,t)=>n.tap(n.acquireRelease(t?.strategy==="unbounded"?K():t?.strategy==="dropping"?J(t.capacity??2):t?.strategy==="sliding"?G(t.capacity??2):V(t?.capacity??2),e=>Z(e)),t=>n.forkScoped(pb(e,t)))),p4=(0,o.dual)(e=>ll(e[0]),(e,t)=>n.tap(n.acquireRelease(V(t?.capacity??2),e=>Z(e)),t=>n.forkScoped(py(e,t)))),p5=(0,o.dual)(e=>ll(e[0]),(e,t)=>p7(e,i2.defaultRuntime,t)),p8=(0,o.dual)(e=>ll(e[0]),(e,t)=>n.map(n.runtime(),r=>p7(e,r,t))),p7=(0,o.dual)(e=>ll(e[0]),(e,r,i)=>{let a,s,o=i2.runFork(r),l=n.unsafeMakeLatch(!1);return new ReadableStream({start(r){(s=o(pu(e,e=>0===e.length?n.void:l.whenOpen(n.sync(()=>{for(let t of(l.unsafeClose(),e))r.enqueue(t);a(),a=void 0}))))).addObserver(e=>{try{"Failure"===e._tag?r.error(t.squash(e.cause)):r.close()}catch{}})},pull:()=>new Promise(e=>{a=e,n.runSync(l.open)}),cancel(){if(s)return n.runPromise(n.asVoid(er.interrupt(s)))}},i?.strategy)}),p9=(0,o.dual)(2,(e,t)=>new lo(tP(()=>{let i={ref:r.empty()},n={ref:!1},a=tP(()=>{let e=i.ref;return r.isEmpty(e)?tF({onInput:e=>(0,o.pipe)(tU(e),tx(()=>a)),onFailure:tE,onDone:tN}):(i.ref=r.empty(),(0,o.pipe)(iD(e),tx(()=>a)))}),s=tF({onInput:e=>tx(tU(e),()=>s),onFailure:tE,onDone:e=>ij(tD(()=>{n.ref=!0}),tN(e))}),l=(0,o.pipe)(t,aM,td,tx(([e,t])=>{let a,s;return(0,o.pipe)(tA([n.ref,(a=i.ref,i.ref=s=r.appendAll(a,r.filter(e,e=>0!==e.length)),s)]),tx(([e,i])=>{let n=e&&r.isEmpty(i)?tL:l;return(0,o.pipe)(tU(r.of(t)),tx(()=>n))}))}));return(0,o.pipe)(uT(e),tT(s),tT(a),ip(l))}))),fe=(0,o.dual)(e=>ll(e[0]),(e,r)=>{let i=i2.runFork(r);return{[Symbol.asyncIterator](){let r,a,s,o=n.unsafeMakeLatch(!1),l=!1;return{next:()=>(s||(s=i(pl(e,e=>o.whenOpen(n.sync(()=>{o.unsafeClose(),r({done:!1,value:e}),r=a=void 0}))))).addObserver(e=>{l||(s=n.runFork(o.whenOpen(n.sync(()=>{"Failure"===e._tag?a(t.squash(e.cause)):r({done:!0,value:void 0}),r=a=void 0}))))}),new Promise((e,t)=>{r=e,a=t,o.unsafeOpen()})),return:()=>(l=!0,s)?n.runPromise(n.as(er.interrupt(s),{done:!0,value:void 0})):Promise.resolve({done:!0,value:void 0})}}}}),ft=(e,t)=>fr(e,e=>(0,o.pipe)(t(e),l.map(([e,t])=>[r.of(e),t]))),fr=(e,t)=>{let r=e=>l.match(t(e),{onNone:()=>tL,onSome:([e,t])=>tx(tU(e),()=>r(t))});return new lo(tP(()=>r(e)))},fi=(e,t)=>pD(()=>{let r=e=>iO(n.map(t(e),l.match({onNone:()=>tL,onSome:([e,t])=>tx(tU(e),()=>r(t))})));return new lo(r(e))}),fn=(e,t)=>fi(e,e=>(0,o.pipe)(t(e),n.map(l.map(([e,t])=>[r.of(e),t])))),fa=pN(void 0),fs=e=>uE(uF(e)),fo=e=>uE(pC(e)),fl=e=>uE(pI(t=>e(t))),fu=(0,o.dual)(3,(e,t,r)=>(0,o.pipe)(e,cq(e=>(0,o.pipe)(e,X.add(t,r((0,o.pipe)(e,X.unsafeGet(t)))))))),fc=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,ff(n.sync(t)))),fp=(0,o.dual)(2,(e,t)=>(0,o.pipe)(uF(e),ub(e=>(0,o.pipe)(t(e),l.getOrElse(()=>ut))))),ff=(0,o.dual)(2,(e,t)=>(0,o.pipe)(uF(t),ub(t=>t?e:ut))),fd=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,fT(t,(e,t)=>[e,t]))),fh=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,fT(t,(e,t)=>[...e,t]))),fm=(0,o.dual)(2,(e,t)=>fw(e,{other:t.other,onSelf:e=>[e,t.defaultOther],onOther:e=>[t.defaultSelf,e],onBoth:(e,t)=>[e,t]})),fg=(0,o.dual)(3,(e,t,r)=>fw(e,{other:t,onSelf:o.identity,onOther:()=>r,onBoth:e=>e})),fy=(0,o.dual)(3,(e,t,r)=>fw(e,{other:t,onSelf:()=>r,onOther:o.identity,onBoth:(e,t)=>t})),fb=(0,o.dual)(2,(e,t)=>fE(e,{other:t.other,onSelf:e=>[e,t.defaultOther],onOther:e=>[t.defaultSelf,e],onBoth:(e,t)=>[e,t],order:t.order})),fS=(0,o.dual)(2,(e,t)=>fE(e,{other:t.other,onSelf:o.identity,onOther:()=>t.defaultSelf,onBoth:e=>e,order:t.order})),fv=(0,o.dual)(2,(e,t)=>fE(e,{other:t.other,onSelf:()=>t.defaultOther,onOther:o.identity,onBoth:(e,t)=>t,order:t.order})),fE=(0,o.dual)(2,(e,t)=>{let i=(e,u,c)=>{switch(e._tag){case oX:return(0,o.pipe)(u,n.match({onFailure:s.fail,onSuccess:e=>s.succeed([r.map(e,([e,r])=>[e,t.onSelf(r)]),o3])}));case o0:return(0,o.pipe)(c,n.match({onFailure:s.fail,onSuccess:e=>s.succeed([r.map(e,([e,r])=>[e,t.onOther(r)]),o4])}));case o1:return(0,o.pipe)(lq(u),n.zip(lq(c),{concurrent:!0}),n.matchEffect({onFailure:e=>n.succeed(s.fail(l.some(e))),onSuccess:([e,p])=>l.isSome(e)&&l.isSome(p)?r.isEmpty(e.value)&&r.isEmpty(p.value)?i(o5,u,c):r.isEmpty(e.value)?i(o8(p.value),u,c):r.isEmpty(p.value)?i(o7(e.value),u,c):n.succeed(s.succeed(a(e.value,p.value))):l.isSome(e)&&l.isNone(p)?r.isEmpty(e.value)?i(o3,u,c):n.succeed(s.succeed([(0,o.pipe)(e.value,r.map(([e,r])=>[e,t.onSelf(r)])),o3])):l.isNone(e)&&l.isSome(p)?r.isEmpty(p.value)?i(o4,u,c):n.succeed(s.succeed([(0,o.pipe)(p.value,r.map(([e,r])=>[e,t.onOther(r)])),o4])):n.succeed(s.fail(l.none()))}));case o2:return n.matchEffect(u,{onFailure:l.match({onNone:()=>n.succeed(s.succeed([(0,o.pipe)(e.rightChunk,r.map(([e,r])=>[e,t.onOther(r)])),o4])),onSome:e=>n.succeed(s.fail(l.some(e)))}),onSuccess:t=>r.isEmpty(t)?i(o8(e.rightChunk),u,c):n.succeed(s.succeed(a(t,e.rightChunk)))});case o6:return n.matchEffect(c,{onFailure:l.match({onNone:()=>n.succeed(s.succeed([r.map(e.leftChunk,([e,r])=>[e,t.onSelf(r)]),o3])),onSome:e=>n.succeed(s.fail(l.some(e)))}),onSuccess:t=>r.isEmpty(t)?i(o7(e.leftChunk),u,c):n.succeed(s.succeed(a(e.leftChunk,t)))})}},a=(e,i)=>{let n,a=(e,t)=>t<e.length-1,s=[],l=0,u=0,c=(0,o.pipe)(e,r.unsafeGet(l)),p=(0,o.pipe)(i,r.unsafeGet(u)),f=c[0],d=c[1],h=p[0],m=p[1],g=!0;for(;g;){let y=t.order(f,h);if(0===y)s.push([f,t.onBoth(d,m)]),a(e,l)&&a(i,u)?(l+=1,u+=1,c=(0,o.pipe)(e,r.unsafeGet(l)),p=(0,o.pipe)(i,r.unsafeGet(u)),f=c[0],d=c[1],h=p[0],m=p[1]):(n=a(e,l)?o7((0,o.pipe)(e,r.drop(l+1))):a(i,u)?o8((0,o.pipe)(i,r.drop(u+1))):o5,g=!1);else if(y<0)if(s.push([f,t.onSelf(d)]),a(e,l))l+=1,f=(c=(0,o.pipe)(e,r.unsafeGet(l)))[0],d=c[1];else{let e=[];for(e.push(p);a(i,u);)u+=1,p=(0,o.pipe)(i,r.unsafeGet(u)),e.push(p);n=o8(r.unsafeFromArray(e)),g=!1}else if(s.push([h,t.onOther(m)]),a(i,u))u+=1,h=(p=(0,o.pipe)(i,r.unsafeGet(u)))[0],m=p[1];else{let t=[];for(t.push(c);a(e,l);)l+=1,c=(0,o.pipe)(e,r.unsafeGet(l)),t.push(c);n=o7(r.unsafeFromArray(t)),g=!1}}return[r.unsafeFromArray(s),n]};return lB(e,t.other,o5,i)}),fw=(0,o.dual)(2,(e,t)=>{let i=(e,u,c)=>{switch(e._tag){case oX:return n.matchEffect(u,{onFailure:e=>n.succeed(s.fail(e)),onSuccess:e=>n.succeed(s.succeed([r.map(e,t.onSelf),o3]))});case o0:return n.matchEffect(c,{onFailure:e=>n.succeed(s.fail(e)),onSuccess:e=>n.succeed(s.succeed([r.map(e,t.onOther),o4]))});case o1:return(0,o.pipe)(lq(u),n.zip(lq(c),{concurrent:!0}),n.matchEffect({onFailure:e=>n.succeed(s.fail(l.some(e))),onSuccess:([e,o])=>l.isSome(e)&&l.isSome(o)?r.isEmpty(e.value)&&r.isEmpty(o.value)?i(o5,u,c):r.isEmpty(e.value)?i(o8(o.value),u,c):r.isEmpty(o.value)?i(o7(e.value),u,c):n.succeed(s.succeed(a(e.value,o.value,t.onBoth))):l.isSome(e)&&l.isNone(o)?n.succeed(s.succeed([r.map(e.value,t.onSelf),o3])):l.isNone(e)&&l.isSome(o)?n.succeed(s.succeed([r.map(o.value,t.onOther),o4])):n.succeed(s.fail(l.none()))}));case o2:return n.matchEffect(u,{onFailure:l.match({onNone:()=>n.succeed(s.succeed([r.map(e.rightChunk,t.onOther),o4])),onSome:e=>n.succeed(s.fail(l.some(e)))}),onSuccess:o=>r.isEmpty(o)?i(o8(e.rightChunk),u,c):r.isEmpty(e.rightChunk)?i(o7(o),u,c):n.succeed(s.succeed(a(o,e.rightChunk,t.onBoth)))});case o6:return n.matchEffect(c,{onFailure:l.match({onNone:()=>n.succeed(s.succeed([r.map(e.leftChunk,t.onSelf),o3])),onSome:e=>n.succeed(s.fail(l.some(e)))}),onSuccess:o=>r.isEmpty(o)?i(o7(e.leftChunk),u,c):r.isEmpty(e.leftChunk)?i(o8(o),u,c):n.succeed(s.succeed(a(e.leftChunk,o,t.onBoth)))})}},a=(e,t,i)=>{let[n,a]=fM(e,t,i);switch(a._tag){case"Left":if(r.isEmpty(a.left))return[n,o5];return[n,o7(a.left)];case"Right":if(r.isEmpty(a.right))return[n,o5];return[n,o8(a.right)]}};return lB(e,t.other,o5,i)}),f_=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,fx(t,(e,t)=>[e,t]))),fk=(...e)=>{if(0===e.length)return ut;if(1===e.length)return u2(e[0],e=>[e]);let[t,...r]=e;return fx(t,fk(...r),(e,t)=>[e,...t])},fx=(0,o.dual)(3,(e,t,i)=>{let a=e=>(0,o.pipe)(e,n.flatMap(t=>r.isEmpty(t)?a(e):n.succeed(t)));return(0,o.pipe)(p6(e),n.map(a),n.zip((0,o.pipe)(p6(t),n.map(a))),n.flatMap(([e,t])=>(0,o.pipe)(uM(n.raceWith(e,t,{onSelfDone:(e,t)=>(0,o.pipe)(n.suspend(()=>e),n.zipWith(er.join(t),(e,t)=>[e,t,!0])),onOtherDone:(e,t)=>(0,o.pipe)(n.suspend(()=>e),n.zipWith(er.join(t),(e,t)=>[t,e,!1]))})),ub(([n,a,s])=>(0,o.pipe)(uF(Q.make([r.unsafeLast(n),r.unsafeLast(a)])),ub(l=>(0,o.pipe)(uR(s?(0,o.pipe)(a,r.map(e=>i(r.unsafeLast(n),e))):(0,o.pipe)(n,r.map(e=>i(e,r.unsafeLast(a))))),lH((0,o.pipe)(cX(e),cu(cX(t)),cr(ee.match({onLeft:e=>Q.modify(l,([t,n])=>[(0,o.pipe)(e,r.map(e=>i(e,n))),[r.unsafeLast(e),n]]),onRight:e=>Q.modify(l,([t,n])=>[(0,o.pipe)(e,r.map(e=>i(t,e))),[t,r.unsafeLast(e)]])})),ub(uR))))))),p6)),uD)}),fC=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,fR(t,(e,t)=>e.length>t.length?[(0,o.pipe)(e,r.take(t.length)),ee.left((0,o.pipe)(e,r.take(t.length)))]:[e,ee.right((0,o.pipe)(t,r.drop(e.length)))]))),fI=(0,o.dual)(2,(e,t)=>(0,o.pipe)(e,fR(t,(e,t)=>e.length>t.length?[t,ee.left((0,o.pipe)(e,r.take(t.length)))]:[(0,o.pipe)(t,r.take(e.length)),ee.right((0,o.pipe)(t,r.drop(e.length)))]))),fT=(0,o.dual)(3,(e,t,r)=>(0,o.pipe)(e,fR(t,(e,t)=>fM(e,t,r)))),fR=(0,o.dual)(3,(e,t,i)=>{let a=(e,t,i)=>{switch(e._tag){case o9:return(0,o.pipe)(lq(t),n.zip(lq(i),{concurrent:!0}),n.matchEffect({onFailure:e=>n.succeed(s.fail(l.some(e))),onSuccess:([e,o])=>l.isSome(e)&&l.isSome(o)?r.isEmpty(e.value)&&r.isEmpty(o.value)?a(lr,t,i):r.isEmpty(e.value)?a(li(o.value),t,i):r.isEmpty(o.value)?a(ln(e.value),t,i):n.succeed(s.succeed(u(e.value,o.value))):n.succeed(s.fail(l.none()))}));case le:return n.matchEffect(t,{onFailure:e=>n.succeed(s.fail(e)),onSuccess:o=>r.isEmpty(o)?a(li(e.rightChunk),t,i):r.isEmpty(e.rightChunk)?a(ln(o),t,i):n.succeed(s.succeed(u(o,e.rightChunk)))});case lt:return n.matchEffect(i,{onFailure:e=>n.succeed(s.fail(e)),onSuccess:o=>r.isEmpty(o)?a(ln(e.leftChunk),t,i):r.isEmpty(e.leftChunk)?a(li(o),t,i):n.succeed(s.succeed(u(e.leftChunk,o)))})}},u=(e,t)=>{let[n,a]=i(e,t);switch(a._tag){case"Left":if(r.isEmpty(a.left))return[n,lr];return[n,ln(a.left)];case"Right":if(r.isEmpty(a.right))return[n,lr];return[n,li(a.right)]}};return(0,o.pipe)(e,lB(t,lr,a))}),fO=e=>{let t=e=>tM({onInput:i=>{let[n,a]=r.mapAccum(i,e,(e,t)=>[l.some(t),(0,o.pipe)(e,l.map(e=>[e,t]))]);return tx(tU(r.filterMap(a,e=>l.isSome(e)?l.some([e.value[0],l.some(e.value[1])]):l.none())),()=>t(n))},onFailure:t_,onDone:()=>l.match(e,{onNone:()=>tL,onSome:e=>ij(tU(r.of([e,l.none()])),tL)})});return new lo((0,o.pipe)(uT(e),ip(t(l.none()))))},fF=e=>(0,o.pipe)(e,u6(l.none(),(e,t)=>[l.some(t),[e,t]])),fM=(e,t,i)=>e.length>t.length?[(0,o.pipe)(e,r.take(t.length),r.zipWith(t,i)),ee.left((0,o.pipe)(e,r.drop(t.length)))]:[(0,o.pipe)(e,r.zipWith((0,o.pipe)(t,r.take(e.length)),i)),ee.right((0,o.pipe)(t,r.drop(e.length)))],fA=pN({}),fN=(0,o.dual)(e=>"string"!=typeof e[0],(e,t,r,i)=>ub(e,e=>u2(r(e),r=>({...e,[t]:r})),i)),fP=og.bindTo(u2),fD=og.let_(u2),fL=(0,o.dual)(e=>ll(e[0]),(e,t="utf-8")=>pD(()=>{let r=new TextDecoder(t);return u2(e,e=>r.decode(e))})),fU=e=>pD(()=>{let t=new TextEncoder;return u2(e,e=>t.encode(e))});e.s(["DefaultChunkSize",0,lu,"Do",0,fA,"StreamTypeId",0,la,"_async",0,(e,r)=>n.acquireRelease(lg(r),e=>Z(e)).pipe(n.flatMap(r=>n.runtime().pipe(n.flatMap(i=>n.sync(()=>{let a=i2.runPromiseExit(i);return e(ow(e=>oB(e).pipe(n.flatMap(e=>O(r,e)),n.asVoid,a).then(e=>{if(s.isFailure(e)&&!t.isInterrupted(e.cause))throw t.squash(e.cause)})))})),n.map(e=>{let t=M(r).pipe(n.flatMap(e=>oW(e)),n.match({onFailure:e=>tI(Z(r)).pipe(ij(l.match(e,{onNone:()=>tL,onSome:e=>tE(e)}))),onSuccess:e=>tU(e).pipe(tx(()=>t))}),iO);return uI(t).pipe(ur(e??n.void))}))),fo),"accumulate",0,e=>lj(lc(e)),"accumulateChunks",0,lc,"acquireRelease",0,lp,"aggregate",0,lf,"aggregateWithin",0,ld,"aggregateWithinEither",0,lh,"as",0,lm,"asyncEffect",0,(e,r)=>(0,o.pipe)(n.acquireRelease(lg(r),e=>Z(e)),n.flatMap(r=>(0,o.pipe)(n.runtime(),n.flatMap(i=>(0,o.pipe)(e(ow(e=>(0,o.pipe)(oB(e),n.flatMap(e=>O(r,e)),n.asVoid,i2.runPromiseExit(i)).then(e=>{if(s.isFailure(e)&&!t.isInterrupted(e.cause))throw t.squash(e.cause)}))),n.map(()=>{let e=(0,o.pipe)(M(r),n.flatMap(oW),n.match({onFailure:e=>(0,o.pipe)(tI(Z(r)),ij(l.match(e,{onNone:()=>tL,onSome:tE}))),onSuccess:t=>(0,o.pipe)(tU(t),tx(()=>e))}),iO);return e}))))),iF,uI),"asyncPush",0,ly,"asyncScoped",0,(e,r)=>(0,o.pipe)(n.acquireRelease(lg(r),e=>Z(e)),n.flatMap(r=>(0,o.pipe)(n.runtime(),n.flatMap(i=>(0,o.pipe)(e(ow(e=>(0,o.pipe)(oB(e),n.flatMap(e=>O(r,e)),n.asVoid,i2.runPromiseExit(i)).then(e=>{if(s.isFailure(e)&&!t.isInterrupted(e.cause))throw t.squash(e.cause)}))),n.zipRight(Q.make(!1)),n.flatMap(e=>(0,o.pipe)(Q.get(e),n.map(t=>t?oJ():(0,o.pipe)(M(r),n.flatMap(oW),n.onError(()=>(0,o.pipe)(Q.set(e,!0),n.zipRight(Z(r)))))))))))),pC,ub(cY)),"bind",0,fN,"bindTo",0,fP,"branchAfter",0,lb,"broadcast",0,lS,"broadcastDynamic",0,lv,"broadcastedQueues",0,lw,"broadcastedQueuesDynamic",0,l_,"buffer",0,lk,"bufferChunks",0,lx,"catchAll",0,lM,"catchAllCause",0,lA,"catchSome",0,lN,"catchSomeCause",0,lP,"catchTag",0,lD,"catchTags",0,lL,"changes",0,e=>(0,o.pipe)(e,lU((e,t)=>et.equals(t)(e))),"changesWith",0,lU,"changesWithEffect",0,lz,"channelToStream",0,e=>new lo(e),"chunks",0,lj,"chunksWith",0,lW,"combine",0,l$,"combineChunks",0,lB,"concat",0,lH,"concatAll",0,e=>pD(()=>(0,o.pipe)(e,r.reduce(ut,(e,t)=>lH(t)(e)))),"context",0,un,"contextWith",0,e=>(0,o.pipe)(un(),u2(e)),"contextWithEffect",0,e=>(0,o.pipe)(un(),cr(e)),"contextWithStream",0,ua,"cross",0,lV,"crossLeft",0,lJ,"crossRight",0,lG,"crossWith",0,lK,"debounce",0,lZ,"decodeText",0,fL,"die",0,lQ,"dieMessage",0,e=>uF(n.dieMessage(e)),"dieSync",0,e=>uF(n.dieSync(e)),"distributedWith",0,lY,"distributedWithDynamic",0,l1,"distributedWithDynamicCallback",0,l2,"drain",0,l6,"drainFork",0,l3,"drop",0,l4,"dropRight",0,l5,"dropUntil",0,l8,"dropUntilEffect",0,l7,"dropWhile",0,l9,"dropWhileEffect",0,ue,"either",0,e=>(0,o.pipe)(e,u2(ee.right),lM(e=>u1(ee.left(e)))),"empty",0,ut,"encodeText",0,fU,"ensuring",0,ur,"ensuringWith",0,ui,"execute",0,us,"fail",0,uo,"failCause",0,uu,"failCauseSync",0,e=>uF(n.failCauseSync(e)),"failSync",0,ul,"filter",0,uc,"filterEffect",0,up,"filterMap",0,uf,"filterMapEffect",0,ud,"filterMapWhile",0,uh,"filterMapWhileEffect",0,um,"finalizer",0,e=>lp(n.void,()=>e),"find",0,ug,"findEffect",0,uy,"flatMap",0,ub,"flatten",0,uE,"flattenChunks",0,uw,"flattenEffect",0,u_,"flattenExitOption",0,uk,"flattenIterables",0,e=>(0,o.pipe)(e,u2(r.fromIterable),uw),"flattenTake",0,ux,"forever",0,uC,"fromAsyncIterable",0,(e,t)=>(0,o.pipe)(n.acquireRelease(n.sync(()=>e[Symbol.asyncIterator]()),e=>e.return?n.promise(async()=>e.return()):n.void),n.map(e=>cX((0,o.pipe)(n.tryPromise({try:async()=>e.next(),catch:e=>l.some(t(e))}),n.flatMap(e=>e.done?n.fail(l.none()):n.succeed(e.value))))),fo),"fromChannel",0,uI,"fromChunk",0,uR,"fromChunkPubSub",0,(e,t)=>{if(t?.scoped){let r=n.map(eq(e),uO);return t.shutdown?n.map(r,ur(e.shutdown)):r}let r=ub(pC(eq(e)),uO);return t?.shutdown?ur(r,e.shutdown):r},"fromChunkQueue",0,uO,"fromChunks",0,(...e)=>(0,o.pipe)(uN(e),ub(uR)),"fromEffect",0,uF,"fromEffectOption",0,uM,"fromEventListener",0,(e,t,r)=>ly(i=>n.acquireRelease(n.sync(()=>e.addEventListener(t,i.single,r)),()=>n.sync(()=>e.removeEventListener(t,i.single,r))),{bufferSize:"object"==typeof r?r.bufferSize:void 0}),"fromIterable",0,uN,"fromIterableEffect",0,e=>(0,o.pipe)(e,n.map(uN),fs),"fromIteratorSucceed",0,uP,"fromPubSub",0,uA,"fromPull",0,uD,"fromQueue",0,uL,"fromReadableStream",0,uz,"fromReadableStreamByob",0,(...e)=>{let t=1===e.length?e[0].evaluate:e[0],r=1===e.length?e[0].onError:e[1],i=(1===e.length?e[0].bufferSize:e[2])??4096,a=1===e.length&&!0===e[0].releaseLockOnEnd;return fo(n.map(n.acquireRelease(n.sync(()=>t().getReader({mode:"byob"})),e=>a?n.sync(()=>e.releaseLock()):n.promise(()=>e.cancel())),e=>{var t,a;let s;return lM(uC((t=e,a=r,s=new ArrayBuffer(i),cT(0,e=>n.flatMap(n.tryPromise({try:()=>t.read(new Uint8Array(s,e,s.byteLength-e)),catch:e=>a(e)}),({done:t,value:r})=>{if(t)return n.fail(uj);let i=e+r.byteLength;return n.succeed([r,i>=s.byteLength?l.none():l.some(i)])})))),e=>e===uj?ut:uo(e))}))},"fromSchedule",0,e=>(0,o.pipe)(i4(e),n.map(e=>cX(e.next(void 0))),fs),"fromTPubSub",0,e=>{let t,r,i,a,s,l;return fo(n.map(n.acquireRelease((t=e.pubsubSize,r=e.publisherHead,i=e.publisherTail,a=e.requestedCapacity,s=e.subscriberCount,l=e.subscribers,(0,o.pipe)(on(i),sJ(e=>{let i,n;return(0,o.pipe)(Symbol.iterator in(i=[s$(t=>{let r=new oi(e);return t.set(r,aB(r,!0)),r}),on(s),on(l)])?s5(i,o.identity,n):n?.discard?s5(Object.values(i),o.identity,n):sQ(s5(Object.entries(i),([e,t])=>sQ(t,t=>[e,t])),e=>{let t={};for(let[r,i]of e)t[r]=i;return t}),s9(([e,t])=>(0,o.pipe)(s,oa(t+1))),s9(([e,t,r])=>(0,o.pipe)(l,oa((0,o.pipe)(r,eH.add(e))))),sQ(([e])=>new oh(t,r,a,e,s,l)))}))),e=>e.shutdown),e=>uU(e)))},"fromTQueue",0,uU,"groupAdjacentBy",0,uW,"grouped",0,uq,"groupedWithin",0,u$,"haltAfter",0,uH,"haltWhen",0,uB,"haltWhenDeferred",0,uV,"identityStream",0,uJ,"interleave",0,uG,"interleaveWith",0,uK,"interruptAfter",0,uY,"interruptWhen",0,uX,"interruptWhenDeferred",0,u0,"intersperse",0,uZ,"intersperseAffixes",0,uQ,"isStream",0,ll,"iterate",0,(e,t)=>ft(e,e=>l.some([e,t(e)])),"let_",0,fD,"make",0,u1,"map",0,u2,"mapAccum",0,u6,"mapAccumEffect",0,u3,"mapBoth",0,u4,"mapChunks",0,u5,"mapChunksEffect",0,u8,"mapConcat",0,u7,"mapConcatChunk",0,u9,"mapConcatChunkEffect",0,ce,"mapConcatEffect",0,ct,"mapEffectPar",0,ci,"mapEffectSequential",0,cr,"mapError",0,cn,"mapErrorCause",0,ca,"mapInputContext",0,cq,"matchConcurrency",0,uS,"merge",0,cs,"mergeAll",0,co,"mergeEither",0,cu,"mergeLeft",0,cc,"mergeRight",0,cp,"mergeWith",0,cf,"mergeWithTag",0,cl,"mkString",0,e=>c7(e,aW),"never",0,cd,"onDone",0,cg,"onEnd",0,ch,"onError",0,cm,"onStart",0,cy,"orDie",0,e=>(0,o.pipe)(e,cb(o.identity)),"orDieWith",0,cb,"orElse",0,cS,"orElseEither",0,cv,"orElseFail",0,cE,"orElseIfEmpty",0,cw,"orElseIfEmptyChunk",0,c_,"orElseIfEmptyStream",0,ck,"orElseSucceed",0,cx,"paginate",0,(e,t)=>cC(e,e=>{let i=t(e);return[r.of(i[0]),i[1]]}),"paginateChunk",0,cC,"paginateChunkEffect",0,cI,"paginateEffect",0,cT,"partition",0,cO,"partitionEither",0,cF,"peel",0,cR,"pipeThrough",0,cM,"pipeThroughChannel",0,cA,"pipeThroughChannelOrFail",0,cN,"prepend",0,cP,"provideContext",0,cD,"provideLayer",0,cU,"provideService",0,cz,"provideServiceEffect",0,cj,"provideServiceStream",0,cW,"provideSomeContext",0,cL,"provideSomeLayer",0,c$,"race",0,cB,"raceAll",0,cH,"range",0,(e,t,i=lu)=>pD(()=>{if(e>t)return ut;let n=(e,t,i)=>{let a=t-e+1;return a>i?(0,o.pipe)(tU(r.range(e,e+i-1)),tx(()=>n(e+i,t,i))):tU(r.range(e,e+a-1))};return new lo(n(e,t,i))}),"rechunk",0,cV,"refineOrDie",0,cK,"refineOrDieWith",0,cZ,"repeat",0,cQ,"repeatEffect",0,e=>cX((0,o.pipe)(e,n.mapError(l.some))),"repeatEffectChunk",0,e=>cY((0,o.pipe)(e,n.mapError(l.some))),"repeatEffectChunkOption",0,cY,"repeatEffectOption",0,cX,"repeatEffectWithSchedule",0,c3,"repeatEither",0,c0,"repeatElements",0,c1,"repeatElementsWith",0,c2,"repeatValue",0,e=>new lo(iy(tU(r.of(e)))),"repeatWith",0,c6,"retry",0,c4,"run",0,c7,"runCollect",0,e=>c7(e,nm()),"runCount",0,e=>c7(e,aj),"runDrain",0,c9,"runFold",0,pe,"runFoldEffect",0,pt,"runFoldScoped",0,pr,"runFoldScopedEffect",0,pi,"runFoldWhile",0,pn,"runFoldWhileEffect",0,pa,"runFoldWhileScoped",0,ps,"runFoldWhileScopedEffect",0,po,"runForEach",0,pl,"runForEachChunk",0,pu,"runForEachChunkScoped",0,pc,"runForEachScoped",0,pp,"runForEachWhile",0,pf,"runForEachWhileScoped",0,pd,"runHead",0,e=>c7(e,af()),"runIntoPubSub",0,ph,"runIntoPubSubScoped",0,pm,"runIntoQueue",0,pg,"runIntoQueueElementsScoped",0,py,"runIntoQueueScoped",0,pb,"runLast",0,e=>c7(e,ah()),"runScoped",0,pS,"runSum",0,e=>c7(e,aO),"scan",0,pv,"scanEffect",0,px,"scanReduce",0,pE,"scanReduceEffect",0,pw,"schedule",0,p_,"scheduleWith",0,pk,"scoped",0,pC,"scopedWith",0,pI,"share",0,lE,"sliding",0,pO,"slidingSize",0,pF,"some",0,e=>(0,o.pipe)(e,cn(l.some),pR(()=>l.none())),"someOrElse",0,pT,"someOrFail",0,pR,"split",0,pM,"splitLines",0,e=>cA(e,i_()),"splitOnChunk",0,pA,"succeed",0,pN,"suspend",0,pD,"sync",0,pP,"take",0,pL,"takeRight",0,pU,"takeUntil",0,pz,"takeUntilEffect",0,pj,"takeWhile",0,pW,"tap",0,pq,"tapBoth",0,p$,"tapError",0,pB,"tapErrorCause",0,pH,"tapSink",0,pV,"throttle",0,pJ,"throttleEffect",0,pG,"tick",0,e=>{let t,r;return t=void 0,r=i8(e),c3(n.succeed(t),r)},"timeout",0,pQ,"timeoutFail",0,pY,"timeoutFailCause",0,pX,"timeoutTo",0,p0,"toAsyncIterable",0,e=>fe(e,i2.defaultRuntime),"toAsyncIterableEffect",0,e=>n.map(n.runtime(),t=>fe(e,t)),"toAsyncIterableRuntime",0,fe,"toChannel",0,uT,"toPubSub",0,p2,"toPull",0,p6,"toQueue",0,p3,"toQueueOfElements",0,p4,"toReadableStream",0,p5,"toReadableStreamEffect",0,p8,"toReadableStreamRuntime",0,p7,"transduce",0,p9,"unfold",0,ft,"unfoldChunk",0,fr,"unfoldChunkEffect",0,fi,"unfoldEffect",0,fn,"unwrap",0,fs,"unwrapScoped",0,fo,"unwrapScopedWith",0,fl,"updateService",0,fu,"void",()=>fa,"when",0,fc,"whenCase",0,(e,t)=>fp(t)(n.sync(e)),"whenCaseEffect",0,fp,"whenEffect",0,ff,"withExecutionPlan",0,c5,"withSpan",0,function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=rR.addSpanStackTrace(e?arguments[2]:arguments[1]);if(e){let e=arguments[0];return new lo(iN(uT(e),t,r))}return e=>new lo(iN(uT(e),t,r))},"zip",0,fd,"zipAll",0,fm,"zipAllLeft",0,fg,"zipAllRight",0,fy,"zipAllSortedByKey",0,fb,"zipAllSortedByKeyLeft",0,fS,"zipAllSortedByKeyRight",0,fv,"zipAllSortedByKeyWith",0,fE,"zipAllWith",0,fw,"zipFlatten",0,fh,"zipLatest",0,f_,"zipLatestAll",0,fk,"zipLatestWith",0,fx,"zipLeft",0,fC,"zipRight",0,fI,"zipWith",0,fT,"zipWithChunks",0,fR,"zipWithIndex",0,e=>(0,o.pipe)(e,u6(0,(e,t)=>[e+1,[t,e]])),"zipWithNext",0,fO,"zipWithPrevious",0,fF,"zipWithPreviousAndNext",0,e=>(0,o.pipe)(fO(fF(e)),u2(([[e,t],r])=>[e,t,(0,o.pipe)(r,l.map(e=>e[1]))]))],65463);let fz=Symbol.for("effect/GroupBy"),fj={_R:e=>e,_E:e=>e,_K:e=>e,_V:e=>e},fW=(0,o.dual)(e=>{let t;return t=e[0],(0,c.hasProperty)(t,fz)},(e,t,r)=>ub(e.grouped,([e,r])=>t(e,ux(uL(r,{shutdown:!0}))),{concurrency:"unbounded",bufferSize:r?.bufferSize??16})),fq=(0,o.dual)(e=>"function"!=typeof e[0],(e,t,r)=>r?.key?fW(fB(e,r.key,{bufferSize:r.bufferSize}),(e,r)=>cr(r,t)):uS(r?.concurrency,()=>cr(e,t),i=>r?.unordered?ub(e,e=>uF(t(e)),{concurrency:i}):ci(e,i,t)));class f$ extends a.Class{dequeue;f;[b]={_Out:e=>e};constructor(e,t){super(),this.dequeue=e,this.f=t}capacity(){return this.dequeue.capacity()}get size(){return this.dequeue.size}unsafeSize(){return this.dequeue.unsafeSize()}get awaitShutdown(){return this.dequeue.awaitShutdown}isActive(){return this.dequeue.isActive()}get isShutdown(){return this.dequeue.isShutdown}get shutdown(){return Z(this.dequeue)}get isFull(){return this.dequeue.isFull}get isEmpty(){return this.dequeue.isEmpty}get take(){return(0,o.pipe)(M(this.dequeue),n.map(e=>this.f(e)))}get takeAll(){return(0,o.pipe)(this.dequeue.takeAll,n.map(r.map(e=>this.f(e))))}takeUpTo(e){return(0,o.pipe)(A(this.dequeue,e),n.map(r.map(e=>this.f(e))))}takeBetween(e,t){return(0,o.pipe)(N(this.dequeue,e,t),n.map(r.map(e=>this.f(e))))}takeN(e){return(0,o.pipe)(P(this.dequeue,e),n.map(r.map(e=>this.f(e))))}poll(){let e;return(0,o.pipe)((e=this.dequeue,m.map(e.takeUpTo(1),r.head)),n.map(l.map(e=>this.f(e))))}pipe(){return(0,u.pipeArguments)(this,arguments)}commit(){return this.take}}let fB=(0,o.dual)(e=>"function"!=typeof e[0],(e,r,i)=>{let a=(e,s)=>tM({onInput:u=>tx(tI(n.forEach(fH(u,r),([r,a])=>{let u=e.get(r);return void 0===u?(0,o.pipe)(V(i?.bufferSize??16),n.flatMap(i=>(0,o.pipe)(n.sync(()=>{e.set(r,i)}),n.zipRight(O(s,oV([r,i]))),n.zipRight((0,o.pipe)(O(i,oj(a)),n.catchSomeCause(e=>t.isInterruptedOnly(e)?l.some(n.void):l.none())))))):n.catchSomeCause(O(u,oj(a)),e=>t.isInterruptedOnly(e)?l.some(n.void):l.none())},{discard:!0})),()=>a(e,s)),onFailure:e=>tI(O(s,o$(e))),onDone:()=>tI((0,o.pipe)(n.forEach(e.entries(),([e,r])=>(0,o.pipe)(O(r,oq),n.catchSomeCause(e=>t.isInterruptedOnly(e)?l.some(n.void):l.none())),{discard:!0}),n.zipRight(O(s,oq))))});return{[fz]:fj,pipe(){return(0,u.pipeArguments)(this,arguments)},grouped:fl(t=>n.gen(function*(){let r=new Map,i=yield*K();return yield*Y.addFinalizer(t,Z(i)),yield*uT(e).pipe(tT(a(r,i)),rH,re(t),n.forkIn(t),n.as(ux(uL(i,{shutdown:!0}))))}))}}),fH=(0,o.dual)(2,(e,t)=>{let i,n=[],a=e[Symbol.iterator](),s=new Map;for(;(i=a.next())&&!i.done;){let e=i.value,r=t(e);if(s.has(r))s.get(r).push(e);else{let t=[e];n.push([r,t]),s.set(r,t)}}return r.unsafeFromArray(n.map(e=>[e[0],r.unsafeFromArray(e[1])]))});e.s(["StreamTypeId",0,la,"bufferChunks",0,lx,"decodeText",0,fL,"encodeText",0,fU,"ensuring",0,ur,"ensuringWith",0,ui,"fail",0,uo,"flatMap",0,ub,"fromChannel",0,uI,"fromIterable",0,uN,"fromReadableStream",0,uz,"map",0,u2,"mapEffect",0,fq,"mapError",0,cn,"pipeThroughChannel",0,cA,"provideContext",0,cD,"provideSomeContext",0,cL,"run",0,c7,"runDrain",0,c9,"runForEach",0,pl,"succeed",0,pN,"suspend",0,pD,"toReadableStreamEffect",0,p8,"toReadableStreamRuntime",0,p7,"unwrap",0,fs,"unwrapScoped",0,fo],724880)},302014,156312,30725,698440,648232,e=>{"use strict";var t=e.i(435146),r=e.i(964665),i=e.i(842862),n=e.i(65632);i.unsafeCoerce;var a=e.i(777865),s=e.i(64317),o=e.i(565005),l=e.i(604234),u=e.i(954277),c=e.i(65463);l.ChannelTypeId,o.ChannelExceptionTypeId,l.isChannel;let p=o.acquireUseRelease;l.acquireReleaseOut,o.as,o.asVoid,o.buffer,o.bufferChunk,o.catchAll,l.catchAllCause,l.concatAll,l.concatAllWith,o.concatMap,l.concatMapWith,l.concatMapWithCustom,o.collect,o.concatOut,o.mapInput,o.mapInputEffect,o.mapInputError,o.mapInputErrorEffect,o.mapInputIn,o.mapInputInEffect,o.doneCollect,o.drain;let f=l.embedInput;o.emitCollect,o.ensuring,l.ensuringWith,o.context,o.contextWith,o.contextWithChannel,o.contextWithEffect,l.fail,l.failSync;let d=l.failCause;l.failCauseSync;let h=l.flatMap;o.flatten,o.foldChannel,l.foldCauseChannel,l.fromEffect,o.fromEither,o.fromInput,o.fromPubSub,o.fromPubSubScoped,o.fromOption,o.fromQueue,o.identityChannel,o.interruptWhen,o.interruptWhenDeferred,o.map,o.mapEffect,o.mapError,o.mapErrorCause,o.mapOut,o.mapOutEffect,o.mapOutEffectPar,o.mergeAll,o.mergeAllUnbounded,o.mergeAllUnboundedWith,o.mergeAllWith,o.mergeMap,o.mergeOut,o.mergeOutWith,o.mergeWith,o.never,o.orDie,o.orDieWith,o.orElse;let m=l.pipeTo;o.pipeToOrFail,l.provideContext,o.provideLayer,o.mapInputContext,o.provideSomeLayer,o.provideService,o.read,l.readOrFail,l.readWith;let g=l.readWithCause;o.repeated;let y=o.run;o.runCollect,o.runDrain,o.runScoped,o.scoped,o.scopedWith,o.splitLines;let b=l.succeed,S=l.suspend,v=l.sync;o.toPubSub,o.toPull,o.toPullIn,o.toQueue,u.channelToSink,c.channelToStream;let E=l.void,w=o.unwrap,_=o.unwrapScoped;o.unwrapScopedWith,o.updateService,o.withSpan;let k=l.write;o.writeAll,o.writeChunk,o.zip,o.zipLeft;let x=o.zipRight;o.ChannelException,o.isChannelException,e.s(["acquireUseRelease",0,p,"embedInput",0,f,"failCause",0,d,"flatMap",0,h,"pipeTo",0,m,"readWithCause",0,g,"run",0,y,"succeed",0,b,"suspend",0,S,"sync",0,v,"unwrap",0,w,"unwrapScoped",0,_,"void",()=>E,"write",0,k,"zipRight",0,x],156312);var C=e.i(526886),I=e.i(405614),T=e.i(347064);u.SinkTypeId,u.as,u.collectAll,u.collectAllN,u.collectAllFrom,u.collectAllToMap,u.collectAllToMapN,u.collectAllToSet,u.collectAllToSetN,u.collectAllUntil,u.collectAllUntilEffect,u.collectAllWhile,u.collectAllWhileEffect,u.collectAllWhileWith,u.collectLeftover,u.mapInput,u.mapInputEffect,u.mapInputChunks,u.mapInputChunksEffect,u.count,u.die,u.dieMessage,u.dieSync,u.dimap,u.dimapEffect,u.dimapChunks,u.dimapChunksEffect,u.drain,u.drop,u.dropUntil,u.dropUntilEffect,u.dropWhile,u.dropWhileEffect,u.ensuring,u.ensuringWith,u.context,u.contextWith,u.contextWithEffect,u.contextWithSink,u.every;let R=u.fail;u.failSync,u.failCause,u.failCauseSync,u.filterInput,u.filterInputEffect,u.findEffect,u.fold,u.foldSink,u.foldChunks,u.foldChunksEffect,u.foldEffect,u.foldLeft,u.foldLeftChunks,u.foldLeftChunksEffect,u.foldLeftEffect,u.foldUntil,u.foldUntilEffect,u.foldWeighted,u.foldWeightedDecompose,u.foldWeightedDecomposeEffect,u.foldWeightedEffect;let O=u.forEach;u.forEachChunk,u.forEachChunkWhile,u.forEachWhile,u.flatMap,u.fromChannel,u.toChannel,u.fromEffect,u.fromPubSub,u.fromPush,u.fromQueue,u.head,u.ignoreLeftover,u.last,u.leftover,u.map,u.mapEffect,u.mapError,u.mapLeftover,u.mkString,u.never,u.orElse,u.provideContext,u.race,u.raceBoth,u.raceWith,u.refineOrDie,u.refineOrDieWith,u.some,u.splitWhere,u.succeed,u.sum,u.summarized,u.suspend,u.sync,u.take,u.timed,u.unwrap;let F=u.unwrapScoped;u.unwrapScopedWith,u.withDuration,u.zip,u.zipLeft,u.zipRight,u.zipWith;var M=e.i(724880),A=s;e.i(100808);var N=e.i(411237);let P=Symbol.for("@effect/platform/Error"),D=N.Literal("Clipboard","Command","FileSystem","KeyValueStore","Path","Stream","Terminal");class L extends N.TaggedError("@effect/platform/Error/BadArgument")("BadArgument",{module:D,method:N.String,description:N.optional(N.String),cause:N.optional(N.Defect)}){[P]=P;get message(){return`${this.module}.${this.method}${this.description?`: ${this.description}`:""}`}}let U=N.Literal("AlreadyExists","BadResource","Busy","InvalidData","NotFound","PermissionDenied","TimedOut","UnexpectedEof","Unknown","WouldBlock","WriteZero");class z extends N.TaggedError("@effect/platform/Error/SystemError")("SystemError",{reason:U,module:D,method:N.String,description:N.optional(N.String),syscall:N.optional(N.String),pathOrDescriptor:N.optional(N.Union(N.String,N.Number)),cause:N.optional(N.Defect)}){[P]=P;get message(){return`${this.reason}: ${this.module}.${this.method}${void 0!==this.pathOrDescriptor?` (${this.pathOrDescriptor})`:""}${this.description?`: ${this.description}`:""}`}}e.s(["BadArgument",()=>L,"SystemError",()=>z,"TypeIdError",0,(e,t)=>{class r extends A.Error{_tag=t}return r.prototype[e]=e,r.prototype.name=t,r}],30725);let j=(0,a.GenericTag)("@effect/platform/FileSystem"),W=e=>"bigint"==typeof e?e:BigInt(e),q=BigInt(1024),$=q*q*q*q*q,B=(e,t)=>new z({module:"FileSystem",method:e,reason:"NotFound",description:"No such file or directory",pathOrDescriptor:t}),H=e=>({access:e=>I.fail(B("access",e)),chmod:e=>I.fail(B("chmod",e)),chown:e=>I.fail(B("chown",e)),copy:e=>I.fail(B("copy",e)),copyFile:e=>I.fail(B("copyFile",e)),exists:()=>I.succeed(!1),link:e=>I.fail(B("link",e)),makeDirectory:()=>I.die("not implemented"),makeTempDirectory:()=>I.die("not implemented"),makeTempDirectoryScoped:()=>I.die("not implemented"),makeTempFile:()=>I.die("not implemented"),makeTempFileScoped:()=>I.die("not implemented"),open:e=>I.fail(B("open",e)),readDirectory:e=>I.fail(B("readDirectory",e)),readFile:e=>I.fail(B("readFile",e)),readFileString:e=>I.fail(B("readFileString",e)),readLink:e=>I.fail(B("readLink",e)),realPath:e=>I.fail(B("realPath",e)),remove:()=>I.void,rename:e=>I.fail(B("rename",e)),sink:e=>R(B("sink",e)),stat:e=>I.fail(B("stat",e)),stream:e=>M.fail(B("stream",e)),symlink:e=>I.fail(B("symlink",e)),truncate:e=>I.fail(B("truncate",e)),utimes:e=>I.fail(B("utimes",e)),watch:e=>M.fail(B("watch",e)),writeFile:e=>I.fail(B("writeFile",e)),writeFileString:e=>I.fail(B("writeFileString",e)),...e});e.s(["GiB",0,e=>W(1024*e*1048576),"KiB",0,e=>W(1024*e),"MiB",0,e=>W(1024*e*1024),"PiB",0,e=>W(BigInt(e)*$),"Size",0,W,"TiB",0,e=>W(1024*e*0x40000000),"layerNoop",0,e=>T.succeed(j,H(e)),"make",0,e=>j.of({...e,exists:t=>(0,i.pipe)(e.access(t),I.as(!0),I.catchTag("SystemError",e=>"NotFound"===e.reason?I.succeed(!1):I.fail(e))),readFileString:(t,r)=>I.tryMap(e.readFile(t),{try:e=>new TextDecoder(r).decode(e),catch:e=>new L({module:"FileSystem",method:"readFileString",description:"invalid encoding",cause:e})}),stream:(t,r)=>(0,i.pipe)(e.open(t,{flag:"r"}),r?.offset?I.tap(e=>e.seek(r.offset,"start")):i.identity,I.map(e=>((e,{bufferSize:t=16,bytesToRead:r,chunkSize:i=W(65536)}={})=>{let a=void 0!==r?W(r):void 0,s=W(i);return M.bufferChunks(M.fromChannel(function t(r){return void 0!==a&&a<=r?E:h(e.readAlloc(void 0!==a&&a-r<s?a-r:s),n.match({onNone:()=>E,onSome:e=>h(k(C.of(e)),i=>t(r+BigInt(e.length)))}))}(BigInt(0))),{capacity:t})})(e,r)),M.unwrapScoped),sink:(t,r)=>(0,i.pipe)(e.open(t,{flag:"w",...r}),I.map(e=>O(t=>e.writeAll(t))),F),writeFileString:(t,r,i)=>I.flatMap(I.try({try:()=>new TextEncoder().encode(r),catch:e=>new L({module:"FileSystem",method:"writeFileString",description:"could not encode string",cause:e})}),r=>e.writeFile(t,r,i))}),"makeNoop",0,H,"tag",0,j],698440),e.s(["FileSystem",0,j,"Size",0,W],302014);let V=e=>{let t=J(e),r=[];for(let e=0;e<t.length;e++)if(Array.isArray(t[e][0])){let[i,n]=t[e];r.push([`${i[0]}[${i.slice(1).join("][")}]`,n])}else r.push(t[e]);return r},J=e=>{let r=Symbol.iterator in e?t.fromIterable(e):Object.entries(e),i=[];for(let[e,t]of r)if(Array.isArray(t))for(let r=0;r<t.length;r++)void 0!==t[r]&&i.push([e,String(t[r])]);else if("object"==typeof t)for(let[r,n]of J(t))i.push([[e,..."string"==typeof r?[r]:r],n]);else void 0!==t&&i.push([e,String(t)]);return i},G=(0,i.dual)(2,(e,r)=>n.map(t.findLast(e,([e])=>e===r),([,e])=>e)),K=(0,i.dual)(3,(e,r,i)=>t.append(t.filter(e,([e])=>e!==r),[r,String(i)])),Z=(0,i.dual)(2,(e,r)=>{let i=V(r),n=i.map(([e])=>e);return t.appendAll(t.filter(e,([e])=>n.includes(e)),i)}),Q=(0,i.dual)(3,(e,r,i)=>t.append(e,[r,String(i)])),Y=(0,i.dual)(2,(e,r)=>t.appendAll(e,V(r)));N.String,e.s(["append",0,Q,"appendAll",0,Y,"empty",0,[],"fromInput",0,V,"makeUrl",0,(e,t,i)=>{try{let n=new URL(e,(()=>{if("location"in globalThis&&void 0!==globalThis.location&&void 0!==globalThis.location.origin&&void 0!==globalThis.location.pathname)return location.origin+location.pathname})());for(let e=0;e<t.length;e++){let[r,i]=t[e];void 0!==i&&n.searchParams.append(r,i)}return"Some"===i._tag&&(n.hash=i.value),r.right(n)}catch(e){return r.left(e)}},"schemaJson",0,(e,t)=>{let r=N.decodeUnknown(N.parseJson(e),t);return(0,i.dual)(2,(e,t)=>r(n.getOrElse(G(e,t),()=>"")))},"schemaStruct",0,(e,t)=>r=>N.decodeUnknown(e,t)((e=>{let t=Object.create(null);for(let[r,i]of e){let e=t[r];void 0===e?t[r]=i:"string"==typeof e?t[r]=[e,i]:e.push(i)}return{...t}})(r)),"set",0,K,"setAll",0,Z,"toString",0,e=>new URLSearchParams(e).toString()],648232)},700248,e=>{"use strict";var t=e.i(64317),r=e.i(405614),i=e.i(842862),n=e.i(580537),a=e.i(411237),s=e.i(724880),o=e.i(302014),l=e.i(648232);let u=Symbol.for("@effect/platform/HttpBody"),c=Symbol.for("@effect/platform/HttpBody/HttpBodyError"),p=t.tagged("HttpBodyError"),f=e=>p({[c]:c,reason:e});class d{[u];constructor(){this[u]=u}[n.NodeInspectSymbol](){return this.toJSON()}toString(){return n.format(this)}}let h=new class extends d{_tag="Empty";toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Empty"}}};class m extends d{body;contentType;contentLength;_tag="Raw";constructor(e,t,r){super(),this.body=e,this.contentType=t,this.contentLength=r}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Raw",body:this.body,contentType:this.contentType,contentLength:this.contentLength}}}class g extends d{body;contentType;_tag="Uint8Array";constructor(e,t){super(),this.body=e,this.contentType=t}get contentLength(){return this.body.length}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Uint8Array",body:this.contentType.startsWith("text/")||this.contentType.endsWith("json")?new TextDecoder().decode(this.body):`Uint8Array(${this.body.length})`,contentType:this.contentType,contentLength:this.contentLength}}}let y=(e,t)=>new g(e,t??"application/octet-stream"),b=new TextEncoder,S=(e,t)=>y(b.encode(e),t??"text/plain"),v=e=>S(JSON.stringify(e),"application/json"),E=e=>r.try({try:()=>v(e),catch:e=>f({_tag:"JsonError",error:e})});class w extends d{formData;_tag="FormData";constructor(e){super(),this.formData=e}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"FormData",formData:this.formData}}}class _ extends d{stream;contentType;contentLength;_tag="Stream";constructor(e,t,r){super(),this.stream=e,this.contentType=t,this.contentLength=r}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Stream",contentType:this.contentType,contentLength:this.contentLength}}}let k=(e,t,r)=>new _(e,t??"application/octet-stream",r);e.s(["ErrorTypeId",0,c,"HttpBodyError",0,f,"TypeId",0,u,"empty",0,h,"file",0,(e,t)=>r.flatMap(o.FileSystem,i=>r.map(i.stat(e),r=>k(i.stream(e,t),t?.contentType,Number(r.size)))),"fileInfo",0,(e,t,i)=>r.map(o.FileSystem,r=>k(r.stream(e,i),i?.contentType,Number(t.size))),"fileWeb",0,e=>k(s.fromReadableStream(()=>e.stream(),i.identity),e.type,e.size),"formData",0,e=>new w(e),"formDataRecord",0,e=>{let t=new FormData;for(let[r,i]of Object.entries(e))if(Array.isArray(i))for(let e of i)null!=e&&t.append(r,"object"==typeof i?e:String(e));else null!=i&&t.append(r,"object"==typeof i?i:String(i));return new w(t)},"json",0,E,"jsonSchema",0,(e,t)=>{let i=a.encode(e,t);return e=>r.flatMap(r.mapError(i(e),e=>f({_tag:"SchemaError",error:e})),E)},"raw",0,(e,t)=>new m(e,t?.contentType,t?.contentLength),"stream",0,k,"text",0,S,"uint8Array",0,y,"unsafeJson",0,v,"urlParams",0,e=>S(l.toString(e),"application/x-www-form-urlencoded")])},453119,e=>{"use strict";e.i(100808);var t=e.i(700248);t.TypeId,t.ErrorTypeId,t.HttpBodyError,t.empty,t.raw,t.uint8Array;let r=t.text;t.unsafeJson,t.json,t.jsonSchema,t.urlParams,t.formData,t.formDataRecord;let i=t.stream;t.file,t.fileInfo,t.fileWeb,e.s(["stream",0,i,"text",0,r])},180837,e=>{"use strict";var t=e.i(649488),r=e.i(964665),i=e.i(842862),n=e.i(580537),a=e.i(65632),s=e.i(787039),o=e.i(100808),l=e.i(847272),u=e.i(30725);let c=Symbol.for("@effect/platform/Cookies"),p=Symbol.for("@effect/platform/Cookies/Cookie"),f=Symbol.for("@effect/platform/Cookies/CookieError");class d extends(0,u.TypeIdError)(f,"CookieError"){get message(){return this.reason}}let h={[c]:c,...n.BaseProto,toJSON(){return{_id:"@effect/platform/Cookies",cookies:l.map(this.cookies,e=>e.toJSON())}},pipe(){return(0,s.pipeArguments)(this,arguments)}},m=e=>{let t=Object.create(h);return t.cookies=e,t},g=e=>{let t={};for(let r of e)t[r.name]=r;return m(t)},y=g([]),b=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,S={[p]:p,...n.BaseProto,toJSON(){return{_id:"@effect/platform/Cookies/Cookie",name:this.name,value:this.value,options:this.options}}};function v(e,i,n){if(!b.test(e))return r.left(new d({reason:"InvalidName"}));let a=encodeURIComponent(i);if(a&&!b.test(a))return r.left(new d({reason:"InvalidValue"}));if(void 0!==n){if(void 0!==n.domain&&!b.test(n.domain))return r.left(new d({reason:"InvalidDomain"}));if(void 0!==n.path&&!b.test(n.path))return r.left(new d({reason:"InvalidPath"}));if(void 0!==n.maxAge&&!t.isFinite(t.decode(n.maxAge)))return r.left(new d({reason:"InfinityMaxAge"}))}return r.right(Object.assign(Object.create(S),{name:e,value:i,valueEncoded:a,options:n}))}let E=(0,i.dual)(2,(e,t)=>m({...e.cookies,...t.cookies})),w=(0,i.dual)(2,(e,t)=>m(l.remove(e.cookies,t))),_=(0,i.dual)(e=>{let t;return t=e[0],o.hasProperty(t,c)},(e,t,i,n)=>r.map(v(t,i,n),r=>m(l.set(e.cookies,t,r)))),k=(0,i.dual)(e=>{let t;return t=e[0],o.hasProperty(t,c)},(e,t,n,a)=>m(l.set(e.cookies,t,r.getOrThrowWith(v(t,n,a),i.identity)))),x=(0,i.dual)(2,(e,t)=>{let i={...e.cookies};for(let[e,n,a]of t){let t=v(e,n,a);if(r.isLeft(t))return t;i[e]=t.right}return r.right(m(i))}),C=(0,i.dual)(2,(e,t)=>r.getOrThrowWith(x(e,t),i.identity));function I(e){let r=e.name+"="+e.valueEncoded;if(void 0===e.options)return r;let i=e.options;if(void 0!==i.maxAge&&(r+="; Max-Age="+Math.trunc(t.toSeconds(i.maxAge))),void 0!==i.domain&&(r+="; Domain="+i.domain),void 0!==i.path&&(r+="; Path="+i.path),void 0!==i.priority)switch(i.priority){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High"}if(void 0!==i.expires&&(r+="; Expires="+i.expires.toUTCString()),i.httpOnly&&(r+="; HttpOnly"),i.secure&&(r+="; Secure"),i.partitioned&&(r+="; Partitioned"),void 0!==i.sameSite)switch(i.sameSite){case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None"}return r}function T(e){let t={},r=e.length,i=0,n=0;for(;n!==r;){-1===(n=e.indexOf(";",i))&&(n=r);let a=e.indexOf("=",i);if(-1===a)break;if(a>n){i=n+1;continue}let s=e.substring(i,a++).trim();if(void 0===t[s]){let r=34===e.charCodeAt(a)?e.substring(a+1,n-1).trim():e.substring(a,n).trim();t[s]=-1!==r.indexOf("%")?R(r):r}i=n+1}return t}let R=e=>{try{return decodeURIComponent(e)}catch{return e}};e.s(["empty",0,y,"fromSetCookie",0,e=>{let r=[];for(let i of"string"==typeof e?[e]:e){let e=function(e){let r=e.split(";").map(e=>e.trim()).filter(e=>""!==e);if(0===r.length)return a.none();let i=r[0].indexOf("=");if(-1===i)return a.none();let n=r[0].slice(0,i);if(!b.test(n))return a.none();let s=r[0].slice(i+1),o=R(s);if(1===r.length)return a.some(Object.assign(Object.create(S),{name:n,value:o,valueEncoded:s}));let l={};for(let e=1;e<r.length;e++){let i=r[e],n=i.indexOf("="),a=-1===n?i:i.slice(0,n).trim(),s=-1===n?void 0:i.slice(n+1).trim();switch(a.toLowerCase()){case"domain":{if(void 0===s)break;let e=s.trim().replace(/^\./,"");e&&(l.domain=e);break}case"expires":{if(void 0===s)break;let e=new Date(s);isNaN(e.getTime())||(l.expires=e);break}case"max-age":{if(void 0===s)break;let e=parseInt(s,10);isNaN(e)||(l.maxAge=t.seconds(e));break}case"path":if(void 0===s)break;"/"===s[0]&&(l.path=s);break;case"priority":if(void 0===s)break;switch(s.toLowerCase()){case"low":l.priority="low";break;case"medium":l.priority="medium";break;case"high":l.priority="high"}break;case"httponly":l.httpOnly=!0;break;case"secure":l.secure=!0;break;case"partitioned":l.partitioned=!0;break;case"samesite":if(void 0===s)break;switch(s.toLowerCase()){case"lax":l.sameSite="lax";break;case"strict":l.sameSite="strict";break;case"none":l.sameSite="none"}}}return a.some(Object.assign(Object.create(S),{name:n,value:o,valueEncoded:s,options:Object.keys(l).length>0?l:void 0}))}(i.trim());a.isSome(e)&&r.push(e.value)}return g(r)},"isEmpty",0,e=>l.isEmptyRecord(e.cookies),"merge",0,E,"parseHeader",()=>T,"remove",0,w,"set",0,_,"setAll",0,x,"toCookieHeader",0,e=>Object.values(e.cookies).map(e=>`${e.name}=${e.valueEncoded}`).join("; "),"toSetCookieHeaders",0,e=>Object.values(e.cookies).map(I),"unsafeSet",0,k,"unsafeSetAll",0,C])},704179,e=>{"use strict";var t=e.i(169228),r=e.i(684823),i=e.i(842862),n=e.i(402409),a=e.i(580537),s=e.i(100808),o=(e.i(847272),e.i(392353)),l=e.i(411237);e.i(923928);let u=Symbol.for("@effect/platform/Headers"),c=Object.assign(Object.create(null),{[u]:u,[a.symbolRedactable](e){return b(this,r.getOrDefault(e,S))}}),p=e=>Object.assign(Object.create(c),e);l.String,l.String,i.identity;let f=Object.create(c),d=e=>{if(void 0===e)return f;if(Symbol.iterator in e){let t=Object.create(c);for(let[r,i]of e)t[r.toLowerCase()]=i;return t}let t=Object.create(c);for(let[r,i]of Object.entries(e))Array.isArray(i)?t[r.toLowerCase()]=i.join(", "):void 0!==i&&(t[r.toLowerCase()]=i);return t},h=(0,i.dual)(3,(e,t,r)=>{let i=p(e);return i[t.toLowerCase()]=r,i}),m=(0,i.dual)(2,(e,t)=>p({...e,...d(t)})),g=(0,i.dual)(2,(e,t)=>{let r=p(e);return Object.assign(r,t),r}),y=(0,i.dual)(2,(e,t)=>{let r=p(e),i=t=>{if("string"==typeof t){let i=t.toLowerCase();i in e&&delete r[i]}else for(let i in e)t.test(i)&&delete r[i]};if(Array.isArray(t))for(let e=0;e<t.length;e++)i(t[e]);else i(t);return r}),b=(0,i.dual)(2,(e,t)=>{let r={...e},i=t=>{if("string"==typeof t){let i=t.toLowerCase();i in e&&(r[i]=o.make(e[i]))}else for(let i in e)t.test(i)&&(r[i]=o.make(e[i]))};if(Array.isArray(t))for(let e=0;e<t.length;e++)i(t[e]);else i(t);return r}),S=(0,n.globalValue)("@effect/platform/Headers/currentRedactedNames",()=>t.unsafeMake(["authorization","cookie","set-cookie","x-api-key"]));e.s(["currentRedactedNames",0,S,"empty",0,f,"fromInput",0,d,"merge",0,g,"redact",0,b,"remove",0,y,"set",0,h,"setAll",0,m,"unsafeFromRecord",0,e=>Object.setPrototypeOf(e,c)])},184697,857952,e=>{"use strict";var t=e.i(777865),r=e.i(405614),i=e.i(680465),n=e.i(842862),a=e.i(580537),s=e.i(847279),o=e.i(724880),l=e.i(180837),u=e.i(704179),c=e.i(65632),p=e.i(100808);function f(e){if(Array.isArray(e))return e.map(f).join("");switch(typeof e){case"string":return e;case"number":case"bigint":return e.toString();case"boolean":return e?"true":"false";default:return""}}function d(e,t){let r="";for(let i=0,n=t.length;i<n;i++)r+=e[i],r+=t[i];return r+e[e.length-1]}function h(e){return r.isEffect(e)&&"Success"===e._op}var m=e.i(648232),g=e.i(700248);let y=Symbol.for("@effect/platform/HttpServerResponse"),b=Symbol.for("@effect/platform/HttpServerRespondable");class S extends i.StructuralClass{status;statusText;cookies;body;[y];headers;constructor(e,t,r,i,n){if(super(),this.status=e,this.statusText=t,this.cookies=i,this.body=n,this[y]=y,n.contentType||n.contentLength){const e={...r};n.contentType&&(e["content-type"]=n.contentType),n.contentLength&&(e["content-length"]=n.contentLength.toString()),this.headers=e}else this.headers=r}commit(){return r.succeed(this)}[b](){return r.succeed(this)}[a.NodeInspectSymbol](){return this.toJSON()}toString(){return a.format(this)}toJSON(){return{_id:"@effect/platform/HttpServerResponse",status:this.status,statusText:this.statusText,headers:a.redact(this.headers),cookies:this.cookies.toJSON(),body:this.body.toJSON()}}}let v=e=>"object"==typeof e&&null!==e&&y in e,E=e=>new S(e?.status??204,e?.statusText,e?.headers?u.fromInput(e.headers):u.empty,e?.cookies??l.empty,g.empty),w=(e,t)=>{let r=t?.headers?u.fromInput(t.headers):u.empty;return new S(t?.status??200,t?.statusText,r,t?.cookies??l.empty,g.text(e,C(t,r)))},_=(e,t)=>r.map(g.json(e),e=>new S(t?.status??200,t?.statusText,t?.headers?u.fromInput(t.headers):u.empty,t?.cookies??l.empty,e)),k=t.GenericTag("@effect/platform/HttpPlatform"),x=(e,t)=>{let r=t?.headers?u.fromInput(t.headers):u.empty;return new S(t?.status??200,t?.statusText,r,t?.cookies??l.empty,g.stream(e,C(t,r),t?.contentLength))},C=(e,t)=>e?.contentType?e.contentType:e?.headers?t["content-type"]:void 0,I=(0,n.dual)(3,(e,t,r)=>new S(e.status,e.statusText,u.set(e.headers,t,r),e.cookies,e.body)),T=(0,n.dual)(2,(e,t)=>new S(e.status,e.statusText,e.headers,t,e.body)),R=(0,n.dual)(e=>v(e[0]),(e,t,i,n)=>r.map(l.set(e.cookies,t,i,n),t=>new S(e.status,e.statusText,e.headers,t,e.body))),O=(0,n.dual)(e=>v(e[0]),(e,t,r,i)=>new S(e.status,e.statusText,e.headers,l.unsafeSet(e.cookies,t,r,i),e.body)),F=(0,n.dual)(2,(e,t)=>new S(e.status,e.statusText,e.headers,t(e.cookies),e.body)),M=(0,n.dual)(2,(e,t)=>r.map(l.setAll(e.cookies,t),t=>new S(e.status,e.statusText,e.headers,t,e.body))),A=(0,n.dual)(2,(e,t)=>new S(e.status,e.statusText,e.headers,l.merge(e.cookies,t),e.body)),N=(0,n.dual)(2,(e,t)=>new S(e.status,e.statusText,e.headers,l.unsafeSetAll(e.cookies,t),e.body)),P=(0,n.dual)(2,(e,t)=>new S(e.status,e.statusText,e.headers,l.remove(e.cookies,t),e.body)),D=(0,n.dual)(3,(e,t,r)=>new S(e.status,e.statusText,e.headers,l.unsafeSet(e.cookies,t,"",{...r??{},maxAge:0}),e.body)),L=(0,n.dual)(2,(e,t)=>new S(e.status,e.statusText,u.setAll(e.headers,t),e.cookies,e.body)),U=(0,n.dual)(e=>v(e[0]),(e,t,r)=>new S(t,r,e.headers,e.cookies,e.body)),z=(0,n.dual)(2,(e,t)=>{let r=e.headers;return"Empty"===t._tag&&(r=u.remove(u.remove(r,"Content-Type"),"Content-length")),new S(e.status,e.statusText,r,e.cookies,t)}),j=(e,t)=>{let r=new globalThis.Headers(e.headers);if(!l.isEmpty(e.cookies))for(let t of l.toSetCookieHeaders(e.cookies))r.append("set-cookie",t);if(t?.withoutBody)return new Response(void 0,{status:e.status,statusText:e.statusText,headers:r});let i=e.body;switch(i._tag){case"Empty":return new Response(void 0,{status:e.status,statusText:e.statusText,headers:r});case"Uint8Array":case"Raw":if(i.body instanceof Response){for(let[e,t]of r)i.body.headers.set(e,t);return i.body}return new Response(i.body,{status:e.status,statusText:e.statusText,headers:r});case"FormData":return new Response(i.formData,{status:e.status,statusText:e.statusText,headers:r});case"Stream":return new Response(o.toReadableStreamRuntime(i.stream,t?.runtime??s.defaultRuntime),{status:e.status,statusText:e.statusText,headers:r})}};e.s(["empty",0,E,"expireCookie",0,D,"file",0,(e,t)=>r.flatMap(k,r=>r.fileResponse(e,t)),"fileWeb",0,(e,t)=>r.flatMap(k,r=>r.fileWebResponse(e,t)),"formData",0,(e,t)=>new S(t?.status??200,t?.statusText,t?.headers?u.fromInput(t.headers):u.empty,t?.cookies??l.empty,g.formData(e)),"html",0,(e,...t)=>"string"==typeof e?w(e,{contentType:"text/html"}):r.map(function(e,...t){let i=t.length,n=Array(i),a=[];for(let e=0;e<i;e++){let i=t[e];c.isOption(i)?n[e]="Some"===i._tag?f(i.value):"":h(i)?n[e]=f(i.effect_instruction_i0):r.isEffect(i)?a.push([e,i]):n[e]=f(i)}return 0===a.length?r.succeed(d(e,n)):r.map(r.forEach(a,([e,t])=>r.tap(t,t=>{n[e]=f(t)}),{concurrency:"inherit",discard:!0}),t=>d(e,n))}(e,...t),e=>w(e,{contentType:"text/html"})),"htmlStream",0,(e,...t)=>r.map(r.context(),i=>x(o.provideContext(o.encodeText(function(e,...t){let i=[],n="";for(let a=0,s=t.length;a<s;a++){n+=e[a];let s=t[a];c.isOption(s)?n+="Some"===s._tag?f(s.value):"":h(s)?n+=f(s.effect_instruction_i0):p.hasProperty(s,o.StreamTypeId)?(n.length>0&&(i.push(n),n=""),r.isEffect(s)?i.push(r.map(s,f)):i.push(o.map(s,f))):n+=f(s)}return(n+=e[e.length-1]).length>0&&(i.push(n),n=""),o.flatMap(o.fromIterable(i),e=>"string"==typeof e?o.succeed(e):e,{concurrency:"unbounded"})}(e,...t)),i),{contentType:"text/html"})),"isServerResponse",0,v,"json",0,_,"mergeCookies",0,A,"raw",0,(e,t)=>new S(t?.status??200,t?.statusText,t?.headers?u.fromInput(t.headers):u.empty,t?.cookies??l.empty,g.raw(e,{contentType:t?.contentType,contentLength:t?.contentLength})),"redirect",0,(e,t)=>{let r=u.unsafeFromRecord({location:e.toString()});return new S(t?.status??302,t?.statusText,t?.headers?u.merge(r,u.fromInput(t.headers)):r,t?.cookies??l.empty,g.empty)},"removeCookie",0,P,"replaceCookies",0,T,"schemaJson",0,(e,t)=>{let i=g.jsonSchema(e,t);return(e,t)=>r.map(i(e),e=>new S(t?.status??200,t?.statusText,t?.headers?u.fromInput(t.headers):u.empty,t?.cookies??l.empty,e))},"setBody",0,z,"setCookie",0,R,"setCookies",0,M,"setHeader",0,I,"setHeaders",0,L,"setStatus",0,U,"stream",0,x,"text",0,w,"toWeb",0,j,"uint8Array",0,(e,t)=>{let r=t?.headers?u.fromInput(t.headers):u.empty;return new S(t?.status??200,t?.statusText,r,t?.cookies??l.empty,g.uint8Array(e,C(t,r)))},"unsafeJson",0,(e,t)=>new S(t?.status??200,t?.statusText,t?.headers?u.fromInput(t.headers):u.empty,t?.cookies??l.empty,g.unsafeJson(e)),"unsafeSetCookie",0,O,"unsafeSetCookies",0,N,"updateCookies",0,F,"urlParams",0,(e,t)=>new S(t?.status??200,t?.statusText,t?.headers?u.fromInput(t.headers):u.empty,t?.cookies??l.empty,g.text(m.toString(m.fromInput(e)),"application/x-www-form-urlencoded"))],857952),e.s(["empty",0,E,"isServerResponse",0,v,"json",0,_,"setBody",0,z,"setHeader",0,I,"setHeaders",0,L,"toWeb",0,j],184697)},482763,e=>{"use strict";var t=e.i(777865),r=e.i(405614);e.i(842862);var i=e.i(580537),n=e.i(65632),a=e.i(411237),s=(e.i(302014),e.i(648232));let o=Symbol.for("@effect/platform/HttpIncomingMessage");class l extends t.Reference()("@effect/platform/HttpIncomingMessage/MaxBodySize",{defaultValue:n.none}){}e.s(["MaxBodySize",()=>l,"TypeId",0,o,"inspect",0,(e,t)=>{let n,a=e.headers["content-type"]??"";if(a.includes("application/json"))try{n=r.runSync(e.json)}catch{}else if(a.includes("text/")||a.includes("urlencoded"))try{n=r.runSync(e.text)}catch{}let s={...t,headers:i.redact(e.headers),remoteAddress:e.remoteAddress.toJSON()};return void 0!==n&&(s.body=n),s},"schemaBodyJson",0,(e,t)=>{let i=a.decodeUnknown(e,t);return e=>r.flatMap(e.json,i)},"schemaBodyUrlParams",0,(e,t)=>{let i=s.schemaStruct(e,t);return e=>r.flatMap(e.urlParamsBody,i)},"schemaHeaders",0,(e,t)=>{let r=a.decodeUnknown(e,t);return e=>r(e.headers)}])},542610,166512,444135,956636,e=>{"use strict";var t,r,i,n,a=e.i(30725),s=e.i(710284),o=e.i(405614),l=e.i(862396),u=e.i(100808),c=e.i(184697);let p=Symbol.for("@effect/platform/HttpServerRespondable"),f=e=>(0,u.hasProperty)(e,p),d=c.empty({status:400}),h=c.empty({status:404}),m=(e,t)=>c.isServerResponse(e)?o.succeed(e):f(e)?o.catchAllCause(e[p](),()=>o.succeed(t)):l.isParseError(e)?o.succeed(d):s.isNoSuchElementException(e)?o.succeed(h):o.succeed(t),g=(e,t)=>c.isServerResponse(e)?o.succeed(e):f(e)?o.catchAllCause(e[p](),()=>o.succeed(t)):o.succeed(t);e.s(["symbol",0,p,"toResponse",0,e=>c.isServerResponse(e)?o.succeed(e):o.orDie(e[p]()),"toResponseOrElse",0,m,"toResponseOrElseDefect",0,g],166512);var y=e.i(500577),b=e.i(402409),S=e.i(65632),v=e.i(857952);let E=Symbol.for("@effect/platform/HttpServerError"),w=(0,b.globalValue)("@effect/platform/HttpServerError/clientAbortFiberId",()=>y.runtime(-499,0)),_=e=>{let t,r=s.stripSomeDefects(e,e=>v.isServerResponse(e)?(t=e,S.some(s.empty)):S.none());return[t??k,r]},k=v.empty({status:500}),x=v.empty({status:499}),C=v.empty({status:503}),I=E;class T extends(0,a.TypeIdError)(I,"RequestError"){[p](){return c.empty({status:400})}get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){return this.description?`${this.reason}: ${this.description} (${this.methodAndUrl})`:`${this.reason} error (${this.methodAndUrl})`}}class R extends(0,a.TypeIdError)(I,"RouteNotFound"){constructor(e){super(e),this.stack=`${this.name}: ${this.message}`}[p](){return c.empty({status:404})}get message(){return`${this.request.method} ${this.request.url} not found`}}e.s(["RequestError",()=>T,"RouteNotFound",()=>R,"causeResponse",0,e=>{let[t,r]=s.reduce(e,[o.succeed(k),s.empty],(e,t)=>{switch(t._tag){case"Empty":return S.some(e);case"Fail":return S.some([m(t.error,k),t]);case"Die":return S.some([g(t.defect,k),t]);case"Interrupt":{if("Empty"!==e[1]._tag)return S.none();let r=t.fiberId===w?x:C;return S.some([o.succeed(r),t])}default:return S.none()}});return o.map(t,e=>s.isEmptyType(r)?[e,s.die(e)]:[e,s.sequential(r,s.die(e))])},"causeResponseStripped",0,_,"clientAbortFiberId",0,w,"exitResponse",0,e=>"Success"===e._tag?e.value:_(e.cause)[0]],542610);var O=e.i(156312),F=e.i(777865),M=e.i(580537),A=e.i(411237),N=e.i(724880),P=e.i(180837),D=e.i(704179),L=e.i(482763),U=e.i(526886),z=F,j=e.i(368171),W=e.i(842862),q=M,$=e.i(435146),B=e.i(680465),H=e.i(753126),V=e.i(787039),J=(e.i(565005),e.i(174073),e.i(604234),e.i(580611));e.i(405889),e.i(276406),e.i(65463);let G=Symbol.for("effect/Mailbox"),K=Symbol.for("effect/Mailbox/ReadonlyMailbox"),Z=U.empty(),Q=J.exitSucceed(Z),Y=J.exitSucceed(!1),X=J.exitSucceed(!0),ee=[Z,!0];class et extends B.Class{scheduler;capacity;strategy;[G]=G;[K]=K;state={_tag:"Open",takers:new Set,offers:new Set,awaiters:new Set};messages=[];messagesChunk=U.empty();constructor(e,t,r){super(),this.scheduler=e,this.capacity=t,this.strategy=r}offer(e){return J.suspend(()=>{if("Open"!==this.state._tag)return Y;if(this.messages.length+this.messagesChunk.length>=this.capacity)switch(this.strategy){case"dropping":return Y;case"suspend":if(this.capacity<=0&&this.state.takers.size>0)return this.messages.push(e),this.releaseTaker(),X;return this.offerRemainingSingle(e);case"sliding":return this.unsafeTake(),this.messages.push(e),X}return this.messages.push(e),this.scheduleReleaseTaker(),X})}unsafeOffer(e){return"Open"===this.state._tag&&(this.messages.length+this.messagesChunk.length>=this.capacity?"sliding"===this.strategy?(this.unsafeTake(),this.messages.push(e),!0):this.capacity<=0&&this.state.takers.size>0&&(this.messages.push(e),this.releaseTaker(),!0):(this.messages.push(e),this.scheduleReleaseTaker(),!0))}offerAll(e){return J.suspend(()=>{if("Open"!==this.state._tag)return J.succeed(U.fromIterable(e));let t=this.unsafeOfferAllArray(e);return 0===t.length?Q:"dropping"===this.strategy?J.succeed(U.unsafeFromArray(t)):this.offerRemainingArray(t)})}unsafeOfferAll(e){return U.unsafeFromArray(this.unsafeOfferAllArray(e))}unsafeOfferAllArray(e){if("Open"!==this.state._tag)return $.fromIterable(e);if(this.capacity===1/0||"sliding"===this.strategy)return this.messages.length>0&&(this.messagesChunk=U.appendAll(this.messagesChunk,U.unsafeFromArray(this.messages))),"sliding"===this.strategy?this.messagesChunk=this.messagesChunk.pipe(U.appendAll(U.fromIterable(e)),U.takeRight(this.capacity)):U.isChunk(e)?this.messagesChunk=U.appendAll(this.messagesChunk,e):this.messages=$.fromIterable(e),this.scheduleReleaseTaker(),[];let t=this.capacity<=0?this.state.takers.size:this.capacity-this.messages.length-this.messagesChunk.length;if(0===t)return $.fromIterable(e);let r=[],i=0;for(let n of e)i<t?this.messages.push(n):r.push(n),i++;return this.scheduleReleaseTaker(),r}fail(e){return this.done(J.exitFail(e))}failCause(e){return this.done(J.exitFailCause(e))}unsafeDone(e){return"Open"===this.state._tag&&(0===this.state.offers.size&&0===this.messages.length&&0===this.messagesChunk.length?this.finalize(e):this.state={...this.state,_tag:"Closing",exit:e},!0)}shutdown=J.sync(()=>{if("Done"===this.state._tag)return!0;this.messages=[],this.messagesChunk=Z;let e=this.state.offers;if(this.finalize("Open"===this.state._tag?J.exitVoid:this.state.exit),e.size>0){for(let t of e)"Single"===t._tag?t.resume(Y):t.resume(J.exitSucceed(U.unsafeFromArray(t.remaining.slice(t.offset))));e.clear()}return!0});done(e){return J.sync(()=>this.unsafeDone(e))}end=this.done(J.exitVoid);clear=J.suspend(()=>{if("Done"===this.state._tag)return J.exitAs(this.state.exit,Z);let e=this.unsafeTakeAll();return this.releaseCapacity(),J.succeed(e)});takeAll=J.suspend(()=>{if("Done"===this.state._tag)return J.exitAs(this.state.exit,ee);let e=this.unsafeTakeAll();return 0===e.length?J.zipRight(this.awaitTake,this.takeAll):J.succeed([e,this.releaseCapacity()])});takeN(e){return J.suspend(()=>{let t;if("Done"===this.state._tag)return J.exitAs(this.state.exit,ee);if(e<=0)return J.succeed([Z,!1]);if((e=Math.min(e,this.capacity))<=this.messagesChunk.length)t=U.take(this.messagesChunk,e),this.messagesChunk=U.drop(this.messagesChunk,e);else{if(!(e<=this.messages.length+this.messagesChunk.length))return J.zipRight(this.awaitTake,this.takeN(e));this.messagesChunk=U.appendAll(this.messagesChunk,U.unsafeFromArray(this.messages)),this.messages=[],t=U.take(this.messagesChunk,e),this.messagesChunk=U.drop(this.messagesChunk,e)}return J.succeed([t,this.releaseCapacity()])})}unsafeTake(){let e;if("Done"===this.state._tag)return J.exitZipRight(this.state.exit,J.exitFail(new s.NoSuchElementException));if(this.messagesChunk.length>0)e=U.unsafeHead(this.messagesChunk),this.messagesChunk=U.drop(this.messagesChunk,1);else if(this.messages.length>0)e=this.messages[0],this.messagesChunk=U.drop(U.unsafeFromArray(this.messages),1),this.messages=[];else if(this.capacity<=0&&this.state.offers.size>0)return this.capacity=1,this.releaseCapacity(),this.capacity=0,this.messages.length>0?J.exitSucceed(this.messages.pop()):void 0;else return;return this.releaseCapacity(),J.exitSucceed(e)}take=J.suspend(()=>this.unsafeTake()??J.zipRight(this.awaitTake,this.take));await=J.asyncInterrupt(e=>"Done"===this.state._tag?e(this.state.exit):(this.state.awaiters.add(e),J.sync(()=>{"Done"!==this.state._tag&&this.state.awaiters.delete(e)})));unsafeSize(){let e=this.messages.length+this.messagesChunk.length;return"Done"===this.state._tag?S.none():S.some(e)}size=J.sync(()=>this.unsafeSize());commit(){return this.takeAll}pipe(){return(0,V.pipeArguments)(this,arguments)}toJSON(){return{_id:"effect/Mailbox",state:this.state._tag,size:this.unsafeSize().toJSON()}}toString(){return M.format(this)}[M.NodeInspectSymbol](){return M.format(this)}offerRemainingSingle(e){return J.asyncInterrupt(t=>{if("Open"!==this.state._tag)return t(Y);let r={_tag:"Single",message:e,resume:t};return this.state.offers.add(r),J.sync(()=>{"Open"===this.state._tag&&this.state.offers.delete(r)})})}offerRemainingArray(e){return J.asyncInterrupt(t=>{if("Open"!==this.state._tag)return t(J.exitSucceed(U.unsafeFromArray(e)));let r={_tag:"Array",remaining:e,offset:0,resume:t};return this.state.offers.add(r),J.sync(()=>{"Open"===this.state._tag&&this.state.offers.delete(r)})})}releaseCapacity(){if("Done"===this.state._tag)return"Success"===this.state.exit._tag;if(0===this.state.offers.size)return"Closing"===this.state._tag&&0===this.messages.length&&0===this.messagesChunk.length&&(this.finalize(this.state.exit),"Success"===this.state.exit._tag);let e=this.capacity-this.messages.length-this.messagesChunk.length;for(let t of this.state.offers)if(0===e)break;else if("Single"===t._tag)this.messages.push(t.message),e--,t.resume(X),this.state.offers.delete(t);else{for(;t.offset<t.remaining.length;t.offset++){if(0===e)return!1;this.messages.push(t.remaining[t.offset]),e--}t.resume(Q),this.state.offers.delete(t)}return!1}awaitTake=J.asyncInterrupt(e=>"Done"===this.state._tag?e(this.state.exit):(this.state.takers.add(e),J.sync(()=>{"Done"!==this.state._tag&&this.state.takers.delete(e)})));scheduleRunning=!1;scheduleReleaseTaker(){this.scheduleRunning||(this.scheduleRunning=!0,this.scheduler.scheduleTask(this.releaseTaker,0))}releaseTaker=()=>{if(this.scheduleRunning=!1,"Done"===this.state._tag||0===this.state.takers.size)return;let e=H.unsafeHead(this.state.takers);this.state.takers.delete(e),e(J.exitVoid)};unsafeTakeAll(){if(this.messagesChunk.length>0){let e=this.messages.length>0?U.appendAll(this.messagesChunk,U.unsafeFromArray(this.messages)):this.messagesChunk;return this.messagesChunk=Z,this.messages=[],e}if(this.messages.length>0){let e=U.unsafeFromArray(this.messages);return this.messages=[],e}return"Done"!==this.state._tag&&this.state.offers.size>0?(this.capacity=1,this.releaseCapacity(),this.capacity=0,U.of(this.messages.pop())):Z}finalize(e){if("Done"===this.state._tag)return;let t=this.state;for(let r of(this.state={_tag:"Done",exit:e},t.takers))r(e);for(let r of(t.takers.clear(),t.awaiters))r(e);t.awaiters.clear()}}(e,t)=>J.uninterruptibleMask(r=>J.matchCauseEffect(r(e),{onFailure:e=>t.failCause(e),onSuccess:e=>t.end}));var er=S,ei=A;let en=/; *([!#$%&'*+.^\w`|~-]+)=("(?:[\v\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\v\u0020-\u00ff])*"|[!#$%&'*+.^\w`|~-]+) */gu,ea=/\\([\v\u0020-\u00ff])/gu,es=/^[!#$%&'*+.^\w|~-]+\/[!#$%&'*+.^\w|~-]+$/u,eo=/^[!#$%&'*+.^\w|~-]+$/u,el={value:"",parameters:Object.create(null)};function eu(e,t=!1){let r,i,n;if("string"!=typeof e)return el;let a=e.indexOf(";"),s=-1!==a?e.slice(0,a).trim():e.trim();if(!1===(t?eo:es).test(s))return el;let o={value:s.toLowerCase(),parameters:Object.create(null)};if(-1===a)return o;for(en.lastIndex=a;i=en.exec(e);){if(i.index!==a)return el;a+=i[0].length,r=i[1].toLowerCase(),'"'===(n=i[2])[0]&&(n=n.slice(1,n.length-1),!t&&ea.test(n)&&(n=n.replace(ea,"$1"))),o.parameters[r]=n}return a!==e.length?el:o}(t=i||(i={}))[t.key=0]="key",t[t.whitespace=1]="whitespace",t[t.value=2]="value";let ec={_tag:"Continue"},ep=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1],ef=[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];(r=n||(n={}))[r.headers=0]="headers",r[r.body=1]="body";let ed={_tag:"InvalidDisposition"},eh={_tag:"EndNotReached"},em={_tag:"ReachedLimit",limit:"MaxParts"},eg={_tag:"ReachedLimit",limit:"MaxTotalSize"},ey={_tag:"ReachedLimit",limit:"MaxPartSize"},eb={_tag:"ReachedLimit",limit:"MaxFieldSize"},eS=new TextEncoder().encode("\r\n");function ev(e){return void 0!==e.filename||"application/octet-stream"===e.contentType}function eE(e){}let ew=new TextDecoder("utf-8"),e_=function({headers:e,onFile:t,onField:r,onError:a,onDone:s,isFile:o=ev,maxParts:l=1/0,maxTotalSize:u=1/0,maxPartSize:c=1/0,maxFieldSize:p=1048576}){var f,d;let h,m,g=eu(e["content-type"]).parameters.boundary;if(void 0===g)return a({_tag:"InvalidBoundary"}),{write:eE,end(){}};let y={state:n.headers,index:0,parts:0,onChunk:eE,info:void 0,headerSkip:0,partSize:0,totalSize:0,isFile:!1,fieldChunks:[],fieldSize:0};function b(){y.state=n.body,y.isFile=!0,y.onChunk=eE}let S=function(){let e=new TextDecoder,t={state:i.key,headers:Object.create(null),key:"",value:void 0,crlf:0,previousChunk:void 0,pairs:0,size:0};function r(e){return t.state=i.key,t.headers=Object.create(null),t.key="",t.value=void 0,t.crlf=0,t.previousChunk=void 0,t.pairs=0,t.size=0,e}function n(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function a(e){return r({_tag:"Failure",reason:e,headers:t.headers})}return function(s,o){let l,u=0;if(void 0!==t.previousChunk){l=u=t.previousChunk.length;let e=new Uint8Array(s.length+u);e.set(t.previousChunk),e.set(s,u),t.previousChunk=void 0,s=e}let c=s.length;e:for(;o<c;){if(t.state===i.key){let r=o;for(;r<c;r++){if(t.size++>16384)return a("HeaderTooLarge");if(58===s[r]){if(t.key+=e.decode(s.subarray(o,r)).toLowerCase(),0===t.key.length)return a("InvalidHeaderName");32===s[r+1]&&32!==s[r+2]&&9!==s[r+2]?(o=r+2,t.state=i.value,t.size++):32!==s[r+1]&&9!==s[r+1]?(o=r+1,t.state=i.value):(o=r+1,t.state=i.whitespace);break}if(1!==ep[s[r]])return a("InvalidHeaderName")}if(r===c)return t.key+=e.decode(s.subarray(o,c)).toLowerCase(),ec}if(t.state===i.whitespace){for(;o<c;o++){if(t.size++>16384)return a("HeaderTooLarge");if(32!==s[o]&&9!==s[o]){t.state=i.value;break}}if(o===c)return ec}if(t.state===i.value){let p=o;for(void 0!==l&&(p=l,l=void 0);p<c;p++){if(t.size++>16384)return a("HeaderTooLarge");if(13===s[p]||t.crlf>0){let l=s[p];if(13===l&&0===t.crlf&&(t.crlf=1,p++,t.size++,l=s[p]),10===l&&1===t.crlf&&(t.crlf=2,p++,t.size++,l=s[p]),13===l&&2===t.crlf&&(t.crlf=3,p++,t.size++,l=s[p]),10===l&&3===t.crlf&&(t.crlf=4,p++,t.size++),t.crlf<4&&p>=c)return t.previousChunk=s.subarray(o),ec;if(t.crlf>=2){t.value=void 0===t.value?s.subarray(o,p-t.crlf):n(t.value,s.subarray(o,p-t.crlf));let l=e.decode(t.value);if(void 0===t.headers[t.key]?t.headers[t.key]=l:"string"==typeof t.headers[t.key]?t.headers[t.key]=[t.headers[t.key],l]:t.headers[t.key].push(l),o=p,t.size--,4!==t.crlf&&100===t.pairs)return a("TooManyHeaders");if(3===t.crlf)return a("InvalidHeaderValue");if(4===t.crlf)return r({_tag:"Headers",headers:t.headers,endPosition:o-u});t.pairs++,t.key="",t.value=void 0,t.crlf=0,t.state=i.key;continue e}}else if(1!==ef[s[p]])return a("InvalidHeaderValue")}if(p===c)return t.value=void 0===t.value?s.subarray(o,c):n(t.value,s.subarray(o,c)),ec}}return o>c&&(t.size+=c-o),ec}}(),v=(f=`\r
--${g}`,d=function(e,i){if(0===e)return void b();if(e!==y.index){if(y.index>0)if(y.isFile)y.onChunk(null),y.partSize=0;else{if(1===y.fieldChunks.length)r(y.info,y.fieldChunks[0]);else{let e=new Uint8Array(y.fieldSize),t=0;for(let r=0;r<y.fieldChunks.length;r++){let i=y.fieldChunks[r];e.set(i,t),t+=i.length}r(y.info,e)}y.fieldSize=0,y.fieldChunks=[]}if(y.state=n.headers,y.index=e,y.headerSkip=2,45===i[0]&&45===i[1])return s();y.parts++,y.parts>l&&a(em)}if((y.partSize+=i.length)>c&&a(ey),y.state===n.headers){let e,r=S(i,y.headerSkip);if(y.headerSkip=0,"Continue"===r._tag)return;if("Failure"===r._tag)return b(),a({_tag:"BadHeaders",error:r});let s=eu(r.headers["content-type"]),l=eu(r.headers["content-disposition"],!0);if("form-data"===l.value&&!("name"in l.parameters))return b(),a(ed);if("filename*"in l.parameters){let t=l.parameters["filename*"].split("''");2===t.length&&(e=decodeURIComponent(t[1]))}if(y.info={name:l.parameters.name??"",filename:e??l.parameters.filename,contentType:""===s.value?void 0!==l.parameters.filename?"application/octet-stream":"text/plain":s.value,contentTypeParameters:s.parameters,contentDisposition:l.value,contentDispositionParameters:l.parameters,headers:r.headers},y.state=n.body,y.isFile=o(y.info),y.isFile&&(y.onChunk=t(y.info)),r.endPosition<i.length)if(y.isFile)y.onChunk(i.subarray(r.endPosition));else{let e=i.subarray(r.endPosition);(y.fieldSize+=e.length)>p&&a(eb),y.fieldChunks.push(e)}}else y.isFile?y.onChunk(i):((y.fieldSize+=i.length)>p&&a(eb),y.fieldChunks.push(i))},h=function(e){let t=new TextEncoder().encode(e),r=t.length,i={};for(let e=0;e<r;e++){let r=t[e];void 0===i[r]&&(i[r]=[]),i[r].push(e)}return{needle:t,needleLength:r,indexes:i,firstByte:t[0],previousChunk:void 0,previousChunkLength:0,matchIndex:0}}(f),void 0!==eS&&(h.previousChunk=eS,h.previousChunkLength=eS.length),m=function(){if("Buffer"in globalThis&&!("Bun"in globalThis||"Deno"in globalThis))return function(e,t,r){return Buffer.prototype.indexOf.call(e,t,r)};let e=new Uint8Array(256).fill(h.needle.length);for(let t=0,r=h.needle.length-1;t<r;++t)e[h.needle[t]]=r-t;return function(t,r,i){let n=t.length,a=i+h.needleLength-1;for(;a<n;){for(let e=h.needleLength-1,i=a;e>=0&&t[i]===r[e];e--,i--)if(0===e)return i;a+=e[t[a]]}return -1}}(),{write:function(e){let t=e.length;if(void 0!==h.previousChunk){let r=new Uint8Array(h.previousChunkLength+t);r.set(h.previousChunk),r.set(e,h.previousChunkLength),e=r,t=h.previousChunkLength+t,h.previousChunk=void 0}if(t<h.needleLength){h.previousChunk=e,h.previousChunkLength=t;return}let r=0;for(;r<t;){let i=m(e,h.needle,r);if(i>-1){i>r&&d(h.matchIndex,e.subarray(r,i)),h.matchIndex+=1,r=i+h.needleLength;continue}if(e[t-1]in h.indexes){let i=h.indexes[e[t-1]],n=-1;for(let r=0,a=i.length;r<a;r++){let a=i[r];e[t-1-a]===h.firstByte&&r>n&&(n=a)}-1===n?0===r?d(h.matchIndex,e):d(h.matchIndex,e.subarray(r)):(t-1-n>r&&d(h.matchIndex,e.subarray(r,t-1-n)),h.previousChunk=e.subarray(t-1-n),h.previousChunkLength=n+1)}else 0===r?d(h.matchIndex,e):d(h.matchIndex,e.subarray(r));break}},end:function(){void 0!==h.previousChunk&&h.previousChunk!==eS&&d(h.matchIndex,h.previousChunk),h.previousChunk=eS,h.previousChunkLength=eS?.length??0,h.matchIndex=0}});return{write:e=>(y.totalSize+=e.length)>u?a(eg):v.write(e),end(){v.end(),y.state===n.body&&a(eh),y.state=n.headers,y.index=0,y.parts=0,y.onChunk=eE,y.info=void 0,y.totalSize=0,y.partSize=0,y.fieldChunks=[],y.fieldSize=0}}};var ek=e.i(302014),ex=e.i(347064);let eC=Symbol.for("@effect/platform/Path"),eI=(0,F.GenericTag)("@effect/platform/Path");function eT(e,t){let r,i="",n=0,a=-1,s=0;for(let o=0;o<=e.length;++o){if(o<e.length)r=e.charCodeAt(o);else if(47===r)break;else r=47;if(47===r){if(a===o-1||1===s);else if(a!==o-1&&2===s){if(i.length<2||2!==n||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2)){if(i.length>2){let e=i.lastIndexOf("/");if(e!==i.length-1){-1===e?(i="",n=0):n=(i=i.slice(0,e)).length-1-i.lastIndexOf("/"),a=o,s=0;continue}}else if(2===i.length||1===i.length){i="",n=0,a=o,s=0;continue}}t&&(i.length>0?i+="/..":i="..",n=2)}else i.length>0?i+="/"+e.slice(a+1,o):i=e.slice(a+1,o),n=o-a-1;a=o,s=0}else 46===r&&-1!==s?++s:s=-1}return i}let eR=function(){let e,t="",r=!1;for(let i=arguments.length-1;i>=-1&&!r;i--){let n;if(i>=0)n=arguments[i];else{let t=globalThis.process;void 0===e&&"process"in globalThis&&"object"==typeof t&&null!==t&&"function"==typeof t.cwd&&(e=t.cwd()),n=e}0!==n.length&&(t=n+"/"+t,r=47===n.charCodeAt(0))}if(t=eT(t,!r),r)if(t.length>0)return"/"+t;else return"/";return t.length>0?t:"."},eO=/%/g,eF=/\\/g,eM=/\n/g,eA=/\r/g,eN=/\t/g,eP=eI.of({[eC]:eC,resolve:eR,normalize(e){if(0===e.length)return".";let t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return(0!==(e=eT(e,!t)).length||t||(e="."),e.length>0&&r&&(e+="/"),t)?"/"+e:e},isAbsolute:e=>e.length>0&&47===e.charCodeAt(0),join(){let e;if(0==arguments.length)return".";for(let t=0;t<arguments.length;++t){let r=arguments[t];r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":eP.normalize(e)},relative(e,t){if(e===t||(e=eP.resolve(e),t=eP.resolve(t),e===t))return"";let r=1;for(;r<e.length&&47===e.charCodeAt(r);++r);let i=e.length,n=i-r,a=1;for(;a<t.length&&47===t.charCodeAt(a);++a);let s=t.length-a,o=n<s?n:s,l=-1,u=0;for(;u<=o;++u){if(u===o){if(s>o){if(47===t.charCodeAt(a+u))return t.slice(a+u+1);else if(0===u)return t.slice(a+u)}else n>o&&(47===e.charCodeAt(r+u)?l=u:0===u&&(l=0));break}let i=e.charCodeAt(r+u);if(i!==t.charCodeAt(a+u))break;47===i&&(l=u)}let c="";for(u=r+l+1;u<=i;++u)(u===i||47===e.charCodeAt(u))&&(0===c.length?c+="..":c+="/..");return c.length>0?c+t.slice(a+l):(a+=l,47===t.charCodeAt(a)&&++a,t.slice(a))},dirname(e){if(0===e.length)return".";let t=e.charCodeAt(0),r=47===t,i=-1,n=!0;for(let r=e.length-1;r>=1;--r)if(47===(t=e.charCodeAt(r))){if(!n){i=r;break}}else n=!1;return -1===i?r?"/":".":r&&1===i?"//":e.slice(0,i)},basename(e,t){let r,i=0,n=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let s=t.length-1,o=-1;for(r=e.length-1;r>=0;--r){let l=e.charCodeAt(r);if(47===l){if(!a){i=r+1;break}}else -1===o&&(a=!1,o=r+1),s>=0&&(l===t.charCodeAt(s)?-1==--s&&(n=r):(s=-1,n=o))}return i===n?n=o:-1===n&&(n=e.length),e.slice(i,n)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!a){i=r+1;break}}else -1===n&&(a=!1,n=r+1);return -1===n?"":e.slice(i,n)},extname(e){let t=-1,r=0,i=-1,n=!0,a=0;for(let s=e.length-1;s>=0;--s){let o=e.charCodeAt(s);if(47===o){if(!n){r=s+1;break}continue}-1===i&&(n=!1,i=s+1),46===o?-1===t?t=s:1!==a&&(a=1):-1!==t&&(a=-1)}return -1===t||-1===i||0===a||1===a&&t===i-1&&t===r+1?"":e.slice(t,i)},format:function(e){let t,r;if(null===e||"object"!=typeof e)throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||""),t?t===e.root?t+r:t+"/"+r:r},parse(e){let t,r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;let i=e.charCodeAt(0),n=47===i;n?(r.root="/",t=1):t=0;let a=-1,s=0,o=-1,l=!0,u=e.length-1,c=0;for(;u>=t;--u){if(47===(i=e.charCodeAt(u))){if(!l){s=u+1;break}continue}-1===o&&(l=!1,o=u+1),46===i?-1===a?a=u:1!==c&&(c=1):-1!==a&&(c=-1)}return -1===a||-1===o||0===c||1===c&&a===o-1&&a===s+1?-1!==o&&(0===s&&n?r.base=r.name=e.slice(1,o):r.base=r.name=e.slice(s,o)):(0===s&&n?(r.name=e.slice(1,a),r.base=e.slice(1,o)):(r.name=e.slice(s,a),r.base=e.slice(s,o)),r.ext=e.slice(a,o)),s>0?r.dir=e.slice(0,s-1):n&&(r.dir="/"),r},sep:"/",fromFileUrl:function(e){if("file:"!==e.protocol)return o.fail(new a.BadArgument({module:"Path",method:"fromFileUrl",description:"URL must be of scheme file"}));if(""!==e.hostname)return o.fail(new a.BadArgument({module:"Path",method:"fromFileUrl",description:"Invalid file URL host"}));let t=e.pathname;for(let e=0;e<t.length;e++)if("%"===t[e]){let r=32|t.codePointAt(e+2);if("2"===t[e+1]&&102===r)return o.fail(new a.BadArgument({module:"Path",method:"fromFileUrl",description:"must not include encoded / characters"}))}return o.succeed(decodeURIComponent(t))},toFileUrl:function(e){var t;let r=new URL("file://"),i=eR(e);return 47===e.charCodeAt(e.length-1)&&"/"!==i[i.length-1]&&(i+="/"),(t=i).includes("%")&&(t=t.replace(eO,"%25")),t.includes("\\")&&(t=t.replace(eF,"%5C")),t.includes("\n")&&(t=t.replace(eM,"%0A")),t.includes("\r")&&(t=t.replace(eA,"%0D")),t.includes("	")&&(t=t.replace(eN,"%09")),r.pathname=t,o.succeed(r)},toNamespacedPath:W.identity}),eD=ex.succeed(eI,eP);e.s(["Path",0,eI,"TypeId",0,eC,"layer",0,eD],444135);let eL=Symbol.for("@effect/platform/Multipart"),eU=Symbol.for("@effect/platform/Multipart/MultipartError");class ez extends ei.TaggedError()("MultipartError",{reason:ei.Literal("FileTooLarge","FieldTooLarge","BodyTooLarge","TooManyParts","InternalError","Parse"),cause:ei.Defect}){[eU]=eU;get message(){return this.reason}}e=>u.hasProperty(e,eL)&&u.isTagged(e,"PersistedFile");let ej=e=>"Success"===e._tag?O.void:O.failCause(e.cause);class eW extends q.Class{[eL];constructor(){super(),this[eL]=eL}}class eq extends eW{key;contentType;value;_tag="Field";constructor(e,t,r){super(),this.key=e,this.contentType=t,this.value=r}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"Field",key:this.key,contentType:this.contentType,value:this.value}}}class e$ extends eW{_tag="File";key;name;contentType;content;contentEffect;constructor(e,t){super(),this.key=e.name,this.name=e.filename??e.name,this.contentType=e.contentType,this.content=N.fromChannel(t),this.contentEffect=t.pipe(O.pipeTo(eH),O.run,o.mapError(e=>new ez({reason:"InternalError",cause:e})))}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"File",key:this.key,name:this.name,contentType:this.contentType}}}let eB=(e,t)=>o.flatMap(ek.FileSystem,r=>o.mapError(N.run(t.content,r.sink(e)),e=>new ez({reason:"InternalError",cause:e}))),eH=O.suspend(()=>{let e=new Uint8Array(0),t=O.readWithCause({onInput(r){for(let t of r){let r=new Uint8Array(e.length+t.length);r.set(e,0),r.set(t,e.length),e=r}return t},onFailure:e=>O.failCause(e),onDone:()=>O.succeed(e)});return t});class eV extends eW{key;name;contentType;path;_tag="PersistedFile";constructor(e,t,r,i){super(),this.key=e,this.name=t,this.contentType=r,this.path=i}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"PersistedFile",key:this.key,name:this.name,contentType:this.contentType,path:this.path}}}class eJ extends z.Reference()("@effect/platform/Multipart/MaxParts",{defaultValue:er.none}){}class eG extends z.Reference()("@effect/platform/Multipart/MaxFieldSize",{defaultValue:(0,W.constant)(ek.Size(0xa00000))}){}class eK extends z.Reference()("@effect/platform/Multipart/MaxFileSize",{defaultValue:er.none}){}class eZ extends z.Reference()("@effect/platform/Multipart/FieldMimeTypes",{defaultValue:(0,W.constant)(U.make("application/json"))}){}var eQ=e.i(385510);e.i(568819),e.i(169228),e.i(165039);var eY=e.i(838927);e.i(847279);let eX=Symbol.for("effect/FiberSet");M.NodeInspectSymbol;let e0=y.make(-1,0),e1=s.reduceWithContext(void 0,{emptyCase:W.constFalse,failCase:W.constFalse,dieCase:W.constFalse,interruptCase:(e,t)=>eY.has(y.ids(t),-1),sequentialCase:(e,t,r)=>t||r,parallelCase:(e,t,r)=>t||r});e=>{let t;return t=e[0],u.hasProperty(t,eX)},e.i(625552);var e2=a;let e6=Symbol.for("@effect/platform/Socket/SocketError");class e3 extends(0,e2.TypeIdError)(e6,"SocketError"){static is(e){return u.hasProperty(e,e6)&&"Close"===e.reason}static isClean(e){return function(t){return e3.is(t)&&e(t.code)}}get message(){return this.closeReason?`${this.reason}: ${this.code}: ${this.closeReason}`:`${this.reason}: ${this.code}`}}var e4=e.i(648232);let e5=Symbol.for("@effect/platform/HttpServerRequest"),e8=F.GenericTag("@effect/platform/HttpServerRequest"),e7=F.GenericTag("@effect/platform/HttpServerRequest/ParsedSearchParams");class e9 extends M.Class{source;url;headersOverride;remoteAddressOverride;[e5];[L.TypeId];constructor(e,t,r,i){super(),this.source=e,this.url=t,this.headersOverride=r,this.remoteAddressOverride=i,this[e5]=e5,this[L.TypeId]=L.TypeId}toJSON(){return L.inspect(this,{_id:"@effect/platform/HttpServerRequest",method:this.method,url:this.originalUrl})}modify(e){return new e9(this.source,e.url??this.url,e.headers??this.headersOverride,e.remoteAddress??this.remoteAddressOverride)}get method(){return this.source.method.toUpperCase()}get originalUrl(){return this.source.url}get remoteAddress(){return this.remoteAddressOverride?S.some(this.remoteAddressOverride):S.none()}get headers(){return this.headersOverride??=D.fromInput(this.source.headers),this.headersOverride}cachedCookies;get cookies(){return this.cachedCookies?this.cachedCookies:this.cachedCookies=P.parseHeader(this.headers.cookie??"")}get stream(){return this.source.body?N.fromReadableStream(()=>this.source.body,e=>new T({request:this,reason:"Decode",cause:e})):N.fail(new T({request:this,reason:"Decode",description:"can not create stream from empty body"}))}textEffect;get text(){return this.textEffect||(this.textEffect=o.runSync(o.cached(o.tryPromise({try:()=>this.source.text(),catch:e=>new T({request:this,reason:"Decode",cause:e})})))),this.textEffect}get json(){return o.tryMap(this.text,{try:e=>JSON.parse(e),catch:e=>new T({request:this,reason:"Decode",cause:e})})}get urlParamsBody(){return o.flatMap(this.text,e=>o.try({try:()=>e4.fromInput(new URLSearchParams(e)),catch:e=>new T({request:this,reason:"Decode",cause:e})}))}multipartEffect;get multipart(){return this.multipartEffect||(this.multipartEffect=o.runSync(o.cached(((e,t=eB)=>o.gen(function*(){let r=yield*ek.FileSystem,i=yield*eI,n=yield*r.makeTempDirectoryScoped(),a=Object.create(null);return yield*N.runForEach(e,e=>{if("Field"===e._tag)return e.key in a?"string"==typeof a[e.key]?a[e.key]=[a[e.key],e.value]:a[e.key].push(e.value):a[e.key]=e.value,o.void;if(""===e.name)return o.void;let r=i.join(n,i.basename(e.name).slice(-128)),s=new eV(e.key,e.name,e.contentType,r);return Array.isArray(a[e.key])?a[e.key].push(s):a[e.key]=[s],t(r,e)}),a}).pipe(o.catchTags({SystemError:e=>o.fail(new ez({reason:"InternalError",cause:e})),BadArgument:e=>o.fail(new ez({reason:"InternalError",cause:e}))})))(this.multipartStream)))),this.multipartEffect}get multipartStream(){return N.pipeThroughChannel(N.mapError(this.stream,e=>new ez({reason:"InternalError",cause:e})),((e,t=16)=>{let r;return O.acquireUseRelease(o.all([o.withFiberRuntime(t=>{let r=z.get(t.currentContext,eZ);return o.succeed({headers:e,maxParts:er.getOrUndefined(z.get(t.currentContext,eJ)),maxFieldSize:Number(z.get(t.currentContext,eG)),maxPartSize:z.get(t.currentContext,eK).pipe(er.map(Number),er.getOrUndefined),maxTotalSize:z.get(t.currentContext,L.MaxBodySize).pipe(er.map(Number),er.getOrUndefined),isFile:0===r.length?void 0:e=>!U.some(r,t=>e.contentType.includes(t))&&ev(e)})}),(r=t,J.withFiberRuntime(e=>J.succeed(new et(e.currentScheduler,"number"==typeof r?r:r?.capacity??1/0,"number"==typeof r?"suspend":r?.strategy??"suspend"))))]),([e,t])=>{let r=[],i=er.none(),n=e_({...e,onField(e,t){r.push(new eq(e.name,e.contentType,(function(e){if("utf-8"===e||"utf8"===e||""===e)return ew;try{return new TextDecoder(e)}catch(e){return ew}})(e.contentTypeParameters.charset??"utf-8").decode(t)))},onFile(e){let t=[],i=!1,n=O.suspend(()=>{if(0===t.length)return i?O.void:O.zipRight(a,n);let e=U.unsafeFromArray(t);return t=[],i?O.write(e):O.zipRight(O.write(e),O.zipRight(a,n))});return r.push(new e$(e,n)),function(e){null===e?i=!0:t.push(e)}},onError(e){i=er.some(j.fail(function(e){if("ReachedLimit"===e._tag)switch(e.limit){case"MaxParts":return new ez({reason:"TooManyParts",cause:e});case"MaxFieldSize":return new ez({reason:"FieldTooLarge",cause:e});case"MaxPartSize":return new ez({reason:"FileTooLarge",cause:e});case"MaxTotalSize":return new ez({reason:"BodyTooLarge",cause:e})}return new ez({reason:"Parse",cause:e})}(e)))},onDone(){i=er.some(j.void)}}),a=O.flatMap(t.takeAll,([e,t])=>O.sync(()=>{U.forEach(e,U.forEach(n.write)),t&&n.end()})),s=O.flatMap(a,()=>{if(0===r.length)return"None"===i._tag?s:ej(i.value);let e=U.unsafeFromArray(r);return r=[],O.zipRight(O.write(e),"None"===i._tag?s:ej(i.value))});return O.embedInput(s,{awaitRead:()=>o.void,emit:e=>t.offer(e),error:e=>(i=er.some(j.failCause(e)),t.end),done:e=>t.end})},([,e])=>e.shutdown)})(this.headers))}arrayBufferEffect;get arrayBuffer(){return this.arrayBufferEffect||(this.arrayBufferEffect=o.runSync(o.cached(o.tryPromise({try:()=>this.source.arrayBuffer(),catch:e=>new T({request:this,reason:"Decode",cause:e})})))),this.arrayBufferEffect}get upgrade(){return o.fail(new T({request:this,reason:"Decode",description:"Not an upgradeable ServerRequest"}))}}e.s(["HttpServerRequest",0,e8,"ParsedSearchParams",0,e7,"fromWeb",0,e=>new e9(e,(e=>{if("/"===e[0])return e;let t=e.indexOf("/",e.indexOf("//")+2);return -1===t?"/":e.slice(t)})(e.url)),"schemaBodyJson",0,(e,t)=>{let r=L.schemaBodyJson(e,t);return o.flatMap(e8,r)},"schemaHeaders",0,(e,t)=>{let r=L.schemaHeaders(e,t);return o.flatMap(e8,r)},"searchParamsFromURL",0,e=>{let t={};for(let[r,i]of e.searchParams.entries()){let e=t[r];void 0!==e?Array.isArray(e)?e.push(i):t[r]=[e,i]:t[r]=i}return t},"toURL",0,e=>{let t=e.headers.host??"localhost",r="https"===e.headers["x-forwarded-proto"]?"https":"http";try{return S.some(new URL(e.url,`${r}://${t}`))}catch{return S.none()}}],956636)},253489,e=>{"use strict";var t=e.i(65632),r=e.i(939798),i=e.i(704179);let n=/^[0-9a-f]{32}$/i,a=/^[0-9a-f]{16}$/i;e.s(["fromHeaders",0,e=>{let i,s=(e=>{if(!e.traceparent)return t.none();let i=e.traceparent.split("-");if(4!==i.length)return t.none();let[s,o,l,u]=i;return"00"!==s||!1===n.test(o)||!1===a.test(l)?t.none():t.some(r.externalSpan({traceId:o,spanId:l,sampled:(1&parseInt(u,16))==1}))})(e);return"Some"===s._tag||"Some"===(s=(e=>{if(!("b3"in e))return t.none();let i=e.b3.split("-");return i.length<2?t.none():t.some(r.externalSpan({traceId:i[0],spanId:i[1],sampled:!i[2]||"1"===i[2]}))})(e))._tag?s:(i=e)["x-b3-traceid"]&&i["x-b3-spanid"]?t.some(r.externalSpan({traceId:i["x-b3-traceid"],spanId:i["x-b3-spanid"],sampled:!i["x-b3-sampled"]||"1"===i["x-b3-sampled"]})):t.none()},"toHeaders",0,e=>i.unsafeFromRecord({b3:`${e.traceId}-${e.spanId}-${e.sampled?"1":"0"}${"Some"===e.parent._tag?`-${e.parent.value.spanId}`:""}`,traceparent:`00-${e.traceId}-${e.spanId}-${e.sampled?"01":"00"}`})])},620671,e=>{"use strict";var t=e.i(777865),r=e.i(405614),i=e.i(368171),n=e.i(165039),a=e.i(402409),s=(e.i(347064),e.i(65632)),o=e.i(847279),l=e.i(625552),u=e.i(724880),c=e.i(842862);let p=c.identity;var f=e.i(453119),d=e.i(542610),h=e.i(956636),m=e.i(184697),g=e.i(169228);let y=(0,a.globalValue)(Symbol.for("@effect/platform/HttpApp/preResponseHandlers"),()=>g.unsafeMake(s.none()));var b=e.i(704179),S=e.i(253489);()=>g.unsafeMake(!1);let v=(0,a.globalValue)(Symbol.for("@effect/platform/HttpMiddleware/tracerDisabledWhen"),()=>g.unsafeMake(c.constFalse)),E=t.Reference()("@effect/platform/HttpMiddleware/SpanNameGenerator",{defaultValue:()=>e=>`http.server ${e.method}`}),w=e=>r.withFiberRuntime(i=>{let n=t.unsafeGet(i.currentContext,h.HttpServerRequest);if(i.getFiberRef(v)(n))return e;let a=s.getOrUndefined(h.toURL(n));void 0!==a&&(""!==a.username||""!==a.password)&&(a.username="REDACTED",a.password="REDACTED");let o=i.getFiberRef(b.currentRedactedNames),l=b.redact(n.headers,o),u=t.get(i.currentContext,E);return r.useSpan(u(n),{parent:s.getOrUndefined(S.fromHeaders(n.headers)),kind:"server",captureStackTrace:!1},t=>{for(let e in t.attribute("http.request.method",n.method),void 0!==a&&(t.attribute("url.full",a.toString()),t.attribute("url.path",a.pathname),""!==a.search.slice(1)&&t.attribute("url.query",a.search.slice(1)),t.attribute("url.scheme",a.protocol.slice(0,-1))),void 0!==n.headers["user-agent"]&&t.attribute("user_agent.original",n.headers["user-agent"]),l)t.attribute(`http.request.header.${e}`,String(l[e]));return"Some"===n.remoteAddress._tag&&t.attribute("client.address",n.remoteAddress.value),r.flatMap(r.exit(r.withParentSpan(e,t)),e=>{let r=d.exitResponse(e);t.attribute("http.response.status_code",r.status);let i=b.redact(r.headers,o);for(let e in i)t.attribute(`http.response.header.${e}`,String(i[e]));return e})})}),_=Symbol.for("@effect/platform/HttpApp/handled"),k=a.globalValue("@effect/platform/HttpApp/ejectedScopes",()=>new WeakSet);o.defaultRuntime,e.s(["toWebHandlerRuntime",0,e=>{let a=o.make(e),c=o.runFork(a);return(o,g)=>{var b;let S,v,E,x,C=Symbol.for("@effect/platform/HttpApp/resolve"),I=(b=(a,o)=>(o=(e=>{if("Stream"!==e.body._tag)return e;let r=s.getOrThrow(n.getCurrentFiber()),a=t.unsafeGet(r.currentContext,l.Scope);return k.add(a),m.setBody(e,f.stream(u.ensuring(e.body.stream,l.close(a,i.void)),e.body.contentType,e.body.contentLength))})(o),a[C](m.toWeb(o,{withoutBody:"HEAD"===a.method,runtime:e})),r.void),v=r.withFiberRuntime(e=>r.flatMap(o,i=>{let n=t.unsafeGet(e.currentContext,h.HttpServerRequest),a=e.getFiberRef(y);return"None"===a._tag?(n[_]=!0,r.as(b(n,i),i)):r.tap(a.value(n,i),e=>(n[_]=!0,b(n,e)))})),E=r.catchAllCause(v,e=>r.withFiberRuntime(i=>r.flatMap(d.causeResponse(e),([e,n])=>{let a=t.unsafeGet(i.currentContext,h.HttpServerRequest),s=i.getFiberRef(y);return"None"===s._tag?(a[_]=!0,r.zipRight(b(a,e),r.failCause(n))):r.zipRight(r.tap(s.value(a,e),e=>(a[_]=!0,b(a,e))),r.failCause(n))}))),x=p(void 0===g?w(E):r.matchCauseEffect(g(w(E)),{onFailure:e=>r.withFiberRuntime(i=>{let n=t.unsafeGet(i.currentContext,h.HttpServerRequest);return _ in n?r.void:r.matchCauseEffect(d.causeResponse(e),{onFailure:e=>b(n,m.empty({status:500})),onSuccess:([e])=>b(n,e)})}),onSuccess:e=>r.withFiberRuntime(i=>{let n=t.unsafeGet(i.currentContext,h.HttpServerRequest);return _ in n?r.void:b(n,e)})})),r.uninterruptible((S=x,r.flatMap(l.make(),e=>r.onExit(l.extend(S,e),t=>k.has(e)?r.void:l.close(e,t))))));return(r,i)=>new Promise(n=>{let s=new Map(e.context.unsafeMap);if(t.isContext(i))for(let[e,t]of i.unsafeMap)s.set(e,t);let o=h.fromWeb(r);s.set(h.HttpServerRequest.key,o),o[C]=n,a.context=t.unsafeMake(s);let l=c(I);r.signal?.addEventListener("abort",()=>{l.unsafeInterruptAsFork(d.clientAbortFiberId)},{once:!0})})}}],620671)},265673,e=>{"use strict";var t=e.i(405614),r=e.i(964665),i=e.i(842862),n=e.i(580537),a=e.i(65632),s=e.i(787039),o=e.i(392353),l=e.i(704179),u=e.i(648232),c=e.i(700248);let p=Symbol.for("@effect/platform/HttpClientRequest"),f={[p]:p,...n.BaseProto,toJSON(){return{_id:"@effect/platform/HttpClientRequest",method:this.method,url:this.url,urlParams:this.urlParams,hash:this.hash,headers:n.redact(this.headers),body:this.body.toJSON()}},pipe(){return(0,s.pipeArguments)(this,arguments)}};function d(e,t,r,i,n,a){let s=Object.create(f);return s.method=e,s.url=t,s.urlParams=r,s.hash=i,s.headers=n,s.body=a,s}let h=e=>"object"==typeof e&&null!==e&&p in e,m=d("GET","",u.empty,a.none(),l.empty,c.empty),g=e=>(t,r)=>k(m,{method:e,url:t,...r??void 0}),y=g("GET"),b=g("POST"),S=g("PUT"),v=g("PATCH"),E=g("DELETE"),w=g("HEAD"),_=g("OPTIONS"),k=(0,i.dual)(2,(e,t)=>{let r=e;return t.method&&(r=M(r,t.method)),t.url&&(r=A(r,t.url)),t.headers&&(r=C(r,t.headers)),t.urlParams&&(r=j(r,t.urlParams)),t.hash&&(r=W(r,t.hash)),t.body&&(r=q(r,t.body)),t.accept&&(r=O(r,t.accept)),t.acceptJson&&(r=F(r)),r}),x=(0,i.dual)(3,(e,t,r)=>d(e.method,e.url,e.urlParams,e.hash,l.set(e.headers,t,r),e.body)),C=(0,i.dual)(2,(e,t)=>d(e.method,e.url,e.urlParams,e.hash,l.setAll(e.headers,t),e.body)),I=e=>"string"==typeof e?e:o.value(e),T=(0,i.dual)(3,(e,t,r)=>x(e,"Authorization",`Basic ${btoa(`${I(t)}:${I(r)}`)}`)),R=(0,i.dual)(2,(e,t)=>x(e,"Authorization",`Bearer ${I(t)}`)),O=(0,i.dual)(2,(e,t)=>x(e,"Accept",t)),F=O("application/json"),M=(0,i.dual)(2,(e,t)=>d(t,e.url,e.urlParams,e.hash,e.headers,e.body)),A=(0,i.dual)(2,(e,t)=>{if("string"==typeof t)return d(e.method,t,e.urlParams,e.hash,e.headers,e.body);let r=new URL(t.toString()),i=u.fromInput(r.searchParams),n=r.hash?a.some(r.hash.slice(1)):a.none();return r.search="",r.hash="",d(e.method,r.toString(),i,n,e.headers,e.body)}),N=(0,i.dual)(2,(e,t)=>d(e.method,e.url.endsWith("/")&&t.startsWith("/")?e.url+t.slice(1):e.url+t,e.urlParams,e.hash,e.headers,e.body)),P=(0,i.dual)(2,(e,t)=>d(e.method,t.endsWith("/")&&e.url.startsWith("/")?t+e.url.slice(1):t+e.url,e.urlParams,e.hash,e.headers,e.body)),D=(0,i.dual)(2,(e,t)=>d(e.method,t(e.url),e.urlParams,e.hash,e.headers,e.body)),L=(0,i.dual)(3,(e,t,r)=>d(e.method,e.url,u.append(e.urlParams,t,r),e.hash,e.headers,e.body)),U=(0,i.dual)(2,(e,t)=>d(e.method,e.url,u.appendAll(e.urlParams,t),e.hash,e.headers,e.body)),z=(0,i.dual)(3,(e,t,r)=>d(e.method,e.url,u.set(e.urlParams,t,r),e.hash,e.headers,e.body)),j=(0,i.dual)(2,(e,t)=>d(e.method,e.url,u.setAll(e.urlParams,t),e.hash,e.headers,e.body)),W=(0,i.dual)(2,(e,t)=>d(e.method,e.url,e.urlParams,a.some(t),e.headers,e.body)),q=(0,i.dual)(2,(e,t)=>{let r=e.headers;if("Empty"===t._tag||"FormData"===t._tag)r=l.remove(r,["Content-type","Content-length"]);else{let e=t.contentType;e&&(r=l.set(r,"content-type",e));let i=t.contentLength;i&&(r=l.set(r,"content-length",i.toString()))}return d(e.method,e.url,e.urlParams,e.hash,r,t)}),$=(0,i.dual)(e=>h(e[0]),(e,t,r="application/octet-stream")=>q(e,c.uint8Array(t,r))),B=(0,i.dual)(e=>h(e[0]),(e,t,r="text/plain")=>q(e,c.text(t,r))),H=(0,i.dual)(2,(e,r)=>t.map(c.json(r),t=>q(e,t))),V=(0,i.dual)(2,(e,t)=>q(e,c.unsafeJson(t))),J=(0,i.dual)(e=>h(e[0]),(e,r,i)=>t.map(c.file(r,i),t=>q(e,t))),G=(0,i.dual)(2,(e,t)=>q(e,c.fileWeb(t))),K=(0,i.dual)(2,(e,t)=>q(e,c.text(u.toString(u.fromInput(t)),"application/x-www-form-urlencoded"))),Z=(0,i.dual)(2,(e,t)=>q(e,c.formData(t))),Q=(0,i.dual)(2,(e,t)=>q(e,c.formDataRecord(t))),Y=(0,i.dual)(e=>h(e[0]),(e,t,{contentLength:r,contentType:i="application/octet-stream"}={})=>q(e,c.stream(t,i,r)));e.s(["accept",0,O,"acceptJson",0,F,"appendUrl",0,N,"appendUrlParam",0,L,"appendUrlParams",0,U,"basicAuth",0,T,"bearerToken",0,R,"bodyFile",0,J,"bodyFileWeb",0,G,"bodyFormData",0,Z,"bodyFormDataRecord",0,Q,"bodyJson",0,H,"bodyStream",0,Y,"bodyText",0,B,"bodyUint8Array",0,$,"bodyUnsafeJson",0,V,"bodyUrlParams",0,K,"del",0,E,"get",0,y,"head",0,w,"make",0,g,"modify",0,k,"options",0,_,"patch",0,v,"post",0,b,"prependUrl",0,P,"put",0,S,"removeHash",0,e=>d(e.method,e.url,e.urlParams,a.none(),e.headers,e.body),"schemaBodyJson",0,(e,r)=>{let n=c.jsonSchema(e,r);return(0,i.dual)(2,(e,r)=>t.map(n(r),t=>q(e,t)))},"setBody",0,q,"setHash",0,W,"setHeader",0,x,"setHeaders",0,C,"setMethod",0,M,"setUrl",0,A,"setUrlParam",0,z,"setUrlParams",0,j,"toUrl",0,e=>r.getRight(u.makeUrl(e.url,e.urlParams,e.hash)),"updateUrl",0,D])},367820,943677,e=>{"use strict";var t=e.i(100808),r=e.i(30725);let i=Symbol.for("@effect/platform/HttpClientError");class n extends r.TypeIdError(i,"RequestError"){get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){return this.description?`${this.reason}: ${this.description} (${this.methodAndUrl})`:`${this.reason} error (${this.methodAndUrl})`}}class a extends r.TypeIdError(i,"ResponseError"){get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){let e=`${this.response.status} ${this.methodAndUrl}`;return this.description?`${this.reason}: ${this.description} (${e})`:`${this.reason} error (${e})`}}e.s(["RequestError",()=>n,"ResponseError",()=>a,"isHttpClientError",0,e=>(0,t.hasProperty)(e,i)],367820);var s=e.i(405614),o=e.i(842862),l=e.i(580537),u=e.i(65632),c=e.i(411237),p=e.i(724880),f=e.i(180837),d=e.i(704179),h=e.i(482763),m=e.i(648232);let g=Symbol.for("@effect/platform/HttpClientResponse");class y extends l.Class{request;source;[h.TypeId];[g];constructor(e,t){super(),this.request=e,this.source=t,this[h.TypeId]=h.TypeId,this[g]=g}toJSON(){return h.inspect(this,{_id:"@effect/platform/HttpClientResponse",request:this.request.toJSON(),status:this.status})}get status(){return this.source.status}get headers(){return d.fromInput(this.source.headers)}cachedCookies;get cookies(){return this.cachedCookies?this.cachedCookies:this.cachedCookies=f.fromSetCookie(this.source.headers.getSetCookie())}get remoteAddress(){return u.none()}get stream(){return this.source.body?p.fromReadableStream(()=>this.source.body,e=>new a({request:this.request,response:this,reason:"Decode",cause:e})):p.fail(new a({request:this.request,response:this,reason:"EmptyBody",description:"can not create stream from empty body"}))}get json(){return s.tryMap(this.text,{try:e=>""===e?null:JSON.parse(e),catch:e=>new a({request:this.request,response:this,reason:"Decode",cause:e})})}textBody;get text(){return this.textBody??=s.tryPromise({try:()=>this.source.text(),catch:e=>new a({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(s.cached,s.runSync)}get urlParamsBody(){return s.flatMap(this.text,e=>s.try({try:()=>m.fromInput(new URLSearchParams(e)),catch:e=>new a({request:this.request,response:this,reason:"Decode",cause:e})}))}formDataBody;get formData(){return this.formDataBody??=s.tryPromise({try:()=>this.source.formData(),catch:e=>new a({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(s.cached,s.runSync)}arrayBufferBody;get arrayBuffer(){return this.arrayBufferBody??=s.tryPromise({try:()=>this.source.arrayBuffer(),catch:e=>new a({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(s.cached,s.runSync)}}let b=(0,o.dual)(2,(e,t)=>{let r=e.status;if(t[r])return t[r](e);if(r>=200&&r<300&&t["2xx"])return t["2xx"](e);if(r>=300&&r<400&&t["3xx"])return t["3xx"](e);if(r>=400&&r<500&&t["4xx"])return t["4xx"](e);if(r>=500&&r<600&&t["5xx"])return t["5xx"](e);return t.orElse(e)}),S=(0,o.dual)(2,(e,t)=>s.suspend(()=>t(e.status)?s.succeed(e):s.fail(new a({response:e,request:e.request,reason:"StatusCode",description:"invalid status code"}))));e.s(["TypeId",0,g,"filterStatus",0,S,"filterStatusOk",0,e=>e.status>=200&&e.status<300?s.succeed(e):s.fail(new a({response:e,request:e.request,reason:"StatusCode",description:"non 2xx status code"})),"fromWeb",0,(e,t)=>new y(e,t),"matchStatus",0,b,"schemaJson",0,(e,t)=>{let r=c.decodeUnknown(e,t);return e=>s.flatMap(e.json,t=>r({status:e.status,headers:e.headers,body:t}))},"schemaNoBody",0,(e,t)=>{let r=c.decodeUnknown(e,t);return e=>r({status:e.status,headers:e.headers})},"stream",0,e=>p.unwrap(s.map(e,e=>e.stream))],943677)},868017,e=>{"use strict";let t=e=>`http.request.header.${e}`,r=e=>`http.response.header.${e}`;var i=e.i(710284),n=e.i(777865),a=e.i(405614),s=e.i(368171),o=e.i(169228),l=e.i(842862),u=e.i(402409),c=e.i(580537),p=e.i(347064),f=e.i(787039),d=e.i(100808),h=e.i(374536),m=e.i(56786),g=e.i(625552),y=e.i(724880),b=e.i(180837),S=e.i(704179),v=e.i(367820),E=e.i(482763),w=e.i(253489),_=e.i(648232),k=e.i(265673),x=e.i(943677);let C=Symbol.for("@effect/platform/HttpClient"),I=n.GenericTag("@effect/platform/HttpClient"),T=(0,u.globalValue)(Symbol.for("@effect/platform/HttpClient/tracerDisabledWhen"),()=>o.unsafeMake(l.constFalse)),R=(0,l.dual)(2,(e,t)=>K(e,a.locally(T,t))),O=(0,u.globalValue)(Symbol.for("@effect/platform/HttpClient/currentTracerPropagation"),()=>o.unsafeMake(!0)),F=(0,l.dual)(2,(e,t)=>K(e,a.locally(O,t))),M=n.Reference()("@effect/platform/HttpClient/SpanNameGenerator",{defaultValue:()=>e=>`http.client ${e.method}`}),A=(0,l.dual)(2,(e,t)=>K(e,a.provideService(M,t))),N={[C]:C,pipe(){return(0,f.pipeArguments)(this,arguments)},...c.BaseProto,toJSON:()=>({_id:"@effect/platform/HttpClient"}),get(e,t){return this.execute(k.get(e,t))},head(e,t){return this.execute(k.head(e,t))},post(e,t){return this.execute(k.post(e,t))},put(e,t){return this.execute(k.put(e,t))},patch(e,t){return this.execute(k.patch(e,t))},del(e,t){return this.execute(k.del(e,t))},options(e,t){return this.execute(k.options(e,t))}},P=(e,t)=>{let r=Object.create(N);return r.preprocess=t,r.postprocess=e,r.execute=function(r){return e(t(r))},r},D=(0,u.globalValue)("@effect/platform/HttpClient/responseRegistry",()=>{if("FinalizationRegistry"in globalThis&&globalThis.FinalizationRegistry){let e=new FinalizationRegistry(e=>{e.abort()});return{register(t,r){e.register(t,r,t)},unregister(t){e.unregister(t)}}}let e=new Map;return{register(t,r){e.set(t,setTimeout(()=>r.abort(),5e3))},unregister(t){let r=e.get(t);void 0!==r&&(clearTimeout(r),e.delete(t))}}}),L=(0,u.globalValue)("@effect/platform/HttpClient/scopedRequests",()=>new WeakMap);class U{original;controller;constructor(e,t){this.original=e,this.controller=t}[x.TypeId]=x.TypeId;[E.TypeId]=E.TypeId;applyInterrupt(e){return a.suspend(()=>(D.unregister(this.original),a.onInterrupt(e,()=>a.sync(()=>{this.controller.abort()}))))}get request(){return this.original.request}get status(){return this.original.status}get headers(){return this.original.headers}get cookies(){return this.original.cookies}get remoteAddress(){return this.original.remoteAddress}get formData(){return this.applyInterrupt(this.original.formData)}get text(){return this.applyInterrupt(this.original.text)}get json(){return this.applyInterrupt(this.original.json)}get urlParamsBody(){return this.applyInterrupt(this.original.urlParamsBody)}get arrayBuffer(){return this.applyInterrupt(this.original.arrayBuffer)}get stream(){return y.suspend(()=>(D.unregister(this.original),y.ensuringWith(this.original.stream,e=>(s.isInterrupted(e)&&this.controller.abort(),a.void))))}toJSON(){return this.original.toJSON()}[c.NodeInspectSymbol](){return this.original[c.NodeInspectSymbol]()}}let{del:z,execute:j,get:W,head:q,options:$,patch:B,post:H,put:V}=a.serviceFunctions(I),J=(0,l.dual)(2,(e,t)=>P(a.flatMap(r=>t(e.postprocess(a.succeed(r)),r)),e.preprocess)),G=(0,l.dual)(2,(e,t)=>K(e,a.flatMap(x.filterStatus(t)))),K=(0,l.dual)(2,(e,t)=>P(r=>t(e.postprocess(r)),e.preprocess)),Z=(0,l.dual)(3,(e,t,r)=>K(e,a.catchTag(t,r))),Q=(0,l.dual)(2,(e,t)=>K(e,a.catchTags(t))),Y=(0,l.dual)(2,(e,t)=>K(e,a.catchAll(t))),X=(0,l.dual)(3,(e,t,r)=>K(e,a.filterOrElse(t,r))),ee=(0,l.dual)(3,(e,t,r)=>K(e,a.filterOrFail(t,r))),et=(0,l.dual)(2,(e,t)=>P(e.postprocess,r=>a.map(e.preprocess(r),t))),er=(0,l.dual)(2,(e,t)=>P(e.postprocess,r=>a.flatMap(e.preprocess(r),t))),ei=(0,l.dual)(2,(e,t)=>P(e.postprocess,r=>e.preprocess(t(r)))),en=(0,l.dual)(2,(e,t)=>P(e.postprocess,r=>a.flatMap(t(r),e.preprocess))),ea=(0,l.dual)(2,(e,t)=>K(e,a.retry(t))),es=(0,l.dual)(2,(e,t)=>K(e,a.retry({while:m.ScheduleTypeId in t||void 0===t.while?eo:d.or(eo,t.while),schedule:m.ScheduleTypeId in t?t:t.schedule,times:m.ScheduleTypeId in t?void 0:t.times}))),eo=e=>d.hasProperty(e,i.TimeoutExceptionTypeId)||el(e),el=e=>v.isHttpClientError(e)&&("RequestError"===e._tag&&"Transport"===e.reason||"ResponseError"===e._tag&&e.response.status>=429),eu=(0,l.dual)(2,(e,t)=>K(e,a.tap(t))),ec=(0,l.dual)(2,(e,t)=>K(e,a.tapError(t))),ep=(0,l.dual)(2,(e,t)=>P(e.postprocess,r=>a.tap(e.preprocess(r),t))),ef=(0,l.dual)(2,(e,t)=>P(r=>a.tap(e.postprocess(r),e=>h.update(t,t=>b.merge(t,e.cookies))),r=>a.flatMap(e.preprocess(r),e=>a.map(h.get(t),t=>b.isEmpty(t)?e:k.setHeader(e,"cookie",b.toCookieHeader(t)))))),ed=(0,l.dual)(e=>{let t;return t=e[0],d.hasProperty(t,C)},(e,t)=>P(r=>{let i=(r,n)=>a.flatMap(e.postprocess(a.succeed(r)),e=>e.status>=300&&e.status<400&&e.headers.location&&n<(t??10)?i(k.setUrl(r,new URL(e.headers.location,e.request.url)),n+1):a.succeed(e));return a.flatMap(r,e=>i(e,0))},e.preprocess));e.s(["SpanNameGenerator",0,M,"TypeId",0,C,"catchAll",0,Y,"catchTag",0,Z,"catchTags",0,Q,"currentTracerDisabledWhen",0,T,"currentTracerPropagation",0,O,"del",0,z,"execute",0,j,"filterOrElse",0,X,"filterOrFail",0,ee,"filterStatus",0,G,"filterStatusOk",0,e=>K(e,a.flatMap(x.filterStatusOk)),"followRedirects",0,ed,"get",0,W,"head",0,q,"layerMergedContext",0,e=>p.effect(I,a.flatMap(a.context(),t=>a.map(e,e=>K(e,a.mapInputContext(e=>n.merge(t,e)))))),"make",0,e=>P(s=>a.flatMap(s,s=>a.withFiberRuntime(l=>{let u=L.get(s),c=u??new AbortController,p=_.makeUrl(s.url,s.urlParams,s.hash);if("Left"===p._tag)return a.fail(new v.RequestError({request:s,reason:"InvalidUrl",cause:p.left}));let f=p.right;if(!l.getFiberRef(o.currentTracerEnabled)||l.getFiberRef(T)(s)){let t=e(s,f,c.signal,l);return u?t:a.uninterruptibleMask(e=>a.matchCauseEffect(e(t),{onSuccess:e=>(D.register(e,c),a.succeed(new U(e,c))),onFailure:e=>(i.isInterrupted(e)&&c.abort(),a.failCause(e))}))}let d=n.get(l.currentContext,M);return a.useSpan(d(s),{kind:"client",captureStackTrace:!1},n=>{n.attribute("http.request.method",s.method),n.attribute("server.address",f.origin),""!==f.port&&n.attribute("server.port",+f.port),n.attribute("url.full",f.toString()),n.attribute("url.path",f.pathname),n.attribute("url.scheme",f.protocol.slice(0,-1));let o=f.search.slice(1);""!==o&&n.attribute("url.query",o);let p=l.getFiberRef(S.currentRedactedNames),d=S.redact(s.headers,p);for(let e in d)n.attribute(t(e),String(d[e]));return s=l.getFiberRef(O)?k.setHeaders(s,w.toHeaders(n)):s,a.uninterruptibleMask(t=>t(e(s,f,c.signal,l)).pipe(a.withParentSpan(n),a.matchCauseEffect({onSuccess:e=>{n.attribute("http.response.status_code",e.status);let t=S.redact(e.headers,p);for(let e in t)n.attribute(r(e),String(t[e]));return u?a.succeed(e):(D.register(e,c),a.succeed(new U(e,c)))},onFailure:e=>(!u&&i.isInterrupted(e)&&c.abort(),a.failCause(e))})))})})),a.succeed),"makeWith",0,P,"mapRequest",0,et,"mapRequestEffect",0,er,"mapRequestInput",0,ei,"mapRequestInputEffect",0,en,"options",0,$,"patch",0,B,"post",0,H,"put",0,V,"retry",0,ea,"retryTransient",0,es,"tag",0,I,"tap",0,eu,"tapError",0,ec,"tapRequest",0,ep,"transform",0,J,"transformResponse",0,K,"withCookiesRef",0,ef,"withScope",0,e=>J(e,(e,t)=>{let r=new AbortController;return L.set(t,r),a.zipRight(a.scopeWith(e=>g.addFinalizer(e,a.sync(()=>r.abort()))),e)}),"withSpanNameGenerator",0,A,"withTracerDisabledWhen",0,R,"withTracerPropagation",0,F],868017)},747125,e=>{"use strict";var t=e.i(868017);t.TypeId;let r=t.tag;t.execute,t.get,t.head,t.post,t.patch,t.put,t.del,t.options,t.catchAll,t.catchTag,t.catchTags,t.filterOrElse,t.filterOrFail,t.filterStatus;let i=t.filterStatusOk;t.makeWith,t.make,t.transform,t.transformResponse;let n=t.mapRequest;t.mapRequestEffect,t.mapRequestInput,t.mapRequestInputEffect,t.retry,t.retryTransient,t.tap,t.tapError,t.tapRequest,t.withCookiesRef,t.followRedirects,t.currentTracerDisabledWhen,t.withTracerDisabledWhen,t.currentTracerPropagation,t.withTracerPropagation,t.layerMergedContext,t.SpanNameGenerator,t.withSpanNameGenerator,t.withScope,e.s(["HttpClient",0,r,"filterStatusOk",0,i,"mapRequest",0,n])},911588,e=>{"use strict";var t=e.i(265673);t.make,t.get;let r=t.post;t.patch,t.put,t.del,t.head,t.options,t.modify,t.setMethod,t.setHeader;let i=t.setHeaders;t.basicAuth,t.bearerToken,t.accept,t.acceptJson,t.setUrl;let n=t.prependUrl;t.appendUrl,t.updateUrl,t.setUrlParam,t.setUrlParams;let a=t.appendUrlParam;t.appendUrlParams,t.setHash,t.removeHash,t.toUrl;let s=t.setBody;t.bodyUint8Array,t.bodyText;let o=t.bodyJson;t.bodyUnsafeJson,t.schemaBodyJson,t.bodyUrlParams,t.bodyFormData,t.bodyFormDataRecord,t.bodyStream,t.bodyFile,t.bodyFileWeb,e.s(["appendUrlParam",0,a,"bodyJson",0,o,"post",0,r,"prependUrl",0,n,"setBody",0,s,"setHeaders",0,i])},516577,e=>{"use strict";var t=e.i(943677);t.TypeId,t.fromWeb,t.schemaJson,t.schemaNoBody;let r=t.stream;t.matchStatus,t.filterStatus,t.filterStatusOk,e.s(["stream",0,r])},433709,e=>{"use strict";var t=e.i(526886),r=e.i(777865),i=e.i(405614),n=e.i(680465),a=e.i(169228),s=e.i(842862),o=e.i(402409),l=e.i(580537),u=e.i(347064),c=e.i(65632),p=e.i(100808),f=e.i(411237),d=e.i(939798);let h=/\+/g,m=function(){};m.prototype=Object.create(null);let g=/^https?:\/\/.*?\//,y=/(\/:[^/()]*?)\?(\/?)/;class b{constructor(e={}){this.options={ignoreTrailingSlash:!0,ignoreDuplicateSlashes:!0,caseSensitive:!1,maxParamLength:100,...e}}options;routes=[];trees={};on(e,t,r){let i=t.match(y);if(i&&void 0!==i.index){x(t.length===i.index+i[0].length,"Optional Parameter needs to be the last parameter of the path");let n=t.replace(y,"$1$2"),a=t.replace(y,"$2");this.on(e,n,r),this.on(e,a,r);return}for(let i of(this.options.ignoreDuplicateSlashes&&(t=C(t)),this.options.ignoreTrailingSlash&&(t=I(t)),"string"==typeof e?[e]:e))this._on(i,t,r)}all(e,t){this.on(O,e,t)}_on(e,t,r){void 0===this.trees[e]&&(this.trees[e]=new w("/"));let i=t;if("*"===i&&0!==this.trees[e].prefix.length){let t=this.trees[e];this.trees[e]=new w(""),this.trees[e].staticChildren["/"]=t}let n=this.trees[e].prefix.length,a=this.trees[e],s=[];for(let e=0;e<=i.length;e++){if(58===i.charCodeAt(e)&&58===i.charCodeAt(e+1)){e++;continue}let t=58===i.charCodeAt(e)&&58!==i.charCodeAt(e+1),r=42===i.charCodeAt(e);if(t||r||e===i.length&&e!==n){let t=i.slice(n,e);this.options.caseSensitive||(t=t.toLowerCase()),t=(t=t.split("::").join(":")).split("%").join("%25"),a=a.createStaticChild(t)}if(t){let t=!1,r=[],l=e+1;for(let u=l;;u++){let c=i.charCodeAt(u),p=40===c,f=45===c||46===c,d=47===c||u===i.length;if(p||f||d){let c=i.slice(l,u);if(s.push(c),t=t||p||f,p){var o;let e=function(e,t){let r=1;for(;t<e.length;){if("\\"===e[++t]){t++;continue}if(")"===e[t]?r--:"("===e[t]&&r++,!r)return t}throw TypeError('Invalid regexp expression in "'+e+'"')}(i,u),t=i.slice(u,e+1);r.push((94===(o=t).charCodeAt(1)&&(o=o.slice(0,1)+o.slice(2)),36===o.charCodeAt(o.length-2)&&(o=o.slice(0,o.length-2)+o.slice(o.length-1)),o)),u=e+1}else r.push("(.*?)");let h=u;for(;u<i.length;u++){let e=i.charCodeAt(u);if(47===e)break;if(58===e)if(58===i.charCodeAt(u+1))u++;else break}let m=i.slice(h,u);if(m&&(m=(m=m.split("::").join(":")).split("%").join("%25"),r.push(m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))),l=u+1,d||47===i.charCodeAt(u)||u===i.length){let s=t?"()"+m:m,o=i.slice(e,u);i=i.slice(0,e+1)+s+i.slice(u),e+=s.length;let l=t?RegExp("^"+r.join("")+"$"):void 0;a=a.createParametricChild(l,m,o),n=e+1;break}}}}else if(r&&(s.push("*"),a=a.createWildcardChild(),n=e+1,e!==i.length-1))throw Error("Wildcard must be the last character in the route")}for(let t of(this.options.caseSensitive||(i=i.toLowerCase()),"*"===i&&(i="/*"),this.routes))if(t.method===e&&t.pattern===i)throw Error(`Method '${e}' already declared for route '${i}'`);let l={method:e,path:t,pattern:i,params:s,handler:r};this.routes.push(l),a.addRoute(l)}has(e,t){let r=this.trees[e];if(void 0===r)return!1;let i=r.getStaticChild(t);return void 0!==i&&i.isLeafNode}find(e,t){let r,i,n,a=this.trees[e];if(void 0===a)return;47!==t.charCodeAt(0)&&(t=t.replace(g,"/")),this.options.ignoreDuplicateSlashes&&(t=C(t));try{t=(r=function(e){let t=!1,r=!1,i="";for(let n=1;n<e.length;n++){let a=e.charCodeAt(n);if(37===a){let i=e.charCodeAt(n+1),a=e.charCodeAt(n+2);void 0===T(i,a)?t=!0:(r=!0,50===i&&53===a&&(t=!0,e=e.slice(0,n+1)+"25"+e.slice(n+1),n+=2),n+=2)}else if(63===a||59===a||35===a){i=e.slice(n+1),e=e.slice(0,n);break}}return{path:t?decodeURI(e):e,querystring:i,shouldDecodeParam:r}}(t)).path,i=r.querystring,n=r.shouldDecodeParam}catch(e){return}this.options.ignoreTrailingSlash&&(t=I(t));let s=t;!1===this.options.caseSensitive&&(t=t.toLowerCase());let o=this.options.maxParamLength,l=a.prefix.length,u=[],c=t.length,p=[];for(;;){if(l===c&&a.isLeafNode){let e=a.handlerStorage?.find();if(void 0!==e)return{handler:e.handler,params:e.createParams(u),searchParams:function(e){let t=new m;if("string"!=typeof e)return t;let r=e.length,i="",n="",a=-1,s=-1,o=!1,l=!1,u=!1,c=!1,p=!1,f=0;for(let d=0;d<r+1;d++)if(38===(f=d!==r?e.charCodeAt(d):38)){if((p=s>a)||(s=d),i=e.slice(a+1,s),p||i.length>0){if(u&&(i=i.replace(h," ")),o)try{i=decodeURIComponent(i)||i}catch{}if(p&&(n=e.slice(s+1,d),c&&(n=n.replace(h," ")),l))try{n=decodeURIComponent(n)||n}catch{}let r=t[i];void 0===r?t[i]=n:r.pop?r.push(n):t[i]=[r,n]}n="",a=d,s=d,o=!1,l=!1,u=!1,c=!1}else 61===f?s<=a?s=d:l=!0:43===f?s>a?c=!0:u=!0:37===f&&(s>a?l=!0:o=!0);return t}(i)}}let e=a.getNextNode(t,l,p,u.length);if(void 0===e){if(0===p.length)return;let t=p.pop();l=t.brotherPathIndex,u.splice(t.paramsCount),e=t.brotherNode}if("StaticNode"===(a=e)._tag){l+=a.prefix.length;continue}if("WildcardNode"===a._tag){let e=s.slice(l);n&&(e=R(e)),u.push(e),l=c;continue}if("ParametricNode"===a._tag){let e=s.indexOf("/",l);-1===e&&(e=c);let t=s.slice(l,e);if(n&&(t=R(t)),void 0!==a.regex){let e=a.regex.exec(t);if(null===e)continue;for(let t=1;t<e.length;t++){let r=e[t];if(r.length>o)return;u.push(r)}}else{if(t.length>o)return;u.push(t)}l=e}}}}class S{handlers=[];unconstrainedHandler;find(){return this.unconstrainedHandler}add(e){var t;let r,i={params:e.params,handler:e.handler,createParams:(r=(t=e.params).length,function(e){let i={};for(let n=0;n<r;n++)i[t[n]]=e[n];return i})};this.handlers.push(i),this.unconstrainedHandler=this.handlers[0]}}class v{isLeafNode=!1;routes;handlerStorage;addRoute(e){void 0===this.routes?this.routes=[e]:this.routes.push(e),void 0===this.handlerStorage&&(this.handlerStorage=new S),this.isLeafNode=!0,this.handlerStorage.add(e)}}class E extends v{staticChildren={};findStaticMatchingChild(e,t){let r=this.staticChildren[e.charAt(t)];if(void 0!==r&&r.matchPrefix(e,t))return r}getStaticChild(e,t=0){if(e.length===t)return this;let r=this.findStaticMatchingChild(e,t);if(void 0!==r)return r.getStaticChild(e,t+r.prefix.length)}createStaticChild(e){if(0===e.length)return this;let t=this.staticChildren[e.charAt(0)];if(t){let r=1;for(;r<t.prefix.length;r++)if(e.charCodeAt(r)!==t.prefix.charCodeAt(r)){t=t.split(this,r);break}return t.createStaticChild(e.slice(r))}let r=e.charAt(0);return this.staticChildren[r]=new w(e),this.staticChildren[r]}}class w extends E{_tag="StaticNode";constructor(e){super(),this.setPrefix(e)}prefix;matchPrefix;parametricChildren=[];wildcardChild;setPrefix(e){if(this.prefix=e,1===e.length)this.matchPrefix=(e,t)=>!0;else{let t=e.length;this.matchPrefix=function(e,r){for(let i=1;i<t;i++)if(e.charCodeAt(r+i)!==this.prefix.charCodeAt(i))return!1;return!0}}}getParametricChild(e){if(void 0===e)return this.parametricChildren.find(e=>!1===e.isRegex);let t=e.source;return this.parametricChildren.find(e=>void 0!==e.regex&&e.regex.source===t)}createParametricChild(e,t,r){let i=this.getParametricChild(e);return void 0!==i?i.nodePaths.add(r):(i=new _(e,t,r),this.parametricChildren.push(i),this.parametricChildren.sort((e,t)=>e.isRegex?t.isRegex?void 0===e.staticSuffix?1:void 0===t.staticSuffix?-1:t.staticSuffix.endsWith(e.staticSuffix)?1:e.staticSuffix.endsWith(t.staticSuffix)?-1:0:-1:1)),i}createWildcardChild(){return void 0===this.wildcardChild&&(this.wildcardChild=new k),this.wildcardChild}split(e,t){let r=this.prefix.slice(0,t),i=this.prefix.slice(t);this.setPrefix(i);let n=new w(r);return n.staticChildren[i.charAt(0)]=this,e.staticChildren[r.charAt(0)]=n,n}getNextNode(e,t,r,i){let n=this.findStaticMatchingChild(e,t),a=0;if(void 0===n){if(0===this.parametricChildren.length)return this.wildcardChild;n=this.parametricChildren[0],a=1}void 0!==this.wildcardChild&&r.push({paramsCount:i,brotherPathIndex:t,brotherNode:this.wildcardChild});for(let e=this.parametricChildren.length-1;e>=a;e--)r.push({paramsCount:i,brotherPathIndex:t,brotherNode:this.parametricChildren[e]});return n}}class _ extends E{regex;staticSuffix;_tag="ParametricNode";constructor(e,t,r){super(),this.regex=e,this.staticSuffix=t,this.isRegex=!!e,this.nodePaths=new Set([r])}isRegex;nodePaths;getNextNode(e,t){return this.findStaticMatchingChild(e,t)}}class k extends v{_tag="WildcardNode";getNextNode(e,t,r,i){}}let x=(e,t)=>{if(!e)throw Error(t)};function C(e){return e.replace(/\/\/+/g,"/")}function I(e){return e.length>1&&47===e.charCodeAt(e.length-1)?e.slice(0,-1):e}function T(e,t){return 50===e?53===t?"%":51===t?"#":52===t?"$":54===t?"&":66===t||98===t?"+":67===t||99===t?",":70===t||102===t?"/":void 0:51===e?65===t||97===t?":":66===t||98===t?";":68===t||100===t?"=":70===t||102===t?"?":void 0:52===e&&48===t?"@":void 0}function R(e){let t=e.indexOf("%");if(-1===t)return e;let r="",i=t;for(let n=t;n<e.length;n++)if(37===e.charCodeAt(n)){let t=T(e.charCodeAt(n+1),e.charCodeAt(n+2));r+=e.slice(i,n)+t,i=n+3}return e.slice(0,t)+r+e.slice(i)}let O=["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE"];var F=e.i(747125),M=e.i(911588);let A=Symbol.for("@effect/platform/Etag/Generator"),N=r.GenericTag("@effect/platform/Etag/Generator");e.i(698440),e.i(724880);e.i(302014),e.i(704179),e.i(857952),e.i(444135);let P=r.GenericTag("@effect/platform/HttpServer"),D=(0,s.dual)(e=>i.isEffect(e[0]),(e,t)=>u.scopedDiscard(i.flatMap(P,r=>r.serve(e,t))));i.flatMap(P,e=>(e=>i.flatMap(F.HttpClient,t=>{if("UnixAddress"===e._tag)return i.die(Error("HttpServer.layerTestClient: UnixAddress not supported"));let r="0.0.0.0"===e.hostname?"127.0.0.1":e.hostname,n=`http://${r}:${e.port}`;return i.succeed(F.mapRequest(t,M.prependUrl(n)))}))(e.address)),F.HttpClient;var L=e.i(542610),U=e.i(956636),z=e.i(166512);let j=Symbol.for("@effect/platform/HttpRouter"),W=Symbol.for("@effect/platform/HttpRouter/Route"),q=Symbol.for("@effect/platform/HttpRouter/RouteContext"),$=r.GenericTag("@effect/platform/HttpRouter/RouteContext"),B=(0,o.globalValue)("@effect/platform/HttpRouter/currentRouterConfig",()=>a.unsafeMake({}));class H extends n.StructuralClass{routes;mounts;[j];constructor(e,t){super(),this.routes=e,this.mounts=t,this[j]=j,this.httpApp=V(this).pipe(i.flatMap(e=>this.httpApp=e))}httpApp;commit(){return this.httpApp}toJSON(){return{_id:"Router",routes:this.routes.toJSON(),mounts:this.mounts.toJSON()}}toString(){return l.format(this)}[l.NodeInspectSymbol](){return this.toJSON()}}let V=e=>i.map(a.get(B),n=>{let s=((e={})=>new b(e))(n),o=t.toReadonlyArray(e.mounts).map(([e,t,r])=>[e,new K(new G("*",r?.includePrefix?`${e}/*`:"/*",t,r?.includePrefix?c.none():c.some(e),!1),{}),r]),l=o.length;return t.forEach(e.routes,e=>{"*"===e.method?s.all(e.path,e):s.on(e.method,e.path,e)}),i.withFiberRuntime(e=>{let t=r.unsafeMake(new Map(e.getFiberRef(a.currentContext).unsafeMap)),n=r.unsafeGet(t,U.HttpServerRequest);if(l>0){let e=n.url.indexOf("?"),r=-1===e?n.url:n.url.slice(0,e);for(let e=0;e<l;e++){let[s,l,u]=o[e];if(r===s||r.startsWith(s+"/"))return t.unsafeMap.set($.key,l),u?.includePrefix!==!0&&t.unsafeMap.set(U.HttpServerRequest.key,J(n,s)),i.locally(i.flatMap(l.route.handler,z.toResponse),a.currentContext,t)}}let u=s.find(n.method,n.url);if(void 0===u&&"HEAD"===n.method&&(u=s.find("GET",n.url)),void 0===u)return i.fail(new L.RouteNotFound({request:n}));let c=u.handler;"Some"===c.prefix._tag&&t.unsafeMap.set(U.HttpServerRequest.key,J(n,c.prefix.value)),t.unsafeMap.set(U.ParsedSearchParams.key,u.searchParams),t.unsafeMap.set($.key,new K(c,u.params));let p=r.getOption(t,d.ParentSpan);"Some"===p._tag&&"Span"===p.value._tag&&p.value.attribute("http.route",c.path);let f=i.flatMap(c.handler,z.toResponse);return i.locally(c.uninterruptible?f:i.interruptible(f),a.currentContext,t)})});function J(e,t){let r=t.length;return e.modify({url:e.url.length<=r?"/":e.url.slice(r)})}class G extends l.Class{method;path;handler;prefix;uninterruptible;[W];constructor(e,t,r,i=c.none(),n=!1){super(),this.method=e,this.path=t,this.handler=r,this.prefix=i,this.uninterruptible=n,this[W]=W}toJSON(){return{_id:"@effect/platform/HttpRouter/Route",method:this.method,path:this.path,prefix:this.prefix.toJSON()}}}class K{route;params;[q];constructor(e,t){this.route=e,this.params=t,this[q]=q}}let Z=new H(t.empty(),t.empty()),Q=(0,s.dual)(2,(e,r)=>new H(t.append(e.routes,r),e.mounts)),Y=(0,s.dual)(2,(e,t)=>X(e,t)),X=(...e)=>new H(e.reduce((e,r)=>t.appendAll(e,r.routes),t.empty()),e.reduce((e,r)=>t.appendAll(e,r.mounts),t.empty())),ee=e=>e.endsWith("/")?e.slice(0,-1):e,et=(0,s.dual)(2,(e,r)=>(r=ee(r),new H(t.map(e.routes,e=>new G(e.method,"/"===e.path?r:r+e.path,e.handler,c.orElse(c.map(e.prefix,e=>r+e),()=>c.some(r)),e.uninterruptible)),t.map(e.mounts,([e,t])=>["/"===e?r:r+e,t])))),er=(0,s.dual)(3,(e,t,r)=>Y(e,et(r,t))),ei=(0,s.dual)(e=>p.hasProperty(e[0],j),(e,r,i,n)=>new H(e.routes,t.append(e.mounts,[ee(r),i,n]))),en=e=>(0,s.dual)(e=>{let t;return t=e[0],p.hasProperty(t,j)},(r,i,n,a)=>new H(t.append(r.routes,new G(e,i,n,c.none(),a?.uninterruptible??!1)),r.mounts)),ea=en("*"),es=en("GET"),eo=en("POST"),el=en("PUT"),eu=en("PATCH"),ec=en("DELETE"),ep=en("HEAD"),ef=en("OPTIONS"),ed=(0,s.dual)(2,(e,r)=>new H(t.map(e.routes,e=>new G(e.method,e.path,r(i.flatMap(e.handler,z.toResponse)),e.prefix,e.uninterruptible)),t.map(e.mounts,([e,t])=>[e,r(t)]))),eh=((e,r)=>new H(t.map(e.routes,e=>new G(e.method,e.path,r(e.handler),e.prefix,e.uninterruptible)),t.map(e.mounts,([e,t])=>[e,i.flatMap(r(t),z.toResponse)])),()=>{let e=Z;return{addRoute:t=>i.sync(()=>{e=Q(e,t)}),all:(t,r,n)=>i.sync(()=>{e=ea(e,t,r,n)}),get:(t,r,n)=>i.sync(()=>{e=es(e,t,r,n)}),post:(t,r,n)=>i.sync(()=>{e=eo(e,t,r,n)}),put:(t,r,n)=>i.sync(()=>{e=el(e,t,r,n)}),patch:(t,r,n)=>i.sync(()=>{e=eu(e,t,r,n)}),del:(t,r,n)=>i.sync(()=>{e=ec(e,t,r,n)}),head:(t,r,n)=>i.sync(()=>{e=ep(e,t,r,n)}),options:(t,r,n)=>i.sync(()=>{e=ef(e,t,r,n)}),router:i.sync(()=>e),mount:(t,r)=>i.sync(()=>{e=er(e,t,r)}),mountApp:(t,r,n)=>i.sync(()=>{e=ei(e,t,r,n)}),concat:t=>i.sync(()=>{e=Y(e,t)})}});e.s(["empty",0,Z,"get",0,es,"post",0,eo,"schemaParams",0,(e,t)=>{let n=f.decodeUnknown(e,t);return i.flatMap(i.context(),e=>{let t=r.get(e,U.ParsedSearchParams),i=r.get(e,$);return n({...t,...i.params})})},"use",0,ed],433709)},933448,e=>{"use strict";var t=e.i(964665),r=e.i(842862);e.i(65632);var i=e.i(787039);let n=Symbol.for("@effect/matcher/Matcher"),a={[n]:{_input:r.identity,_filters:r.identity,_remaining:r.identity,_result:r.identity,_return:r.identity},_tag:"TypeMatcher",add(e){return function(e){let t=Object.create(a);return t.cases=e,t}([...this.cases,e])},pipe(){return(0,i.pipeArguments)(this,arguments)}},s={[n]:{_input:r.identity,_filters:r.identity,_remaining:r.identity,_result:r.identity,_provided:r.identity,_return:r.identity},_tag:"ValueMatcher",add(e){return"Right"===this.value._tag?this:"When"===e._tag&&!0===e.guard(this.provided)||"Not"===e._tag&&!1===e.guard(this.provided)?o(this.provided,t.right(e.evaluate(this.provided))):this},pipe(){return(0,i.pipeArguments)(this,arguments)}};function o(e,t){let r=Object.create(s);return r.provided=e,r.value=t,r}let l=(e,t)=>({_tag:"When",guard:e,evaluate:t}),u=e=>{if("function"==typeof e)return e;if(Array.isArray(e)){let t=e.map(u),r=t.length;return e=>{if(!Array.isArray(e))return!1;for(let i=0;i<r;i++)if(!1===t[i](e[i]))return!1;return!0}}if(null!==e&&"object"==typeof e){let t=Object.entries(e).map(([e,t])=>[e,u(t)]),r=t.length;return e=>{if("object"!=typeof e||null===e)return!1;for(let i=0;i<r;i++){let[r,n]=t[i];if(!(r in e)||!1===n(e[r]))return!1}return!0}}return t=>t===e},c=e=>{if("ValueMatcher"===e._tag)return e.value;let r=e.cases.length;if(1===r){let r=e.cases[0];return e=>"When"===r._tag&&!0===r.guard(e)||"Not"===r._tag&&!1===r.guard(e)?t.right(r.evaluate(e)):t.left(e)}return i=>{for(let n=0;n<r;n++){let r=e.cases[n];if("When"===r._tag&&!0===r.guard(i)||"Not"===r._tag&&!1===r.guard(i))return t.right(r.evaluate(i))}return t.left(i)}};var p=e.i(100808);p.isString,p.isNumber,p.isBoolean,p.isUndefined,p.isNull,p.isBigInt,p.isSymbol,p.isDate,p.isRecord,e.s(["orElse",0,e=>r=>{let i=c(r);return t.isEither(i)?"Right"===i._tag?i.right:e(i.left):t=>{let r=i(t);return"Right"===r._tag?r.right:e(r.left)}},"value",0,e=>o(e,t.left(e)),"when",0,(e,t)=>r=>r.add(l(u(e),t))],933448)},649052,e=>{"use strict";var t=e.i(436518);t.ConfigProviderTypeId,t.FlatConfigProviderTypeId,t.configProviderTag,t.make,t.makeFlat;let r=t.fromEnv;t.fromFlat;let i=t.fromJson,n=t.fromMap,a=t.constantCase;t.mapInputPath,t.kebabCase,t.lowerCase;let s=t.nested,o=t.orElse;t.unnested,t.snakeCase,t.upperCase,t.within,e.s(["constantCase",0,a,"fromEnv",0,r,"fromJson",0,i,"fromMap",0,n,"nested",0,s,"orElse",0,o])},11194,e=>{"use strict";var t=e.i(276406),r=e.i(457602),i=e.i(710284),n=e.i(842862),a=e.i(214250),s=e.i(807816),o=e.i(580611),l=e.i(720369),u=e.i(973165);let c=(0,n.dual)(2,(e,t)=>e.log({fiberId:l.none,logLevel:o.logLevelInfo,message:t,cause:i.empty,context:u.empty(),spans:s.empty(),annotations:a.empty(),date:new Date}));var p=e.i(12653);let f=p.LoggerTypeId,d=p.makeLogger,h=r.addLogger,m=r.addLoggerEffect,g=r.addLoggerScoped,y=p.mapInput,b=p.mapInputOptions,S=p.filterLogLevel,v=p.map,E=t.batchedLogger,w=t.loggerWithConsoleLog,_=t.loggerWithLeveledLog,k=t.loggerWithConsoleError,x=p.none,C=r.removeLogger,I=r.replaceLogger,T=r.replaceLoggerEffect,R=r.replaceLoggerScoped,O=p.simple,F=p.succeed,M=p.sync,A=r.withMinimumLogLevel,N=t.loggerWithSpanAnnotations,P=p.zip,D=p.zipLeft,L=p.zipRight,U=t.defaultLogger,z=p.jsonLogger,j=p.logfmtLogger,W=p.stringLogger,q=p.prettyLogger,$=p.prettyLoggerDefault,B=p.structuredLogger,H=t.tracerLogger,V=I(t.defaultLogger,t.jsonLogger),J=I(t.defaultLogger,t.logFmtLogger),G=I(t.defaultLogger,t.prettyLogger),K=I(t.defaultLogger,t.structuredLogger),Z=r.minimumLogLevel,Q=p.isLogger;e.s(["LoggerTypeId",0,f,"add",0,h,"addEffect",0,m,"addScoped",0,g,"batched",0,E,"defaultLogger",0,U,"filterLogLevel",0,S,"isLogger",0,Q,"json",0,V,"jsonLogger",0,z,"logFmt",0,J,"logfmtLogger",0,j,"make",0,d,"map",0,v,"mapInput",0,y,"mapInputOptions",0,b,"minimumLogLevel",0,Z,"none",0,x,"pretty",0,G,"prettyLogger",0,q,"prettyLoggerDefault",0,$,"remove",0,C,"replace",0,I,"replaceEffect",0,T,"replaceScoped",0,R,"simple",0,O,"stringLogger",0,W,"structured",0,K,"structuredLogger",0,B,"succeed",0,F,"sync",0,M,"test",0,c,"tracerLogger",0,H,"withConsoleError",0,k,"withConsoleLog",0,w,"withLeveledConsole",0,_,"withMinimumLogLevel",0,A,"withSpanAnnotations",0,N,"zip",0,P,"zipLeft",0,D,"zipRight",0,L],11194)},64882,e=>{"use strict";var t=e.i(777865),r=e.i(405614),i=e.i(169228),n=e.i(724880),a=e.i(704179),s=e.i(367820),o=e.i(868017),l=e.i(943677);let u="@effect/platform/FetchHttpClient/Fetch",c=o.make((e,t,o,c)=>{let p=c.getFiberRef(i.currentContext),f=p.unsafeMap.get(u)??globalThis.fetch,d=p.unsafeMap.get("@effect/platform/FetchHttpClient/FetchOptions")??{},h=d.headers?a.merge(a.fromInput(d.headers),e.headers):e.headers,m=i=>r.map(r.tryPromise({try:()=>f(t,{...d,method:e.method,headers:h,body:i,duplex:"Stream"===e.body._tag?"half":void 0,signal:o}),catch:t=>new s.RequestError({request:e,reason:"Transport",cause:t})}),t=>l.fromWeb(e,t));switch(e.body._tag){case"Raw":case"Uint8Array":return m(e.body.body);case"FormData":return m(e.body.formData);case"Stream":return r.flatMap(n.toReadableStreamEffect(e.body.stream),m)}return m(void 0)}),p=o.layerMergedContext(r.succeed(c));class f extends t.Tag(u)(){}e.s(["Fetch",()=>f,"layer",0,p],64882)},36177,e=>{"use strict";var t=e.i(680465),r=e.i(787039);e.i(100808);var i=e.i(625552),n=e.i(580611),a=e.i(276406),s=e.i(885858),o=e.i(82431),l=e.i(741840);function u(e,t){return n.flatMap(e.runtimeEffect,e=>n.withFiberRuntime(r=>(r.setFiberRefs(e.fiberRefs),r.currentRuntimeFlags=e.runtimeFlags,n.provideContext(t,e.context))))}let c={...t.CommitPrototype,[o.TypeId]:o.TypeId,pipe(){return(0,r.pipeArguments)(this,arguments)},commit(){return this.runtimeEffect}};o.TypeId,e.s(["make",0,(e,t)=>{let r;t=t??s.unsafeMakeMemoMap();let o=l.unsafeRunSyncEffect(a.scopeMake()),p=n.withFiberRuntime(a=>(r||(r=l.unsafeForkEffect(n.tap(i.extend(s.toRuntimeWithMemoMap(e,t),o),e=>{f.cachedRuntime=e}),{scope:o,scheduler:a.currentScheduler})),n.flatten(r.await))),f=Object.assign(Object.create(c),{memoMap:t,scope:o,runtimeEffect:p,cachedRuntime:void 0,runtime:()=>void 0===f.cachedRuntime?l.unsafeRunPromiseEffect(f.runtimeEffect):Promise.resolve(f.cachedRuntime),dispose:()=>l.unsafeRunPromiseEffect(f.disposeEffect),disposeEffect:n.suspend(()=>(f.runtimeEffect=n.die("ManagedRuntime disposed"),f.cachedRuntime=void 0,i.close(f.scope,n.exitVoid))),runFork:(e,t)=>void 0===f.cachedRuntime?l.unsafeForkEffect(u(f,e),t):l.unsafeFork(f.cachedRuntime)(e,t),runSyncExit:e=>void 0===f.cachedRuntime?l.unsafeRunSyncExitEffect(u(f,e)):l.unsafeRunSyncExit(f.cachedRuntime)(e),runSync:e=>void 0===f.cachedRuntime?l.unsafeRunSyncEffect(u(f,e)):l.unsafeRunSync(f.cachedRuntime)(e),runPromiseExit:(e,t)=>void 0===f.cachedRuntime?l.unsafeRunPromiseExitEffect(u(f,e),t):l.unsafeRunPromiseExit(f.cachedRuntime)(e,t),runCallback:(e,t)=>void 0===f.cachedRuntime?l.unsafeRunCallback(l.defaultRuntime)(u(f,e),t):l.unsafeRunCallback(f.cachedRuntime)(e,t),runPromise:(e,t)=>void 0===f.cachedRuntime?l.unsafeRunPromiseEffect(u(f,e),t):l.unsafeRunPromise(f.cachedRuntime)(e,t)});return f}],36177)},300021,e=>e.a(async(t,r)=>{try{let H;var i,n=e.i(717890),a=e.i(330415),s=e.i(658079),o=e.i(244795),l=e.i(405614),u=e.i(620671),c=e.i(453119),p=e.i(747125),f=e.i(911588),d=e.i(482763),h=e.i(516577),m=e.i(433709),g=e.i(956636),y=e.i(184697),b=e.i(293889),S=e.i(777865),v=e.i(933448),E=e.i(392353),w=e.i(411237),_=e.i(649052),k=e.i(724880),x=e.i(433366),C=e.i(964665),I=e.i(347064),T=e.i(11194),R=e.i(321172),O=e.i(710284),F=e.i(64317),M=e.i(847279),A=e.i(64882),N=e.i(704179),P=e.i(169228),D=e.i(36177),L=t([s,o]);[s,o]=L.then?(await L)():L;let V={get url(){return`file://${e.P("node_modules/uploadthing/dist/upload-builder-BlFOAnsv.js")}`}},J=_.fromEnv().pipe(_.orElse(()=>_.fromMap(new Map(Object.entries((0,o.filterDefinedObjectValues)(V?.env??{}))),{pathDelim:"_"})),_.nested("uploadthing"),_.constantCase),G=b.boolean("isDev").pipe(b.orElse(()=>b.succeed("u">typeof process?"production":void 0).pipe(b.map(e=>"development"===e))),b.withDefault(!1)),K=w.Config("token",s.UploadThingToken).pipe(l.catchTags({ConfigError:e=>new o.UploadThingError({code:"InvalidData"===e._op?"INVALID_SERVER_CONFIG":"MISSING_ENV",message:"InvalidData"===e._op?"Invalid token. A token is a base64 encoded JSON object matching { apiKey: string, appId: string, regions: string[] }.":"Missing token. Please set the `UPLOADTHING_TOKEN` environment variable or provide a token manually through config.",cause:e})}));b.string("apiUrl").pipe(b.withDefault("https://api.uploadthing.com"),b.mapAttempt(e=>new URL(e)),b.map(e=>e.href.replace(/\/$/,"")));let Z=l.fn(function*(e){let{regions:t,ingestHost:r}=yield*K,i=e?t.find(t=>t===e)??t[0]:t[0];return yield*b.string("ingestUrl").pipe(b.withDefault(`https://${i}.${r}`),b.mapAttempt(e=>new URL(e)),b.map(e=>e.href.replace(/\/$/,"")))});function U(e){return{message:e.message}}function z(e,t){let r=Object.keys(t)[0];return(r?t[r]?.errorFormatter??U:U)(e)}b.string("utfsHost").pipe(b.withDefault("utfs.io")),b.string("ufsHost").pipe(b.withDefault("ufs.sh")),b.literal("subdomain","path")("ufsAppIdLocation").pipe(b.withDefault("subdomain"));let Q=(i="logLevel",H=b.mapOrFail(b.string(),e=>{let t=R.allLevels.find(t=>t._tag===e);return void 0===t?C.left(x.InvalidData([],`Expected a log level but received ${e}`)):C.right(t)}),void 0===i?H:b.nested(H,i)).pipe(b.withDefault(R.Info),l.andThen(e=>T.minimumLogLevel(e)),l.tapError(e=>l.logError("Invalid log level").pipe(l.annotateLogs("error",e))),l.catchTag("ConfigError",e=>new o.UploadThingError({code:"INVALID_SERVER_CONFIG",message:"Invalid server configuration",cause:e})),I.unwrapEffect),Y=b.literal("json","logFmt","structured","pretty")("logFormat"),X=l.gen(function*(){let e=yield*G;return T[yield*Y.pipe(b.withDefault(e?"pretty":"json"))]}).pipe(l.catchTag("ConfigError",e=>new o.UploadThingError({code:"INVALID_SERVER_CONFIG",message:"Invalid server configuration",cause:e})),I.unwrapEffect),ee=(e,t)=>{let r=t?.mixin??"json",i=R.fromLiteral(t?.level??"Debug");return t=>l.flatMap("None"!==r?t[r]:l.void,()=>l.logWithLevel(i,`${e} (${t.status})`).pipe(l.annotateLogs("response",t)))},et=e=>t=>"ResponseError"===t._tag?ee(e,{level:"Error"})(t.response):l.logError(e).pipe(l.annotateLogs("error",t));var j=class extends F.TaggedError("ParserError"){message="Input validation failed. The original error with it's validation issues is in the error cause."},W=class extends F.Error{_tag="FileSizeMismatch";name="FileSizeMismatchError";constructor(e,t,r){super({reason:`You uploaded a ${e} file that was ${(0,o.bytesToFileSize)(r)}, but the limit for that type is ${t}`})}},q=class extends F.Error{_tag="FileCountMismatch";name="FileCountMismatchError";constructor(e,t,r,i){super({reason:`You uploaded ${i} file(s) of type '${e}', but the ${t} for that type is ${r}`})}};let er=Symbol("uploadthing-region-symbol"),ei=Symbol("uploadthing-custom-id-symbol");var $=class extends S.Tag("uploadthing/AdapterArguments")(){};let en=(e,t,r,i)=>{var n,a;let s,o,c,p=(n=r.config?.fetch,a=r.config,s=I.provideMerge(A.layer,I.succeed(A.Fetch,n)),o=I.effectDiscard(P.update(N.currentRedactedNames,e=>e.concat(["x-uploadthing-api-key"]))),c=I.provide(I.mergeAll(X,Q,s,o),I.setConfigProvider(_.fromJson(a??{}).pipe(_.orElse(()=>J)))),D.make(c)),f=l.promise(()=>p.runtime().then(u.toWebHandlerRuntime));return async(...n)=>await f.pipe(l.ap(((...t)=>l.map(l.promise(()=>p.runPromise(ea(r,i??"custom"))),l.provideServiceEffect($,e(...t))))(...n)),l.ap(t(...n)),l.withLogSpan("requestHandler"),p.runPromise)},ea=(e,t)=>l.gen(function*(){let r,i=yield*G,a=yield*(r=e.router,l.forEach((0,o.objectKeys)(r),e=>l.map((0,o.fillInputRouteConfig)(r[e].routerConfig),t=>({slug:e,config:t})))),u=e.config?.handleDaemonPromise?e.config.handleDaemonPromise:i?"void":"await";if(i&&"await"===u)return yield*new o.UploadThingError({code:"INVALID_SERVER_CONFIG",message:'handleDaemonPromise: "await" is forbidden in development.'});let c=l.gen(function*(){return yield*y.json(a)}),p=l.gen(function*(){let{"uploadthing-hook":r,"x-uploadthing-package":i,"x-uploadthing-version":a}=yield*g.schemaHeaders(w.Struct({"uploadthing-hook":s.UploadThingHook.pipe(w.optional),"x-uploadthing-package":w.String.pipe(w.optionalWith({default:()=>"unknown"})),"x-uploadthing-version":w.String.pipe(w.optionalWith({default:()=>n.version}))}));if(a!==n.version){let e=n.version;yield*l.logWarning("Client version mismatch. Things may not work as expected, please sync your versions to ensure compatibility.").pipe(l.annotateLogs({clientVersion:a,serverVersion:e}))}let{slug:c,actionType:p}=yield*m.schemaParams(w.Struct({actionType:s.ActionType.pipe(w.optional),slug:w.String})),f=e.router[c];if(!f){let e=`No file route found for slug ${c}`;return yield*l.logError(e),yield*new o.UploadThingError({code:"NOT_FOUND",message:e})}let{body:d,fiber:h}=yield*v.value({actionType:p,uploadthingHook:r}).pipe(v.when({actionType:"upload",uploadthingHook:void 0},()=>el({uploadable:f,fePackage:i,beAdapter:t,slug:c})),v.when({actionType:void 0,uploadthingHook:"callback"},()=>eo({uploadable:f,fePackage:i,beAdapter:t})),v.when({actionType:void 0,uploadthingHook:"error"},()=>es({uploadable:f})),v.orElse(()=>l.succeed({body:null,fiber:null})));return h&&(yield*l.logDebug("Running fiber as daemon").pipe(l.annotateLogs("handleDaemon",u)),"void"===u||("await"===u?yield*h.await:"function"==typeof u&&u(l.runPromise(h.await)))),yield*l.logDebug("Sending response").pipe(l.annotateLogs("body",d)),yield*y.json(d)}).pipe(l.catchTags({ParseError:t=>y.json(z(new o.UploadThingError({code:"BAD_REQUEST",message:"Invalid input",cause:t.message}),e.router),{status:400}),UploadThingError:t=>y.json(z(t,e.router),{status:(0,o.getStatusCodeFromError)(t)})})),f=l.map(y.setHeader("x-uploadthing-version",n.version));return m.empty.pipe(m.get("*",c),m.post("*",p),m.use(f))}).pipe(l.withLogSpan("createRequestHandler")),es=e=>l.gen(function*(){let{uploadable:t}=e,r=yield*g.HttpServerRequest,{apiKey:i}=yield*K,n=yield*(0,o.verifySignature)((yield*r.text),r.headers["x-uploadthing-signature"]??null,i);if(yield*l.logDebug(`Signature verified: ${n}`),!n)return yield*l.logError("Invalid signature"),yield*new o.UploadThingError({code:"BAD_REQUEST",message:"Invalid signature"});let a=yield*g.schemaBodyJson(w.Struct({fileKey:w.String,error:w.String}));yield*l.logDebug("Handling error callback request with input:").pipe(l.annotateLogs("json",a));let s=yield*$,u=yield*l.tryPromise({try:async()=>t.onUploadError({...s,error:new o.UploadThingError({code:"UPLOAD_FAILED",message:`Upload failed for ${a.fileKey}: ${a.error}`}),fileKey:a.fileKey}),catch:e=>new o.UploadThingError({code:"INTERNAL_SERVER_ERROR",message:"Failed to run onUploadError",cause:e})}).pipe(l.tapError(e=>l.logError("Failed to run onUploadError. You probably shouldn't be throwing errors here.").pipe(l.annotateLogs("error",e)))).pipe(l.ignoreLogged,l.forkDaemon);return{body:null,fiber:u}}).pipe(l.withLogSpan("handleErrorRequest")),eo=e=>l.gen(function*(){let{uploadable:t,fePackage:r,beAdapter:i}=e,u=yield*g.HttpServerRequest,{apiKey:c}=yield*K,h=yield*(0,o.verifySignature)((yield*u.text),u.headers["x-uploadthing-signature"]??null,c);if(yield*l.logDebug(`Signature verified: ${h}`),!h)return yield*l.logError("Invalid signature"),yield*new o.UploadThingError({code:"BAD_REQUEST",message:"Invalid signature"});let m=yield*g.schemaBodyJson(w.Struct({status:w.String,file:s.UploadedFileData,origin:w.String,metadata:w.Record({key:w.String,value:w.Unknown})}));yield*l.logDebug("Handling callback request with input:").pipe(l.annotateLogs("json",m));let y=yield*l.gen(function*(){let e=yield*$,u=yield*l.tryPromise({try:async()=>t.onUploadComplete({...e,file:{...m.file,get url(){return(0,a.logDeprecationWarning)("`file.url` is deprecated and will be removed in uploadthing v9. Use `file.ufsUrl` instead."),m.file.url},get appUrl(){return(0,a.logDeprecationWarning)("`file.appUrl` is deprecated and will be removed in uploadthing v9. Use `file.ufsUrl` instead."),m.file.appUrl}},metadata:m.metadata}),catch:e=>new o.UploadThingError({code:"INTERNAL_SERVER_ERROR",message:"Failed to run onUploadComplete. You probably shouldn't be throwing errors here.",cause:e})}),h={fileKey:m.file.key,callbackData:u??null};yield*l.logDebug("'onUploadComplete' callback finished. Sending response to UploadThing:").pipe(l.annotateLogs("callbackData",h));let g=(yield*p.HttpClient).pipe(p.filterStatusOk);yield*f.post("/callback-result").pipe(f.prependUrl(m.origin),f.setHeaders({"x-uploadthing-api-key":E.value(c),"x-uploadthing-version":n.version,"x-uploadthing-be-adapter":i,"x-uploadthing-fe-package":r}),f.bodyJson(h),l.flatMap(g.execute),l.tapError(et("Failed to register callback result")),l.flatMap(d.schemaBodyJson(s.CallbackResultResponse)),l.tap(l.log("Sent callback result to UploadThing")),l.scoped)}).pipe(l.ignoreLogged,l.forkDaemon);return{body:null,fiber:y}}).pipe(l.withLogSpan("handleCallbackRequest")),el=e=>l.gen(function*(){let t,r,i=(yield*p.HttpClient).pipe(p.filterStatusOk),{uploadable:a,fePackage:u,beAdapter:m,slug:y}=e,S=yield*g.schemaBodyJson(s.UploadActionPayload);yield*l.logDebug("Handling upload request").pipe(l.annotateLogs("json",S)),yield*l.logDebug("Parsing user input");let v=yield*l.tryPromise({try:()=>(function(e){if("parseAsync"in e&&"function"==typeof e.parseAsync)return e.parseAsync;if(w.isSchema(e))return t=>w.decodeUnknownPromise(e)(t).catch(e=>{throw new j({cause:O.squash(e[M.FiberFailureCauseId])})});if("~standard"in e)return async t=>{let r=await e["~standard"].validate(t);if(r.issues)throw new j({cause:r.issues});return r.value};throw Error("Invalid parser")})(a.inputParser)(S.input),catch:e=>new o.UploadThingError({code:"BAD_REQUEST",message:"Invalid input",cause:e})});yield*l.logDebug("Input parsed successfully").pipe(l.annotateLogs("input",v));let{metadata:_,filesWithCustomIds:x,preferredRegion:C}=yield*(t={json:{input:v,files:S.files},uploadable:a},l.gen(function*(){let{json:{files:e,input:r},uploadable:i}=t;yield*l.logDebug("Running middleware");let n=yield*$,a=yield*l.tryPromise({try:async()=>i.middleware({...n,input:r,files:e}),catch:e=>e instanceof o.UploadThingError?e:new o.UploadThingError({code:"INTERNAL_SERVER_ERROR",message:"Failed to run middleware",cause:e})});if(a[ei]&&a[ei].length!==e.length){let t=`Expected files override to have the same length as original files, got ${a[ei].length} but expected ${e.length}`;return yield*l.logError(t),yield*new o.UploadThingError({code:"BAD_REQUEST",message:"Files override must have the same length as files",cause:t})}let s=yield*l.forEach(e,(e,t)=>l.gen(function*(){let r=a[ei]?.[t];return r&&r.size!==e.size&&(yield*l.logWarning("File size mismatch. Reverting to original size")),{name:r?.name??e.name,size:e.size,type:e.type,customId:r?.customId,lastModified:r?.lastModified??Date.now()}}));return{metadata:a,filesWithCustomIds:s,preferredRegion:a[er]}}).pipe(l.withLogSpan("runRouteMiddleware")));yield*l.logDebug("Parsing route config").pipe(l.annotateLogs("routerConfig",a.routerConfig));let I=yield*(0,o.fillInputRouteConfig)(a.routerConfig).pipe(l.catchTag("InvalidRouteConfig",e=>new o.UploadThingError({code:"BAD_REQUEST",message:"Invalid route config",cause:e})));yield*l.logDebug("Route config parsed successfully").pipe(l.annotateLogs("routeConfig",I)),yield*l.logDebug("Validating files meet the config requirements").pipe(l.annotateLogs("files",S.files)),yield*(r=S.files,l.gen(function*(){let e={};for(let t of r){let r=yield*(0,o.matchFileType)(t,(0,o.objectKeys)(I));e[r]=(e[r]??0)+1;let i=I[r]?.maxFileSize;if(!i)return yield*new o.InvalidRouteConfigError(r,"maxFileSize");let n=yield*(0,o.fileSizeToBytes)(i);if(t.size>n)return yield*new W(r,i,t.size)}for(let t in e){let r=I[t];if(!r)return yield*new o.InvalidRouteConfigError(t);let i=e[t],n=r.minFileCount,a=r.maxFileCount;if(n>a)return yield*new o.UploadThingError({code:"BAD_REQUEST",message:"Invalid config during file count - minFileCount > maxFileCount",cause:`minFileCount must be less than maxFileCount for key ${t}. got: ${n} > ${a}`});if(null!=i&&i<n)return yield*new q(t,"minimum",n,i);if(null!=i&&i>a)return yield*new q(t,"maximum",a,i)}return null})).pipe(l.mapError(e=>new o.UploadThingError({code:"BAD_REQUEST",message:`Invalid config: ${e._tag}`,cause:"reason"in e?e.reason:e.message}))),yield*l.logDebug("Files validated.");let T=yield*l.forEach(x,e=>l.map((0,o.matchFileType)(e,(0,o.objectKeys)(I)),t=>({name:e.name,size:e.size,type:e.type||t,lastModified:e.lastModified,customId:e.customId,contentDisposition:I[t]?.contentDisposition??"inline",acl:I[t]?.acl}))).pipe(l.catchTags({InvalidFileType:e=>l.die(e),UnknownFileType:e=>l.die(e)})),R=a.routeOptions,{apiKey:F,appId:A}=yield*K,N=yield*Z(C),P=yield*G;yield*l.logDebug("Generating presigned URLs").pipe(l.annotateLogs("fileUploadRequests",T),l.annotateLogs("ingestUrl",N));let D=yield*l.forEach(T,e=>l.gen(function*(){let t=yield*(0,o.generateKey)(e,A,R.getFileHashParts);return{url:yield*(0,o.generateSignedURL)(`${N}/${t}`,F,{ttlInSeconds:R.presignedURLTTL,data:{"x-ut-identifier":A,"x-ut-file-name":e.name,"x-ut-file-size":e.size,"x-ut-file-type":e.type,"x-ut-slug":y,"x-ut-custom-id":e.customId,"x-ut-content-disposition":e.contentDisposition,"x-ut-acl":e.acl}}),key:t}}),{concurrency:"unbounded"}),L=yield*g.HttpServerRequest,U=yield*g.toURL(L),z=yield*b.string("callbackUrl").pipe(b.withDefault(U.origin+U.pathname),l.map(e=>f.post(e).pipe(f.appendUrlParam("slug",y)))),B=f.post("/route-metadata").pipe(f.prependUrl(N),f.setHeaders({"x-uploadthing-api-key":E.value(F),"x-uploadthing-version":n.version,"x-uploadthing-be-adapter":m,"x-uploadthing-fe-package":u}),f.bodyJson({fileKeys:D.map(({key:e})=>e),metadata:_,isDev:P,callbackUrl:z.url,callbackSlug:y,awaitServerData:R.awaitServerData??!0}),l.flatMap(i.execute)),H=l.fn("handleDevStreamError")(function*(e,t){let r=w.parseJson(w.Struct({file:s.UploadedFileData})),a=(yield*w.decodeUnknown(r)(t)).file.key;yield*l.logError("Failed to forward callback request from dev stream").pipe(l.annotateLogs({fileKey:a,error:e.message}));let o=yield*f.post("/callback-result").pipe(f.prependUrl(N),f.setHeaders({"x-uploadthing-api-key":E.value(F),"x-uploadthing-version":n.version,"x-uploadthing-be-adapter":m,"x-uploadthing-fe-package":u}),f.bodyJson({fileKey:a,error:`Failed to forward callback request from dev stream: ${e.message}`}),l.flatMap(i.execute));yield*ee("Reported callback error to UploadThing")(o)}),V=yield*l.if(P,{onTrue:()=>{let e,t;return B.pipe(l.tapBoth({onSuccess:ee("Registered metadata",{mixin:"None"}),onFailure:et("Failed to register metadata")}),h.stream,(e=s.MetadataFetchStreamPart,t=e=>z.pipe(f.setHeaders({"uploadthing-hook":e.hook,"x-uploadthing-signature":e.signature}),f.setBody(c.text(e.payload,"application/json")),i.execute,l.tap(ee("Successfully forwarded callback request from dev stream")),l.catchTag("ResponseError",t=>H(t,e.payload)),l.annotateLogs(e),l.asVoid,l.ignoreLogged,l.scoped),r=>{let i="";return r.pipe(k.decodeText(),k.mapEffect(e=>l.gen(function*(){let t=(i+=e).split("\n"),r=[];for(let e of t)try{r.push(JSON.parse(e)),i=i.slice(e.length+1)}catch{}return yield*l.logDebug("Received chunks").pipe(l.annotateLogs("chunk",e),l.annotateLogs("parsedChunks",r),l.annotateLogs("buf",i)),r})),k.mapEffect(w.decodeUnknown(w.Array(e))),k.mapEffect(l.forEach(e=>t(e))),k.runDrain,l.withLogSpan("handleJsonLineStream"))}))},onFalse:()=>B.pipe(l.tapBoth({onSuccess:ee("Registered metadata"),onFailure:et("Failed to register metadata")}),l.flatMap(d.schemaBodyJson(s.MetadataFetchResponse)),l.scoped)}).pipe(l.forkDaemon),J=D.map((e,t)=>({url:e.url,key:e.key,name:T[t].name,customId:T[t].customId??null}));return yield*l.logInfo("Sending presigned URLs to client").pipe(l.annotateLogs("presignedUrls",J)),{body:J,fiber:V}}).pipe(l.withLogSpan("handleUploadAction"));function B(e){return(t,r)=>(function e(t={}){let r={$types:{},routerConfig:{image:{maxFileSize:"4MB"}},routeOptions:{awaitServerData:!0},inputParser:{parseAsync:()=>Promise.resolve(void 0),_input:void 0,_output:void 0},middleware:()=>({}),onUploadError:()=>{},onUploadComplete:()=>void 0,errorFormatter:t.errorFormatter??U,...t};return{input:t=>e({...r,inputParser:t}),middleware:t=>e({...r,middleware:t}),onUploadComplete:e=>({...r,onUploadComplete:e}),onUploadError:t=>e({...r,onUploadError:t})}})({routerConfig:t,routeOptions:r??{},...e})}e.s(["UTFiles",()=>ei,"UTRegion",()=>er,"createBuilder",()=>B,"makeAdapterHandler",()=>en]),r()}catch(e){r(e)}},!1),313745,e=>e.a(async(t,r)=>{try{var i=e.i(300021),n=e.i(405614),a=t([i]);[i]=a.then?(await a)():a;let s=e=>(0,i.createBuilder)(e),o=e=>{let t=(0,i.makeAdapterHandler)(e=>n.succeed({req:e}),e=>n.succeed(e),e,"nextjs-app");return{POST:t,GET:t}};e.s(["createRouteHandler",()=>o,"createUploadthing",()=>s]),r()}catch(e){r(e)}},!1),154163,e=>e.a(async(t,r)=>{try{var i=e.i(313745),n=e.i(698902),a=t([i]);[i]=a.then?(await a)():a;let s=(0,i.createUploadthing)(),o=async()=>{let e=await (0,n.auth)();if(!e?.user)throw Error("Unauthorized");return{userId:e.user.id}},l={subaccountLogo:s({image:{maxFileSize:"4MB",maxFileCount:1}}).middleware(o).onUploadComplete(()=>{}),avatar:s({image:{maxFileSize:"4MB",maxFileCount:1}}).middleware(o).onUploadComplete(()=>{}),agencyLogo:s({image:{maxFileSize:"4MB",maxFileCount:1}}).middleware(o).onUploadComplete(()=>{}),media:s({image:{maxFileSize:"4MB",maxFileCount:1}}).middleware(o).onUploadComplete(()=>{})};e.s(["ourFileRouter",0,l]),r()}catch(e){r(e)}},!1),873279,e=>e.a(async(t,r)=>{try{var i=e.i(313745),n=e.i(154163),a=t([i,n]);[i,n]=a.then?(await a)():a;let{GET:s,POST:o}=(0,i.createRouteHandler)({router:n.ourFileRouter});e.s(["GET",0,s,"POST",0,o]),r()}catch(e){r(e)}},!1),901880,e=>e.a(async(t,r)=>{try{var i=e.i(747909),n=e.i(174017),a=e.i(996250),s=e.i(759756),o=e.i(561916),l=e.i(174677),u=e.i(869741),c=e.i(316795),p=e.i(487718),f=e.i(995169),d=e.i(47587),h=e.i(666012),m=e.i(570101),g=e.i(626937),y=e.i(10372),b=e.i(193695);e.i(52474);var S=e.i(600220),v=e.i(873279),E=t([v]);[v]=E.then?(await E)():E;let k=new i.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/uploadthing/route",pathname:"/api/uploadthing",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/uploadthing/route.ts",nextConfigOutput:"standalone",userland:v}),{workAsyncStorage:x,workUnitAsyncStorage:C,serverHooks:I}=k;function w(){return(0,a.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:C})}async function _(e,t,r){k.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let i="/api/uploadthing/route";i=i.replace(/\/index$/,"")||"/";let a=await k.prepare(e,t,{srcPage:i,multiZoneDraftMode:!1});if(!a)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:v,params:E,nextConfig:w,parsedUrl:_,isDraftMode:x,prerenderManifest:C,routerServerContext:I,isOnDemandRevalidate:T,revalidateOnlyGenerated:R,resolvedPathname:O,clientReferenceManifest:F,serverActionsManifest:M}=a,A=(0,u.normalizeAppPath)(i),N=!!(C.dynamicRoutes[A]||C.routes[O]),P=async()=>((null==I?void 0:I.render404)?await I.render404(e,t,_,!1):t.end("This page could not be found"),null);if(N&&!x){let e=!!C.routes[O],t=C.dynamicRoutes[A];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await P();throw new b.NoFallbackError}}let D=null;!N||k.isDev||x||(D=O,D="/index"===D?"/":D);let L=!0===k.isDev||!N,U=N&&!L;M&&F&&(0,l.setManifestsSingleton)({page:i,clientReferenceManifest:F,serverActionsManifest:M});let z=e.method||"GET",j=(0,o.getTracer)(),W=j.getActiveScopeSpan(),q={params:E,prerenderManifest:C,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:L,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,i,n)=>k.onRequestError(e,t,i,n,I)},sharedContext:{buildId:v}},$=new c.NodeNextRequest(e),B=new c.NodeNextResponse(t),H=p.NextRequestAdapter.fromNodeNextRequest($,(0,p.signalFromNodeResponse)(t));try{let a=async e=>k.handle(H,q).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=j.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==f.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${z} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${z} ${i}`)}),l=!!(0,s.getRequestMeta)(e,"minimalMode"),u=async s=>{var o,u;let c=async({previousCacheEntry:n})=>{try{if(!l&&T&&R&&!n)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await a(s);e.fetchMetrics=q.renderOpts.fetchMetrics;let o=q.renderOpts.pendingWaitUntil;o&&r.waitUntil&&(r.waitUntil(o),o=void 0);let u=q.renderOpts.collectedTags;if(!N)return await (0,h.sendResponse)($,B,i,q.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(i.headers);u&&(t[y.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==q.renderOpts.collectedRevalidate&&!(q.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&q.renderOpts.collectedRevalidate,n=void 0===q.renderOpts.collectedExpire||q.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:q.renderOpts.collectedExpire;return{value:{kind:S.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==n?void 0:n.isStale)&&await k.onRequestError(e,t,{routerKind:"App Router",routePath:i,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:T})},!1,I),t}},p=await k.handleResponse({req:e,nextConfig:w,cacheKey:D,routeKind:n.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:C,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:R,responseGenerator:c,waitUntil:r.waitUntil,isMinimalMode:l});if(!N)return null;if((null==p||null==(o=p.value)?void 0:o.kind)!==S.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(u=p.value)?void 0:u.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",T?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),x&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let f=(0,m.fromNodeOutgoingHttpHeaders)(p.value.headers);return l&&N||f.delete(y.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||f.get("Cache-Control")||f.set("Cache-Control",(0,g.getCacheControlHeader)(p.cacheControl)),await (0,h.sendResponse)($,B,new Response(p.value.body,{headers:f,status:p.value.status||200})),null};W?await u(W):await j.withPropagatedContext(e.headers,()=>j.trace(f.BaseServerSpan.handleRequest,{spanName:`${z} ${i}`,kind:o.SpanKind.SERVER,attributes:{"http.method":z,"http.target":e.url}},u))}catch(t){if(t instanceof b.NoFallbackError||await k.onRequestError(e,t,{routerKind:"App Router",routePath:A,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:T})},!1,I),N)throw t;return await (0,h.sendResponse)($,B,new Response(null,{status:500})),null}}e.s(["handler",()=>_,"patchFetch",()=>w,"routeModule",()=>k,"serverHooks",()=>I,"workAsyncStorage",()=>x,"workUnitAsyncStorage",()=>C]),r()}catch(e){r(e)}},!1)];

//# sourceMappingURL=_ff9e9e4c._.js.map